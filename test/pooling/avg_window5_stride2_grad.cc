/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.13.2.

#include <gtest/gtest.h>

#include "sycldnn/padding_mode.h"

#include "sycldnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/kernel_data_types.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn; // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using GTestTypePairs = sycldnn::types::ToGTestTypes<SNNTypePairs>::type;

template <typename Pair>
using AvgWindow5Stride2Grad =
    PoolingFixture<typename Pair::FirstType, typename Pair::SecondType,
                   pooling::Average, pooling::Backpropagate>;
TYPED_TEST_SUITE(AvgWindow5Stride2Grad, GTestTypePairs);
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.8177777777777777, 0.8177777777777777, 1.2977777777777777, 0.8533333333333334, 1.8311111111111114, 1.4577777777777778, 1.4577777777777778, 0.8177777777777777, 0.8177777777777777, 1.2977777777777777, 0.8533333333333334, 1.8311111111111114, 1.4577777777777778, 1.4577777777777778, 1.8177777777777777, 1.8177777777777777, 2.7377777777777776, 1.6933333333333334, 3.471111111111111 , 2.6977777777777776, 2.6977777777777776, 1.5733333333333333, 1.5733333333333333, 2.293333333333333 , 1.36              , 2.6933333333333334, 2.0533333333333337, 2.0533333333333337, 3.9511111111111115, 3.9511111111111115, 5.671111111111111 , 3.2933333333333334, 6.404444444444445 , 4.831111111111111 , 4.831111111111111 , 3.377777777777778 , 3.377777777777778 , 4.817777777777778 , 2.7733333333333334, 5.351111111111111 , 4.017777777777778 , 4.017777777777778 , 3.377777777777778 , 3.377777777777778 , 4.817777777777778 , 2.7733333333333334, 5.351111111111111 , 4.017777777777778 , 4.017777777777778 };
  const std::array<int, 4> in_shape = {{ 1, 7, 7, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16};
  const std::array<int, 4> in_shape = {{ 1, 7, 7, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 1.3511111111111112,  1.6355555555555554,  1.3511111111111112,  1.6355555555555554,  2.2044444444444444,  2.5955555555555554,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  1.3511111111111112,  1.6355555555555554,  1.3511111111111112,  1.6355555555555554,  2.2044444444444444,  2.5955555555555554,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  3.2444444444444445,  3.6355555555555554,  3.2444444444444445,  3.6355555555555554,  4.937777777777778 ,  5.475555555555555 ,  3.0933333333333333,  3.3866666666666667,  6.404444444444444 ,  6.942222222222222 ,  5.004444444444444 ,  5.395555555555555 ,  5.004444444444444 ,  5.395555555555555 ,  2.9333333333333336,  3.1466666666666665,  2.9333333333333336,  3.1466666666666665,  4.293333333333333 ,  4.586666666666666 ,  2.56              ,  2.72              ,  5.093333333333333 ,  5.386666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  7.511111111111111 ,  7.902222222222223 ,  7.511111111111111 ,  7.902222222222223 , 10.804444444444444 , 11.342222222222222 ,  6.293333333333334 ,  6.586666666666667 , 12.27111111111111  , 12.80888888888889  ,  9.27111111111111  ,  9.662222222222223 ,  9.27111111111111  ,  9.662222222222223 ,  6.471111111111111 ,  6.755555555555556 ,  6.471111111111111 ,  6.755555555555556 ,  9.244444444444444 ,  9.635555555555555 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 ,  6.471111111111111 ,  6.755555555555556 ,  6.471111111111111 ,  6.755555555555556 ,  9.244444444444444 ,  9.635555555555555 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 };
  const std::array<int, 4> in_shape = {{ 1, 7, 7, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               };
  const std::array<int, 4> in_shape = {{ 1, 7, 7, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  4.017777777777777 ,  4.408888888888889 ,  4.8               ,  5.191111111111111 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  4.017777777777777 ,  4.408888888888889 ,  4.8               ,  5.191111111111111 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  6.097777777777779 ,  6.488888888888889 ,  6.880000000000001 ,  7.271111111111111 ,  6.097777777777779 ,  6.488888888888889 ,  6.880000000000001 ,  7.271111111111111 ,  9.337777777777777 ,  9.875555555555556 , 10.413333333333334 , 10.95111111111111  ,  5.893333333333334 ,  6.1866666666666665,  6.4799999999999995,  6.773333333333333 , 12.271111111111113 , 12.808888888888887 , 13.346666666666666 , 13.884444444444444 ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  8.293333333333335 ,  8.586666666666666 ,  8.88              ,  9.173333333333332 ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 21.07111111111111  , 21.608888888888888 , 22.14666666666667  , 22.684444444444445 , 12.293333333333333 , 12.586666666666668 , 12.88              , 13.173333333333334 , 24.004444444444445 , 24.54222222222222  , 25.08              , 25.61777777777778  , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  };
  const std::array<int, 4> in_shape = {{ 1, 7, 7, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               };
  const std::array<int, 4> in_shape = {{ 1, 7, 7, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.3333333333333333, 0.7066666666666667, 0.7066666666666667, 1.1866666666666668, 0.8533333333333334, 1.8311111111111114, 1.4577777777777778, 1.4577777777777778, 0.3333333333333333, 0.7066666666666667, 0.7066666666666667, 1.1866666666666668, 0.8533333333333334, 1.8311111111111114, 1.4577777777777778, 1.4577777777777778, 0.7833333333333333, 1.5566666666666666, 1.5566666666666666, 2.4766666666666666, 1.6933333333333334, 3.471111111111111 , 2.6977777777777776, 2.6977777777777776, 0.7               , 1.3399999999999999, 1.3399999999999999, 2.06              , 1.36              , 2.6933333333333334, 2.0533333333333337, 2.0533333333333337, 1.7833333333333332, 3.3566666666666665, 3.3566666666666665, 5.076666666666667 , 3.2933333333333334, 6.404444444444445 , 4.831111111111111 , 4.831111111111111 , 1.5333333333333332, 2.8666666666666667, 2.8666666666666667, 4.306666666666667 , 2.7733333333333334, 5.351111111111111 , 4.017777777777778 , 4.017777777777778 , 1.5333333333333332, 2.8666666666666667, 2.8666666666666667, 4.306666666666667 , 2.7733333333333334, 5.351111111111111 , 4.017777777777778 , 4.017777777777778 };
  const std::array<int, 4> in_shape = {{ 1, 7, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.  , 0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.  , 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.  , 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.  , 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.  , 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.  , 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.  };
  const std::array<int, 4> in_shape = {{ 1, 7, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.5333333333333333,  0.6666666666666666,  1.1733333333333333,  1.4133333333333333,  1.1733333333333333,  1.4133333333333333,  2.0266666666666664,  2.3733333333333335,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  0.5333333333333333,  0.6666666666666666,  1.1733333333333333,  1.4133333333333333,  1.1733333333333333,  1.4133333333333333,  2.0266666666666664,  2.3733333333333335,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  1.3833333333333333,  1.5666666666666667,  2.783333333333333 ,  3.1133333333333333,  2.783333333333333 ,  3.1133333333333333,  4.476666666666667 ,  4.953333333333333 ,  3.0933333333333333,  3.3866666666666667,  6.404444444444444 ,  6.942222222222222 ,  5.004444444444444 ,  5.395555555555555 ,  5.004444444444444 ,  5.395555555555555 ,  1.3               ,  1.4               ,  2.5               ,  2.6799999999999997,  2.5               ,  2.6799999999999997,  3.8600000000000003,  4.12              ,  2.56              ,  2.72              ,  5.093333333333333 ,  5.386666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  3.383333333333333 ,  3.5666666666666664,  6.383333333333333 ,  6.713333333333333 ,  6.383333333333333 ,  6.713333333333333 ,  9.676666666666666 , 10.153333333333334 ,  6.293333333333334 ,  6.586666666666667 , 12.27111111111111  , 12.80888888888889  ,  9.27111111111111  ,  9.662222222222223 ,  9.27111111111111  ,  9.662222222222223 ,  2.933333333333333 ,  3.0666666666666664,  5.493333333333333 ,  5.733333333333333 ,  5.493333333333333 ,  5.733333333333333 ,  8.266666666666666 ,  8.613333333333333 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 ,  2.933333333333333 ,  3.0666666666666664,  5.493333333333333 ,  5.733333333333333 ,  5.493333333333333 ,  5.733333333333333 ,  8.266666666666666 ,  8.613333333333333 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 };
  const std::array<int, 4> in_shape = {{ 1, 7, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 7, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.9333333333333335,  1.0666666666666667,  1.2000000000000002,  1.3333333333333333,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  3.7066666666666666,  4.053333333333333 ,  4.4               ,  4.746666666666667 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  0.9333333333333335,  1.0666666666666667,  1.2000000000000002,  1.3333333333333333,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  3.7066666666666666,  4.053333333333333 ,  4.4               ,  4.746666666666667 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  2.5833333333333335,  2.7666666666666666,  2.95              ,  3.1333333333333333,  5.236666666666666 ,  5.566666666666666 ,  5.8966666666666665,  6.226666666666667 ,  5.236666666666666 ,  5.566666666666666 ,  5.8966666666666665,  6.226666666666667 ,  8.476666666666667 ,  8.953333333333333 ,  9.430000000000001 ,  9.906666666666666 ,  5.893333333333334 ,  6.1866666666666665,  6.4799999999999995,  6.773333333333333 , 12.271111111111113 , 12.808888888888887 , 13.346666666666666 , 13.884444444444444 ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  2.5               ,  2.6               ,  2.7               ,  2.8               ,  4.82              ,  5.                ,  5.18              ,  5.359999999999999 ,  4.82              ,  5.                ,  5.18              ,  5.359999999999999 ,  7.460000000000001 ,  7.720000000000001 ,  7.9799999999999995,  8.24              ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  6.583333333333333 ,  6.766666666666666 ,  6.95              ,  7.133333333333333 , 12.436666666666666 , 12.766666666666666 , 13.096666666666666 , 13.426666666666666 , 12.436666666666666 , 12.766666666666666 , 13.096666666666666 , 13.426666666666666 , 18.876666666666665 , 19.35333333333333  , 19.83              , 20.30666666666667  , 12.293333333333333 , 12.586666666666668 , 12.88              , 13.173333333333334 , 24.004444444444445 , 24.54222222222222  , 25.08              , 25.61777777777778  , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 ,  5.733333333333333 ,  5.866666666666666 ,  6.                ,  6.133333333333333 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 16.186666666666664 , 16.53333333333333  , 16.88              , 17.226666666666667 , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  ,  5.733333333333333 ,  5.866666666666666 ,  6.                ,  6.133333333333333 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 16.186666666666664 , 16.53333333333333  , 16.88              , 17.226666666666667 , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  };
  const std::array<int, 4> in_shape = {{ 1, 7, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 7, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.38333333333333336, 0.7966666666666667 , 0.7966666666666667 , 1.3166666666666669 , 0.9333333333333333 , 1.56               , 1.1466666666666665 , 2.368888888888889  , 1.8488888888888888 , 1.8488888888888888 , 0.38333333333333336, 0.7966666666666667 , 0.7966666666666667 , 1.3166666666666669 , 0.9333333333333333 , 1.56               , 1.1466666666666665 , 2.368888888888889  , 1.8488888888888888 , 1.8488888888888888 , 0.9333333333333333 , 1.8266666666666667 , 1.8266666666666667 , 2.8666666666666667 , 1.9333333333333333 , 3.12               , 2.2266666666666666 , 4.448888888888889  , 3.408888888888889  , 3.408888888888889  , 0.8500000000000001 , 1.61               , 1.61               , 2.45               , 1.6                , 2.52               , 1.76               , 3.4266666666666667 , 2.586666666666667  , 2.586666666666667  , 2.1833333333333336 , 4.076666666666666  , 4.076666666666666  , 6.116666666666666  , 3.9333333333333336 , 6.12               , 4.226666666666667  , 8.115555555555556  , 6.075555555555556  , 6.075555555555556  , 1.8833333333333333 , 3.4966666666666666 , 3.4966666666666666 , 5.216666666666667  , 3.333333333333333  , 5.16               , 3.546666666666667  , 6.768888888888889  , 5.048888888888889  , 5.048888888888889  , 1.8833333333333333 , 3.4966666666666666 , 3.4966666666666666 , 5.216666666666667  , 3.333333333333333  , 5.16               , 3.546666666666667  , 6.768888888888889  , 5.048888888888889  , 5.048888888888889  };
  const std::array<int, 4> in_shape = {{ 1, 7, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 7, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.6333333333333334,  0.7666666666666667,  1.3533333333333335,  1.5933333333333335,  1.3533333333333335,  1.5933333333333335,  2.2866666666666666,  2.6333333333333337,  1.6533333333333333,  1.8666666666666667,  2.8000000000000003,  3.12              ,  2.08              ,  2.293333333333333 ,  4.346666666666667 ,  4.737777777777778 ,  3.4133333333333336,  3.6977777777777776,  3.4133333333333336,  3.6977777777777776,  0.6333333333333334,  0.7666666666666667,  1.3533333333333335,  1.5933333333333335,  1.3533333333333335,  1.5933333333333335,  2.2866666666666666,  2.6333333333333337,  1.6533333333333333,  1.8666666666666667,  2.8000000000000003,  3.12              ,  2.08              ,  2.293333333333333 ,  4.346666666666667 ,  4.737777777777778 ,  3.4133333333333336,  3.6977777777777776,  3.4133333333333336,  3.6977777777777776,  1.6833333333333336,  1.8666666666666667,  3.3233333333333333,  3.6533333333333333,  3.3233333333333333,  3.6533333333333333,  5.256666666666667 ,  5.733333333333333 ,  3.5733333333333333,  3.8666666666666667,  5.800000000000001 ,  6.24              ,  4.16              ,  4.453333333333333 ,  8.36              ,  8.897777777777778 ,  6.426666666666668 ,  6.817777777777778 ,  6.426666666666668 ,  6.817777777777778 ,  1.6               ,  1.7000000000000002,  3.04              ,  3.22              ,  3.04              ,  3.22              ,  4.64              ,  4.9               ,  3.04              ,  3.2               ,  4.800000000000001 ,  5.04              ,  3.3600000000000003,  3.52              ,  6.5600000000000005,  6.8533333333333335,  4.96              ,  5.173333333333334 ,  4.96              ,  5.173333333333334 ,  4.183333333333334 ,  4.366666666666667 ,  7.823333333333333 ,  8.153333333333332 ,  7.823333333333333 ,  8.153333333333332 , 11.756666666666666 , 12.233333333333333 ,  7.573333333333334 ,  7.866666666666667 , 11.8               , 12.24              ,  8.16              ,  8.453333333333333 , 15.693333333333335 , 16.23111111111111  , 11.76              , 12.151111111111112 , 11.76              , 12.151111111111112 ,  3.633333333333333 ,  3.7666666666666666,  6.753333333333333 ,  6.993333333333333 ,  6.753333333333333 ,  6.993333333333333 , 10.086666666666666 , 10.433333333333334 ,  6.453333333333333 ,  6.666666666666666 , 10.                , 10.32              ,  6.880000000000001 ,  7.093333333333334 , 13.146666666666668 , 13.537777777777778 ,  9.813333333333333 , 10.097777777777779 ,  9.813333333333333 , 10.097777777777779 ,  3.633333333333333 ,  3.7666666666666666,  6.753333333333333 ,  6.993333333333333 ,  6.753333333333333 ,  6.993333333333333 , 10.086666666666666 , 10.433333333333334 ,  6.453333333333333 ,  6.666666666666666 , 10.                , 10.32              ,  6.880000000000001 ,  7.093333333333334 , 13.146666666666668 , 13.537777777777778 ,  9.813333333333333 , 10.097777777777779 ,  9.813333333333333 , 10.097777777777779 };
  const std::array<int, 4> in_shape = {{ 1, 7, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 1, 7, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 1.1333333333333333,  1.2666666666666668,  1.4000000000000001,  1.5333333333333334,  2.466666666666667 ,  2.706666666666667 ,  2.9466666666666668,  3.186666666666667 ,  2.466666666666667 ,  2.706666666666667 ,  2.9466666666666668,  3.186666666666667 ,  4.226666666666667 ,  4.573333333333333 ,  4.92              ,  5.2666666666666675,  3.0933333333333333,  3.3066666666666666,  3.5200000000000005,  3.7333333333333334,  5.28              ,  5.6000000000000005,  5.920000000000001 ,  6.24              ,  3.946666666666667 ,  4.16              ,  4.373333333333334 ,  4.586666666666666 ,  8.302222222222223 ,  8.693333333333333 ,  9.084444444444445 ,  9.475555555555555 ,  6.542222222222223 ,  6.826666666666667 ,  7.111111111111111 ,  7.395555555555555 ,  6.542222222222223 ,  6.826666666666667 ,  7.111111111111111 ,  7.395555555555555 ,  1.1333333333333333,  1.2666666666666668,  1.4000000000000001,  1.5333333333333334,  2.466666666666667 ,  2.706666666666667 ,  2.9466666666666668,  3.186666666666667 ,  2.466666666666667 ,  2.706666666666667 ,  2.9466666666666668,  3.186666666666667 ,  4.226666666666667 ,  4.573333333333333 ,  4.92              ,  5.2666666666666675,  3.0933333333333333,  3.3066666666666666,  3.5200000000000005,  3.7333333333333334,  5.28              ,  5.6000000000000005,  5.920000000000001 ,  6.24              ,  3.946666666666667 ,  4.16              ,  4.373333333333334 ,  4.586666666666666 ,  8.302222222222223 ,  8.693333333333333 ,  9.084444444444445 ,  9.475555555555555 ,  6.542222222222223 ,  6.826666666666667 ,  7.111111111111111 ,  7.395555555555555 ,  6.542222222222223 ,  6.826666666666667 ,  7.111111111111111 ,  7.395555555555555 ,  3.1833333333333336,  3.366666666666667 ,  3.55              ,  3.7333333333333334,  6.316666666666667 ,  6.6466666666666665,  6.976666666666667 ,  7.306666666666667 ,  6.316666666666667 ,  6.6466666666666665,  6.976666666666667 ,  7.306666666666667 , 10.036666666666669 , 10.513333333333334 , 10.990000000000002 , 11.466666666666667 ,  6.8533333333333335,  7.1466666666666665,  7.44              ,  7.733333333333333 , 11.16              , 11.600000000000001 , 12.04              , 12.48              ,  8.026666666666667 ,  8.32              ,  8.613333333333333 ,  8.906666666666666 , 16.182222222222226 , 16.72              , 17.25777777777778  , 17.795555555555556 , 12.462222222222223 , 12.853333333333335 , 13.244444444444444 , 13.635555555555555 , 12.462222222222223 , 12.853333333333335 , 13.244444444444444 , 13.635555555555555 ,  3.1000000000000005,  3.2               ,  3.3               ,  3.4000000000000004,  5.8999999999999995,  6.08              ,  6.260000000000001 ,  6.44              ,  5.8999999999999995,  6.08              ,  6.260000000000001 ,  6.44              ,  9.02              ,  9.28              ,  9.540000000000001 ,  9.8               ,  5.92              ,  6.08              ,  6.24              ,  6.4               ,  9.36              ,  9.600000000000001 ,  9.84              , 10.08              ,  6.56              ,  6.720000000000001 ,  6.88              ,  7.04              , 12.826666666666668 , 13.120000000000001 , 13.413333333333334 , 13.706666666666667 ,  9.706666666666667 ,  9.92              , 10.133333333333333 , 10.346666666666668 ,  9.706666666666667 ,  9.92              , 10.133333333333333 , 10.346666666666668 ,  8.183333333333334 ,  8.366666666666667 ,  8.55              ,  8.733333333333334 , 15.316666666666666 , 15.646666666666667 , 15.976666666666668 , 16.306666666666665 , 15.316666666666666 , 15.646666666666667 , 15.976666666666668 , 16.306666666666665 , 23.03666666666666  , 23.513333333333332 , 23.990000000000002 , 24.466666666666665 , 14.853333333333333 , 15.146666666666668 , 15.440000000000001 , 15.733333333333334 , 23.159999999999997 , 23.6               , 24.04              , 24.48              , 16.026666666666667 , 16.32              , 16.613333333333333 , 16.906666666666666 , 30.848888888888894 , 31.38666666666667  , 31.924444444444447 , 32.46222222222222  , 23.128888888888888 , 23.52              , 23.91111111111111  , 24.302222222222223 , 23.128888888888888 , 23.52              , 23.91111111111111  , 24.302222222222223 ,  7.133333333333333 ,  7.266666666666666 ,  7.4               ,  7.533333333333333 , 13.266666666666666 , 13.506666666666666 , 13.746666666666668 , 13.986666666666666 , 13.266666666666666 , 13.506666666666666 , 13.746666666666668 , 13.986666666666666 , 19.826666666666668 , 20.173333333333332 , 20.52              , 20.866666666666667 , 12.693333333333333 , 12.906666666666666 , 13.120000000000001 , 13.333333333333332 , 19.68              , 20.                , 20.32              , 20.64              , 13.546666666666667 , 13.760000000000002 , 13.973333333333333 , 14.186666666666667 , 25.90222222222222  , 26.293333333333337 , 26.684444444444445 , 27.075555555555557 , 19.34222222222222  , 19.626666666666665 , 19.91111111111111  , 20.195555555555558 , 19.34222222222222  , 19.626666666666665 , 19.91111111111111  , 20.195555555555558 ,  7.133333333333333 ,  7.266666666666666 ,  7.4               ,  7.533333333333333 , 13.266666666666666 , 13.506666666666666 , 13.746666666666668 , 13.986666666666666 , 13.266666666666666 , 13.506666666666666 , 13.746666666666668 , 13.986666666666666 , 19.826666666666668 , 20.173333333333332 , 20.52              , 20.866666666666667 , 12.693333333333333 , 12.906666666666666 , 13.120000000000001 , 13.333333333333332 , 19.68              , 20.                , 20.32              , 20.64              , 13.546666666666667 , 13.760000000000002 , 13.973333333333333 , 14.186666666666667 , 25.90222222222222  , 26.293333333333337 , 26.684444444444445 , 27.075555555555557 , 19.34222222222222  , 19.626666666666665 , 19.91111111111111  , 20.195555555555558 , 19.34222222222222  , 19.626666666666665 , 19.91111111111111  , 20.195555555555558 };
  const std::array<int, 4> in_shape = {{ 1, 7, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.6                , 0.72               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.6                , 0.72               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 2.04               , 2.16               , 2.28               , 2.4                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 2.04               , 2.16               , 2.28               , 2.4                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 7, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.18333333333333335, 0.18333333333333335, 0.33333333333333337, 0.25               , 0.5833333333333333 , 0.48333333333333334, 0.48333333333333334, 0.7566666666666666 , 0.7566666666666666 , 1.1866666666666668 , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 0.7566666666666666 , 0.7566666666666666 , 1.1866666666666668 , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 1.7566666666666664 , 1.7566666666666664 , 2.6266666666666665 , 1.6099999999999999 , 3.2766666666666664 , 2.536666666666667  , 2.536666666666667  , 1.5733333333333333 , 1.5733333333333333 , 2.293333333333333  , 1.36               , 2.6933333333333334 , 2.0533333333333337 , 2.0533333333333337 , 3.9511111111111115 , 3.9511111111111115 , 5.671111111111111  , 3.2933333333333334 , 6.404444444444445  , 4.831111111111111  , 4.831111111111111  , 3.377777777777778  , 3.377777777777778  , 4.817777777777778  , 2.7733333333333334 , 5.351111111111111  , 4.017777777777778  , 4.017777777777778  , 3.377777777777778  , 3.377777777777778  , 4.817777777777778  , 2.7733333333333334 , 5.351111111111111  , 4.017777777777778  , 4.017777777777778  };
  const std::array<int, 4> in_shape = {{ 1, 8, 7, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  };
  const std::array<int, 4> in_shape = {{ 1, 8, 7, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.23333333333333334,  0.3666666666666667 ,  0.23333333333333334,  0.3666666666666667 ,  0.48333333333333334,  0.6666666666666667 ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  3.166666666666666  ,  3.5133333333333328 ,  3.166666666666666  ,  3.5133333333333328 ,  4.776666666666666  ,  5.253333333333333  ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  2.9333333333333336 ,  3.1466666666666665 ,  2.9333333333333336 ,  3.1466666666666665 ,  4.293333333333333  ,  4.586666666666666  ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  7.511111111111111  ,  7.902222222222223  ,  7.511111111111111  ,  7.902222222222223  , 10.804444444444444  , 11.342222222222222  ,  6.293333333333334  ,  6.586666666666667  , 12.27111111111111   , 12.80888888888889   ,  9.27111111111111   ,  9.662222222222223  ,  9.27111111111111   ,  9.662222222222223  ,  6.471111111111111  ,  6.755555555555556  ,  6.471111111111111  ,  6.755555555555556  ,  9.244444444444444  ,  9.635555555555555  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  ,  6.471111111111111  ,  6.755555555555556  ,  6.471111111111111  ,  6.755555555555556  ,  9.244444444444444  ,  9.635555555555555  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  };
  const std::array<int, 4> in_shape = {{ 1, 8, 7, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 8, 7, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.3333333333333333,  0.4666666666666667,  0.6000000000000001,  0.7333333333333334,  0.3333333333333333,  0.4666666666666667,  0.6000000000000001,  0.7333333333333334,  0.7833333333333333,  0.9666666666666667,  1.1500000000000001,  1.3333333333333335,  0.7               ,  0.8               ,  0.9000000000000001,  1.                ,  1.7833333333333332,  1.9666666666666666,  2.1500000000000004,  2.333333333333333 ,  1.5333333333333332,  1.6666666666666665,  1.8               ,  1.9333333333333333,  1.5333333333333332,  1.6666666666666665,  1.8               ,  1.9333333333333333,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  3.7566666666666664,  4.086666666666666 ,  4.416666666666667 ,  4.746666666666667 ,  2.54              ,  2.72              ,  2.9000000000000004,  3.08              ,  5.556666666666667 ,  5.886666666666667 ,  6.216666666666667 ,  6.546666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  3.7566666666666664,  4.086666666666666 ,  4.416666666666667 ,  4.746666666666667 ,  2.54              ,  2.72              ,  2.9000000000000004,  3.08              ,  5.556666666666667 ,  5.886666666666667 ,  6.216666666666667 ,  6.546666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  5.986666666666666 ,  6.333333333333332 ,  6.68              ,  7.0266666666666655,  5.986666666666666 ,  6.333333333333332 ,  6.68              ,  7.0266666666666655,  9.076666666666668 ,  9.553333333333333 , 10.030000000000001 , 10.506666666666666 ,  5.66              ,  5.92              ,  6.180000000000001 ,  6.4399999999999995, 11.676666666666668 , 12.153333333333332 , 12.63              , 13.106666666666666 ,  9.106666666666667 ,  9.453333333333333 ,  9.799999999999999 , 10.146666666666668 ,  9.106666666666667 ,  9.453333333333333 ,  9.799999999999999 , 10.146666666666668 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  8.293333333333335 ,  8.586666666666666 ,  8.88              ,  9.173333333333332 ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 21.07111111111111  , 21.608888888888888 , 22.14666666666667  , 22.684444444444445 , 12.293333333333333 , 12.586666666666668 , 12.88              , 13.173333333333334 , 24.004444444444445 , 24.54222222222222  , 25.08              , 25.61777777777778  , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  };
  const std::array<int, 4> in_shape = {{ 1, 8, 7, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 8, 7, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625             , 0.1625             , 0.1625             , 0.3125             , 0.25               , 0.5833333333333333 , 0.48333333333333334, 0.48333333333333334, 0.3125             , 0.6525             , 0.6525             , 1.0825             , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 0.3125             , 0.6525             , 0.6525             , 1.0825             , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 0.7625             , 1.5025             , 1.5025             , 2.3725             , 1.6099999999999999 , 3.2766666666666664 , 2.536666666666667  , 2.536666666666667  , 0.7                , 1.3399999999999999 , 1.3399999999999999 , 2.06               , 1.36               , 2.6933333333333334 , 2.0533333333333337 , 2.0533333333333337 , 1.7833333333333332 , 3.3566666666666665 , 3.3566666666666665 , 5.076666666666667  , 3.2933333333333334 , 6.404444444444445  , 4.831111111111111  , 4.831111111111111  , 1.5333333333333332 , 2.8666666666666667 , 2.8666666666666667 , 4.306666666666667  , 2.7733333333333334 , 5.351111111111111  , 4.017777777777778  , 4.017777777777778  , 1.5333333333333332 , 2.8666666666666667 , 2.8666666666666667 , 4.306666666666667  , 2.7733333333333334 , 5.351111111111111  , 4.017777777777778  , 4.017777777777778  };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.  , 0.04, 0.04, 0.12, 0.12, 0.12, 0.08, 0.08, 0.  , 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.  , 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.  , 0.16, 0.16, 0.4 , 0.4 , 0.4 , 0.24, 0.24, 0.  , 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.  , 0.12, 0.12, 0.28, 0.28, 0.28, 0.16, 0.16, 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.3625             ,  1.525              ,  2.7125000000000004 ,  3.005              ,  2.7125000000000004 ,  3.005              ,  4.3225             ,  4.745              ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  1.3                ,  1.4                ,  2.5                ,  2.6799999999999997 ,  2.5                ,  2.6799999999999997 ,  3.8600000000000003 ,  4.12               ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.383333333333333  ,  3.5666666666666664 ,  6.383333333333333  ,  6.713333333333333  ,  6.383333333333333  ,  6.713333333333333  ,  9.676666666666666  , 10.153333333333334  ,  6.293333333333334  ,  6.586666666666667  , 12.27111111111111   , 12.80888888888889   ,  9.27111111111111   ,  9.662222222222223  ,  9.27111111111111   ,  9.662222222222223  ,  2.933333333333333  ,  3.0666666666666664 ,  5.493333333333333  ,  5.733333333333333  ,  5.493333333333333  ,  5.733333333333333  ,  8.266666666666666  ,  8.613333333333333  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  ,  2.933333333333333  ,  3.0666666666666664 ,  5.493333333333333  ,  5.733333333333333  ,  5.493333333333333  ,  5.733333333333333  ,  8.266666666666666  ,  8.613333333333333  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.1875             ,  0.25               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.7625             ,  0.925              ,  1.0875000000000001 ,  1.25               ,  0.7                ,  0.8                ,  0.9000000000000001 ,  1.                 ,  1.7833333333333332 ,  1.9666666666666666 ,  2.1500000000000004 ,  2.333333333333333  ,  1.5333333333333332 ,  1.6666666666666665 ,  1.8                ,  1.9333333333333333 ,  1.5333333333333332 ,  1.6666666666666665 ,  1.8                ,  1.9333333333333333 ,  0.9125000000000001 ,  1.025              ,  1.1375000000000002 ,  1.25               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  3.4525             ,  3.745              ,  4.0375             ,  4.33               ,  2.54               ,  2.72               ,  2.9000000000000004 ,  3.08               ,  5.556666666666667  ,  5.886666666666667  ,  6.216666666666667  ,  6.546666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  0.9125000000000001 ,  1.025              ,  1.1375000000000002 ,  1.25               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  3.4525             ,  3.745              ,  4.0375             ,  4.33               ,  2.54               ,  2.72               ,  2.9000000000000004 ,  3.08               ,  5.556666666666667  ,  5.886666666666667  ,  6.216666666666667  ,  6.546666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  2.5625             ,  2.725              ,  2.8875             ,  3.05               ,  5.1325             ,  5.425000000000001  ,  5.717500000000001  ,  6.01               ,  5.1325             ,  5.425000000000001  ,  5.717500000000001  ,  6.01               ,  8.2225             ,  8.645              ,  9.0675             ,  9.49               ,  5.66               ,  5.92               ,  6.180000000000001  ,  6.4399999999999995 , 11.676666666666668  , 12.153333333333332  , 12.63               , 13.106666666666666  ,  9.106666666666667  ,  9.453333333333333  ,  9.799999999999999  , 10.146666666666668  ,  9.106666666666667  ,  9.453333333333333  ,  9.799999999999999  , 10.146666666666668  ,  2.5                ,  2.6                ,  2.7                ,  2.8                ,  4.82               ,  5.                 ,  5.18               ,  5.359999999999999  ,  4.82               ,  5.                 ,  5.18               ,  5.359999999999999  ,  7.460000000000001  ,  7.720000000000001  ,  7.9799999999999995 ,  8.24               ,  4.96               ,  5.12               ,  5.28               ,  5.44               ,  9.893333333333334  , 10.186666666666666  , 10.48               , 10.773333333333333  ,  7.573333333333334  ,  7.786666666666666  ,  8.                 ,  8.213333333333335  ,  7.573333333333334  ,  7.786666666666666  ,  8.                 ,  8.213333333333335  ,  6.583333333333333  ,  6.766666666666666  ,  6.95               ,  7.133333333333333  , 12.436666666666666  , 12.766666666666666  , 13.096666666666666  , 13.426666666666666  , 12.436666666666666  , 12.766666666666666  , 13.096666666666666  , 13.426666666666666  , 18.876666666666665  , 19.35333333333333   , 19.83               , 20.30666666666667   , 12.293333333333333  , 12.586666666666668  , 12.88               , 13.173333333333334  , 24.004444444444445  , 24.54222222222222   , 25.08               , 25.61777777777778   , 18.151111111111113  , 18.54222222222222   , 18.933333333333334  , 19.324444444444445  , 18.151111111111113  , 18.54222222222222   , 18.933333333333334  , 19.324444444444445  ,  5.733333333333333  ,  5.866666666666666  ,  6.                 ,  6.133333333333333  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 16.186666666666664  , 16.53333333333333   , 16.88               , 17.226666666666667  , 10.453333333333333  , 10.666666666666668  , 10.88               , 11.093333333333334  , 20.23111111111111   , 20.622222222222224  , 21.013333333333335  , 21.404444444444444  , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   ,  5.733333333333333  ,  5.866666666666666  ,  6.                 ,  6.133333333333333  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 16.186666666666664  , 16.53333333333333   , 16.88               , 17.226666666666667  , 10.453333333333333  , 10.666666666666668  , 10.88               , 11.093333333333334  , 20.23111111111111   , 20.622222222222224  , 21.013333333333335  , 21.404444444444444  , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625             , 0.1625             , 0.1625             , 0.3125             , 0.25               , 0.45               , 0.35000000000000003, 0.7666666666666666 , 0.6166666666666667 , 0.6166666666666667 , 0.36250000000000004, 0.7425             , 0.7425             , 1.2125000000000001 , 0.8500000000000001 , 1.4100000000000001 , 1.03               , 2.1133333333333333 , 1.6433333333333333 , 1.6433333333333333 , 0.36250000000000004, 0.7425             , 0.7425             , 1.2125000000000001 , 0.8500000000000001 , 1.4100000000000001 , 1.03               , 2.1133333333333333 , 1.6433333333333333 , 1.6433333333333333 , 0.9125000000000001 , 1.7725             , 1.7725             , 2.7625             , 1.85               , 2.97               , 2.1100000000000003 , 4.193333333333333  , 3.203333333333333  , 3.203333333333333  , 0.8500000000000001 , 1.61               , 1.61               , 2.45               , 1.6                , 2.52               , 1.76               , 3.4266666666666667 , 2.586666666666667  , 2.586666666666667  , 2.1833333333333336 , 4.076666666666666  , 4.076666666666666  , 6.116666666666666  , 3.9333333333333336 , 6.12               , 4.226666666666667  , 8.115555555555556  , 6.075555555555556  , 6.075555555555556  , 1.8833333333333333 , 3.4966666666666666 , 3.4966666666666666 , 5.216666666666667  , 3.333333333333333  , 5.16               , 3.546666666666667  , 6.768888888888889  , 5.048888888888889  , 5.048888888888889  , 1.8833333333333333 , 3.4966666666666666 , 3.4966666666666666 , 5.216666666666667  , 3.333333333333333  , 5.16               , 3.546666666666667  , 6.768888888888889  , 5.048888888888889  , 5.048888888888889  };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.75               ,  0.9                ,  0.6000000000000001 ,  0.7000000000000001 ,  1.35               ,  1.5333333333333332 ,  1.1                ,  1.2333333333333334 ,  1.1                ,  1.2333333333333334 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  1.6625             ,  1.8250000000000002 ,  3.2525000000000004 ,  3.545              ,  3.2525000000000004 ,  3.545              ,  5.1025             ,  5.525              ,  3.44               ,  3.7                ,  5.550000000000001  ,  5.94               ,  3.9600000000000004 ,  4.220000000000001  ,  7.91               ,  8.386666666666667  ,  6.0600000000000005 ,  6.406666666666666  ,  6.0600000000000005 ,  6.406666666666666  ,  1.6                ,  1.7000000000000002 ,  3.04               ,  3.22               ,  3.04               ,  3.22               ,  4.64               ,  4.9                ,  3.04               ,  3.2                ,  4.800000000000001  ,  5.04               ,  3.3600000000000003 ,  3.52               ,  6.5600000000000005 ,  6.8533333333333335 ,  4.96               ,  5.173333333333334  ,  4.96               ,  5.173333333333334  ,  4.183333333333334  ,  4.366666666666667  ,  7.823333333333333  ,  8.153333333333332  ,  7.823333333333333  ,  8.153333333333332  , 11.756666666666666  , 12.233333333333333  ,  7.573333333333334  ,  7.866666666666667  , 11.8                , 12.24               ,  8.16               ,  8.453333333333333  , 15.693333333333335  , 16.23111111111111   , 11.76               , 12.151111111111112  , 11.76               , 12.151111111111112  ,  3.633333333333333  ,  3.7666666666666666 ,  6.753333333333333  ,  6.993333333333333  ,  6.753333333333333  ,  6.993333333333333  , 10.086666666666666  , 10.433333333333334  ,  6.453333333333333  ,  6.666666666666666  , 10.                 , 10.32               ,  6.880000000000001  ,  7.093333333333334  , 13.146666666666668  , 13.537777777777778  ,  9.813333333333333  , 10.097777777777779  ,  9.813333333333333  , 10.097777777777779  ,  3.633333333333333  ,  3.7666666666666666 ,  6.753333333333333  ,  6.993333333333333  ,  6.753333333333333  ,  6.993333333333333  , 10.086666666666666  , 10.433333333333334  ,  6.453333333333333  ,  6.666666666666666  , 10.                 , 10.32               ,  6.880000000000001  ,  7.093333333333334  , 13.146666666666668  , 13.537777777777778  ,  9.813333333333333  , 10.097777777777779  ,  9.813333333333333  , 10.097777777777779  };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.1875             ,  0.25               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.7625             ,  0.925              ,  1.0875000000000001 ,  1.25               ,  0.7                ,  0.8                ,  0.9000000000000001 ,  1.                 ,  1.35               ,  1.5                ,  1.6500000000000001 ,  1.8                ,  1.1                ,  1.2000000000000002 ,  1.3                ,  1.4000000000000001 ,  2.5166666666666666 ,  2.7                ,  2.8833333333333333 ,  3.0666666666666664 ,  2.0666666666666664 ,  2.2                ,  2.333333333333333  ,  2.466666666666667  ,  2.0666666666666664 ,  2.2                ,  2.333333333333333  ,  2.466666666666667  ,  1.1125             ,  1.225              ,  1.3375000000000001 ,  1.4500000000000002 ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  3.9725             ,  4.265000000000001  ,  4.5575             ,  4.8500000000000005 ,  2.86               ,  3.04               ,  3.22               ,  3.4000000000000004 ,  4.83               ,  5.1000000000000005 ,  5.370000000000001  ,  5.640000000000001  ,  3.58               ,  3.7600000000000007 ,  3.9400000000000004 ,  4.12               ,  7.463333333333334  ,  7.793333333333334  ,  8.123333333333333  ,  8.453333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  1.1125             ,  1.225              ,  1.3375000000000001 ,  1.4500000000000002 ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  3.9725             ,  4.265000000000001  ,  4.5575             ,  4.8500000000000005 ,  2.86               ,  3.04               ,  3.22               ,  3.4000000000000004 ,  4.83               ,  5.1000000000000005 ,  5.370000000000001  ,  5.640000000000001  ,  3.58               ,  3.7600000000000007 ,  3.9400000000000004 ,  4.12               ,  7.463333333333334  ,  7.793333333333334  ,  8.123333333333333  ,  8.453333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  3.1625000000000005 ,  3.325              ,  3.4875             ,  3.6500000000000004 ,  6.2124999999999995 ,  6.505000000000001  ,  6.7975             ,  7.09               ,  6.2124999999999995 ,  6.505000000000001  ,  6.7975             ,  7.09               ,  9.7825             , 10.205              , 10.627500000000001  , 11.05               ,  6.62               ,  6.88               ,  7.140000000000001  ,  7.4                , 10.71               , 11.100000000000001  , 11.490000000000002  , 11.88               ,  7.66               ,  7.920000000000001  ,  8.18               ,  8.440000000000001  , 15.343333333333334  , 15.82               , 16.296666666666667  , 16.773333333333333  , 11.773333333333333  , 12.120000000000001  , 12.466666666666669  , 12.813333333333333  , 11.773333333333333  , 12.120000000000001  , 12.466666666666669  , 12.813333333333333  ,  3.1000000000000005 ,  3.2                ,  3.3                ,  3.4000000000000004 ,  5.8999999999999995 ,  6.08               ,  6.260000000000001  ,  6.44               ,  5.8999999999999995 ,  6.08               ,  6.260000000000001  ,  6.44               ,  9.02               ,  9.28               ,  9.540000000000001  ,  9.8                ,  5.92               ,  6.08               ,  6.24               ,  6.4                ,  9.36               ,  9.600000000000001  ,  9.84               , 10.08               ,  6.56               ,  6.720000000000001  ,  6.88               ,  7.04               , 12.826666666666668  , 13.120000000000001  , 13.413333333333334  , 13.706666666666667  ,  9.706666666666667  ,  9.92               , 10.133333333333333  , 10.346666666666668  ,  9.706666666666667  ,  9.92               , 10.133333333333333  , 10.346666666666668  ,  8.183333333333334  ,  8.366666666666667  ,  8.55               ,  8.733333333333334  , 15.316666666666666  , 15.646666666666667  , 15.976666666666668  , 16.306666666666665  , 15.316666666666666  , 15.646666666666667  , 15.976666666666668  , 16.306666666666665  , 23.03666666666666   , 23.513333333333332  , 23.990000000000002  , 24.466666666666665  , 14.853333333333333  , 15.146666666666668  , 15.440000000000001  , 15.733333333333334  , 23.159999999999997  , 23.6                , 24.04               , 24.48               , 16.026666666666667  , 16.32               , 16.613333333333333  , 16.906666666666666  , 30.848888888888894  , 31.38666666666667   , 31.924444444444447  , 32.46222222222222   , 23.128888888888888  , 23.52               , 23.91111111111111   , 24.302222222222223  , 23.128888888888888  , 23.52               , 23.91111111111111   , 24.302222222222223  ,  7.133333333333333  ,  7.266666666666666  ,  7.4                ,  7.533333333333333  , 13.266666666666666  , 13.506666666666666  , 13.746666666666668  , 13.986666666666666  , 13.266666666666666  , 13.506666666666666  , 13.746666666666668  , 13.986666666666666  , 19.826666666666668  , 20.173333333333332  , 20.52               , 20.866666666666667  , 12.693333333333333  , 12.906666666666666  , 13.120000000000001  , 13.333333333333332  , 19.68               , 20.                 , 20.32               , 20.64               , 13.546666666666667  , 13.760000000000002  , 13.973333333333333  , 14.186666666666667  , 25.90222222222222   , 26.293333333333337  , 26.684444444444445  , 27.075555555555557  , 19.34222222222222   , 19.626666666666665  , 19.91111111111111   , 20.195555555555558  , 19.34222222222222   , 19.626666666666665  , 19.91111111111111   , 20.195555555555558  ,  7.133333333333333  ,  7.266666666666666  ,  7.4                ,  7.533333333333333  , 13.266666666666666  , 13.506666666666666  , 13.746666666666668  , 13.986666666666666  , 13.266666666666666  , 13.506666666666666  , 13.746666666666668  , 13.986666666666666  , 19.826666666666668  , 20.173333333333332  , 20.52               , 20.866666666666667  , 12.693333333333333  , 12.906666666666666  , 13.120000000000001  , 13.333333333333332  , 19.68               , 20.                 , 20.32               , 20.64               , 13.546666666666667  , 13.760000000000002  , 13.973333333333333  , 14.186666666666667  , 25.90222222222222   , 26.293333333333337  , 26.684444444444445  , 27.075555555555557  , 19.34222222222222   , 19.626666666666665  , 19.91111111111111   , 20.195555555555558  , 19.34222222222222   , 19.626666666666665  , 19.91111111111111   , 20.195555555555558  };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.6                , 0.72               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.6                , 0.72               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 2.04               , 2.16               , 2.28               , 2.4                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 1.2000000000000002 , 1.28               , 1.3599999999999999 , 1.44               , 2.04               , 2.16               , 2.28               , 2.4                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.18333333333333335, 0.18333333333333335, 0.33333333333333337, 0.25               , 0.5833333333333333 , 0.48333333333333334, 0.48333333333333334, 0.7566666666666666 , 0.7566666666666666 , 1.1866666666666668 , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 0.7566666666666666 , 0.7566666666666666 , 1.1866666666666668 , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 1.7566666666666664 , 1.7566666666666664 , 2.6266666666666665 , 1.6099999999999999 , 3.2766666666666664 , 2.536666666666667  , 2.536666666666667  , 1.5733333333333333 , 1.5733333333333333 , 2.293333333333333  , 1.36               , 2.6933333333333334 , 2.0533333333333337 , 2.0533333333333337 , 3.                 , 3.                 , 4.319999999999999  , 2.52               , 4.92               , 3.7200000000000006 , 3.7200000000000006 , 2.4266666666666667 , 2.4266666666666667 , 3.466666666666667  , 2.                 , 3.866666666666667  , 2.9066666666666663 , 2.9066666666666663 , 5.515555555555555  , 5.515555555555555  , 7.822222222222223  , 4.466666666666667  , 8.555555555555557  , 6.395555555555555  , 6.395555555555555  , 4.515555555555555  , 4.515555555555555  , 6.3822222222222225 , 3.626666666666667  , 6.915555555555556  , 5.155555555555555  , 5.155555555555555  , 4.515555555555555  , 4.515555555555555  , 6.3822222222222225 , 3.626666666666667  , 6.915555555555556  , 5.155555555555555  , 5.155555555555555  };
  const std::array<int, 4> in_shape = {{ 1, 10, 7, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.36              , 0.36              , 0.8400000000000001, 0.8400000000000001, 0.8400000000000001, 0.48              , 0.48              , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 1, 10, 7, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.23333333333333334,  0.3666666666666667 ,  0.23333333333333334,  0.3666666666666667 ,  0.48333333333333334,  0.6666666666666667 ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  3.166666666666666  ,  3.5133333333333328 ,  3.166666666666666  ,  3.5133333333333328 ,  4.776666666666666  ,  5.253333333333333  ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  2.9333333333333336 ,  3.1466666666666665 ,  2.9333333333333336 ,  3.1466666666666665 ,  4.293333333333333  ,  4.586666666666666  ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  5.680000000000001  ,  6.                 ,  5.680000000000001  ,  6.                 ,  8.2                ,  8.639999999999999  ,  4.8                ,  5.04               ,  9.399999999999999  ,  9.84               ,  7.119999999999999  ,  7.440000000000001  ,  7.119999999999999  ,  7.440000000000001  ,  4.640000000000001  ,  4.8533333333333335 ,  4.640000000000001  ,  4.8533333333333335 ,  6.640000000000001  ,  6.933333333333334  ,  3.84               ,  4.                 ,  7.4399999999999995 ,  7.733333333333334  ,  5.6                ,  5.813333333333333  ,  5.6                ,  5.813333333333333  , 10.64               , 11.03111111111111   , 10.64               , 11.03111111111111   , 15.106666666666667  , 15.644444444444446  ,  8.64               ,  8.933333333333334  , 16.573333333333334  , 17.111111111111114  , 12.399999999999999  , 12.79111111111111   , 12.399999999999999  , 12.79111111111111   ,  8.746666666666668  ,  9.03111111111111   ,  8.746666666666668  ,  9.03111111111111   , 12.373333333333335  , 12.764444444444445  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   ,  8.746666666666668  ,  9.03111111111111   ,  8.746666666666668  ,  9.03111111111111   , 12.373333333333335  , 12.764444444444445  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   };
  const std::array<int, 4> in_shape = {{ 1, 10, 7, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.6                , 0.72               , 0.6                , 0.72               , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 0.8400000000000001 , 0.96               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 10, 7, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.3333333333333333,  0.4666666666666667,  0.6000000000000001,  0.7333333333333334,  0.3333333333333333,  0.4666666666666667,  0.6000000000000001,  0.7333333333333334,  0.7833333333333333,  0.9666666666666667,  1.1500000000000001,  1.3333333333333335,  0.7               ,  0.8               ,  0.9000000000000001,  1.                ,  1.7833333333333332,  1.9666666666666666,  2.1500000000000004,  2.333333333333333 ,  1.5333333333333332,  1.6666666666666665,  1.8               ,  1.9333333333333333,  1.5333333333333332,  1.6666666666666665,  1.8               ,  1.9333333333333333,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  3.7566666666666664,  4.086666666666666 ,  4.416666666666667 ,  4.746666666666667 ,  2.54              ,  2.72              ,  2.9000000000000004,  3.08              ,  5.556666666666667 ,  5.886666666666667 ,  6.216666666666667 ,  6.546666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  3.7566666666666664,  4.086666666666666 ,  4.416666666666667 ,  4.746666666666667 ,  2.54              ,  2.72              ,  2.9000000000000004,  3.08              ,  5.556666666666667 ,  5.886666666666667 ,  6.216666666666667 ,  6.546666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  5.986666666666666 ,  6.333333333333332 ,  6.68              ,  7.0266666666666655,  5.986666666666666 ,  6.333333333333332 ,  6.68              ,  7.0266666666666655,  9.076666666666668 ,  9.553333333333333 , 10.030000000000001 , 10.506666666666666 ,  5.66              ,  5.92              ,  6.180000000000001 ,  6.4399999999999995, 11.676666666666668 , 12.153333333333332 , 12.63              , 13.106666666666666 ,  9.106666666666667 ,  9.453333333333333 ,  9.799999999999999 , 10.146666666666668 ,  9.106666666666667 ,  9.453333333333333 ,  9.799999999999999 , 10.146666666666668 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  8.293333333333335 ,  8.586666666666666 ,  8.88              ,  9.173333333333332 ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 , 11.040000000000003 , 11.360000000000001 , 11.68              , 12.                , 11.040000000000003 , 11.360000000000001 , 11.68              , 12.                , 15.960000000000004 , 16.4               , 16.84              , 17.279999999999998 ,  9.36              ,  9.6               ,  9.84              , 10.08              , 18.360000000000003 , 18.799999999999997 , 19.24              , 19.68              , 13.920000000000002 , 14.239999999999998 , 14.559999999999999 , 14.880000000000003 , 13.920000000000002 , 14.239999999999998 , 14.559999999999999 , 14.880000000000003 ,  9.066666666666666 ,  9.280000000000001 ,  9.493333333333332 ,  9.706666666666667 ,  9.066666666666666 ,  9.280000000000001 ,  9.493333333333332 ,  9.706666666666667 , 12.986666666666668 , 13.280000000000001 , 13.573333333333334 , 13.866666666666667 ,  7.5200000000000005,  7.68              ,  7.84              ,  8.                , 14.586666666666666 , 14.879999999999999 , 15.173333333333332 , 15.466666666666669 , 10.986666666666668 , 11.2               , 11.413333333333334 , 11.626666666666665 , 10.986666666666668 , 11.2               , 11.413333333333334 , 11.626666666666665 , 20.888888888888886 , 21.28              , 21.67111111111111  , 22.06222222222222  , 20.888888888888886 , 21.28              , 21.67111111111111  , 22.06222222222222  , 29.675555555555555 , 30.213333333333335 , 30.75111111111111  , 31.28888888888889  , 16.986666666666668 , 17.28              , 17.573333333333334 , 17.866666666666667 , 32.60888888888889  , 33.14666666666667  , 33.684444444444445 , 34.22222222222223  , 24.40888888888889  , 24.799999999999997 , 25.191111111111113 , 25.58222222222222  , 24.40888888888889  , 24.799999999999997 , 25.191111111111113 , 25.58222222222222  , 17.208888888888886 , 17.493333333333336 , 17.77777777777778  , 18.06222222222222  , 17.208888888888886 , 17.493333333333336 , 17.77777777777778  , 18.06222222222222  , 24.355555555555554 , 24.74666666666667  , 25.137777777777778 , 25.52888888888889  , 13.866666666666667 , 14.080000000000002 , 14.293333333333333 , 14.506666666666668 , 26.488888888888887 , 26.880000000000003 , 27.27111111111111  , 27.662222222222223 , 19.76888888888889  , 20.053333333333335 , 20.337777777777777 , 20.62222222222222  , 19.76888888888889  , 20.053333333333335 , 20.337777777777777 , 20.62222222222222  , 17.208888888888886 , 17.493333333333336 , 17.77777777777778  , 18.06222222222222  , 17.208888888888886 , 17.493333333333336 , 17.77777777777778  , 18.06222222222222  , 24.355555555555554 , 24.74666666666667  , 25.137777777777778 , 25.52888888888889  , 13.866666666666667 , 14.080000000000002 , 14.293333333333333 , 14.506666666666668 , 26.488888888888887 , 26.880000000000003 , 27.27111111111111  , 27.662222222222223 , 19.76888888888889  , 20.053333333333335 , 20.337777777777777 , 20.62222222222222  , 19.76888888888889  , 20.053333333333335 , 20.337777777777777 , 20.62222222222222  };
  const std::array<int, 4> in_shape = {{ 1, 10, 7, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 1.08               , 1.2                , 1.32               , 1.44               , 1.08               , 1.2                , 1.32               , 1.44               , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 1.56               , 1.6800000000000002 , 1.8                , 1.92               , 1.56               , 1.6800000000000002 , 1.8                , 1.92               , 1.04               , 1.12               , 1.2                , 1.28               , 1.04               , 1.12               , 1.2                , 1.28               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 1.04               , 1.12               , 1.2                , 1.28               , 1.04               , 1.12               , 1.2                , 1.28               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 10, 7, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.0625             , 0.1625             , 0.1625             , 0.3125             , 0.25               , 0.5833333333333333 , 0.48333333333333334, 0.48333333333333334, 0.3125             , 0.6525             , 0.6525             , 1.0825             , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 0.3125             , 0.6525             , 0.6525             , 1.0825             , 0.77               , 1.6366666666666667 , 1.2966666666666669 , 1.2966666666666669 , 0.7625             , 1.5025             , 1.5025             , 2.3725             , 1.6099999999999999 , 3.2766666666666664 , 2.536666666666667  , 2.536666666666667  , 0.7                , 1.3399999999999999 , 1.3399999999999999 , 2.06               , 1.36               , 2.6933333333333334 , 2.0533333333333337 , 2.0533333333333337 , 1.35               , 2.55               , 2.55               , 3.87               , 2.52               , 4.92               , 3.7200000000000006 , 3.7200000000000006 , 1.1                , 2.06               , 2.06               , 3.1                , 2.                 , 3.866666666666667  , 2.9066666666666663 , 2.9066666666666663 , 2.5166666666666666 , 4.676666666666667  , 4.676666666666667  , 6.983333333333333  , 4.466666666666667  , 8.555555555555557  , 6.395555555555555  , 6.395555555555555  , 2.0666666666666664 , 3.826666666666666  , 3.826666666666666  , 5.693333333333333  , 3.626666666666667  , 6.915555555555556  , 5.155555555555555  , 5.155555555555555  , 2.0666666666666664 , 3.826666666666666  , 3.826666666666666  , 5.693333333333333  , 3.626666666666667  , 6.915555555555556  , 5.155555555555555  , 5.155555555555555  };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.                , 0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.                , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.                , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.                , 0.36              , 0.36              , 0.8400000000000001, 0.8400000000000001, 0.8400000000000001, 0.48              , 0.48              , 0.                , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.                , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.                , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.                , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.3625             ,  1.525              ,  2.7125000000000004 ,  3.005              ,  2.7125000000000004 ,  3.005              ,  4.3225             ,  4.745              ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  1.3                ,  1.4                ,  2.5                ,  2.6799999999999997 ,  2.5                ,  2.6799999999999997 ,  3.8600000000000003 ,  4.12               ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  2.55               ,  2.7                ,  4.83               ,  5.1                ,  4.83               ,  5.1                ,  7.3500000000000005 ,  7.74               ,  4.8                ,  5.04               ,  9.399999999999999  ,  9.84               ,  7.119999999999999  ,  7.440000000000001  ,  7.119999999999999  ,  7.440000000000001  ,  2.1                ,  2.2                ,  3.9400000000000004 ,  4.12               ,  3.9400000000000004 ,  4.12               ,  5.94               ,  6.2                ,  3.84               ,  4.                 ,  7.4399999999999995 ,  7.733333333333334  ,  5.6                ,  5.813333333333333  ,  5.6                ,  5.813333333333333  ,  4.85               ,  5.033333333333333  ,  9.023333333333333  ,  9.353333333333333  ,  9.023333333333333  ,  9.353333333333333  , 13.490000000000002  , 13.966666666666667  ,  8.64               ,  8.933333333333334  , 16.573333333333334  , 17.111111111111114  , 12.399999999999999  , 12.79111111111111   , 12.399999999999999  , 12.79111111111111   ,  4.                 ,  4.133333333333333  ,  7.413333333333334  ,  7.653333333333332  ,  7.413333333333334  ,  7.653333333333332  , 11.040000000000001  , 11.386666666666667  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   ,  4.                 ,  4.133333333333333  ,  7.413333333333334  ,  7.653333333333332  ,  7.413333333333334  ,  7.653333333333332  , 11.040000000000001  , 11.386666666666667  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.6                , 0.72               , 0.6                , 0.72               , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 0.8400000000000001 , 0.96               , 0.8400000000000001 , 0.96               , 0.                 , 0.                 , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.                 , 0.                 , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.1875             ,  0.25               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.7625             ,  0.925              ,  1.0875000000000001 ,  1.25               ,  0.7                ,  0.8                ,  0.9000000000000001 ,  1.                 ,  1.7833333333333332 ,  1.9666666666666666 ,  2.1500000000000004 ,  2.333333333333333  ,  1.5333333333333332 ,  1.6666666666666665 ,  1.8                ,  1.9333333333333333 ,  1.5333333333333332 ,  1.6666666666666665 ,  1.8                ,  1.9333333333333333 ,  0.9125000000000001 ,  1.025              ,  1.1375000000000002 ,  1.25               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  3.4525             ,  3.745              ,  4.0375             ,  4.33               ,  2.54               ,  2.72               ,  2.9000000000000004 ,  3.08               ,  5.556666666666667  ,  5.886666666666667  ,  6.216666666666667  ,  6.546666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  0.9125000000000001 ,  1.025              ,  1.1375000000000002 ,  1.25               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  3.4525             ,  3.745              ,  4.0375             ,  4.33               ,  2.54               ,  2.72               ,  2.9000000000000004 ,  3.08               ,  5.556666666666667  ,  5.886666666666667  ,  6.216666666666667  ,  6.546666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  2.5625             ,  2.725              ,  2.8875             ,  3.05               ,  5.1325             ,  5.425000000000001  ,  5.717500000000001  ,  6.01               ,  5.1325             ,  5.425000000000001  ,  5.717500000000001  ,  6.01               ,  8.2225             ,  8.645              ,  9.0675             ,  9.49               ,  5.66               ,  5.92               ,  6.180000000000001  ,  6.4399999999999995 , 11.676666666666668  , 12.153333333333332  , 12.63               , 13.106666666666666  ,  9.106666666666667  ,  9.453333333333333  ,  9.799999999999999  , 10.146666666666668  ,  9.106666666666667  ,  9.453333333333333  ,  9.799999999999999  , 10.146666666666668  ,  2.5                ,  2.6                ,  2.7                ,  2.8                ,  4.82               ,  5.                 ,  5.18               ,  5.359999999999999  ,  4.82               ,  5.                 ,  5.18               ,  5.359999999999999  ,  7.460000000000001  ,  7.720000000000001  ,  7.9799999999999995 ,  8.24               ,  4.96               ,  5.12               ,  5.28               ,  5.44               ,  9.893333333333334  , 10.186666666666666  , 10.48               , 10.773333333333333  ,  7.573333333333334  ,  7.786666666666666  ,  8.                 ,  8.213333333333335  ,  7.573333333333334  ,  7.786666666666666  ,  8.                 ,  8.213333333333335  ,  4.95               ,  5.1                ,  5.25               ,  5.4                ,  9.39               ,  9.66               ,  9.93               , 10.2                ,  9.39               ,  9.66               ,  9.93               , 10.2                , 14.310000000000002  , 14.700000000000001  , 15.09               , 15.48               ,  9.36               ,  9.6                ,  9.84               , 10.08               , 18.360000000000003  , 18.799999999999997  , 19.24               , 19.68               , 13.920000000000002  , 14.239999999999998  , 14.559999999999999  , 14.880000000000003  , 13.920000000000002  , 14.239999999999998  , 14.559999999999999  , 14.880000000000003  ,  4.1000000000000005 ,  4.2                ,  4.300000000000001  ,  4.4                ,  7.7                ,  7.880000000000001  ,  8.06               ,  8.24               ,  7.7                ,  7.880000000000001  ,  8.06               ,  8.24               , 11.620000000000001  , 11.88               , 12.14               , 12.4                ,  7.5200000000000005 ,  7.68               ,  7.84               ,  8.                 , 14.586666666666666  , 14.879999999999999  , 15.173333333333332  , 15.466666666666669  , 10.986666666666668  , 11.2                , 11.413333333333334  , 11.626666666666665  , 10.986666666666668  , 11.2                , 11.413333333333334  , 11.626666666666665  ,  9.516666666666666  ,  9.7                ,  9.883333333333333  , 10.066666666666666  , 17.71666666666667   , 18.046666666666667  , 18.37666666666667   , 18.706666666666667  , 17.71666666666667   , 18.046666666666667  , 18.37666666666667   , 18.706666666666667  , 26.503333333333337  , 26.980000000000004  , 27.456666666666667  , 27.933333333333334  , 16.986666666666668  , 17.28               , 17.573333333333334  , 17.866666666666667  , 32.60888888888889   , 33.14666666666667   , 33.684444444444445  , 34.22222222222223   , 24.40888888888889   , 24.799999999999997  , 25.191111111111113  , 25.58222222222222   , 24.40888888888889   , 24.799999999999997  , 25.191111111111113  , 25.58222222222222   ,  7.866666666666666  ,  8.                 ,  8.133333333333333  ,  8.266666666666666  , 14.586666666666666  , 14.826666666666668  , 15.066666666666666  , 15.306666666666665  , 14.586666666666666  , 14.826666666666668  , 15.066666666666666  , 15.306666666666665  , 21.733333333333334  , 22.080000000000002  , 22.426666666666666  , 22.773333333333333  , 13.866666666666667  , 14.080000000000002  , 14.293333333333333  , 14.506666666666668  , 26.488888888888887  , 26.880000000000003  , 27.27111111111111   , 27.662222222222223  , 19.76888888888889   , 20.053333333333335  , 20.337777777777777  , 20.62222222222222   , 19.76888888888889   , 20.053333333333335  , 20.337777777777777  , 20.62222222222222   ,  7.866666666666666  ,  8.                 ,  8.133333333333333  ,  8.266666666666666  , 14.586666666666666  , 14.826666666666668  , 15.066666666666666  , 15.306666666666665  , 14.586666666666666  , 14.826666666666668  , 15.066666666666666  , 15.306666666666665  , 21.733333333333334  , 22.080000000000002  , 22.426666666666666  , 22.773333333333333  , 13.866666666666667  , 14.080000000000002  , 14.293333333333333  , 14.506666666666668  , 26.488888888888887  , 26.880000000000003  , 27.27111111111111   , 27.662222222222223  , 19.76888888888889   , 20.053333333333335  , 20.337777777777777  , 20.62222222222222   , 19.76888888888889   , 20.053333333333335  , 20.337777777777777  , 20.62222222222222   };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 1.08               , 1.2                , 1.32               , 1.44               , 1.08               , 1.2                , 1.32               , 1.44               , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 1.56               , 1.6800000000000002 , 1.8                , 1.92               , 1.56               , 1.6800000000000002 , 1.8                , 1.92               , 0.                 , 0.                 , 0.                 , 0.                 , 1.04               , 1.12               , 1.2                , 1.28               , 1.04               , 1.12               , 1.2                , 1.28               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 0.                 , 0.                 , 0.                 , 0.                 , 1.04               , 1.12               , 1.2                , 1.28               , 1.04               , 1.12               , 1.2                , 1.28               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 2.4                , 2.56               , 2.72               , 2.88               , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 1.3599999999999999 , 1.44               , 1.52               , 1.6                , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.1625             ,  0.1625             ,  0.3125             ,  0.25               ,  0.45               ,  0.35000000000000003,  0.7666666666666666 ,  0.6166666666666667 ,  0.6166666666666667 ,  0.36250000000000004,  0.7425             ,  0.7425             ,  1.2125000000000001 ,  0.8500000000000001 ,  1.4100000000000001 ,  1.03               ,  2.1133333333333333 ,  1.6433333333333333 ,  1.6433333333333333 ,  0.36250000000000004,  0.7425             ,  0.7425             ,  1.2125000000000001 ,  0.8500000000000001 ,  1.4100000000000001 ,  1.03               ,  2.1133333333333333 ,  1.6433333333333333 ,  1.6433333333333333 ,  0.9125000000000001 ,  1.7725             ,  1.7725             ,  2.7625             ,  1.85               ,  2.97               ,  2.1100000000000003 ,  4.193333333333333  ,  3.203333333333333  ,  3.203333333333333  ,  0.8500000000000001 ,  1.61               ,  1.61               ,  2.45               ,  1.6                ,  2.52               ,  1.76               ,  3.4266666666666667 ,  2.586666666666667  ,  2.586666666666667  ,  1.6500000000000001 ,  3.0900000000000003 ,  3.0900000000000003 ,  4.65               ,  3.                 ,  4.68               ,  3.24               ,  6.239999999999999  ,  4.68               ,  4.68               ,  1.35               ,  2.5100000000000002 ,  2.5100000000000002 ,  3.75               ,  2.4000000000000004 ,  3.7199999999999998 ,  2.56               ,  4.893333333333333  ,  3.6533333333333333 ,  3.6533333333333333 ,  3.1                ,  5.726666666666667  ,  5.726666666666667  ,  8.5                ,  5.4                ,  8.32               ,  5.693333333333333  , 10.804444444444442  ,  8.031111111111112  ,  8.031111111111112  ,  2.55               ,  4.696666666666666  ,  4.696666666666666  ,  6.95               ,  4.3999999999999995 ,  6.76               ,  4.613333333333333  ,  8.724444444444444  ,  6.471111111111111  ,  6.471111111111111  ,  2.55               ,  4.696666666666666  ,  4.696666666666666  ,  6.95               ,  4.3999999999999995 ,  6.76               ,  4.613333333333333  ,  8.724444444444444  ,  6.471111111111111  ,  6.471111111111111  };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.08               , 1.08               , 1.8000000000000003 , 1.3199999999999998 , 1.3199999999999998 , 0.72               , 0.72               , 0.                 , 0.44000000000000006, 0.44000000000000006, 0.96               , 0.96               , 1.56               , 1.12               , 1.12               , 0.6                , 0.6                , 0.                 , 0.44000000000000006, 0.44000000000000006, 0.96               , 0.96               , 1.56               , 1.12               , 1.12               , 0.6                , 0.6                , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.75               ,  0.9                ,  0.6000000000000001 ,  0.7000000000000001 ,  1.35               ,  1.5333333333333332 ,  1.1                ,  1.2333333333333334 ,  1.1                ,  1.2333333333333334 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  1.6625             ,  1.8250000000000002 ,  3.2525000000000004 ,  3.545              ,  3.2525000000000004 ,  3.545              ,  5.1025             ,  5.525              ,  3.44               ,  3.7                ,  5.550000000000001  ,  5.94               ,  3.9600000000000004 ,  4.220000000000001  ,  7.91               ,  8.386666666666667  ,  6.0600000000000005 ,  6.406666666666666  ,  6.0600000000000005 ,  6.406666666666666  ,  1.6                ,  1.7000000000000002 ,  3.04               ,  3.22               ,  3.04               ,  3.22               ,  4.64               ,  4.9                ,  3.04               ,  3.2                ,  4.800000000000001  ,  5.04               ,  3.3600000000000003 ,  3.52               ,  6.5600000000000005 ,  6.8533333333333335 ,  4.96               ,  5.173333333333334  ,  4.96               ,  5.173333333333334  ,  3.1500000000000004 ,  3.3000000000000003 ,  5.91               ,  6.180000000000001  ,  5.91               ,  6.180000000000001  ,  8.91               ,  9.3                ,  5.760000000000001  ,  6.                 ,  9.000000000000002  ,  9.36               ,  6.24               ,  6.48               , 12.040000000000001  , 12.479999999999999  ,  9.04               ,  9.36               ,  9.04               ,  9.36               ,  2.6                ,  2.7                ,  4.840000000000001  ,  5.0200000000000005 ,  4.840000000000001  ,  5.0200000000000005 ,  7.240000000000001  ,  7.5                ,  4.640000000000001  ,  4.800000000000001  ,  7.200000000000001  ,  7.4399999999999995 ,  4.960000000000001  ,  5.12               ,  9.493333333333334  ,  9.786666666666665  ,  7.093333333333334  ,  7.306666666666667  ,  7.093333333333334  ,  7.306666666666667  ,  6.016666666666667  ,  6.2                , 11.123333333333335  , 11.453333333333333  , 11.123333333333335  , 11.453333333333333  , 16.523333333333333  , 17.                 , 10.506666666666668  , 10.8                , 16.200000000000003  , 16.64               , 11.093333333333334  , 11.386666666666667  , 21.07111111111111   , 21.608888888888885  , 15.67111111111111   , 16.062222222222225  , 15.67111111111111   , 16.062222222222225  ,  4.966666666666667  ,  5.1                ,  9.153333333333334  ,  9.393333333333333  ,  9.153333333333334  ,  9.393333333333333  , 13.553333333333335  , 13.9                ,  8.586666666666666  ,  8.799999999999999  , 13.2                , 13.52               ,  9.013333333333334  ,  9.226666666666667  , 17.057777777777776  , 17.448888888888888  , 12.657777777777778  , 12.942222222222222  , 12.657777777777778  , 12.942222222222222  ,  4.966666666666667  ,  5.1                ,  9.153333333333334  ,  9.393333333333333  ,  9.153333333333334  ,  9.393333333333333  , 13.553333333333335  , 13.9                ,  8.586666666666666  ,  8.799999999999999  , 13.2                , 13.52               ,  9.013333333333334  ,  9.226666666666667  , 17.057777777777776  , 17.448888888888888  , 12.657777777777778  , 12.942222222222222  , 12.657777777777778  , 12.942222222222222  };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.8400000000000001, 0.9600000000000001, 0.8400000000000001, 0.9600000000000001, 1.92              , 2.16              , 1.92              , 2.16              , 3.24              , 3.6000000000000005, 2.4               , 2.6399999999999997, 2.4               , 2.6399999999999997, 1.32              , 1.44              , 1.32              , 1.44              , 0.                , 0.                , 0.8               , 0.8800000000000001, 0.8               , 0.8800000000000001, 1.7600000000000002, 1.92              , 1.7600000000000002, 1.92              , 2.8800000000000003, 3.12              , 2.08              , 2.24              , 2.08              , 2.24              , 1.12              , 1.2               , 1.12              , 1.2               , 0.                , 0.                , 0.8               , 0.8800000000000001, 0.8               , 0.8800000000000001, 1.7600000000000002, 1.92              , 1.7600000000000002, 1.92              , 2.8800000000000003, 3.12              , 2.08              , 2.24              , 2.08              , 2.24              , 1.12              , 1.2               , 1.12              , 1.2               , 0.                , 0.                , 0.52              , 0.56              , 0.52              , 0.56              , 1.12              , 1.2000000000000002, 1.12              , 1.2000000000000002, 1.8000000000000003, 1.9200000000000002, 1.28              , 1.3599999999999999, 1.28              , 1.3599999999999999, 0.68              , 0.72              , 0.68              , 0.72              , 0.                , 0.                , 0.52              , 0.56              , 0.52              , 0.56              , 1.12              , 1.2000000000000002, 1.12              , 1.2000000000000002, 1.8000000000000003, 1.9200000000000002, 1.28              , 1.3599999999999999, 1.28              , 1.3599999999999999, 0.68              , 0.72              , 0.68              , 0.72              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.1875             ,  0.25               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.7625             ,  0.925              ,  1.0875000000000001 ,  1.25               ,  0.7                ,  0.8                ,  0.9000000000000001 ,  1.                 ,  1.35               ,  1.5                ,  1.6500000000000001 ,  1.8                ,  1.1                ,  1.2000000000000002 ,  1.3                ,  1.4000000000000001 ,  2.5166666666666666 ,  2.7                ,  2.8833333333333333 ,  3.0666666666666664 ,  2.0666666666666664 ,  2.2                ,  2.333333333333333  ,  2.466666666666667  ,  2.0666666666666664 ,  2.2                ,  2.333333333333333  ,  2.466666666666667  ,  1.1125             ,  1.225              ,  1.3375000000000001 ,  1.4500000000000002 ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  3.9725             ,  4.265000000000001  ,  4.5575             ,  4.8500000000000005 ,  2.86               ,  3.04               ,  3.22               ,  3.4000000000000004 ,  4.83               ,  5.1000000000000005 ,  5.370000000000001  ,  5.640000000000001  ,  3.58               ,  3.7600000000000007 ,  3.9400000000000004 ,  4.12               ,  7.463333333333334  ,  7.793333333333334  ,  8.123333333333333  ,  8.453333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  1.1125             ,  1.225              ,  1.3375000000000001 ,  1.4500000000000002 ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  2.3625             ,  2.5650000000000004 ,  2.7675             ,  2.97               ,  3.9725             ,  4.265000000000001  ,  4.5575             ,  4.8500000000000005 ,  2.86               ,  3.04               ,  3.22               ,  3.4000000000000004 ,  4.83               ,  5.1000000000000005 ,  5.370000000000001  ,  5.640000000000001  ,  3.58               ,  3.7600000000000007 ,  3.9400000000000004 ,  4.12               ,  7.463333333333334  ,  7.793333333333334  ,  8.123333333333333  ,  8.453333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  5.8533333333333335 ,  6.093333333333334  ,  6.333333333333334  ,  6.573333333333333  ,  3.1625000000000005 ,  3.325              ,  3.4875             ,  3.6500000000000004 ,  6.2124999999999995 ,  6.505000000000001  ,  6.7975             ,  7.09               ,  6.2124999999999995 ,  6.505000000000001  ,  6.7975             ,  7.09               ,  9.7825             , 10.205              , 10.627500000000001  , 11.05               ,  6.62               ,  6.88               ,  7.140000000000001  ,  7.4                , 10.71               , 11.100000000000001  , 11.490000000000002  , 11.88               ,  7.66               ,  7.920000000000001  ,  8.18               ,  8.440000000000001  , 15.343333333333334  , 15.82               , 16.296666666666667  , 16.773333333333333  , 11.773333333333333  , 12.120000000000001  , 12.466666666666669  , 12.813333333333333  , 11.773333333333333  , 12.120000000000001  , 12.466666666666669  , 12.813333333333333  ,  3.1000000000000005 ,  3.2                ,  3.3                ,  3.4000000000000004 ,  5.8999999999999995 ,  6.08               ,  6.260000000000001  ,  6.44               ,  5.8999999999999995 ,  6.08               ,  6.260000000000001  ,  6.44               ,  9.02               ,  9.28               ,  9.540000000000001  ,  9.8                ,  5.92               ,  6.08               ,  6.24               ,  6.4                ,  9.36               ,  9.600000000000001  ,  9.84               , 10.08               ,  6.56               ,  6.720000000000001  ,  6.88               ,  7.04               , 12.826666666666668  , 13.120000000000001  , 13.413333333333334  , 13.706666666666667  ,  9.706666666666667  ,  9.92               , 10.133333333333333  , 10.346666666666668  ,  9.706666666666667  ,  9.92               , 10.133333333333333  , 10.346666666666668  ,  6.15               ,  6.300000000000001  ,  6.45               ,  6.6000000000000005 , 11.549999999999999  , 11.82               , 12.09               , 12.360000000000001  , 11.549999999999999  , 11.82               , 12.09               , 12.360000000000001  , 17.43               , 17.82               , 18.21               , 18.6                , 11.28               , 11.520000000000001  , 11.76               , 12.                 , 17.64               , 18.000000000000004  , 18.36               , 18.72               , 12.24               , 12.48               , 12.719999999999999  , 12.96               , 23.64               , 24.080000000000002  , 24.52               , 24.959999999999997  , 17.759999999999998  , 18.08               , 18.4                , 18.72               , 17.759999999999998  , 18.08               , 18.4                , 18.72               ,  5.1000000000000005 ,  5.2                ,  5.300000000000001  ,  5.4                ,  9.5                ,  9.680000000000001  ,  9.860000000000001  , 10.040000000000001  ,  9.5                ,  9.680000000000001  ,  9.860000000000001  , 10.040000000000001  , 14.22               , 14.480000000000002  , 14.74               , 15.                 ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.64               , 14.879999999999999  ,  9.76               ,  9.920000000000002  , 10.08               , 10.24               , 18.693333333333335  , 18.986666666666668  , 19.28               , 19.57333333333333   , 13.973333333333333  , 14.186666666666667  , 14.399999999999999  , 14.613333333333333  , 13.973333333333333  , 14.186666666666667  , 14.399999999999999  , 14.613333333333333  , 11.850000000000001  , 12.033333333333333  , 12.216666666666667  , 12.4                , 21.916666666666668  , 22.24666666666667   , 22.576666666666668  , 22.906666666666666  , 21.916666666666668  , 22.24666666666667   , 22.576666666666668  , 22.906666666666666  , 32.57               , 33.04666666666667   , 33.52333333333333   , 34.                 , 20.72               , 21.013333333333335  , 21.306666666666665  , 21.6                , 31.96               , 32.400000000000006  , 32.84               , 33.28               , 21.893333333333334  , 22.186666666666667  , 22.48               , 22.773333333333333  , 41.60444444444445   , 42.14222222222222   , 42.68               , 43.21777777777777   , 30.95111111111111   , 31.34222222222222   , 31.73333333333333   , 32.12444444444445   , 30.95111111111111   , 31.34222222222222   , 31.73333333333333   , 32.12444444444445   ,  9.8                ,  9.933333333333334  , 10.066666666666666  , 10.2                , 18.066666666666666  , 18.30666666666667   , 18.546666666666667  , 18.786666666666665  , 18.066666666666666  , 18.30666666666667   , 18.546666666666667  , 18.786666666666665  , 26.76               , 27.10666666666667   , 27.453333333333333  , 27.8                , 16.96               , 17.173333333333332  , 17.386666666666667  , 17.599999999999998  , 26.080000000000002  , 26.4                , 26.72               , 27.04               , 17.813333333333333  , 18.026666666666667  , 18.24               , 18.453333333333333  , 33.724444444444444  , 34.11555555555555   , 34.50666666666666   , 34.897777777777776  , 25.03111111111111   , 25.315555555555555  , 25.599999999999998  , 25.884444444444444  , 25.03111111111111   , 25.315555555555555  , 25.599999999999998  , 25.884444444444444  ,  9.8                ,  9.933333333333334  , 10.066666666666666  , 10.2                , 18.066666666666666  , 18.30666666666667   , 18.546666666666667  , 18.786666666666665  , 18.066666666666666  , 18.30666666666667   , 18.546666666666667  , 18.786666666666665  , 26.76               , 27.10666666666667   , 27.453333333333333  , 27.8                , 16.96               , 17.173333333333332  , 17.386666666666667  , 17.599999999999998  , 26.080000000000002  , 26.4                , 26.72               , 27.04               , 17.813333333333333  , 18.026666666666667  , 18.24               , 18.453333333333333  , 33.724444444444444  , 34.11555555555555   , 34.50666666666666   , 34.897777777777776  , 25.03111111111111   , 25.315555555555555  , 25.599999999999998  , 25.884444444444444  , 25.03111111111111   , 25.315555555555555  , 25.599999999999998  , 25.884444444444444  };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.6                , 0.72               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.6                , 0.72               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.56               , 0.64               , 0.72               , 0.8                , 0.56               , 0.64               , 0.72               , 0.8                , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 1.44               , 1.6                , 1.76               , 1.9200000000000002 , 2.64               , 2.88               , 3.12               , 3.3600000000000003 , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 2.08               , 2.2399999999999998 , 2.4                , 2.56               , 1.2                , 1.28               , 1.36               , 1.44               , 1.2                , 1.28               , 1.36               , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 1.56               , 1.6800000000000002 , 1.8                , 1.9200000000000002 , 1.56               , 1.6800000000000002 , 1.8                , 1.9200000000000002 , 3.5999999999999996 , 3.84               , 4.08               , 4.32               , 3.5999999999999996 , 3.84               , 4.08               , 4.32               , 6.12               , 6.48               , 6.840000000000001  , 7.200000000000001  , 4.5600000000000005 , 4.8                , 5.04               , 5.279999999999999  , 4.5600000000000005 , 4.8                , 5.04               , 5.279999999999999  , 2.52               , 2.64               , 2.7600000000000002 , 2.88               , 2.52               , 2.64               , 2.7600000000000002 , 2.88               , 0.                 , 0.                 , 0.                 , 0.                 , 1.52               , 1.6                , 1.6800000000000002 , 1.7600000000000002 , 1.52               , 1.6                , 1.6800000000000002 , 1.7600000000000002 , 3.3600000000000003 , 3.5200000000000005 , 3.6799999999999997 , 3.84               , 3.3600000000000003 , 3.5200000000000005 , 3.6799999999999997 , 3.84               , 5.5200000000000005 , 5.760000000000001  , 6.                 , 6.24               , 4.                 , 4.16               , 4.32               , 4.48               , 4.                 , 4.16               , 4.32               , 4.48               , 2.16               , 2.24               , 2.3200000000000003 , 2.4                , 2.16               , 2.24               , 2.3200000000000003 , 2.4                , 0.                 , 0.                 , 0.                 , 0.                 , 1.52               , 1.6                , 1.6800000000000002 , 1.7600000000000002 , 1.52               , 1.6                , 1.6800000000000002 , 1.7600000000000002 , 3.3600000000000003 , 3.5200000000000005 , 3.6799999999999997 , 3.84               , 3.3600000000000003 , 3.5200000000000005 , 3.6799999999999997 , 3.84               , 5.5200000000000005 , 5.760000000000001  , 6.                 , 6.24               , 4.                 , 4.16               , 4.32               , 4.48               , 4.                 , 4.16               , 4.32               , 4.48               , 2.16               , 2.24               , 2.3200000000000003 , 2.4                , 2.16               , 2.24               , 2.3200000000000003 , 2.4                , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 3.4800000000000004 , 3.6000000000000005 , 3.7200000000000006 , 3.8400000000000003 , 2.48               , 2.56               , 2.64               , 2.7199999999999998 , 2.48               , 2.56               , 2.64               , 2.7199999999999998 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 3.4800000000000004 , 3.6000000000000005 , 3.7200000000000006 , 3.8400000000000003 , 2.48               , 2.56               , 2.64               , 2.7199999999999998 , 2.48               , 2.56               , 2.64               , 2.7199999999999998 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.8177777777777777,  0.8177777777777777,  1.2977777777777777,  0.8533333333333334,  1.8311111111111114,  1.4577777777777778,  1.4577777777777778,  0.8177777777777777,  0.8177777777777777,  1.2977777777777777,  0.8533333333333334,  1.8311111111111114,  1.4577777777777778,  1.4577777777777778,  1.8177777777777777,  1.8177777777777777,  2.7377777777777776,  1.6933333333333334,  3.471111111111111 ,  2.6977777777777776,  2.6977777777777776,  1.5733333333333333,  1.5733333333333333,  2.293333333333333 ,  1.36              ,  2.6933333333333334,  2.0533333333333337,  2.0533333333333337,  3.9511111111111115,  3.9511111111111115,  5.671111111111111 ,  3.2933333333333334,  6.404444444444445 ,  4.831111111111111 ,  4.831111111111111 ,  3.377777777777778 ,  3.377777777777778 ,  4.817777777777778 ,  2.7733333333333334,  5.351111111111111 ,  4.017777777777778 ,  4.017777777777778 ,  3.377777777777778 ,  3.377777777777778 ,  4.817777777777778 ,  2.7733333333333334,  5.351111111111111 ,  4.017777777777778 ,  4.017777777777778 ,  5.368888888888889 ,  5.368888888888889 ,  7.5555555555555545,  4.266666666666667 ,  8.088888888888889 ,  6.0088888888888885,  6.0088888888888885,  5.368888888888889 ,  5.368888888888889 ,  7.5555555555555545,  4.266666666666667 ,  8.088888888888889 ,  6.0088888888888885,  6.0088888888888885,  8.075555555555557 ,  8.075555555555557 , 11.34222222222222  ,  6.386666666666667 , 12.075555555555555 ,  8.955555555555556 ,  8.955555555555556 ,  4.986666666666666 ,  4.986666666666666 ,  6.986666666666666 ,  3.92              ,  7.386666666666667 ,  5.466666666666667 ,  5.466666666666667 , 10.208888888888888 , 10.208888888888888 , 14.275555555555554 ,  7.986666666666666 , 15.008888888888889 , 11.088888888888889 , 11.088888888888889 ,  7.928888888888888 ,  7.928888888888888 , 11.075555555555555 ,  6.1866666666666665, 11.608888888888888 ,  8.568888888888889 ,  8.568888888888889 ,  7.928888888888888 ,  7.928888888888888 , 11.075555555555555 ,  6.1866666666666665, 11.608888888888888 ,  8.568888888888889 ,  8.568888888888889 ,  9.92              ,  9.92              , 13.813333333333334 ,  7.68              , 14.346666666666666 , 10.56              , 10.56              ,  9.92              ,  9.92              , 13.813333333333334 ,  7.68              , 14.346666666666666 , 10.56              , 10.56              , 14.333333333333332 , 14.333333333333332 , 19.946666666666665 , 11.08              , 20.68              , 15.213333333333335 , 15.213333333333335 ,  8.4               ,  8.4               , 11.680000000000001 ,  6.4799999999999995, 12.08              ,  8.879999999999999 ,  8.879999999999999 , 16.46666666666667  , 16.46666666666667  , 22.88              , 12.68              , 23.613333333333333 , 17.346666666666664 , 17.346666666666664 , 12.48              , 12.48              , 17.333333333333332 ,  9.6               , 17.866666666666664 , 13.120000000000001 , 13.120000000000001 , 12.48              , 12.48              , 17.333333333333332 ,  9.6               , 17.866666666666664 , 13.120000000000001 , 13.120000000000001 };
  const std::array<int, 4> in_shape = {{ 3, 7, 7, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               };
  const std::array<int, 4> in_shape = {{ 3, 7, 7, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 1.3511111111111112,  1.6355555555555554,  1.3511111111111112,  1.6355555555555554,  2.2044444444444444,  2.5955555555555554,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  1.3511111111111112,  1.6355555555555554,  1.3511111111111112,  1.6355555555555554,  2.2044444444444444,  2.5955555555555554,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  3.2444444444444445,  3.6355555555555554,  3.2444444444444445,  3.6355555555555554,  4.937777777777778 ,  5.475555555555555 ,  3.0933333333333333,  3.3866666666666667,  6.404444444444444 ,  6.942222222222222 ,  5.004444444444444 ,  5.395555555555555 ,  5.004444444444444 ,  5.395555555555555 ,  2.9333333333333336,  3.1466666666666665,  2.9333333333333336,  3.1466666666666665,  4.293333333333333 ,  4.586666666666666 ,  2.56              ,  2.72              ,  5.093333333333333 ,  5.386666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  7.511111111111111 ,  7.902222222222223 ,  7.511111111111111 ,  7.902222222222223 , 10.804444444444444 , 11.342222222222222 ,  6.293333333333334 ,  6.586666666666667 , 12.27111111111111  , 12.80888888888889  ,  9.27111111111111  ,  9.662222222222223 ,  9.27111111111111  ,  9.662222222222223 ,  6.471111111111111 ,  6.755555555555556 ,  6.471111111111111 ,  6.755555555555556 ,  9.244444444444444 ,  9.635555555555555 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 ,  6.471111111111111 ,  6.755555555555556 ,  6.471111111111111 ,  6.755555555555556 ,  9.244444444444444 ,  9.635555555555555 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 , 10.453333333333335 , 10.737777777777778 , 10.453333333333335 , 10.737777777777778 , 14.72              , 15.111111111111109 ,  8.32              ,  8.533333333333333 , 15.786666666666667 , 16.177777777777777 , 11.733333333333333 , 12.017777777777777 , 11.733333333333333 , 12.017777777777777 , 10.453333333333335 , 10.737777777777778 , 10.453333333333335 , 10.737777777777778 , 14.72              , 15.111111111111109 ,  8.32              ,  8.533333333333333 , 15.786666666666667 , 16.177777777777777 , 11.733333333333333 , 12.017777777777777 , 11.733333333333333 , 12.017777777777777 , 15.760000000000002 , 16.151111111111113 , 15.760000000000002 , 16.151111111111113 , 22.14666666666667  , 22.68444444444444  , 12.48              , 12.773333333333333 , 23.613333333333337 , 24.15111111111111  , 17.52              , 17.91111111111111  , 17.52              , 17.91111111111111  ,  9.76              ,  9.973333333333333 ,  9.76              ,  9.973333333333333 , 13.68              , 13.973333333333333 ,  7.680000000000001 ,  7.84              , 14.479999999999999 , 14.773333333333333 , 10.72              , 10.933333333333334 , 10.72              , 10.933333333333334 , 20.026666666666667 , 20.417777777777776 , 20.026666666666667 , 20.417777777777776 , 28.013333333333332 , 28.55111111111111  , 15.68              , 15.973333333333333 , 29.479999999999997 , 30.017777777777777 , 21.78666666666667  , 22.177777777777777 , 21.78666666666667  , 22.177777777777777 , 15.573333333333334 , 15.857777777777777 , 15.573333333333334 , 15.857777777777777 , 21.759999999999998 , 22.15111111111111  , 12.16              , 12.373333333333333 , 22.826666666666668 , 23.217777777777776 , 16.85333333333333  , 17.137777777777778 , 16.85333333333333  , 17.137777777777778 , 15.573333333333334 , 15.857777777777777 , 15.573333333333334 , 15.857777777777777 , 21.759999999999998 , 22.15111111111111  , 12.16              , 12.373333333333333 , 22.826666666666668 , 23.217777777777776 , 16.85333333333333  , 17.137777777777778 , 16.85333333333333  , 17.137777777777778 , 19.555555555555554 , 19.84              , 19.555555555555554 , 19.84              , 27.235555555555557 , 27.62666666666667  , 15.146666666666667 , 15.36              , 28.30222222222222  , 28.69333333333333  , 20.835555555555555 , 21.12              , 20.835555555555555 , 21.12              , 19.555555555555554 , 19.84              , 19.555555555555554 , 19.84              , 27.235555555555557 , 27.62666666666667  , 15.146666666666667 , 15.36              , 28.30222222222222  , 28.69333333333333  , 20.835555555555555 , 21.12              , 20.835555555555555 , 21.12              , 28.275555555555556 , 28.666666666666664 , 28.275555555555556 , 28.666666666666664 , 39.355555555555554 , 39.89333333333333  , 21.866666666666667 , 22.16              , 40.822222222222216 , 41.36              , 30.035555555555554 , 30.42666666666667  , 30.035555555555554 , 30.42666666666667  , 16.586666666666666 , 16.8               , 16.586666666666666 , 16.8               , 23.066666666666663 , 23.360000000000003 , 12.8               , 12.959999999999999 , 23.866666666666667 , 24.16              , 17.546666666666667 , 17.759999999999998 , 17.546666666666667 , 17.759999999999998 , 32.54222222222222  , 32.93333333333334  , 32.54222222222222  , 32.93333333333334  , 45.222222222222214 , 45.76              , 25.066666666666666 , 25.36              , 46.68888888888889  , 47.22666666666667  , 34.30222222222222  , 34.69333333333333  , 34.30222222222222  , 34.69333333333333  , 24.675555555555555 , 24.96              , 24.675555555555555 , 24.96              , 34.275555555555556 , 34.666666666666664 , 18.986666666666668 , 19.2               , 35.34222222222222  , 35.73333333333333  , 25.955555555555556 , 26.240000000000002 , 25.955555555555556 , 26.240000000000002 , 24.675555555555555 , 24.96              , 24.675555555555555 , 24.96              , 34.275555555555556 , 34.666666666666664 , 18.986666666666668 , 19.2               , 35.34222222222222  , 35.73333333333333  , 25.955555555555556 , 26.240000000000002 , 25.955555555555556 , 26.240000000000002 };
  const std::array<int, 4> in_shape = {{ 3, 7, 7, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               };
  const std::array<int, 4> in_shape = {{ 3, 7, 7, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  4.017777777777777 ,  4.408888888888889 ,  4.8               ,  5.191111111111111 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  2.417777777777778 ,  2.7022222222222223,  2.9866666666666664,  3.271111111111111 ,  4.017777777777777 ,  4.408888888888889 ,  4.8               ,  5.191111111111111 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  6.097777777777779 ,  6.488888888888889 ,  6.880000000000001 ,  7.271111111111111 ,  6.097777777777779 ,  6.488888888888889 ,  6.880000000000001 ,  7.271111111111111 ,  9.337777777777777 ,  9.875555555555556 , 10.413333333333334 , 10.95111111111111  ,  5.893333333333334 ,  6.1866666666666665,  6.4799999999999995,  6.773333333333333 , 12.271111111111113 , 12.808888888888887 , 13.346666666666666 , 13.884444444444444 ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  8.293333333333335 ,  8.586666666666666 ,  8.88              ,  9.173333333333332 ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 21.07111111111111  , 21.608888888888888 , 22.14666666666667  , 22.684444444444445 , 12.293333333333333 , 12.586666666666668 , 12.88              , 13.173333333333334 , 24.004444444444445 , 24.54222222222222  , 25.08              , 25.61777777777778  , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 20.62222222222222  , 20.90666666666667  , 21.19111111111111  , 21.475555555555555 , 20.62222222222222  , 20.90666666666667  , 21.19111111111111  , 21.475555555555555 , 29.048888888888886 , 29.44              , 29.83111111111111  , 30.222222222222218 , 16.426666666666666 , 16.64              , 16.853333333333335 , 17.066666666666666 , 31.182222222222215 , 31.573333333333334 , 31.964444444444446 , 32.355555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 20.62222222222222  , 20.90666666666667  , 21.19111111111111  , 21.475555555555555 , 20.62222222222222  , 20.90666666666667  , 21.19111111111111  , 21.475555555555555 , 29.048888888888886 , 29.44              , 29.83111111111111  , 30.222222222222218 , 16.426666666666666 , 16.64              , 16.853333333333335 , 17.066666666666666 , 31.182222222222215 , 31.573333333333334 , 31.964444444444446 , 32.355555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 31.128888888888888 , 31.520000000000003 , 31.911111111111108 , 32.30222222222223  , 31.128888888888888 , 31.520000000000003 , 31.911111111111108 , 32.30222222222223  , 43.75555555555555  , 44.29333333333334  , 44.831111111111106 , 45.36888888888888  , 24.666666666666664 , 24.96              , 25.253333333333337 , 25.546666666666667 , 46.68888888888888  , 47.226666666666674 , 47.76444444444444  , 48.30222222222222  , 34.648888888888884 , 35.04              , 35.43111111111111  , 35.82222222222222  , 34.648888888888884 , 35.04              , 35.43111111111111  , 35.82222222222222  , 19.30666666666667  , 19.52              , 19.733333333333334 , 19.946666666666665 , 19.30666666666667  , 19.52              , 19.733333333333334 , 19.946666666666665 , 27.066666666666666 , 27.36              , 27.653333333333336 , 27.946666666666665 , 15.2               , 15.360000000000001 , 15.52              , 15.68              , 28.666666666666664 , 28.959999999999997 , 29.253333333333334 , 29.546666666666667 , 21.226666666666667 , 21.44              , 21.653333333333332 , 21.866666666666667 , 21.226666666666667 , 21.44              , 21.653333333333332 , 21.866666666666667 , 39.66222222222222  , 40.053333333333335 , 40.44444444444444  , 40.83555555555555  , 39.66222222222222  , 40.053333333333335 , 40.44444444444444  , 40.83555555555555  , 55.48888888888888  , 56.026666666666664 , 56.56444444444445  , 57.10222222222222  , 31.066666666666666 , 31.36              , 31.653333333333332 , 31.946666666666665 , 58.42222222222222  , 58.959999999999994 , 59.497777777777785 , 60.035555555555554 , 43.18222222222222  , 43.57333333333334  , 43.96444444444444  , 44.355555555555554 , 43.18222222222222  , 43.57333333333334  , 43.96444444444444  , 44.355555555555554 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 43.12888888888888  , 43.519999999999996 , 43.91111111111111  , 44.30222222222222  , 24.106666666666666 , 24.32              , 24.533333333333335 , 24.746666666666666 , 45.26222222222222  , 45.653333333333336 , 46.044444444444444 , 46.43555555555555  , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 43.12888888888888  , 43.519999999999996 , 43.91111111111111  , 44.30222222222222  , 24.106666666666666 , 24.32              , 24.533333333333335 , 24.746666666666666 , 45.26222222222222  , 45.653333333333336 , 46.044444444444444 , 46.43555555555555  , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 38.82666666666667  , 39.11111111111111  , 39.39555555555555  , 39.68              , 38.82666666666667  , 39.11111111111111  , 39.39555555555555  , 39.68              , 54.07999999999999  , 54.471111111111114 , 54.86222222222222  , 55.25333333333334  , 30.080000000000002 , 30.293333333333333 , 30.506666666666664 , 30.72              , 56.21333333333333  , 56.60444444444444  , 56.995555555555555 , 57.38666666666666  , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 38.82666666666667  , 39.11111111111111  , 39.39555555555555  , 39.68              , 38.82666666666667  , 39.11111111111111  , 39.39555555555555  , 39.68              , 54.07999999999999  , 54.471111111111114 , 54.86222222222222  , 55.25333333333334  , 30.080000000000002 , 30.293333333333333 , 30.506666666666664 , 30.72              , 56.21333333333333  , 56.60444444444444  , 56.995555555555555 , 57.38666666666666  , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 56.160000000000004 , 56.55111111111111  , 56.94222222222222  , 57.33333333333333  , 56.160000000000004 , 56.55111111111111  , 56.94222222222222  , 57.33333333333333  , 78.17333333333332  , 78.71111111111111  , 79.2488888888889   , 79.78666666666666  , 43.44              , 43.733333333333334 , 44.02666666666667  , 44.32              , 81.10666666666667  , 81.64444444444443  , 82.18222222222222  , 82.72              , 59.67999999999999  , 60.07111111111111  , 60.462222222222216 , 60.85333333333334  , 59.67999999999999  , 60.07111111111111  , 60.462222222222216 , 60.85333333333334  , 32.96              , 33.17333333333333  , 33.38666666666667  , 33.6               , 32.96              , 33.17333333333333  , 33.38666666666667  , 33.6               , 45.839999999999996 , 46.133333333333326 , 46.42666666666666  , 46.720000000000006 , 25.439999999999998 , 25.6               , 25.76              , 25.919999999999998 , 47.44              , 47.733333333333334 , 48.026666666666664 , 48.32              , 34.879999999999995 , 35.093333333333334 , 35.306666666666665 , 35.519999999999996 , 34.879999999999995 , 35.093333333333334 , 35.306666666666665 , 35.519999999999996 , 64.69333333333333  , 65.08444444444444  , 65.47555555555556  , 65.86666666666667  , 64.69333333333333  , 65.08444444444444  , 65.47555555555556  , 65.86666666666667  , 89.90666666666665  , 90.44444444444443  , 90.98222222222222  , 91.52              , 49.839999999999996 , 50.13333333333333  , 50.42666666666667  , 50.72              , 92.83999999999999  , 93.37777777777778  , 93.91555555555556  , 94.45333333333333  , 68.21333333333334  , 68.60444444444444  , 68.99555555555555  , 69.38666666666666  , 68.21333333333334  , 68.60444444444444  , 68.99555555555555  , 69.38666666666666  , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 68.16              , 68.55111111111111  , 68.94222222222223  , 69.33333333333333  , 37.76              , 37.973333333333336 , 38.18666666666667  , 38.4               , 70.29333333333332  , 70.68444444444444  , 71.07555555555555  , 71.46666666666665  , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 68.16              , 68.55111111111111  , 68.94222222222223  , 69.33333333333333  , 37.76              , 37.973333333333336 , 38.18666666666667  , 38.4               , 70.29333333333332  , 70.68444444444444  , 71.07555555555555  , 71.46666666666665  , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 };
  const std::array<int, 4> in_shape = {{ 3, 7, 7, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               };
  const std::array<int, 4> in_shape = {{ 3, 7, 7, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.3333333333333333,  0.7066666666666667,  0.7066666666666667,  1.1866666666666668,  0.8533333333333334,  1.8311111111111114,  1.4577777777777778,  1.4577777777777778,  0.3333333333333333,  0.7066666666666667,  0.7066666666666667,  1.1866666666666668,  0.8533333333333334,  1.8311111111111114,  1.4577777777777778,  1.4577777777777778,  0.7833333333333333,  1.5566666666666666,  1.5566666666666666,  2.4766666666666666,  1.6933333333333334,  3.471111111111111 ,  2.6977777777777776,  2.6977777777777776,  0.7               ,  1.3399999999999999,  1.3399999999999999,  2.06              ,  1.36              ,  2.6933333333333334,  2.0533333333333337,  2.0533333333333337,  1.7833333333333332,  3.3566666666666665,  3.3566666666666665,  5.076666666666667 ,  3.2933333333333334,  6.404444444444445 ,  4.831111111111111 ,  4.831111111111111 ,  1.5333333333333332,  2.8666666666666667,  2.8666666666666667,  4.306666666666667 ,  2.7733333333333334,  5.351111111111111 ,  4.017777777777778 ,  4.017777777777778 ,  1.5333333333333332,  2.8666666666666667,  2.8666666666666667,  4.306666666666667 ,  2.7733333333333334,  5.351111111111111 ,  4.017777777777778 ,  4.017777777777778 ,  2.466666666666667 ,  4.546666666666666 ,  4.546666666666666 ,  6.7333333333333325,  4.266666666666667 ,  8.088888888888889 ,  6.0088888888888885,  6.0088888888888885,  2.466666666666667 ,  4.546666666666666 ,  4.546666666666666 ,  6.7333333333333325,  4.266666666666667 ,  8.088888888888889 ,  6.0088888888888885,  6.0088888888888885,  3.716666666666667 ,  6.836666666666666 ,  6.836666666666666 , 10.103333333333333 ,  6.386666666666667 , 12.075555555555555 ,  8.955555555555556 ,  8.955555555555556 ,  2.3               ,  4.220000000000001 ,  4.220000000000001 ,  6.22              ,  3.92              ,  7.386666666666667 ,  5.466666666666667 ,  5.466666666666667 ,  4.716666666666667 ,  8.636666666666667 ,  8.636666666666667 , 12.703333333333333 ,  7.986666666666666 , 15.008888888888889 , 11.088888888888889 , 11.088888888888889 ,  3.6666666666666665,  6.706666666666667 ,  6.706666666666667 ,  9.853333333333333 ,  6.1866666666666665, 11.608888888888888 ,  8.568888888888889 ,  8.568888888888889 ,  3.6666666666666665,  6.706666666666667 ,  6.706666666666667 ,  9.853333333333333 ,  6.1866666666666665, 11.608888888888888 ,  8.568888888888889 ,  8.568888888888889 ,  4.6               ,  8.386666666666667 ,  8.386666666666667 , 12.28              ,  7.68              , 14.346666666666666 , 10.56              , 10.56              ,  4.6               ,  8.386666666666667 ,  8.386666666666667 , 12.28              ,  7.68              , 14.346666666666666 , 10.56              , 10.56              ,  6.65              , 12.116666666666667 , 12.116666666666667 , 17.73              , 11.08              , 20.68              , 15.213333333333335 , 15.213333333333335 ,  3.9000000000000004,  7.1               ,  7.1               , 10.38              ,  6.4799999999999995, 12.08              ,  8.879999999999999 ,  8.879999999999999 ,  7.65              , 13.916666666666666 , 13.916666666666666 , 20.33              , 12.68              , 23.613333333333333 , 17.346666666666664 , 17.346666666666664 ,  5.800000000000001 , 10.546666666666667 , 10.546666666666667 , 15.399999999999999 ,  9.6               , 17.866666666666664 , 13.120000000000001 , 13.120000000000001 ,  5.800000000000001 , 10.546666666666667 , 10.546666666666667 , 15.399999999999999 ,  9.6               , 17.866666666666664 , 13.120000000000001 , 13.120000000000001 };
  const std::array<int, 4> in_shape = {{ 3, 7, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.                 , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.                 , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.                 , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.                 , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.                 , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.                 , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.                 , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.                 , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.                 , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.                 , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 7, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.5333333333333333,  0.6666666666666666,  1.1733333333333333,  1.4133333333333333,  1.1733333333333333,  1.4133333333333333,  2.0266666666666664,  2.3733333333333335,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  0.5333333333333333,  0.6666666666666666,  1.1733333333333333,  1.4133333333333333,  1.1733333333333333,  1.4133333333333333,  2.0266666666666664,  2.3733333333333335,  1.4933333333333334,  1.7066666666666668,  3.271111111111111 ,  3.6622222222222227,  2.631111111111111 ,  2.9155555555555557,  2.631111111111111 ,  2.9155555555555557,  1.3833333333333333,  1.5666666666666667,  2.783333333333333 ,  3.1133333333333333,  2.783333333333333 ,  3.1133333333333333,  4.476666666666667 ,  4.953333333333333 ,  3.0933333333333333,  3.3866666666666667,  6.404444444444444 ,  6.942222222222222 ,  5.004444444444444 ,  5.395555555555555 ,  5.004444444444444 ,  5.395555555555555 ,  1.3               ,  1.4               ,  2.5               ,  2.6799999999999997,  2.5               ,  2.6799999999999997,  3.8600000000000003,  4.12              ,  2.56              ,  2.72              ,  5.093333333333333 ,  5.386666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  3.893333333333333 ,  4.106666666666667 ,  3.383333333333333 ,  3.5666666666666664,  6.383333333333333 ,  6.713333333333333 ,  6.383333333333333 ,  6.713333333333333 ,  9.676666666666666 , 10.153333333333334 ,  6.293333333333334 ,  6.586666666666667 , 12.27111111111111  , 12.80888888888889  ,  9.27111111111111  ,  9.662222222222223 ,  9.27111111111111  ,  9.662222222222223 ,  2.933333333333333 ,  3.0666666666666664,  5.493333333333333 ,  5.733333333333333 ,  5.493333333333333 ,  5.733333333333333 ,  8.266666666666666 ,  8.613333333333333 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 ,  2.933333333333333 ,  3.0666666666666664,  5.493333333333333 ,  5.733333333333333 ,  5.493333333333333 ,  5.733333333333333 ,  8.266666666666666 ,  8.613333333333333 ,  5.333333333333334 ,  5.546666666666667 , 10.311111111111112 , 10.702222222222222 ,  7.751111111111111 ,  8.035555555555556 ,  7.751111111111111 ,  8.035555555555556 ,  4.800000000000001 ,  4.933333333333334 ,  8.853333333333335 ,  9.093333333333332 ,  8.853333333333335 ,  9.093333333333332 , 13.120000000000003 , 13.466666666666665 ,  8.32              ,  8.533333333333333 , 15.786666666666667 , 16.177777777777777 , 11.733333333333333 , 12.017777777777777 , 11.733333333333333 , 12.017777777777777 ,  4.800000000000001 ,  4.933333333333334 ,  8.853333333333335 ,  9.093333333333332 ,  8.853333333333335 ,  9.093333333333332 , 13.120000000000003 , 13.466666666666665 ,  8.32              ,  8.533333333333333 , 15.786666666666667 , 16.177777777777777 , 11.733333333333333 , 12.017777777777777 , 11.733333333333333 , 12.017777777777777 ,  7.250000000000001 ,  7.433333333333334 , 13.343333333333334 , 13.673333333333332 , 13.343333333333334 , 13.673333333333332 , 19.730000000000004 , 20.206666666666667 , 12.48              , 12.773333333333333 , 23.613333333333337 , 24.15111111111111  , 17.52              , 17.91111111111111  , 17.52              , 17.91111111111111  ,  4.5               ,  4.6               ,  8.260000000000002 ,  8.440000000000001 ,  8.260000000000002 ,  8.440000000000001 , 12.18              , 12.44              ,  7.680000000000001 ,  7.84              , 14.479999999999999 , 14.773333333333333 , 10.72              , 10.933333333333334 , 10.72              , 10.933333333333334 ,  9.25              ,  9.433333333333334 , 16.943333333333335 , 17.273333333333333 , 16.943333333333335 , 17.273333333333333 , 24.93              , 25.406666666666666 , 15.68              , 15.973333333333333 , 29.479999999999997 , 30.017777777777777 , 21.78666666666667  , 22.177777777777777 , 21.78666666666667  , 22.177777777777777 ,  7.2               ,  7.333333333333333 , 13.173333333333334 , 13.413333333333334 , 13.173333333333334 , 13.413333333333334 , 19.36              , 19.706666666666667 , 12.16              , 12.373333333333333 , 22.826666666666668 , 23.217777777777776 , 16.85333333333333  , 17.137777777777778 , 16.85333333333333  , 17.137777777777778 ,  7.2               ,  7.333333333333333 , 13.173333333333334 , 13.413333333333334 , 13.173333333333334 , 13.413333333333334 , 19.36              , 19.706666666666667 , 12.16              , 12.373333333333333 , 22.826666666666668 , 23.217777777777776 , 16.85333333333333  , 17.137777777777778 , 16.85333333333333  , 17.137777777777778 ,  9.066666666666666 ,  9.2               , 16.53333333333333  , 16.773333333333333 , 16.53333333333333  , 16.773333333333333 , 24.21333333333333  , 24.56              , 15.146666666666667 , 15.36              , 28.30222222222222  , 28.69333333333333  , 20.835555555555555 , 21.12              , 20.835555555555555 , 21.12              ,  9.066666666666666 ,  9.2               , 16.53333333333333  , 16.773333333333333 , 16.53333333333333  , 16.773333333333333 , 24.21333333333333  , 24.56              , 15.146666666666667 , 15.36              , 28.30222222222222  , 28.69333333333333  , 20.835555555555555 , 21.12              , 20.835555555555555 , 21.12              , 13.116666666666667 , 13.3               , 23.903333333333332 , 24.233333333333334 , 23.903333333333332 , 24.233333333333334 , 34.983333333333334 , 35.46              , 21.866666666666667 , 22.16              , 40.822222222222216 , 41.36              , 30.035555555555554 , 30.42666666666667  , 30.035555555555554 , 30.42666666666667  ,  7.7               ,  7.800000000000001 , 14.02              , 14.2               , 14.02              , 14.2               , 20.5               , 20.76              , 12.8               , 12.959999999999999 , 23.866666666666667 , 24.16              , 17.546666666666667 , 17.759999999999998 , 17.546666666666667 , 17.759999999999998 , 15.116666666666667 , 15.3               , 27.503333333333334 , 27.833333333333332 , 27.503333333333334 , 27.833333333333332 , 40.18333333333334  , 40.66              , 25.066666666666666 , 25.36              , 46.68888888888889  , 47.22666666666667  , 34.30222222222222  , 34.69333333333333  , 34.30222222222222  , 34.69333333333333  , 11.466666666666665 , 11.600000000000001 , 20.85333333333333  , 21.093333333333334 , 20.85333333333333  , 21.093333333333334 , 30.453333333333333 , 30.799999999999997 , 18.986666666666668 , 19.2               , 35.34222222222222  , 35.73333333333333  , 25.955555555555556 , 26.240000000000002 , 25.955555555555556 , 26.240000000000002 , 11.466666666666665 , 11.600000000000001 , 20.85333333333333  , 21.093333333333334 , 20.85333333333333  , 21.093333333333334 , 30.453333333333333 , 30.799999999999997 , 18.986666666666668 , 19.2               , 35.34222222222222  , 35.73333333333333  , 25.955555555555556 , 26.240000000000002 , 25.955555555555556 , 26.240000000000002 };
  const std::array<int, 4> in_shape = {{ 3, 7, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.                 , 0.                 , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.                 , 0.                 , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 0.                 , 0.                 , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 7, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.9333333333333335,  1.0666666666666667,  1.2000000000000002,  1.3333333333333333,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  3.7066666666666666,  4.053333333333333 ,  4.4               ,  4.746666666666667 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  0.9333333333333335,  1.0666666666666667,  1.2000000000000002,  1.3333333333333333,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  2.1066666666666665,  2.3466666666666667,  2.586666666666667 ,  2.8266666666666667,  3.7066666666666666,  4.053333333333333 ,  4.4               ,  4.746666666666667 ,  2.7733333333333334,  2.986666666666667 ,  3.2               ,  3.4133333333333336,  6.151111111111112 ,  6.542222222222222 ,  6.933333333333333 ,  7.324444444444445 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  4.977777777777778 ,  5.262222222222222 ,  5.546666666666667 ,  5.831111111111111 ,  2.5833333333333335,  2.7666666666666666,  2.95              ,  3.1333333333333333,  5.236666666666666 ,  5.566666666666666 ,  5.8966666666666665,  6.226666666666667 ,  5.236666666666666 ,  5.566666666666666 ,  5.8966666666666665,  6.226666666666667 ,  8.476666666666667 ,  8.953333333333333 ,  9.430000000000001 ,  9.906666666666666 ,  5.893333333333334 ,  6.1866666666666665,  6.4799999999999995,  6.773333333333333 , 12.271111111111113 , 12.808888888888887 , 13.346666666666666 , 13.884444444444444 ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  9.617777777777778 , 10.008888888888889 , 10.4               , 10.79111111111111  ,  2.5               ,  2.6               ,  2.7               ,  2.8               ,  4.82              ,  5.                ,  5.18              ,  5.359999999999999 ,  4.82              ,  5.                ,  5.18              ,  5.359999999999999 ,  7.460000000000001 ,  7.720000000000001 ,  7.9799999999999995,  8.24              ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  6.583333333333333 ,  6.766666666666666 ,  6.95              ,  7.133333333333333 , 12.436666666666666 , 12.766666666666666 , 13.096666666666666 , 13.426666666666666 , 12.436666666666666 , 12.766666666666666 , 13.096666666666666 , 13.426666666666666 , 18.876666666666665 , 19.35333333333333  , 19.83              , 20.30666666666667  , 12.293333333333333 , 12.586666666666668 , 12.88              , 13.173333333333334 , 24.004444444444445 , 24.54222222222222  , 25.08              , 25.61777777777778  , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 ,  5.733333333333333 ,  5.866666666666666 ,  6.                ,  6.133333333333333 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 16.186666666666664 , 16.53333333333333  , 16.88              , 17.226666666666667 , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  ,  5.733333333333333 ,  5.866666666666666 ,  6.                ,  6.133333333333333 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 10.746666666666666 , 10.986666666666666 , 11.226666666666667 , 11.466666666666667 , 16.186666666666664 , 16.53333333333333  , 16.88              , 17.226666666666667 , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  ,  9.466666666666665 ,  9.600000000000001 ,  9.733333333333334 ,  9.866666666666667 , 17.466666666666665 , 17.70666666666667  , 17.946666666666665 , 18.186666666666664 , 17.466666666666665 , 17.70666666666667  , 17.946666666666665 , 18.186666666666664 , 25.89333333333333  , 26.240000000000006 , 26.58666666666667  , 26.93333333333333  , 16.426666666666666 , 16.64              , 16.853333333333335 , 17.066666666666666 , 31.182222222222215 , 31.573333333333334 , 31.964444444444446 , 32.355555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 ,  9.466666666666665 ,  9.600000000000001 ,  9.733333333333334 ,  9.866666666666667 , 17.466666666666665 , 17.70666666666667  , 17.946666666666665 , 18.186666666666664 , 17.466666666666665 , 17.70666666666667  , 17.946666666666665 , 18.186666666666664 , 25.89333333333333  , 26.240000000000006 , 26.58666666666667  , 26.93333333333333  , 16.426666666666666 , 16.64              , 16.853333333333335 , 17.066666666666666 , 31.182222222222215 , 31.573333333333334 , 31.964444444444446 , 32.355555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 23.18222222222222  , 23.466666666666665 , 23.751111111111108 , 24.035555555555554 , 14.316666666666666 , 14.500000000000002 , 14.683333333333334 , 14.866666666666667 , 26.356666666666666 , 26.686666666666667 , 27.016666666666666 , 27.346666666666664 , 26.356666666666666 , 26.686666666666667 , 27.016666666666666 , 27.346666666666664 , 38.983333333333334 , 39.46000000000001  , 39.93666666666667  , 40.413333333333334 , 24.666666666666664 , 24.96              , 25.253333333333337 , 25.546666666666667 , 46.68888888888888  , 47.226666666666674 , 47.76444444444444  , 48.30222222222222  , 34.648888888888884 , 35.04              , 35.43111111111111  , 35.82222222222222  , 34.648888888888884 , 35.04              , 35.43111111111111  , 35.82222222222222  ,  8.9               ,  9.                ,  9.100000000000001 ,  9.2               , 16.34              , 16.520000000000003 , 16.700000000000003 , 16.880000000000003 , 16.34              , 16.520000000000003 , 16.700000000000003 , 16.880000000000003 , 24.099999999999998 , 24.36              , 24.620000000000005 , 24.88              , 15.2               , 15.360000000000001 , 15.52              , 15.68              , 28.666666666666664 , 28.959999999999997 , 29.253333333333334 , 29.546666666666667 , 21.226666666666667 , 21.44              , 21.653333333333332 , 21.866666666666667 , 21.226666666666667 , 21.44              , 21.653333333333332 , 21.866666666666667 , 18.316666666666666 , 18.5               , 18.683333333333334 , 18.866666666666667 , 33.556666666666665 , 33.88666666666667  , 34.21666666666667  , 34.54666666666667  , 33.556666666666665 , 33.88666666666667  , 34.21666666666667  , 34.54666666666667  , 49.383333333333326 , 49.86              , 50.33666666666667  , 50.81333333333333  , 31.066666666666666 , 31.36              , 31.653333333333332 , 31.946666666666665 , 58.42222222222222  , 58.959999999999994 , 59.497777777777785 , 60.035555555555554 , 43.18222222222222  , 43.57333333333334  , 43.96444444444444  , 44.355555555555554 , 43.18222222222222  , 43.57333333333334  , 43.96444444444444  , 44.355555555555554 , 14.266666666666666 , 14.4               , 14.533333333333331 , 14.666666666666666 , 26.106666666666666 , 26.346666666666668 , 26.586666666666666 , 26.826666666666668 , 26.106666666666666 , 26.346666666666668 , 26.586666666666666 , 26.826666666666668 , 38.373333333333335 , 38.72              , 39.06666666666666  , 39.413333333333334 , 24.106666666666666 , 24.32              , 24.533333333333335 , 24.746666666666666 , 45.26222222222222  , 45.653333333333336 , 46.044444444444444 , 46.43555555555555  , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 14.266666666666666 , 14.4               , 14.533333333333331 , 14.666666666666666 , 26.106666666666666 , 26.346666666666668 , 26.586666666666666 , 26.826666666666668 , 26.106666666666666 , 26.346666666666668 , 26.586666666666666 , 26.826666666666668 , 38.373333333333335 , 38.72              , 39.06666666666666  , 39.413333333333334 , 24.106666666666666 , 24.32              , 24.533333333333335 , 24.746666666666666 , 45.26222222222222  , 45.653333333333336 , 46.044444444444444 , 46.43555555555555  , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 18.                , 18.133333333333333 , 18.266666666666666 , 18.4               , 32.82666666666667  , 33.06666666666666  , 33.306666666666665 , 33.54666666666667  , 32.82666666666667  , 33.06666666666666  , 33.306666666666665 , 33.54666666666667  , 48.08              , 48.42666666666666  , 48.77333333333333  , 49.12              , 30.080000000000002 , 30.293333333333333 , 30.506666666666664 , 30.72              , 56.21333333333333  , 56.60444444444444  , 56.995555555555555 , 57.38666666666666  , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 18.                , 18.133333333333333 , 18.266666666666666 , 18.4               , 32.82666666666667  , 33.06666666666666  , 33.306666666666665 , 33.54666666666667  , 32.82666666666667  , 33.06666666666666  , 33.306666666666665 , 33.54666666666667  , 48.08              , 48.42666666666666  , 48.77333333333333  , 49.12              , 30.080000000000002 , 30.293333333333333 , 30.506666666666664 , 30.72              , 56.21333333333333  , 56.60444444444444  , 56.995555555555555 , 57.38666666666666  , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 41.38666666666666  , 41.67111111111111  , 41.95555555555555  , 42.24              , 26.05              , 26.233333333333334 , 26.416666666666664 , 26.6               , 47.47666666666667  , 47.806666666666665 , 48.13666666666666  , 48.46666666666667  , 47.47666666666667  , 47.806666666666665 , 48.13666666666666  , 48.46666666666667  , 69.49              , 69.96666666666667  , 70.44333333333333  , 70.92              , 43.44              , 43.733333333333334 , 44.02666666666667  , 44.32              , 81.10666666666667  , 81.64444444444443  , 82.18222222222222  , 82.72              , 59.67999999999999  , 60.07111111111111  , 60.462222222222216 , 60.85333333333334  , 59.67999999999999  , 60.07111111111111  , 60.462222222222216 , 60.85333333333334  , 15.3               , 15.4               , 15.5               , 15.600000000000001 , 27.860000000000003 , 28.04              , 28.22              , 28.4               , 27.860000000000003 , 28.04              , 28.22              , 28.4               , 40.74              , 41.                , 41.260000000000005 , 41.52              , 25.439999999999998 , 25.6               , 25.76              , 25.919999999999998 , 47.44              , 47.733333333333334 , 48.026666666666664 , 48.32              , 34.879999999999995 , 35.093333333333334 , 35.306666666666665 , 35.519999999999996 , 34.879999999999995 , 35.093333333333334 , 35.306666666666665 , 35.519999999999996 , 30.05              , 30.233333333333334 , 30.416666666666664 , 30.6               , 54.67666666666666  , 55.00666666666667  , 55.33666666666666  , 55.666666666666664 , 54.67666666666666  , 55.00666666666667  , 55.33666666666666  , 55.666666666666664 , 79.89              , 80.36666666666667  , 80.84333333333333  , 81.32              , 49.839999999999996 , 50.13333333333333  , 50.42666666666667  , 50.72              , 92.83999999999999  , 93.37777777777778  , 93.91555555555556  , 94.45333333333333  , 68.21333333333334  , 68.60444444444444  , 68.99555555555555  , 69.38666666666666  , 68.21333333333334  , 68.60444444444444  , 68.99555555555555  , 69.38666666666666  , 22.8               , 22.93333333333333  , 23.066666666666666 , 23.200000000000003 , 41.46666666666667  , 41.70666666666666  , 41.946666666666665 , 42.18666666666667  , 41.46666666666667  , 41.70666666666666  , 41.946666666666665 , 42.18666666666667  , 60.56000000000001  , 60.906666666666666 , 61.25333333333333  , 61.599999999999994 , 37.76              , 37.973333333333336 , 38.18666666666667  , 38.4               , 70.29333333333332  , 70.68444444444444  , 71.07555555555555  , 71.46666666666665  , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 22.8               , 22.93333333333333  , 23.066666666666666 , 23.200000000000003 , 41.46666666666667  , 41.70666666666666  , 41.946666666666665 , 42.18666666666667  , 41.46666666666667  , 41.70666666666666  , 41.946666666666665 , 42.18666666666667  , 60.56000000000001  , 60.906666666666666 , 61.25333333333333  , 61.599999999999994 , 37.76              , 37.973333333333336 , 38.18666666666667  , 38.4               , 70.29333333333332  , 70.68444444444444  , 71.07555555555555  , 71.46666666666665  , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 };
  const std::array<int, 4> in_shape = {{ 3, 7, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 0.                 , 0.                 , 0.                 , 0.                 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 0.                 , 0.                 , 0.                 , 0.                 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 0.                 , 0.                 , 0.                 , 0.                 , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 0.                 , 0.                 , 0.                 , 0.                 , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 0.                 , 0.                 , 0.                 , 0.                 , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 7, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.38333333333333336,  0.7966666666666667 ,  0.7966666666666667 ,  1.3166666666666669 ,  0.9333333333333333 ,  1.56               ,  1.1466666666666665 ,  2.368888888888889  ,  1.8488888888888888 ,  1.8488888888888888 ,  0.38333333333333336,  0.7966666666666667 ,  0.7966666666666667 ,  1.3166666666666669 ,  0.9333333333333333 ,  1.56               ,  1.1466666666666665 ,  2.368888888888889  ,  1.8488888888888888 ,  1.8488888888888888 ,  0.9333333333333333 ,  1.8266666666666667 ,  1.8266666666666667 ,  2.8666666666666667 ,  1.9333333333333333 ,  3.12               ,  2.2266666666666666 ,  4.448888888888889  ,  3.408888888888889  ,  3.408888888888889  ,  0.8500000000000001 ,  1.61               ,  1.61               ,  2.45               ,  1.6                ,  2.52               ,  1.76               ,  3.4266666666666667 ,  2.586666666666667  ,  2.586666666666667  ,  2.1833333333333336 ,  4.076666666666666  ,  4.076666666666666  ,  6.116666666666666  ,  3.9333333333333336 ,  6.12               ,  4.226666666666667  ,  8.115555555555556  ,  6.075555555555556  ,  6.075555555555556  ,  1.8833333333333333 ,  3.4966666666666666 ,  3.4966666666666666 ,  5.216666666666667  ,  3.333333333333333  ,  5.16               ,  3.546666666666667  ,  6.768888888888889  ,  5.048888888888889  ,  5.048888888888889  ,  1.8833333333333333 ,  3.4966666666666666 ,  3.4966666666666666 ,  5.216666666666667  ,  3.333333333333333  ,  5.16               ,  3.546666666666667  ,  6.768888888888889  ,  5.048888888888889  ,  5.048888888888889  ,  3.05               ,  5.596666666666667  ,  5.596666666666667  ,  8.25               ,  5.2                ,  7.96               ,  5.413333333333334  , 10.19111111111111   ,  7.537777777777778  ,  7.537777777777778  ,  3.05               ,  5.596666666666667  ,  5.596666666666667  ,  8.25               ,  5.2                ,  7.96               ,  5.413333333333334  , 10.19111111111111   ,  7.537777777777778  ,  7.537777777777778  ,  4.6                ,  8.426666666666666  ,  8.426666666666666  , 12.4                ,  7.800000000000001  , 11.92               ,  8.093333333333334  , 15.204444444444444  , 11.231111111111112  , 11.231111111111112  ,  2.85               ,  5.21               ,  5.21               ,  7.65               ,  4.800000000000001  ,  7.320000000000001  ,  4.960000000000001  ,  9.293333333333335  ,  6.8533333333333335 ,  6.8533333333333335 ,  5.85               , 10.676666666666668  , 10.676666666666668  , 15.65               ,  9.8                , 14.920000000000002  , 10.093333333333334  , 18.871111111111112  , 13.897777777777778  , 13.897777777777778  ,  4.55               ,  8.296666666666667  ,  8.296666666666667  , 12.15               ,  7.6                , 11.56               ,  7.813333333333333  , 14.591111111111111  , 10.737777777777778  , 10.737777777777778  ,  4.55               ,  8.296666666666667  ,  8.296666666666667  , 12.15               ,  7.6                , 11.56               ,  7.813333333333333  , 14.591111111111111  , 10.737777777777778  , 10.737777777777778  ,  5.716666666666667  , 10.396666666666668  , 10.396666666666668  , 15.183333333333335  ,  9.466666666666665  , 14.36               ,  9.68               , 18.013333333333332  , 13.226666666666668  , 13.226666666666668  ,  5.716666666666667  , 10.396666666666668  , 10.396666666666668  , 15.183333333333335  ,  9.466666666666665  , 14.36               ,  9.68               , 18.013333333333332  , 13.226666666666668  , 13.226666666666668  ,  8.266666666666667  , 15.026666666666669  , 15.026666666666669  , 21.933333333333334  , 13.666666666666664  , 20.72               , 13.96               , 25.96               , 19.053333333333335  , 19.053333333333335  ,  4.8500000000000005 ,  8.81               ,  8.81               , 12.850000000000001  ,  8.                 , 12.120000000000001  ,  8.16               , 15.159999999999998  , 11.12               , 11.12               ,  9.516666666666666  , 17.276666666666667  , 17.276666666666667  , 25.183333333333334  , 15.666666666666668  , 23.720000000000002  , 15.96               , 29.626666666666665  , 21.72               , 21.72               ,  7.216666666666667  , 13.096666666666668  , 13.096666666666668  , 19.083333333333336  , 11.866666666666667  , 17.96               , 12.08               , 22.413333333333334  , 16.426666666666666  , 16.426666666666666  ,  7.216666666666667  , 13.096666666666668  , 13.096666666666668  , 19.083333333333336  , 11.866666666666667  , 17.96               , 12.08               , 22.413333333333334  , 16.426666666666666  , 16.426666666666666  };
  const std::array<int, 4> in_shape = {{ 3, 7, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.68               , 0.68               , 1.44               , 1.44               , 2.2800000000000002 , 1.5999999999999999 , 1.5999999999999999 , 0.84               , 0.84               , 0.                 , 0.68               , 0.68               , 1.44               , 1.44               , 2.2800000000000002 , 1.5999999999999999 , 1.5999999999999999 , 0.84               , 0.84               , 0.                 , 0.68               , 0.68               , 1.44               , 1.44               , 2.2800000000000002 , 1.5999999999999999 , 1.5999999999999999 , 0.84               , 0.84               , 0.                 , 0.4                , 0.4                , 0.8400000000000001 , 0.8400000000000001 , 1.32               , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.4                , 0.4                , 0.8400000000000001 , 0.8400000000000001 , 1.32               , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.52               , 0.52               , 1.08               , 1.08               , 1.6800000000000002 , 1.1600000000000001 , 1.1600000000000001 , 0.6                , 0.6                , 0.                 , 0.52               , 0.52               , 1.08               , 1.08               , 1.6800000000000002 , 1.1600000000000001 , 1.1600000000000001 , 0.6                , 0.6                , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 0.64               , 0.64               , 1.32               , 1.32               , 2.04               , 1.4                , 1.4                , 0.72               , 0.72               , 0.                 , 0.64               , 0.64               , 1.32               , 1.32               , 2.04               , 1.4                , 1.4                , 0.72               , 0.72               , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 7, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.6333333333333334,  0.7666666666666667,  1.3533333333333335,  1.5933333333333335,  1.3533333333333335,  1.5933333333333335,  2.2866666666666666,  2.6333333333333337,  1.6533333333333333,  1.8666666666666667,  2.8000000000000003,  3.12              ,  2.08              ,  2.293333333333333 ,  4.346666666666667 ,  4.737777777777778 ,  3.4133333333333336,  3.6977777777777776,  3.4133333333333336,  3.6977777777777776,  0.6333333333333334,  0.7666666666666667,  1.3533333333333335,  1.5933333333333335,  1.3533333333333335,  1.5933333333333335,  2.2866666666666666,  2.6333333333333337,  1.6533333333333333,  1.8666666666666667,  2.8000000000000003,  3.12              ,  2.08              ,  2.293333333333333 ,  4.346666666666667 ,  4.737777777777778 ,  3.4133333333333336,  3.6977777777777776,  3.4133333333333336,  3.6977777777777776,  1.6833333333333336,  1.8666666666666667,  3.3233333333333333,  3.6533333333333333,  3.3233333333333333,  3.6533333333333333,  5.256666666666667 ,  5.733333333333333 ,  3.5733333333333333,  3.8666666666666667,  5.800000000000001 ,  6.24              ,  4.16              ,  4.453333333333333 ,  8.36              ,  8.897777777777778 ,  6.426666666666668 ,  6.817777777777778 ,  6.426666666666668 ,  6.817777777777778 ,  1.6               ,  1.7000000000000002,  3.04              ,  3.22              ,  3.04              ,  3.22              ,  4.64              ,  4.9               ,  3.04              ,  3.2               ,  4.800000000000001 ,  5.04              ,  3.3600000000000003,  3.52              ,  6.5600000000000005,  6.8533333333333335,  4.96              ,  5.173333333333334 ,  4.96              ,  5.173333333333334 ,  4.183333333333334 ,  4.366666666666667 ,  7.823333333333333 ,  8.153333333333332 ,  7.823333333333333 ,  8.153333333333332 , 11.756666666666666 , 12.233333333333333 ,  7.573333333333334 ,  7.866666666666667 , 11.8               , 12.24              ,  8.16              ,  8.453333333333333 , 15.693333333333335 , 16.23111111111111  , 11.76              , 12.151111111111112 , 11.76              , 12.151111111111112 ,  3.633333333333333 ,  3.7666666666666666,  6.753333333333333 ,  6.993333333333333 ,  6.753333333333333 ,  6.993333333333333 , 10.086666666666666 , 10.433333333333334 ,  6.453333333333333 ,  6.666666666666666 , 10.                , 10.32              ,  6.880000000000001 ,  7.093333333333334 , 13.146666666666668 , 13.537777777777778 ,  9.813333333333333 , 10.097777777777779 ,  9.813333333333333 , 10.097777777777779 ,  3.633333333333333 ,  3.7666666666666666,  6.753333333333333 ,  6.993333333333333 ,  6.753333333333333 ,  6.993333333333333 , 10.086666666666666 , 10.433333333333334 ,  6.453333333333333 ,  6.666666666666666 , 10.                , 10.32              ,  6.880000000000001 ,  7.093333333333334 , 13.146666666666668 , 13.537777777777778 ,  9.813333333333333 , 10.097777777777779 ,  9.813333333333333 , 10.097777777777779 ,  5.966666666666667 ,  6.1               , 10.953333333333333 , 11.193333333333333 , 10.953333333333333 , 11.193333333333333 , 16.153333333333332 , 16.5               , 10.186666666666667 , 10.4               , 15.600000000000001 , 15.92              , 10.613333333333333 , 10.826666666666668 , 19.99111111111111  , 20.38222222222222  , 14.79111111111111  , 15.075555555555557 , 14.79111111111111  , 15.075555555555557 ,  5.966666666666667 ,  6.1               , 10.953333333333333 , 11.193333333333333 , 10.953333333333333 , 11.193333333333333 , 16.153333333333332 , 16.5               , 10.186666666666667 , 10.4               , 15.600000000000001 , 15.92              , 10.613333333333333 , 10.826666666666668 , 19.99111111111111  , 20.38222222222222  , 14.79111111111111  , 15.075555555555557 , 14.79111111111111  , 15.075555555555557 ,  9.016666666666667 ,  9.2               , 16.523333333333333 , 16.85333333333333  , 16.523333333333333 , 16.85333333333333  , 24.323333333333334 , 24.8               , 15.306666666666667 , 15.600000000000001 , 23.400000000000002 , 23.84              , 15.893333333333333 , 16.186666666666667 , 29.871111111111112 , 30.40888888888889  , 22.071111111111108 , 22.462222222222223 , 22.071111111111108 , 22.462222222222223 ,  5.6000000000000005,  5.7               , 10.24              , 10.42              , 10.24              , 10.42              , 15.04              , 15.3               ,  9.44              ,  9.600000000000001 , 14.4               , 14.640000000000002 ,  9.76              ,  9.920000000000002 , 18.293333333333333 , 18.58666666666667  , 13.493333333333332 , 13.706666666666667 , 13.493333333333332 , 13.706666666666667 , 11.516666666666666 , 11.7               , 21.023333333333333 , 21.353333333333335 , 21.023333333333333 , 21.353333333333335 , 30.82333333333333  , 31.3               , 19.306666666666665 , 19.6               , 29.4               , 29.840000000000003 , 19.89333333333333  , 20.186666666666667 , 37.20444444444444  , 37.742222222222225 , 27.404444444444444 , 27.795555555555556 , 27.404444444444444 , 27.795555555555556 ,  8.966666666666667 ,  9.1               , 16.35333333333333  , 16.593333333333334 , 16.35333333333333  , 16.593333333333334 , 23.953333333333333 , 24.3               , 14.986666666666666 , 15.2               , 22.8               , 23.12              , 15.413333333333334 , 15.626666666666665 , 28.791111111111107 , 29.182222222222222 , 21.19111111111111  , 21.475555555555555 , 21.19111111111111  , 21.475555555555555 ,  8.966666666666667 ,  9.1               , 16.35333333333333  , 16.593333333333334 , 16.35333333333333  , 16.593333333333334 , 23.953333333333333 , 24.3               , 14.986666666666666 , 15.2               , 22.8               , 23.12              , 15.413333333333334 , 15.626666666666665 , 28.791111111111107 , 29.182222222222222 , 21.19111111111111  , 21.475555555555555 , 21.19111111111111  , 21.475555555555555 , 11.3               , 11.433333333333334 , 20.55333333333333  , 20.793333333333337 , 20.55333333333333  , 20.793333333333337 , 30.02              , 30.36666666666667  , 18.72              , 18.93333333333333  , 28.4               , 28.72              , 19.14666666666667  , 19.36              , 35.635555555555555 , 36.026666666666664 , 26.168888888888887 , 26.453333333333337 , 26.168888888888887 , 26.453333333333337 , 11.3               , 11.433333333333334 , 20.55333333333333  , 20.793333333333337 , 20.55333333333333  , 20.793333333333337 , 30.02              , 30.36666666666667  , 18.72              , 18.93333333333333  , 28.4               , 28.72              , 19.14666666666667  , 19.36              , 35.635555555555555 , 36.026666666666664 , 26.168888888888887 , 26.453333333333337 , 26.168888888888887 , 26.453333333333337 , 16.35              , 16.533333333333335 , 29.723333333333333 , 30.053333333333338 , 29.723333333333333 , 30.053333333333338 , 43.39              , 43.86666666666667  , 27.04              , 27.33333333333333  , 41.                , 41.44              , 27.62666666666667  , 27.92              , 51.382222222222225 , 51.92              , 37.715555555555554 , 38.10666666666667  , 37.715555555555554 , 38.10666666666667  ,  9.600000000000001 ,  9.700000000000001 , 17.44              , 17.62              , 17.44              , 17.62              , 25.44              , 25.700000000000003 , 15.84              , 16.                , 24.                , 24.240000000000002 , 16.16              , 16.32              , 30.026666666666667 , 30.319999999999997 , 22.026666666666667 , 22.24              , 22.026666666666667 , 22.24              , 18.85              , 19.03333333333333  , 34.223333333333336 , 34.553333333333335 , 34.223333333333336 , 34.553333333333335 , 49.88999999999999  , 50.36666666666667  , 31.040000000000003 , 31.333333333333336 , 46.99999999999999  , 47.440000000000005 , 31.62666666666667  , 31.92              , 58.715555555555554 , 59.25333333333333  , 43.04888888888889  , 43.44              , 43.04888888888889  , 43.44              , 14.3               , 14.433333333333334 , 25.953333333333333 , 26.193333333333335 , 25.953333333333333 , 26.193333333333335 , 37.82              , 38.16666666666667  , 23.52              , 23.733333333333334 , 35.6               , 35.92              , 23.94666666666667  , 24.16              , 44.43555555555555  , 44.82666666666667  , 32.56888888888889  , 32.85333333333333  , 32.56888888888889  , 32.85333333333333  , 14.3               , 14.433333333333334 , 25.953333333333333 , 26.193333333333335 , 25.953333333333333 , 26.193333333333335 , 37.82              , 38.16666666666667  , 23.52              , 23.733333333333334 , 35.6               , 35.92              , 23.94666666666667  , 24.16              , 44.43555555555555  , 44.82666666666667  , 32.56888888888889  , 32.85333333333333  , 32.56888888888889  , 32.85333333333333  };
  const std::array<int, 4> in_shape = {{ 3, 7, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.52              , 0.56              , 0.52              , 0.56              , 1.12              , 1.2000000000000002, 1.12              , 1.2000000000000002, 1.8000000000000003, 1.9200000000000002, 1.28              , 1.3599999999999999, 1.28              , 1.3599999999999999, 0.68              , 0.72              , 0.68              , 0.72              , 0.                , 0.                , 0.52              , 0.56              , 0.52              , 0.56              , 1.12              , 1.2000000000000002, 1.12              , 1.2000000000000002, 1.8000000000000003, 1.9200000000000002, 1.28              , 1.3599999999999999, 1.28              , 1.3599999999999999, 0.68              , 0.72              , 0.68              , 0.72              , 0.                , 0.                , 1.28              , 1.36              , 1.28              , 1.36              , 2.72              , 2.88              , 2.72              , 2.88              , 4.32              , 4.5600000000000005, 3.04              , 3.1999999999999997, 3.04              , 3.1999999999999997, 1.6               , 1.68              , 1.6               , 1.68              , 0.                , 0.                , 1.28              , 1.36              , 1.28              , 1.36              , 2.72              , 2.88              , 2.72              , 2.88              , 4.32              , 4.5600000000000005, 3.04              , 3.1999999999999997, 3.04              , 3.1999999999999997, 1.6               , 1.68              , 1.6               , 1.68              , 0.                , 0.                , 1.28              , 1.36              , 1.28              , 1.36              , 2.72              , 2.88              , 2.72              , 2.88              , 4.32              , 4.5600000000000005, 3.04              , 3.1999999999999997, 3.04              , 3.1999999999999997, 1.6               , 1.68              , 1.6               , 1.68              , 0.                , 0.                , 0.76              , 0.8               , 0.76              , 0.8               , 1.6               , 1.6800000000000002, 1.6               , 1.6800000000000002, 2.52              , 2.64              , 1.76              , 1.8399999999999999, 1.76              , 1.8399999999999999, 0.92              , 0.96              , 0.92              , 0.96              , 0.                , 0.                , 0.76              , 0.8               , 0.76              , 0.8               , 1.6               , 1.6800000000000002, 1.6               , 1.6800000000000002, 2.52              , 2.64              , 1.76              , 1.8399999999999999, 1.76              , 1.8399999999999999, 0.92              , 0.96              , 0.92              , 0.96              , 0.                , 0.                , 1.                , 1.04              , 1.                , 1.04              , 2.08              , 2.16              , 2.08              , 2.16              , 3.24              , 3.3600000000000003, 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 1.16              , 1.2               , 1.16              , 1.2               , 0.                , 0.                , 1.                , 1.04              , 1.                , 1.04              , 2.08              , 2.16              , 2.08              , 2.16              , 3.24              , 3.3600000000000003, 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 1.16              , 1.2               , 1.16              , 1.2               , 0.                , 0.                , 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 4.640000000000001 , 4.800000000000001 , 4.640000000000001 , 4.800000000000001 , 7.200000000000001 , 7.440000000000001 , 4.960000000000001 , 5.120000000000001 , 4.960000000000001 , 5.120000000000001 , 2.56              , 2.6399999999999997, 2.56              , 2.6399999999999997, 0.                , 0.                , 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 4.640000000000001 , 4.800000000000001 , 4.640000000000001 , 4.800000000000001 , 7.200000000000001 , 7.440000000000001 , 4.960000000000001 , 5.120000000000001 , 4.960000000000001 , 5.120000000000001 , 2.56              , 2.6399999999999997, 2.56              , 2.6399999999999997, 0.                , 0.                , 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 4.640000000000001 , 4.800000000000001 , 4.640000000000001 , 4.800000000000001 , 7.200000000000001 , 7.440000000000001 , 4.960000000000001 , 5.120000000000001 , 4.960000000000001 , 5.120000000000001 , 2.56              , 2.6399999999999997, 2.56              , 2.6399999999999997, 0.                , 0.                , 1.24              , 1.28              , 1.24              , 1.28              , 2.56              , 2.64              , 2.56              , 2.64              , 3.96              , 4.08              , 2.72              , 2.8               , 2.72              , 2.8               , 1.4000000000000001, 1.44              , 1.4000000000000001, 1.44              , 0.                , 0.                , 1.24              , 1.28              , 1.24              , 1.28              , 2.56              , 2.64              , 2.56              , 2.64              , 3.96              , 4.08              , 2.72              , 2.8               , 2.72              , 2.8               , 1.4000000000000001, 1.44              , 1.4000000000000001, 1.44              , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 3, 7, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  1.1333333333333333,   1.2666666666666668,   1.4000000000000001,   1.5333333333333334,   2.466666666666667 ,   2.706666666666667 ,   2.9466666666666668,   3.186666666666667 ,   2.466666666666667 ,   2.706666666666667 ,   2.9466666666666668,   3.186666666666667 ,   4.226666666666667 ,   4.573333333333333 ,   4.92              ,   5.2666666666666675,   3.0933333333333333,   3.3066666666666666,   3.5200000000000005,   3.7333333333333334,   5.28              ,   5.6000000000000005,   5.920000000000001 ,   6.24              ,   3.946666666666667 ,   4.16              ,   4.373333333333334 ,   4.586666666666666 ,   8.302222222222223 ,   8.693333333333333 ,   9.084444444444445 ,   9.475555555555555 ,   6.542222222222223 ,   6.826666666666667 ,   7.111111111111111 ,   7.395555555555555 ,   6.542222222222223 ,   6.826666666666667 ,   7.111111111111111 ,   7.395555555555555 ,   1.1333333333333333,   1.2666666666666668,   1.4000000000000001,   1.5333333333333334,   2.466666666666667 ,   2.706666666666667 ,   2.9466666666666668,   3.186666666666667 ,   2.466666666666667 ,   2.706666666666667 ,   2.9466666666666668,   3.186666666666667 ,   4.226666666666667 ,   4.573333333333333 ,   4.92              ,   5.2666666666666675,   3.0933333333333333,   3.3066666666666666,   3.5200000000000005,   3.7333333333333334,   5.28              ,   5.6000000000000005,   5.920000000000001 ,   6.24              ,   3.946666666666667 ,   4.16              ,   4.373333333333334 ,   4.586666666666666 ,   8.302222222222223 ,   8.693333333333333 ,   9.084444444444445 ,   9.475555555555555 ,   6.542222222222223 ,   6.826666666666667 ,   7.111111111111111 ,   7.395555555555555 ,   6.542222222222223 ,   6.826666666666667 ,   7.111111111111111 ,   7.395555555555555 ,   3.1833333333333336,   3.366666666666667 ,   3.55              ,   3.7333333333333334,   6.316666666666667 ,   6.6466666666666665,   6.976666666666667 ,   7.306666666666667 ,   6.316666666666667 ,   6.6466666666666665,   6.976666666666667 ,   7.306666666666667 ,  10.036666666666669 ,  10.513333333333334 ,  10.990000000000002 ,  11.466666666666667 ,   6.8533333333333335,   7.1466666666666665,   7.44              ,   7.733333333333333 ,  11.16              ,  11.600000000000001 ,  12.04              ,  12.48              ,   8.026666666666667 ,   8.32              ,   8.613333333333333 ,   8.906666666666666 ,  16.182222222222226 ,  16.72              ,  17.25777777777778  ,  17.795555555555556 ,  12.462222222222223 ,  12.853333333333335 ,  13.244444444444444 ,  13.635555555555555 ,  12.462222222222223 ,  12.853333333333335 ,  13.244444444444444 ,  13.635555555555555 ,   3.1000000000000005,   3.2               ,   3.3               ,   3.4000000000000004,   5.8999999999999995,   6.08              ,   6.260000000000001 ,   6.44              ,   5.8999999999999995,   6.08              ,   6.260000000000001 ,   6.44              ,   9.02              ,   9.28              ,   9.540000000000001 ,   9.8               ,   5.92              ,   6.08              ,   6.24              ,   6.4               ,   9.36              ,   9.600000000000001 ,   9.84              ,  10.08              ,   6.56              ,   6.720000000000001 ,   6.88              ,   7.04              ,  12.826666666666668 ,  13.120000000000001 ,  13.413333333333334 ,  13.706666666666667 ,   9.706666666666667 ,   9.92              ,  10.133333333333333 ,  10.346666666666668 ,   9.706666666666667 ,   9.92              ,  10.133333333333333 ,  10.346666666666668 ,   8.183333333333334 ,   8.366666666666667 ,   8.55              ,   8.733333333333334 ,  15.316666666666666 ,  15.646666666666667 ,  15.976666666666668 ,  16.306666666666665 ,  15.316666666666666 ,  15.646666666666667 ,  15.976666666666668 ,  16.306666666666665 ,  23.03666666666666  ,  23.513333333333332 ,  23.990000000000002 ,  24.466666666666665 ,  14.853333333333333 ,  15.146666666666668 ,  15.440000000000001 ,  15.733333333333334 ,  23.159999999999997 ,  23.6               ,  24.04              ,  24.48              ,  16.026666666666667 ,  16.32              ,  16.613333333333333 ,  16.906666666666666 ,  30.848888888888894 ,  31.38666666666667  ,  31.924444444444447 ,  32.46222222222222  ,  23.128888888888888 ,  23.52              ,  23.91111111111111  ,  24.302222222222223 ,  23.128888888888888 ,  23.52              ,  23.91111111111111  ,  24.302222222222223 ,   7.133333333333333 ,   7.266666666666666 ,   7.4               ,   7.533333333333333 ,  13.266666666666666 ,  13.506666666666666 ,  13.746666666666668 ,  13.986666666666666 ,  13.266666666666666 ,  13.506666666666666 ,  13.746666666666668 ,  13.986666666666666 ,  19.826666666666668 ,  20.173333333333332 ,  20.52              ,  20.866666666666667 ,  12.693333333333333 ,  12.906666666666666 ,  13.120000000000001 ,  13.333333333333332 ,  19.68              ,  20.                ,  20.32              ,  20.64              ,  13.546666666666667 ,  13.760000000000002 ,  13.973333333333333 ,  14.186666666666667 ,  25.90222222222222  ,  26.293333333333337 ,  26.684444444444445 ,  27.075555555555557 ,  19.34222222222222  ,  19.626666666666665 ,  19.91111111111111  ,  20.195555555555558 ,  19.34222222222222  ,  19.626666666666665 ,  19.91111111111111  ,  20.195555555555558 ,   7.133333333333333 ,   7.266666666666666 ,   7.4               ,   7.533333333333333 ,  13.266666666666666 ,  13.506666666666666 ,  13.746666666666668 ,  13.986666666666666 ,  13.266666666666666 ,  13.506666666666666 ,  13.746666666666668 ,  13.986666666666666 ,  19.826666666666668 ,  20.173333333333332 ,  20.52              ,  20.866666666666667 ,  12.693333333333333 ,  12.906666666666666 ,  13.120000000000001 ,  13.333333333333332 ,  19.68              ,  20.                ,  20.32              ,  20.64              ,  13.546666666666667 ,  13.760000000000002 ,  13.973333333333333 ,  14.186666666666667 ,  25.90222222222222  ,  26.293333333333337 ,  26.684444444444445 ,  27.075555555555557 ,  19.34222222222222  ,  19.626666666666665 ,  19.91111111111111  ,  20.195555555555558 ,  19.34222222222222  ,  19.626666666666665 ,  19.91111111111111  ,  20.195555555555558 ,  11.8               ,  11.933333333333334 ,  12.066666666666666 ,  12.2               ,  21.666666666666668 ,  21.906666666666666 ,  22.14666666666667  ,  22.386666666666667 ,  21.666666666666668 ,  21.906666666666666 ,  22.14666666666667  ,  22.386666666666667 ,  31.96              ,  32.306666666666665 ,  32.65333333333333  ,  33.                ,  20.16              ,  20.373333333333335 ,  20.58666666666667  ,  20.8               ,  30.88              ,  31.200000000000003 ,  31.520000000000003 ,  31.84              ,  21.013333333333332 ,  21.226666666666667 ,  21.44              ,  21.653333333333336 ,  39.59111111111111  ,  39.98222222222222  ,  40.373333333333335 ,  40.76444444444444  ,  29.297777777777778 ,  29.58222222222222  ,  29.866666666666667 ,  30.151111111111113 ,  29.297777777777778 ,  29.58222222222222  ,  29.866666666666667 ,  30.151111111111113 ,  11.8               ,  11.933333333333334 ,  12.066666666666666 ,  12.2               ,  21.666666666666668 ,  21.906666666666666 ,  22.14666666666667  ,  22.386666666666667 ,  21.666666666666668 ,  21.906666666666666 ,  22.14666666666667  ,  22.386666666666667 ,  31.96              ,  32.306666666666665 ,  32.65333333333333  ,  33.                ,  20.16              ,  20.373333333333335 ,  20.58666666666667  ,  20.8               ,  30.88              ,  31.200000000000003 ,  31.520000000000003 ,  31.84              ,  21.013333333333332 ,  21.226666666666667 ,  21.44              ,  21.653333333333336 ,  39.59111111111111  ,  39.98222222222222  ,  40.373333333333335 ,  40.76444444444444  ,  29.297777777777778 ,  29.58222222222222  ,  29.866666666666667 ,  30.151111111111113 ,  29.297777777777778 ,  29.58222222222222  ,  29.866666666666667 ,  30.151111111111113 ,  17.85              ,  18.033333333333335 ,  18.21666666666667  ,  18.4               ,  32.71666666666667  ,  33.04666666666667  ,  33.376666666666665 ,  33.70666666666666  ,  32.71666666666667  ,  33.04666666666667  ,  33.376666666666665 ,  33.70666666666666  ,  48.17              ,  48.64666666666667  ,  49.12333333333333  ,  49.6               ,  30.32              ,  30.613333333333333 ,  30.906666666666673 ,  31.200000000000003 ,  46.35999999999999  ,  46.800000000000004 ,  47.24              ,  47.68              ,  31.493333333333332 ,  31.786666666666665 ,  32.08              ,  32.373333333333335 ,  59.20444444444445  ,  59.742222222222225 ,  60.28              ,  60.81777777777778  ,  43.75111111111111  ,  44.142222222222216 ,  44.53333333333333  ,  44.92444444444445  ,  43.75111111111111  ,  44.142222222222216 ,  44.53333333333333  ,  44.92444444444445  ,  11.100000000000001 ,  11.200000000000001 ,  11.3               ,  11.4               ,  20.3               ,  20.48              ,  20.66              ,  20.84              ,  20.3               ,  20.48              ,  20.66              ,  20.84              ,  29.82              ,  30.08              ,  30.340000000000003 ,  30.6               ,  18.72              ,  18.88              ,  19.04              ,  19.200000000000003 ,  28.560000000000002 ,  28.8               ,  29.04              ,  29.280000000000005 ,  19.36              ,  19.52              ,  19.68              ,  19.840000000000003 ,  36.29333333333334  ,  36.586666666666666 ,  36.88              ,  37.17333333333334  ,  26.773333333333333 ,  26.986666666666665 ,  27.200000000000003 ,  27.413333333333334 ,  26.773333333333333 ,  26.986666666666665 ,  27.200000000000003 ,  27.413333333333334 ,  22.85              ,  23.03333333333333  ,  23.21666666666667  ,  23.4               ,  41.71666666666666  ,  42.04666666666667  ,  42.376666666666665 ,  42.70666666666667  ,  41.71666666666666  ,  42.04666666666667  ,  42.376666666666665 ,  42.70666666666667  ,  61.17              ,  61.64666666666666  ,  62.123333333333335 ,  62.6               ,  38.31999999999999  ,  38.61333333333333  ,  38.906666666666666 ,  39.2               ,  58.36              ,  58.8               ,  59.24              ,  59.68000000000001  ,  39.49333333333333  ,  39.78666666666666  ,  40.08              ,  40.373333333333335 ,  73.87111111111112  ,  74.40888888888888  ,  74.94666666666667  ,  75.48444444444445  ,  54.41777777777777  ,  54.80888888888889  ,  55.2               ,  55.59111111111111  ,  54.41777777777777  ,  54.80888888888889  ,  55.2               ,  55.59111111111111  ,  17.8               ,  17.933333333333334 ,  18.066666666666666 ,  18.2               ,  32.46666666666667  ,  32.70666666666666  ,  32.94666666666667  ,  33.18666666666667  ,  32.46666666666667  ,  32.70666666666666  ,  32.94666666666667  ,  33.18666666666667  ,  47.56              ,  47.906666666666666 ,  48.25333333333333  ,  48.6               ,  29.76              ,  29.973333333333333 ,  30.186666666666667 ,  30.4               ,  45.28              ,  45.6               ,  45.92000000000001  ,  46.24              ,  30.613333333333333 ,  30.826666666666668 ,  31.04              ,  31.25333333333333  ,  57.19111111111111  ,  57.582222222222214 ,  57.97333333333333  ,  58.364444444444445 ,  42.09777777777778  ,  42.38222222222222  ,  42.666666666666664 ,  42.95111111111111  ,  42.09777777777778  ,  42.38222222222222  ,  42.666666666666664 ,  42.95111111111111  ,  17.8               ,  17.933333333333334 ,  18.066666666666666 ,  18.2               ,  32.46666666666667  ,  32.70666666666666  ,  32.94666666666667  ,  33.18666666666667  ,  32.46666666666667  ,  32.70666666666666  ,  32.94666666666667  ,  33.18666666666667  ,  47.56              ,  47.906666666666666 ,  48.25333333333333  ,  48.6               ,  29.76              ,  29.973333333333333 ,  30.186666666666667 ,  30.4               ,  45.28              ,  45.6               ,  45.92000000000001  ,  46.24              ,  30.613333333333333 ,  30.826666666666668 ,  31.04              ,  31.25333333333333  ,  57.19111111111111  ,  57.582222222222214 ,  57.97333333333333  ,  58.364444444444445 ,  42.09777777777778  ,  42.38222222222222  ,  42.666666666666664 ,  42.95111111111111  ,  42.09777777777778  ,  42.38222222222222  ,  42.666666666666664 ,  42.95111111111111  ,  22.46666666666667  ,  22.6               ,  22.733333333333334 ,  22.866666666666667 ,  40.86666666666667  ,  41.10666666666666  ,  41.346666666666664 ,  41.58666666666667  ,  40.86666666666667  ,  41.10666666666666  ,  41.346666666666664 ,  41.58666666666667  ,  59.693333333333335 ,  60.04              ,  60.38666666666667  ,  60.73333333333334  ,  37.22666666666667  ,  37.44              ,  37.653333333333336 ,  37.86666666666666  ,  56.48              ,  56.8               ,  57.11999999999999  ,  57.44              ,  38.08              ,  38.29333333333334  ,  38.50666666666667  ,  38.72              ,  70.88              ,  71.27111111111111  ,  71.66222222222223  ,  72.05333333333333  ,  52.05333333333333  ,  52.337777777777774 ,  52.62222222222222  ,  52.90666666666667  ,  52.05333333333333  ,  52.337777777777774 ,  52.62222222222222  ,  52.90666666666667  ,  22.46666666666667  ,  22.6               ,  22.733333333333334 ,  22.866666666666667 ,  40.86666666666667  ,  41.10666666666666  ,  41.346666666666664 ,  41.58666666666667  ,  40.86666666666667  ,  41.10666666666666  ,  41.346666666666664 ,  41.58666666666667  ,  59.693333333333335 ,  60.04              ,  60.38666666666667  ,  60.73333333333334  ,  37.22666666666667  ,  37.44              ,  37.653333333333336 ,  37.86666666666666  ,  56.48              ,  56.8               ,  57.11999999999999  ,  57.44              ,  38.08              ,  38.29333333333334  ,  38.50666666666667  ,  38.72              ,  70.88              ,  71.27111111111111  ,  71.66222222222223  ,  72.05333333333333  ,  52.05333333333333  ,  52.337777777777774 ,  52.62222222222222  ,  52.90666666666667  ,  52.05333333333333  ,  52.337777777777774 ,  52.62222222222222  ,  52.90666666666667  ,  32.516666666666666 ,  32.7               ,  32.88333333333333  ,  33.06666666666667  ,  59.116666666666674 ,  59.446666666666665 ,  59.776666666666664 ,  60.106666666666676 ,  59.116666666666674 ,  59.446666666666665 ,  59.776666666666664 ,  60.106666666666676 ,  86.30333333333334  ,  86.78              ,  87.25666666666667  ,  87.73333333333333  ,  53.78666666666666  ,  54.08              ,  54.373333333333335 ,  54.66666666666666  ,  81.55999999999999  ,  82.                ,  82.43999999999998  ,  82.88              ,  54.959999999999994 ,  55.25333333333334  ,  55.54666666666667  ,  55.84              , 102.22666666666666  , 102.76444444444445  , 103.30222222222221  , 103.84              ,  75.03999999999999  ,  75.43111111111111  ,  75.82222222222222  ,  76.21333333333334  ,  75.03999999999999  ,  75.43111111111111  ,  75.82222222222222  ,  76.21333333333334  ,  19.1               ,  19.200000000000003 ,  19.3               ,  19.400000000000002 ,  34.7               ,  34.88              ,  35.06              ,  35.24              ,  34.7               ,  34.88              ,  35.06              ,  35.24              ,  50.620000000000005 ,  50.88              ,  51.14              ,  51.400000000000006 ,  31.52              ,  31.68              ,  31.839999999999996 ,  32.                ,  47.75999999999999  ,  48.                ,  48.24              ,  48.480000000000004 ,  32.16              ,  32.32              ,  32.480000000000004 ,  32.64              ,  59.760000000000005 ,  60.053333333333335 ,  60.34666666666667  ,  60.63999999999999  ,  43.839999999999996 ,  44.053333333333335 ,  44.266666666666666 ,  44.48              ,  43.839999999999996 ,  44.053333333333335 ,  44.266666666666666 ,  44.48              ,  37.516666666666666 ,  37.7               ,  37.88333333333333  ,  38.06666666666666  ,  68.11666666666667  ,  68.44666666666667  ,  68.77666666666667  ,  69.10666666666667  ,  68.11666666666667  ,  68.44666666666667  ,  68.77666666666667  ,  69.10666666666667  ,  99.30333333333333  ,  99.77999999999999  , 100.25666666666666  , 100.73333333333333  ,  61.78666666666666  ,  62.080000000000005 ,  62.37333333333333  ,  62.66666666666667  ,  93.55999999999999  ,  93.99999999999999  ,  94.44000000000001  ,  94.88000000000001  ,  62.959999999999994 ,  63.25333333333334  ,  63.54666666666667  ,  63.84              , 116.89333333333333  , 117.43111111111111  , 117.9688888888889   , 118.50666666666666  ,  85.70666666666666  ,  86.09777777777778  ,  86.48888888888888  ,  86.88              ,  85.70666666666666  ,  86.09777777777778  ,  86.48888888888888  ,  86.88              ,  28.466666666666665 ,  28.6               ,  28.733333333333334 ,  28.866666666666667 ,  51.666666666666664 ,  51.906666666666666 ,  52.14666666666667  ,  52.38666666666667  ,  51.666666666666664 ,  51.906666666666666 ,  52.14666666666667  ,  52.38666666666667  ,  75.29333333333332  ,  75.64              ,  75.98666666666666  ,  76.33333333333334  ,  46.82666666666667  ,  47.04              ,  47.25333333333333  ,  47.46666666666667  ,  70.88              ,  71.2               ,  71.52              ,  71.84              ,  47.67999999999999  ,  47.89333333333334  ,  48.10666666666666  ,  48.32              ,  88.47999999999999  ,  88.8711111111111   ,  89.26222222222222  ,  89.65333333333334  ,  64.85333333333332  ,  65.13777777777779  ,  65.42222222222222  ,  65.70666666666666  ,  64.85333333333332  ,  65.13777777777779  ,  65.42222222222222  ,  65.70666666666666  ,  28.466666666666665 ,  28.6               ,  28.733333333333334 ,  28.866666666666667 ,  51.666666666666664 ,  51.906666666666666 ,  52.14666666666667  ,  52.38666666666667  ,  51.666666666666664 ,  51.906666666666666 ,  52.14666666666667  ,  52.38666666666667  ,  75.29333333333332  ,  75.64              ,  75.98666666666666  ,  76.33333333333334  ,  46.82666666666667  ,  47.04              ,  47.25333333333333  ,  47.46666666666667  ,  70.88              ,  71.2               ,  71.52              ,  71.84              ,  47.67999999999999  ,  47.89333333333334  ,  48.10666666666666  ,  48.32              ,  88.47999999999999  ,  88.8711111111111   ,  89.26222222222222  ,  89.65333333333334  ,  64.85333333333332  ,  65.13777777777779  ,  65.42222222222222  ,  65.70666666666666  ,  64.85333333333332  ,  65.13777777777779  ,  65.42222222222222  ,  65.70666666666666  };
  const std::array<int, 4> in_shape = {{ 3, 7, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x7x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.6                ,  0.72               ,  0.8400000000000001 ,  0.96               ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.6                ,  0.72               ,  0.8400000000000001 ,  0.96               ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  2.04               ,  2.16               ,  2.28               ,  2.4                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  2.04               ,  2.16               ,  2.28               ,  2.4                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  3.4800000000000004 ,  3.6000000000000005 ,  3.7200000000000006 ,  3.8400000000000003 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  3.4800000000000004 ,  3.6000000000000005 ,  3.7200000000000006 ,  3.8400000000000003 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  4.92               ,  5.04               ,  5.16               ,  5.28               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  4.92               ,  5.04               ,  5.16               ,  5.28               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  6.36               ,  6.48               ,  6.6                ,  6.720000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  6.36               ,  6.48               ,  6.6                ,  6.720000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  7.800000000000001  ,  7.92               ,  8.04               ,  8.16               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  7.800000000000001  ,  7.92               ,  8.04               ,  8.16               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 };
  const std::array<int, 4> in_shape = {{ 3, 7, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.18333333333333335,  0.18333333333333335,  0.33333333333333337,  0.25               ,  0.5833333333333333 ,  0.48333333333333334,  0.48333333333333334,  0.7566666666666666 ,  0.7566666666666666 ,  1.1866666666666668 ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  0.7566666666666666 ,  0.7566666666666666 ,  1.1866666666666668 ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  1.7566666666666664 ,  1.7566666666666664 ,  2.6266666666666665 ,  1.6099999999999999 ,  3.2766666666666664 ,  2.536666666666667  ,  2.536666666666667  ,  1.5733333333333333 ,  1.5733333333333333 ,  2.293333333333333  ,  1.36               ,  2.6933333333333334 ,  2.0533333333333337 ,  2.0533333333333337 ,  3.9511111111111115 ,  3.9511111111111115 ,  5.671111111111111  ,  3.2933333333333334 ,  6.404444444444445  ,  4.831111111111111  ,  4.831111111111111  ,  3.377777777777778  ,  3.377777777777778  ,  4.817777777777778  ,  2.7733333333333334 ,  5.351111111111111  ,  4.017777777777778  ,  4.017777777777778  ,  3.377777777777778  ,  3.377777777777778  ,  4.817777777777778  ,  2.7733333333333334 ,  5.351111111111111  ,  4.017777777777778  ,  4.017777777777778  ,  2.3166666666666664 ,  2.3166666666666664 ,  3.2666666666666666 ,  1.85               ,  3.5166666666666666 ,  2.6166666666666667 ,  2.6166666666666667 ,  4.596666666666667  ,  4.596666666666667  ,  6.466666666666666  ,  3.65               ,  6.916666666666666  ,  5.136666666666667  ,  5.136666666666667  ,  4.596666666666667  ,  4.596666666666667  ,  6.466666666666666  ,  3.65               ,  6.916666666666666  ,  5.136666666666667  ,  5.136666666666667  ,  7.303333333333334  ,  7.303333333333334  , 10.253333333333332  ,  5.77               , 10.903333333333332  ,  8.083333333333334  ,  8.083333333333334  ,  4.986666666666666  ,  4.986666666666666  ,  6.986666666666666  ,  3.92               ,  7.386666666666667  ,  5.466666666666667  ,  5.466666666666667  , 10.208888888888888  , 10.208888888888888  , 14.275555555555554  ,  7.986666666666666  , 15.008888888888889  , 11.088888888888889  , 11.088888888888889  ,  7.928888888888888  ,  7.928888888888888  , 11.075555555555555  ,  6.1866666666666665 , 11.608888888888888  ,  8.568888888888889  ,  8.568888888888889  ,  7.928888888888888  ,  7.928888888888888  , 11.075555555555555  ,  6.1866666666666665 , 11.608888888888888  ,  8.568888888888889  ,  8.568888888888889  ,  4.45               ,  4.45               ,  6.2                ,  3.45               ,  6.45               ,  4.75               ,  4.75               ,  8.436666666666667  ,  8.436666666666667  , 11.746666666666668  ,  6.530000000000001  , 12.196666666666667  ,  8.976666666666667  ,  8.976666666666667  ,  8.436666666666667  ,  8.436666666666667  , 11.746666666666668  ,  6.530000000000001  , 12.196666666666667  ,  8.976666666666667  ,  8.976666666666667  , 12.850000000000001  , 12.850000000000001  , 17.88               ,  9.930000000000001  , 18.53               , 13.63               , 13.63               ,  8.4                ,  8.4                , 11.680000000000001  ,  6.4799999999999995 , 12.08               ,  8.879999999999999  ,  8.879999999999999  , 16.46666666666667   , 16.46666666666667   , 22.88               , 12.68               , 23.613333333333333  , 17.346666666666664  , 17.346666666666664  , 12.48               , 12.48               , 17.333333333333332  ,  9.6                , 17.866666666666664  , 13.120000000000001  , 13.120000000000001  , 12.48               , 12.48               , 17.333333333333332  ,  9.6                , 17.866666666666664  , 13.120000000000001  , 13.120000000000001  };
  const std::array<int, 4> in_shape = {{ 3, 8, 7, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 7, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.23333333333333334,  0.3666666666666667 ,  0.23333333333333334,  0.3666666666666667 ,  0.48333333333333334,  0.6666666666666667 ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  3.166666666666666  ,  3.5133333333333328 ,  3.166666666666666  ,  3.5133333333333328 ,  4.776666666666666  ,  5.253333333333333  ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  2.9333333333333336 ,  3.1466666666666665 ,  2.9333333333333336 ,  3.1466666666666665 ,  4.293333333333333  ,  4.586666666666666  ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  7.511111111111111  ,  7.902222222222223  ,  7.511111111111111  ,  7.902222222222223  , 10.804444444444444  , 11.342222222222222  ,  6.293333333333334  ,  6.586666666666667  , 12.27111111111111   , 12.80888888888889   ,  9.27111111111111   ,  9.662222222222223  ,  9.27111111111111   ,  9.662222222222223  ,  6.471111111111111  ,  6.755555555555556  ,  6.471111111111111  ,  6.755555555555556  ,  9.244444444444444  ,  9.635555555555555  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  ,  6.471111111111111  ,  6.755555555555556  ,  6.471111111111111  ,  6.755555555555556  ,  9.244444444444444  ,  9.635555555555555  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  ,  4.5                ,  4.633333333333333  ,  4.5                ,  4.633333333333333  ,  6.35               ,  6.533333333333333  ,  3.6                ,  3.7                ,  6.85               ,  7.033333333333333  ,  5.1                ,  5.233333333333333  ,  5.1                ,  5.233333333333333  ,  8.953333333333333  ,  9.193333333333333  ,  8.953333333333333  ,  9.193333333333333  , 12.603333333333333  , 12.933333333333332  ,  7.12               ,  7.3                , 13.503333333333334  , 13.833333333333332  , 10.033333333333333  , 10.273333333333333  , 10.033333333333333  , 10.273333333333333  ,  8.953333333333333  ,  9.193333333333333  ,  8.953333333333333  ,  9.193333333333333  , 12.603333333333333  , 12.933333333333332  ,  7.12               ,  7.3                , 13.503333333333334  , 13.833333333333332  , 10.033333333333333  , 10.273333333333333  , 10.033333333333333  , 10.273333333333333  , 14.259999999999998  , 14.606666666666667  , 14.259999999999998  , 14.606666666666667  , 20.03               , 20.506666666666664  , 11.280000000000001  , 11.54               , 21.330000000000002  , 21.806666666666665  , 15.819999999999999  , 16.166666666666668  , 15.819999999999999  , 16.166666666666668  ,  9.76               ,  9.973333333333333  ,  9.76               ,  9.973333333333333  , 13.68               , 13.973333333333333  ,  7.680000000000001  ,  7.84               , 14.479999999999999  , 14.773333333333333  , 10.72               , 10.933333333333334  , 10.72               , 10.933333333333334  , 20.026666666666667  , 20.417777777777776  , 20.026666666666667  , 20.417777777777776  , 28.013333333333332  , 28.55111111111111   , 15.68               , 15.973333333333333  , 29.479999999999997  , 30.017777777777777  , 21.78666666666667   , 22.177777777777777  , 21.78666666666667   , 22.177777777777777  , 15.573333333333334  , 15.857777777777777  , 15.573333333333334  , 15.857777777777777  , 21.759999999999998  , 22.15111111111111   , 12.16               , 12.373333333333333  , 22.826666666666668  , 23.217777777777776  , 16.85333333333333   , 17.137777777777778  , 16.85333333333333   , 17.137777777777778  , 15.573333333333334  , 15.857777777777777  , 15.573333333333334  , 15.857777777777777  , 21.759999999999998  , 22.15111111111111   , 12.16               , 12.373333333333333  , 22.826666666666668  , 23.217777777777776  , 16.85333333333333   , 17.137777777777778  , 16.85333333333333   , 17.137777777777778  ,  8.766666666666666  ,  8.9                ,  8.766666666666666  ,  8.9                , 12.216666666666665  , 12.4                ,  6.800000000000001  ,  6.9                , 12.716666666666667  , 12.9                ,  9.366666666666667  ,  9.5                ,  9.366666666666667  ,  9.5                , 16.633333333333333  , 16.873333333333335  , 16.633333333333333  , 16.873333333333335  , 23.163333333333334  , 23.493333333333336  , 12.88               , 13.060000000000002  , 24.063333333333333  , 24.393333333333334  , 17.713333333333335  , 17.953333333333333  , 17.713333333333335  , 17.953333333333333  , 16.633333333333333  , 16.873333333333335  , 16.633333333333333  , 16.873333333333335  , 23.163333333333334  , 23.493333333333336  , 12.88               , 13.060000000000002  , 24.063333333333333  , 24.393333333333334  , 17.713333333333335  , 17.953333333333333  , 17.713333333333335  , 17.953333333333333  , 25.35333333333333   , 25.700000000000003  , 25.35333333333333   , 25.700000000000003  , 35.28333333333333   , 35.76               , 19.6                , 19.860000000000003  , 36.58333333333333   , 37.06               , 26.913333333333334  , 27.26               , 26.913333333333334  , 27.26               , 16.586666666666666  , 16.8                , 16.586666666666666  , 16.8                , 23.066666666666663  , 23.360000000000003  , 12.8                , 12.959999999999999  , 23.866666666666667  , 24.16               , 17.546666666666667  , 17.759999999999998  , 17.546666666666667  , 17.759999999999998  , 32.54222222222222   , 32.93333333333334   , 32.54222222222222   , 32.93333333333334   , 45.222222222222214  , 45.76               , 25.066666666666666  , 25.36               , 46.68888888888889   , 47.22666666666667   , 34.30222222222222   , 34.69333333333333   , 34.30222222222222   , 34.69333333333333   , 24.675555555555555  , 24.96               , 24.675555555555555  , 24.96               , 34.275555555555556  , 34.666666666666664  , 18.986666666666668  , 19.2                , 35.34222222222222   , 35.73333333333333   , 25.955555555555556  , 26.240000000000002  , 25.955555555555556  , 26.240000000000002  , 24.675555555555555  , 24.96               , 24.675555555555555  , 24.96               , 34.275555555555556  , 34.666666666666664  , 18.986666666666668  , 19.2                , 35.34222222222222   , 35.73333333333333   , 25.955555555555556  , 26.240000000000002  , 25.955555555555556  , 26.240000000000002  };
  const std::array<int, 4> in_shape = {{ 3, 8, 7, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 7, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.3333333333333333,  0.4666666666666667,  0.6000000000000001,  0.7333333333333334,  0.3333333333333333,  0.4666666666666667,  0.6000000000000001,  0.7333333333333334,  0.7833333333333333,  0.9666666666666667,  1.1500000000000001,  1.3333333333333335,  0.7               ,  0.8               ,  0.9000000000000001,  1.                ,  1.7833333333333332,  1.9666666666666666,  2.1500000000000004,  2.333333333333333 ,  1.5333333333333332,  1.6666666666666665,  1.8               ,  1.9333333333333333,  1.5333333333333332,  1.6666666666666665,  1.8               ,  1.9333333333333333,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  3.7566666666666664,  4.086666666666666 ,  4.416666666666667 ,  4.746666666666667 ,  2.54              ,  2.72              ,  2.9000000000000004,  3.08              ,  5.556666666666667 ,  5.886666666666667 ,  6.216666666666667 ,  6.546666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  2.3066666666666666,  2.5466666666666664,  2.7866666666666666,  3.0266666666666664,  3.7566666666666664,  4.086666666666666 ,  4.416666666666667 ,  4.746666666666667 ,  2.54              ,  2.72              ,  2.9000000000000004,  3.08              ,  5.556666666666667 ,  5.886666666666667 ,  6.216666666666667 ,  6.546666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  4.466666666666667 ,  4.706666666666667 ,  4.946666666666666 ,  5.186666666666667 ,  5.986666666666666 ,  6.333333333333332 ,  6.68              ,  7.0266666666666655,  5.986666666666666 ,  6.333333333333332 ,  6.68              ,  7.0266666666666655,  9.076666666666668 ,  9.553333333333333 , 10.030000000000001 , 10.506666666666666 ,  5.66              ,  5.92              ,  6.180000000000001 ,  6.4399999999999995, 11.676666666666668 , 12.153333333333332 , 12.63              , 13.106666666666666 ,  9.106666666666667 ,  9.453333333333333 ,  9.799999999999999 , 10.146666666666668 ,  9.106666666666667 ,  9.453333333333333 ,  9.799999999999999 , 10.146666666666668 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  5.653333333333334 ,  5.866666666666667 ,  6.08              ,  6.293333333333333 ,  8.293333333333335 ,  8.586666666666666 ,  8.88              ,  9.173333333333332 ,  4.96              ,  5.12              ,  5.28              ,  5.44              ,  9.893333333333334 , 10.186666666666666 , 10.48              , 10.773333333333333 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 ,  7.573333333333334 ,  7.786666666666666 ,  8.                ,  8.213333333333335 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 14.631111111111112 , 15.022222222222222 , 15.413333333333332 , 15.804444444444446 , 21.07111111111111  , 21.608888888888888 , 22.14666666666667  , 22.684444444444445 , 12.293333333333333 , 12.586666666666668 , 12.88              , 13.173333333333334 , 24.004444444444445 , 24.54222222222222  , 25.08              , 25.61777777777778  , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 18.151111111111113 , 18.54222222222222  , 18.933333333333334 , 19.324444444444445 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 12.657777777777778 , 12.942222222222222 , 13.226666666666665 , 13.511111111111113 , 18.097777777777775 , 18.488888888888887 , 18.88              , 19.27111111111111  , 10.453333333333333 , 10.666666666666668 , 10.88              , 11.093333333333334 , 20.23111111111111  , 20.622222222222224 , 21.013333333333335 , 21.404444444444444 , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  , 15.21777777777778  , 15.502222222222223 , 15.786666666666667 , 16.07111111111111  ,  8.866666666666667 ,  9.                ,  9.133333333333333 ,  9.266666666666666 ,  8.866666666666667 ,  9.                ,  9.133333333333333 ,  9.266666666666666 , 12.516666666666667 , 12.7               , 12.883333333333333 , 13.066666666666666 ,  7.1000000000000005,  7.2               ,  7.300000000000001 ,  7.4               , 13.516666666666666 , 13.7               , 13.883333333333333 , 14.066666666666666 , 10.066666666666666 , 10.2               , 10.333333333333332 , 10.466666666666667 , 10.066666666666666 , 10.2               , 10.333333333333332 , 10.466666666666667 , 17.666666666666668 , 17.906666666666666 , 18.146666666666665 , 18.386666666666667 , 17.666666666666668 , 17.906666666666666 , 18.146666666666665 , 18.386666666666667 , 24.876666666666665 , 25.206666666666667 , 25.536666666666665 , 25.866666666666664 , 14.06              , 14.24              , 14.420000000000002 , 14.6               , 26.676666666666662 , 27.006666666666668 , 27.336666666666666 , 27.666666666666664 , 19.826666666666668 , 20.066666666666666 , 20.306666666666665 , 20.546666666666667 , 19.826666666666668 , 20.066666666666666 , 20.306666666666665 , 20.546666666666667 , 17.666666666666668 , 17.906666666666666 , 18.146666666666665 , 18.386666666666667 , 17.666666666666668 , 17.906666666666666 , 18.146666666666665 , 18.386666666666667 , 24.876666666666665 , 25.206666666666667 , 25.536666666666665 , 25.866666666666664 , 14.06              , 14.24              , 14.420000000000002 , 14.6               , 26.676666666666662 , 27.006666666666668 , 27.336666666666666 , 27.666666666666664 , 19.826666666666668 , 20.066666666666666 , 20.306666666666665 , 20.546666666666667 , 19.826666666666668 , 20.066666666666666 , 20.306666666666665 , 20.546666666666667 , 28.173333333333332 , 28.519999999999996 , 28.866666666666664 , 29.213333333333335 , 28.173333333333332 , 28.519999999999996 , 28.866666666666664 , 29.213333333333335 , 39.583333333333336 , 40.06              , 40.53666666666666  , 41.01333333333333  , 22.3               , 22.560000000000002 , 22.820000000000004 , 23.08              , 42.18333333333333  , 42.660000000000004 , 43.13666666666666  , 43.61333333333333  , 31.293333333333333 , 31.639999999999997 , 31.986666666666665 , 32.333333333333336 , 31.293333333333333 , 31.639999999999997 , 31.986666666666665 , 32.333333333333336 , 19.30666666666667  , 19.52              , 19.733333333333334 , 19.946666666666665 , 19.30666666666667  , 19.52              , 19.733333333333334 , 19.946666666666665 , 27.066666666666666 , 27.36              , 27.653333333333336 , 27.946666666666665 , 15.2               , 15.360000000000001 , 15.52              , 15.68              , 28.666666666666664 , 28.959999999999997 , 29.253333333333334 , 29.546666666666667 , 21.226666666666667 , 21.44              , 21.653333333333332 , 21.866666666666667 , 21.226666666666667 , 21.44              , 21.653333333333332 , 21.866666666666667 , 39.66222222222222  , 40.053333333333335 , 40.44444444444444  , 40.83555555555555  , 39.66222222222222  , 40.053333333333335 , 40.44444444444444  , 40.83555555555555  , 55.48888888888888  , 56.026666666666664 , 56.56444444444445  , 57.10222222222222  , 31.066666666666666 , 31.36              , 31.653333333333332 , 31.946666666666665 , 58.42222222222222  , 58.959999999999994 , 59.497777777777785 , 60.035555555555554 , 43.18222222222222  , 43.57333333333334  , 43.96444444444444  , 44.355555555555554 , 43.18222222222222  , 43.57333333333334  , 43.96444444444444  , 44.355555555555554 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 43.12888888888888  , 43.519999999999996 , 43.91111111111111  , 44.30222222222222  , 24.106666666666666 , 24.32              , 24.533333333333335 , 24.746666666666666 , 45.26222222222222  , 45.653333333333336 , 46.044444444444444 , 46.43555555555555  , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 30.862222222222226 , 31.14666666666667  , 31.43111111111111  , 31.715555555555554 , 43.12888888888888  , 43.519999999999996 , 43.91111111111111  , 44.30222222222222  , 24.106666666666666 , 24.32              , 24.533333333333335 , 24.746666666666666 , 45.26222222222222  , 45.653333333333336 , 46.044444444444444 , 46.43555555555555  , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 33.42222222222222  , 33.70666666666666  , 33.99111111111111  , 34.275555555555556 , 17.4               , 17.53333333333333  , 17.666666666666664 , 17.8               , 17.4               , 17.53333333333333  , 17.666666666666664 , 17.8               , 24.25              , 24.43333333333333  , 24.616666666666664 , 24.8               , 13.5               , 13.600000000000001 , 13.7               , 13.8               , 25.25              , 25.433333333333334 , 25.616666666666667 , 25.8               , 18.6               , 18.733333333333334 , 18.866666666666667 , 19.                , 18.6               , 18.733333333333334 , 18.866666666666667 , 19.                , 33.026666666666664 , 33.266666666666666 , 33.50666666666667  , 33.74666666666667  , 33.026666666666664 , 33.266666666666666 , 33.50666666666667  , 33.74666666666667  , 45.99666666666666  , 46.32666666666667  , 46.656666666666666 , 46.98666666666667  , 25.580000000000002 , 25.76              , 25.939999999999998 , 26.120000000000005 , 47.79666666666667  , 48.126666666666665 , 48.45666666666667  , 48.78666666666667  , 35.18666666666667  , 35.42666666666667  , 35.666666666666664 , 35.906666666666666 , 35.18666666666667  , 35.42666666666667  , 35.666666666666664 , 35.906666666666666 , 33.026666666666664 , 33.266666666666666 , 33.50666666666667  , 33.74666666666667  , 33.026666666666664 , 33.266666666666666 , 33.50666666666667  , 33.74666666666667  , 45.99666666666666  , 46.32666666666667  , 46.656666666666666 , 46.98666666666667  , 25.580000000000002 , 25.76              , 25.939999999999998 , 26.120000000000005 , 47.79666666666667  , 48.126666666666665 , 48.45666666666667  , 48.78666666666667  , 35.18666666666667  , 35.42666666666667  , 35.666666666666664 , 35.906666666666666 , 35.18666666666667  , 35.42666666666667  , 35.666666666666664 , 35.906666666666666 , 50.36              , 50.70666666666666  , 51.053333333333335 , 51.400000000000006 , 50.36              , 50.70666666666666  , 51.053333333333335 , 51.400000000000006 , 70.09              , 70.56666666666666  , 71.04333333333334  , 71.52              , 38.94              , 39.2               , 39.459999999999994 , 39.720000000000006 , 72.69              , 73.16666666666666  , 73.64333333333335  , 74.12              , 53.48              , 53.82666666666667  , 54.173333333333325 , 54.52              , 53.48              , 53.82666666666667  , 54.173333333333325 , 54.52              , 32.96              , 33.17333333333333  , 33.38666666666667  , 33.6               , 32.96              , 33.17333333333333  , 33.38666666666667  , 33.6               , 45.839999999999996 , 46.133333333333326 , 46.42666666666666  , 46.720000000000006 , 25.439999999999998 , 25.6               , 25.76              , 25.919999999999998 , 47.44              , 47.733333333333334 , 48.026666666666664 , 48.32              , 34.879999999999995 , 35.093333333333334 , 35.306666666666665 , 35.519999999999996 , 34.879999999999995 , 35.093333333333334 , 35.306666666666665 , 35.519999999999996 , 64.69333333333333  , 65.08444444444444  , 65.47555555555556  , 65.86666666666667  , 64.69333333333333  , 65.08444444444444  , 65.47555555555556  , 65.86666666666667  , 89.90666666666665  , 90.44444444444443  , 90.98222222222222  , 91.52              , 49.839999999999996 , 50.13333333333333  , 50.42666666666667  , 50.72              , 92.83999999999999  , 93.37777777777778  , 93.91555555555556  , 94.45333333333333  , 68.21333333333334  , 68.60444444444444  , 68.99555555555555  , 69.38666666666666  , 68.21333333333334  , 68.60444444444444  , 68.99555555555555  , 69.38666666666666  , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 68.16              , 68.55111111111111  , 68.94222222222223  , 69.33333333333333  , 37.76              , 37.973333333333336 , 38.18666666666667  , 38.4               , 70.29333333333332  , 70.68444444444444  , 71.07555555555555  , 71.46666666666665  , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 49.06666666666666  , 49.35111111111111  , 49.635555555555555 , 49.92              , 68.16              , 68.55111111111111  , 68.94222222222223  , 69.33333333333333  , 37.76              , 37.973333333333336 , 38.18666666666667  , 38.4               , 70.29333333333332  , 70.68444444444444  , 71.07555555555555  , 71.46666666666665  , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 , 51.626666666666665 , 51.91111111111111  , 52.19555555555556  , 52.480000000000004 };
  const std::array<int, 4> in_shape = {{ 3, 8, 7, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 7, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.1625             ,  0.1625             ,  0.3125             ,  0.25               ,  0.5833333333333333 ,  0.48333333333333334,  0.48333333333333334,  0.3125             ,  0.6525             ,  0.6525             ,  1.0825             ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  0.3125             ,  0.6525             ,  0.6525             ,  1.0825             ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  0.7625             ,  1.5025             ,  1.5025             ,  2.3725             ,  1.6099999999999999 ,  3.2766666666666664 ,  2.536666666666667  ,  2.536666666666667  ,  0.7                ,  1.3399999999999999 ,  1.3399999999999999 ,  2.06               ,  1.36               ,  2.6933333333333334 ,  2.0533333333333337 ,  2.0533333333333337 ,  1.7833333333333332 ,  3.3566666666666665 ,  3.3566666666666665 ,  5.076666666666667  ,  3.2933333333333334 ,  6.404444444444445  ,  4.831111111111111  ,  4.831111111111111  ,  1.5333333333333332 ,  2.8666666666666667 ,  2.8666666666666667 ,  4.306666666666667  ,  2.7733333333333334 ,  5.351111111111111  ,  4.017777777777778  ,  4.017777777777778  ,  1.5333333333333332 ,  2.8666666666666667 ,  2.8666666666666667 ,  4.306666666666667  ,  2.7733333333333334 ,  5.351111111111111  ,  4.017777777777778  ,  4.017777777777778  ,  1.0625             ,  1.9625             ,  1.9625             ,  2.9125             ,  1.85               ,  3.5166666666666666 ,  2.6166666666666667 ,  2.6166666666666667 ,  2.1125             ,  3.8925             ,  3.8925             ,  5.7625             ,  3.65               ,  6.916666666666666  ,  5.136666666666667  ,  5.136666666666667  ,  2.1125             ,  3.8925             ,  3.8925             ,  5.7625             ,  3.65               ,  6.916666666666666  ,  5.136666666666667  ,  5.136666666666667  ,  3.3625             ,  6.1825             ,  6.1825             ,  9.1325             ,  5.77               , 10.903333333333332  ,  8.083333333333334  ,  8.083333333333334  ,  2.3                ,  4.220000000000001  ,  4.220000000000001  ,  6.22               ,  3.92               ,  7.386666666666667  ,  5.466666666666667  ,  5.466666666666667  ,  4.716666666666667  ,  8.636666666666667  ,  8.636666666666667  , 12.703333333333333  ,  7.986666666666666  , 15.008888888888889  , 11.088888888888889  , 11.088888888888889  ,  3.6666666666666665 ,  6.706666666666667  ,  6.706666666666667  ,  9.853333333333333  ,  6.1866666666666665 , 11.608888888888888  ,  8.568888888888889  ,  8.568888888888889  ,  3.6666666666666665 ,  6.706666666666667  ,  6.706666666666667  ,  9.853333333333333  ,  6.1866666666666665 , 11.608888888888888  ,  8.568888888888889  ,  8.568888888888889  ,  2.0625             ,  3.7625             ,  3.7625             ,  5.5125             ,  3.45               ,  6.45               ,  4.75               ,  4.75               ,  3.9125             ,  7.1325             ,  7.1325             , 10.4425             ,  6.530000000000001  , 12.196666666666667  ,  8.976666666666667  ,  8.976666666666667  ,  3.9125             ,  7.1325             ,  7.1325             , 10.4425             ,  6.530000000000001  , 12.196666666666667  ,  8.976666666666667  ,  8.976666666666667  ,  5.9625             , 10.8625             , 10.8625             , 15.892500000000002  ,  9.930000000000001  , 18.53               , 13.63               , 13.63               ,  3.9000000000000004 ,  7.1                ,  7.1                , 10.38               ,  6.4799999999999995 , 12.08               ,  8.879999999999999  ,  8.879999999999999  ,  7.65               , 13.916666666666666  , 13.916666666666666  , 20.33               , 12.68               , 23.613333333333333  , 17.346666666666664  , 17.346666666666664  ,  5.800000000000001  , 10.546666666666667  , 10.546666666666667  , 15.399999999999999  ,  9.6                , 17.866666666666664  , 13.120000000000001  , 13.120000000000001  ,  5.800000000000001  , 10.546666666666667  , 10.546666666666667  , 15.399999999999999  ,  9.6                , 17.866666666666664  , 13.120000000000001  , 13.120000000000001  };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.12               , 0.08               , 0.08               , 0.                 , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.4                , 0.4                , 0.4                , 0.24               , 0.24               , 0.                 , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.                 , 0.12               , 0.12               , 0.28               , 0.28               , 0.28               , 0.16               , 0.16               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.2                , 0.2                , 0.44               , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.04               , 1.04               , 1.04               , 0.56               , 0.56               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.6000000000000001 , 0.32               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.                 , 0.36               , 0.36               , 0.76               , 0.76               , 0.76               , 0.4                , 0.4                , 0.                 , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.                 , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.                 , 0.8                , 0.8                , 1.68               , 1.68               , 1.68               , 0.88               , 0.88               , 0.                 , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.44               , 0.44               , 0.9199999999999999 , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.3625             ,  1.525              ,  2.7125000000000004 ,  3.005              ,  2.7125000000000004 ,  3.005              ,  4.3225             ,  4.745              ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  1.3                ,  1.4                ,  2.5                ,  2.6799999999999997 ,  2.5                ,  2.6799999999999997 ,  3.8600000000000003 ,  4.12               ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.383333333333333  ,  3.5666666666666664 ,  6.383333333333333  ,  6.713333333333333  ,  6.383333333333333  ,  6.713333333333333  ,  9.676666666666666  , 10.153333333333334  ,  6.293333333333334  ,  6.586666666666667  , 12.27111111111111   , 12.80888888888889   ,  9.27111111111111   ,  9.662222222222223  ,  9.27111111111111   ,  9.662222222222223  ,  2.933333333333333  ,  3.0666666666666664 ,  5.493333333333333  ,  5.733333333333333  ,  5.493333333333333  ,  5.733333333333333  ,  8.266666666666666  ,  8.613333333333333  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  ,  2.933333333333333  ,  3.0666666666666664 ,  5.493333333333333  ,  5.733333333333333  ,  5.493333333333333  ,  5.733333333333333  ,  8.266666666666666  ,  8.613333333333333  ,  5.333333333333334  ,  5.546666666666667  , 10.311111111111112  , 10.702222222222222  ,  7.751111111111111  ,  8.035555555555556  ,  7.751111111111111  ,  8.035555555555556  ,  2.0625             ,  2.125              ,  3.8125             ,  3.925              ,  3.8125             ,  3.925              ,  5.6625             ,  5.825              ,  3.6                ,  3.7                ,  6.85               ,  7.033333333333333  ,  5.1                ,  5.233333333333333  ,  5.1                ,  5.233333333333333  ,  4.112500000000001  ,  4.225              ,  7.5825000000000005 ,  7.785              ,  7.5825000000000005 ,  7.785              , 11.232500000000002  , 11.525              ,  7.12               ,  7.3                , 13.503333333333334  , 13.833333333333332  , 10.033333333333333  , 10.273333333333333  , 10.033333333333333  , 10.273333333333333  ,  4.112500000000001  ,  4.225              ,  7.5825000000000005 ,  7.785              ,  7.5825000000000005 ,  7.785              , 11.232500000000002  , 11.525              ,  7.12               ,  7.3                , 13.503333333333334  , 13.833333333333332  , 10.033333333333333  , 10.273333333333333  , 10.033333333333333  , 10.273333333333333  ,  6.562500000000001  ,  6.725              , 12.072500000000002  , 12.365              , 12.072500000000002  , 12.365              , 17.8425             , 18.265              , 11.280000000000001  , 11.54               , 21.330000000000002  , 21.806666666666665  , 15.819999999999999  , 16.166666666666668  , 15.819999999999999  , 16.166666666666668  ,  4.5                ,  4.6                ,  8.260000000000002  ,  8.440000000000001  ,  8.260000000000002  ,  8.440000000000001  , 12.18               , 12.44               ,  7.680000000000001  ,  7.84               , 14.479999999999999  , 14.773333333333333  , 10.72               , 10.933333333333334  , 10.72               , 10.933333333333334  ,  9.25               ,  9.433333333333334  , 16.943333333333335  , 17.273333333333333  , 16.943333333333335  , 17.273333333333333  , 24.93               , 25.406666666666666  , 15.68               , 15.973333333333333  , 29.479999999999997  , 30.017777777777777  , 21.78666666666667   , 22.177777777777777  , 21.78666666666667   , 22.177777777777777  ,  7.2                ,  7.333333333333333  , 13.173333333333334  , 13.413333333333334  , 13.173333333333334  , 13.413333333333334  , 19.36               , 19.706666666666667  , 12.16               , 12.373333333333333  , 22.826666666666668  , 23.217777777777776  , 16.85333333333333   , 17.137777777777778  , 16.85333333333333   , 17.137777777777778  ,  7.2                ,  7.333333333333333  , 13.173333333333334  , 13.413333333333334  , 13.173333333333334  , 13.413333333333334  , 19.36               , 19.706666666666667  , 12.16               , 12.373333333333333  , 22.826666666666668  , 23.217777777777776  , 16.85333333333333   , 17.137777777777778  , 16.85333333333333   , 17.137777777777778  ,  4.0625             ,  4.125              ,  7.4125             ,  7.525              ,  7.4125             ,  7.525              , 10.8625             , 11.025              ,  6.800000000000001  ,  6.9                , 12.716666666666667  , 12.9                ,  9.366666666666667  ,  9.5                ,  9.366666666666667  ,  9.5                ,  7.7125             ,  7.825              , 14.0625             , 14.265              , 14.0625             , 14.265              , 20.5925             , 20.885              , 12.88               , 13.060000000000002  , 24.063333333333333  , 24.393333333333334  , 17.713333333333335  , 17.953333333333333  , 17.713333333333335  , 17.953333333333333  ,  7.7125             ,  7.825              , 14.0625             , 14.265              , 14.0625             , 14.265              , 20.5925             , 20.885              , 12.88               , 13.060000000000002  , 24.063333333333333  , 24.393333333333334  , 17.713333333333335  , 17.953333333333333  , 17.713333333333335  , 17.953333333333333  , 11.7625             , 11.925              , 21.4325             , 21.725              , 21.4325             , 21.725              , 31.3625             , 31.785000000000004  , 19.6                , 19.860000000000003  , 36.58333333333333   , 37.06               , 26.913333333333334  , 27.26               , 26.913333333333334  , 27.26               ,  7.7                ,  7.800000000000001  , 14.02               , 14.2                , 14.02               , 14.2                , 20.5                , 20.76               , 12.8                , 12.959999999999999  , 23.866666666666667  , 24.16               , 17.546666666666667  , 17.759999999999998  , 17.546666666666667  , 17.759999999999998  , 15.116666666666667  , 15.3                , 27.503333333333334  , 27.833333333333332  , 27.503333333333334  , 27.833333333333332  , 40.18333333333334   , 40.66               , 25.066666666666666  , 25.36               , 46.68888888888889   , 47.22666666666667   , 34.30222222222222   , 34.69333333333333   , 34.30222222222222   , 34.69333333333333   , 11.466666666666665  , 11.600000000000001  , 20.85333333333333   , 21.093333333333334  , 20.85333333333333   , 21.093333333333334  , 30.453333333333333  , 30.799999999999997  , 18.986666666666668  , 19.2                , 35.34222222222222   , 35.73333333333333   , 25.955555555555556  , 26.240000000000002  , 25.955555555555556  , 26.240000000000002  , 11.466666666666665  , 11.600000000000001  , 20.85333333333333   , 21.093333333333334  , 20.85333333333333   , 21.093333333333334  , 30.453333333333333  , 30.799999999999997  , 18.986666666666668  , 19.2                , 35.34222222222222   , 35.73333333333333   , 25.955555555555556  , 26.240000000000002  , 25.955555555555556  , 26.240000000000002  };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.2                , 0.24               , 0.2                , 0.24               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.48000000000000004, 0.56               , 0.28               , 0.32               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.                 , 0.                 , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.                 , 0.                 , 0.88               , 0.9600000000000001 , 0.88               , 0.9600000000000001 , 1.92               , 2.08               , 1.92               , 2.08               , 1.92               , 2.08               , 1.04               , 1.12               , 1.04               , 1.12               , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 0.                 , 0.                 , 0.68               , 0.72               , 0.68               , 0.72               , 1.44               , 1.52               , 1.44               , 1.52               , 1.44               , 1.52               , 0.76               , 0.8                , 0.76               , 0.8                , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.1875             ,  0.25               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.3125             ,  0.42500000000000004,  0.5375000000000001 ,  0.65               ,  0.7625             ,  0.925              ,  1.0875000000000001 ,  1.25               ,  0.7                ,  0.8                ,  0.9000000000000001 ,  1.                 ,  1.7833333333333332 ,  1.9666666666666666 ,  2.1500000000000004 ,  2.333333333333333  ,  1.5333333333333332 ,  1.6666666666666665 ,  1.8                ,  1.9333333333333333 ,  1.5333333333333332 ,  1.6666666666666665 ,  1.8                ,  1.9333333333333333 ,  0.9125000000000001 ,  1.025              ,  1.1375000000000002 ,  1.25               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  3.4525             ,  3.745              ,  4.0375             ,  4.33               ,  2.54               ,  2.72               ,  2.9000000000000004 ,  3.08               ,  5.556666666666667  ,  5.886666666666667  ,  6.216666666666667  ,  6.546666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  0.9125000000000001 ,  1.025              ,  1.1375000000000002 ,  1.25               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  2.0025             ,  2.205              ,  2.4075             ,  2.61               ,  3.4525             ,  3.745              ,  4.0375             ,  4.33               ,  2.54               ,  2.72               ,  2.9000000000000004 ,  3.08               ,  5.556666666666667  ,  5.886666666666667  ,  6.216666666666667  ,  6.546666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  4.466666666666667  ,  4.706666666666667  ,  4.946666666666666  ,  5.186666666666667  ,  2.5625             ,  2.725              ,  2.8875             ,  3.05               ,  5.1325             ,  5.425000000000001  ,  5.717500000000001  ,  6.01               ,  5.1325             ,  5.425000000000001  ,  5.717500000000001  ,  6.01               ,  8.2225             ,  8.645              ,  9.0675             ,  9.49               ,  5.66               ,  5.92               ,  6.180000000000001  ,  6.4399999999999995 , 11.676666666666668  , 12.153333333333332  , 12.63               , 13.106666666666666  ,  9.106666666666667  ,  9.453333333333333  ,  9.799999999999999  , 10.146666666666668  ,  9.106666666666667  ,  9.453333333333333  ,  9.799999999999999  , 10.146666666666668  ,  2.5                ,  2.6                ,  2.7                ,  2.8                ,  4.82               ,  5.                 ,  5.18               ,  5.359999999999999  ,  4.82               ,  5.                 ,  5.18               ,  5.359999999999999  ,  7.460000000000001  ,  7.720000000000001  ,  7.9799999999999995 ,  8.24               ,  4.96               ,  5.12               ,  5.28               ,  5.44               ,  9.893333333333334  , 10.186666666666666  , 10.48               , 10.773333333333333  ,  7.573333333333334  ,  7.786666666666666  ,  8.                 ,  8.213333333333335  ,  7.573333333333334  ,  7.786666666666666  ,  8.                 ,  8.213333333333335  ,  6.583333333333333  ,  6.766666666666666  ,  6.95               ,  7.133333333333333  , 12.436666666666666  , 12.766666666666666  , 13.096666666666666  , 13.426666666666666  , 12.436666666666666  , 12.766666666666666  , 13.096666666666666  , 13.426666666666666  , 18.876666666666665  , 19.35333333333333   , 19.83               , 20.30666666666667   , 12.293333333333333  , 12.586666666666668  , 12.88               , 13.173333333333334  , 24.004444444444445  , 24.54222222222222   , 25.08               , 25.61777777777778   , 18.151111111111113  , 18.54222222222222   , 18.933333333333334  , 19.324444444444445  , 18.151111111111113  , 18.54222222222222   , 18.933333333333334  , 19.324444444444445  ,  5.733333333333333  ,  5.866666666666666  ,  6.                 ,  6.133333333333333  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 16.186666666666664  , 16.53333333333333   , 16.88               , 17.226666666666667  , 10.453333333333333  , 10.666666666666668  , 10.88               , 11.093333333333334  , 20.23111111111111   , 20.622222222222224  , 21.013333333333335  , 21.404444444444444  , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   ,  5.733333333333333  ,  5.866666666666666  ,  6.                 ,  6.133333333333333  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 10.746666666666666  , 10.986666666666666  , 11.226666666666667  , 11.466666666666667  , 16.186666666666664  , 16.53333333333333   , 16.88               , 17.226666666666667  , 10.453333333333333  , 10.666666666666668  , 10.88               , 11.093333333333334  , 20.23111111111111   , 20.622222222222224  , 21.013333333333335  , 21.404444444444444  , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   , 15.21777777777778   , 15.502222222222223  , 15.786666666666667  , 16.07111111111111   ,  4.0625             ,  4.125              ,  4.1875             ,  4.25               ,  7.5125             ,  7.625              ,  7.737500000000001  ,  7.85               ,  7.5125             ,  7.625              ,  7.737500000000001  ,  7.85               , 11.162500000000001  , 11.325              , 11.4875             , 11.65               ,  7.1000000000000005 ,  7.2                ,  7.300000000000001  ,  7.4                , 13.516666666666666  , 13.7                , 13.883333333333333  , 14.066666666666666  , 10.066666666666666  , 10.2                , 10.333333333333332  , 10.466666666666667  , 10.066666666666666  , 10.2                , 10.333333333333332  , 10.466666666666667  ,  8.1125             ,  8.225000000000001  ,  8.3375             ,  8.45               , 14.9625             , 15.165000000000001  , 15.367500000000001  , 15.57               , 14.9625             , 15.165000000000001  , 15.367500000000001  , 15.57               , 22.1725             , 22.465000000000003  , 22.7575             , 23.05               , 14.06               , 14.24               , 14.420000000000002  , 14.6                , 26.676666666666662  , 27.006666666666668  , 27.336666666666666  , 27.666666666666664  , 19.826666666666668  , 20.066666666666666  , 20.306666666666665  , 20.546666666666667  , 19.826666666666668  , 20.066666666666666  , 20.306666666666665  , 20.546666666666667  ,  8.1125             ,  8.225000000000001  ,  8.3375             ,  8.45               , 14.9625             , 15.165000000000001  , 15.367500000000001  , 15.57               , 14.9625             , 15.165000000000001  , 15.367500000000001  , 15.57               , 22.1725             , 22.465000000000003  , 22.7575             , 23.05               , 14.06               , 14.24               , 14.420000000000002  , 14.6                , 26.676666666666662  , 27.006666666666668  , 27.336666666666666  , 27.666666666666664  , 19.826666666666668  , 20.066666666666666  , 20.306666666666665  , 20.546666666666667  , 19.826666666666668  , 20.066666666666666  , 20.306666666666665  , 20.546666666666667  , 12.962500000000002  , 13.125000000000002  , 13.287500000000001  , 13.45               , 23.8525             , 24.145000000000003  , 24.437500000000004  , 24.73               , 23.8525             , 24.145000000000003  , 24.437500000000004  , 24.73               , 35.2625             , 35.685              , 36.1075             , 36.53               , 22.3                , 22.560000000000002  , 22.820000000000004  , 23.08               , 42.18333333333333   , 42.660000000000004  , 43.13666666666666   , 43.61333333333333   , 31.293333333333333  , 31.639999999999997  , 31.986666666666665  , 32.333333333333336  , 31.293333333333333  , 31.639999999999997  , 31.986666666666665  , 32.333333333333336  ,  8.9                ,  9.                 ,  9.100000000000001  ,  9.2                , 16.34               , 16.520000000000003  , 16.700000000000003  , 16.880000000000003  , 16.34               , 16.520000000000003  , 16.700000000000003  , 16.880000000000003  , 24.099999999999998  , 24.36               , 24.620000000000005  , 24.88               , 15.2                , 15.360000000000001  , 15.52               , 15.68               , 28.666666666666664  , 28.959999999999997  , 29.253333333333334  , 29.546666666666667  , 21.226666666666667  , 21.44               , 21.653333333333332  , 21.866666666666667  , 21.226666666666667  , 21.44               , 21.653333333333332  , 21.866666666666667  , 18.316666666666666  , 18.5                , 18.683333333333334  , 18.866666666666667  , 33.556666666666665  , 33.88666666666667   , 34.21666666666667   , 34.54666666666667   , 33.556666666666665  , 33.88666666666667   , 34.21666666666667   , 34.54666666666667   , 49.383333333333326  , 49.86               , 50.33666666666667   , 50.81333333333333   , 31.066666666666666  , 31.36               , 31.653333333333332  , 31.946666666666665  , 58.42222222222222   , 58.959999999999994  , 59.497777777777785  , 60.035555555555554  , 43.18222222222222   , 43.57333333333334   , 43.96444444444444   , 44.355555555555554  , 43.18222222222222   , 43.57333333333334   , 43.96444444444444   , 44.355555555555554  , 14.266666666666666  , 14.4                , 14.533333333333331  , 14.666666666666666  , 26.106666666666666  , 26.346666666666668  , 26.586666666666666  , 26.826666666666668  , 26.106666666666666  , 26.346666666666668  , 26.586666666666666  , 26.826666666666668  , 38.373333333333335  , 38.72               , 39.06666666666666   , 39.413333333333334  , 24.106666666666666  , 24.32               , 24.533333333333335  , 24.746666666666666  , 45.26222222222222   , 45.653333333333336  , 46.044444444444444  , 46.43555555555555   , 33.42222222222222   , 33.70666666666666   , 33.99111111111111   , 34.275555555555556  , 33.42222222222222   , 33.70666666666666   , 33.99111111111111   , 34.275555555555556  , 14.266666666666666  , 14.4                , 14.533333333333331  , 14.666666666666666  , 26.106666666666666  , 26.346666666666668  , 26.586666666666666  , 26.826666666666668  , 26.106666666666666  , 26.346666666666668  , 26.586666666666666  , 26.826666666666668  , 38.373333333333335  , 38.72               , 39.06666666666666   , 39.413333333333334  , 24.106666666666666  , 24.32               , 24.533333333333335  , 24.746666666666666  , 45.26222222222222   , 45.653333333333336  , 46.044444444444444  , 46.43555555555555   , 33.42222222222222   , 33.70666666666666   , 33.99111111111111   , 34.275555555555556  , 33.42222222222222   , 33.70666666666666   , 33.99111111111111   , 34.275555555555556  ,  8.0625             ,  8.125              ,  8.1875             ,  8.25               , 14.7125             , 14.825              , 14.9375             , 15.05               , 14.7125             , 14.825              , 14.9375             , 15.05               , 21.5625             , 21.725              , 21.8875             , 22.05               , 13.5                , 13.600000000000001  , 13.7                , 13.8                , 25.25               , 25.433333333333334  , 25.616666666666667  , 25.8                , 18.6                , 18.733333333333334  , 18.866666666666667  , 19.                 , 18.6                , 18.733333333333334  , 18.866666666666667  , 19.                 , 15.3125             , 15.425              , 15.537500000000001  , 15.65               , 27.9225             , 28.125              , 28.3275             , 28.53               , 27.9225             , 28.125              , 28.3275             , 28.53               , 40.8925             , 41.185              , 41.477500000000006  , 41.77               , 25.580000000000002  , 25.76               , 25.939999999999998  , 26.120000000000005  , 47.79666666666667   , 48.126666666666665  , 48.45666666666667   , 48.78666666666667   , 35.18666666666667   , 35.42666666666667   , 35.666666666666664  , 35.906666666666666  , 35.18666666666667   , 35.42666666666667   , 35.666666666666664  , 35.906666666666666  , 15.3125             , 15.425              , 15.537500000000001  , 15.65               , 27.9225             , 28.125              , 28.3275             , 28.53               , 27.9225             , 28.125              , 28.3275             , 28.53               , 40.8925             , 41.185              , 41.477500000000006  , 41.77               , 25.580000000000002  , 25.76               , 25.939999999999998  , 26.120000000000005  , 47.79666666666667   , 48.126666666666665  , 48.45666666666667   , 48.78666666666667   , 35.18666666666667   , 35.42666666666667   , 35.666666666666664  , 35.906666666666666  , 35.18666666666667   , 35.42666666666667   , 35.666666666666664  , 35.906666666666666  , 23.3625             , 23.525              , 23.6875             , 23.85               , 42.5725             , 42.865              , 43.1575             , 43.45               , 42.5725             , 42.865              , 43.1575             , 43.45               , 62.302499999999995  , 62.725              , 63.14750000000001   , 63.57000000000001   , 38.94               , 39.2                , 39.459999999999994  , 39.720000000000006  , 72.69               , 73.16666666666666   , 73.64333333333335   , 74.12               , 53.48               , 53.82666666666667   , 54.173333333333325  , 54.52               , 53.48               , 53.82666666666667   , 54.173333333333325  , 54.52               , 15.3                , 15.4                , 15.5                , 15.600000000000001  , 27.860000000000003  , 28.04               , 28.22               , 28.4                , 27.860000000000003  , 28.04               , 28.22               , 28.4                , 40.74               , 41.                 , 41.260000000000005  , 41.52               , 25.439999999999998  , 25.6                , 25.76               , 25.919999999999998  , 47.44               , 47.733333333333334  , 48.026666666666664  , 48.32               , 34.879999999999995  , 35.093333333333334  , 35.306666666666665  , 35.519999999999996  , 34.879999999999995  , 35.093333333333334  , 35.306666666666665  , 35.519999999999996  , 30.05               , 30.233333333333334  , 30.416666666666664  , 30.6                , 54.67666666666666   , 55.00666666666667   , 55.33666666666666   , 55.666666666666664  , 54.67666666666666   , 55.00666666666667   , 55.33666666666666   , 55.666666666666664  , 79.89               , 80.36666666666667   , 80.84333333333333   , 81.32               , 49.839999999999996  , 50.13333333333333   , 50.42666666666667   , 50.72               , 92.83999999999999   , 93.37777777777778   , 93.91555555555556   , 94.45333333333333   , 68.21333333333334   , 68.60444444444444   , 68.99555555555555   , 69.38666666666666   , 68.21333333333334   , 68.60444444444444   , 68.99555555555555   , 69.38666666666666   , 22.8                , 22.93333333333333   , 23.066666666666666  , 23.200000000000003  , 41.46666666666667   , 41.70666666666666   , 41.946666666666665  , 42.18666666666667   , 41.46666666666667   , 41.70666666666666   , 41.946666666666665  , 42.18666666666667   , 60.56000000000001   , 60.906666666666666  , 61.25333333333333   , 61.599999999999994  , 37.76               , 37.973333333333336  , 38.18666666666667   , 38.4                , 70.29333333333332   , 70.68444444444444   , 71.07555555555555   , 71.46666666666665   , 51.626666666666665  , 51.91111111111111   , 52.19555555555556   , 52.480000000000004  , 51.626666666666665  , 51.91111111111111   , 52.19555555555556   , 52.480000000000004  , 22.8                , 22.93333333333333   , 23.066666666666666  , 23.200000000000003  , 41.46666666666667   , 41.70666666666666   , 41.946666666666665  , 42.18666666666667   , 41.46666666666667   , 41.70666666666666   , 41.946666666666665  , 42.18666666666667   , 60.56000000000001   , 60.906666666666666  , 61.25333333333333   , 61.599999999999994  , 37.76               , 37.973333333333336  , 38.18666666666667   , 38.4                , 70.29333333333332   , 70.68444444444444   , 71.07555555555555   , 71.46666666666665   , 51.626666666666665  , 51.91111111111111   , 52.19555555555556   , 52.480000000000004  , 51.626666666666665  , 51.91111111111111   , 52.19555555555556   , 52.480000000000004  };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.04               , 0.08               , 0.12               , 0.16               , 0.04               , 0.08               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.4                , 0.48               , 0.2                , 0.24               , 0.28               , 0.32               , 0.2                , 0.24               , 0.28               , 0.32               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 0.39999999999999997, 0.48000000000000004, 0.56               , 0.64               , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 1.12               , 1.28               , 1.44               , 1.6                , 0.72               , 0.8                , 0.88               , 0.96               , 0.72               , 0.8                , 0.88               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.36               , 0.4                , 0.44               , 0.48               , 0.36               , 0.4                , 0.44               , 0.48               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.88               , 0.9600000000000001 , 1.04               , 1.12               , 0.52               , 0.56               , 0.6                , 0.64               , 0.52               , 0.56               , 0.6                , 0.64               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.68               , 0.72               , 0.76               , 0.8                , 0.68               , 0.72               , 0.76               , 0.8                , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.92               , 0.96               , 0.84               , 0.88               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 1.6800000000000002 , 1.76               , 1.84               , 1.9200000000000002 , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 3.6799999999999997 , 3.84               , 4.                 , 4.16               , 2.                 , 2.08               , 2.16               , 2.24               , 2.                 , 2.08               , 2.16               , 2.24               , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.08               , 1.12               , 1.                 , 1.04               , 1.08               , 1.12               , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.3200000000000003 , 2.4000000000000004 , 1.16               , 1.2                , 1.24               , 1.28               , 1.16               , 1.2                , 1.24               , 1.28               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 0.                 , 0.                 , 0.                 , 0.                 , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.4000000000000001 , 1.44               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 2.8                , 2.88               , 2.96               , 3.04               , 1.48               , 1.52               , 1.56               , 1.6                , 1.48               , 1.52               , 1.56               , 1.6                , 0.                 , 0.                 , 0.                 , 0.                 , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 0.                 , 0.                 , 0.                 , 0.                 , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 0.                 , 0.                 , 0.                 , 0.                 , 2.96               , 3.04               , 3.12               , 3.2                , 2.96               , 3.04               , 3.12               , 3.2                , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 6.239999999999999  , 6.3999999999999995 , 6.56               , 6.72               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 3.2800000000000002 , 3.3600000000000003 , 3.4400000000000004 , 3.52               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 0.                 , 0.                 , 0.                 , 0.                 , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 1.6400000000000001 , 1.68               , 1.72               , 1.76               , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 3.4400000000000004 , 3.52               , 3.6                , 3.6799999999999997 , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 1.8                , 1.84               , 1.8800000000000001 , 1.92               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.1625             ,  0.1625             ,  0.3125             ,  0.25               ,  0.45               ,  0.35000000000000003,  0.7666666666666666 ,  0.6166666666666667 ,  0.6166666666666667 ,  0.36250000000000004,  0.7425             ,  0.7425             ,  1.2125000000000001 ,  0.8500000000000001 ,  1.4100000000000001 ,  1.03               ,  2.1133333333333333 ,  1.6433333333333333 ,  1.6433333333333333 ,  0.36250000000000004,  0.7425             ,  0.7425             ,  1.2125000000000001 ,  0.8500000000000001 ,  1.4100000000000001 ,  1.03               ,  2.1133333333333333 ,  1.6433333333333333 ,  1.6433333333333333 ,  0.9125000000000001 ,  1.7725             ,  1.7725             ,  2.7625             ,  1.85               ,  2.97               ,  2.1100000000000003 ,  4.193333333333333  ,  3.203333333333333  ,  3.203333333333333  ,  0.8500000000000001 ,  1.61               ,  1.61               ,  2.45               ,  1.6                ,  2.52               ,  1.76               ,  3.4266666666666667 ,  2.586666666666667  ,  2.586666666666667  ,  2.1833333333333336 ,  4.076666666666666  ,  4.076666666666666  ,  6.116666666666666  ,  3.9333333333333336 ,  6.12               ,  4.226666666666667  ,  8.115555555555556  ,  6.075555555555556  ,  6.075555555555556  ,  1.8833333333333333 ,  3.4966666666666666 ,  3.4966666666666666 ,  5.216666666666667  ,  3.333333333333333  ,  5.16               ,  3.546666666666667  ,  6.768888888888889  ,  5.048888888888889  ,  5.048888888888889  ,  1.8833333333333333 ,  3.4966666666666666 ,  3.4966666666666666 ,  5.216666666666667  ,  3.333333333333333  ,  5.16               ,  3.546666666666667  ,  6.768888888888889  ,  5.048888888888889  ,  5.048888888888889  ,  1.3125             ,  2.4125             ,  2.4125             ,  3.5625             ,  2.25               ,  3.45               ,  2.3500000000000005 ,  4.433333333333334  ,  3.283333333333333  ,  3.283333333333333  ,  2.6125             ,  4.7925             ,  4.7925             ,  7.0625             ,  4.45               ,  6.8100000000000005 ,  4.630000000000001  ,  8.713333333333335  ,  6.443333333333333  ,  6.443333333333333  ,  2.6125             ,  4.7925             ,  4.7925             ,  7.0625             ,  4.45               ,  6.8100000000000005 ,  4.630000000000001  ,  8.713333333333335  ,  6.443333333333333  ,  6.443333333333333  ,  4.1625             ,  7.6225000000000005 ,  7.6225000000000005 , 11.2125             ,  7.050000000000001  , 10.77               ,  7.310000000000001  , 13.726666666666668  , 10.136666666666667  , 10.136666666666667  ,  2.85               ,  5.21               ,  5.21               ,  7.65               ,  4.800000000000001  ,  7.320000000000001  ,  4.960000000000001  ,  9.293333333333335  ,  6.8533333333333335 ,  6.8533333333333335 ,  5.85               , 10.676666666666668  , 10.676666666666668  , 15.65               ,  9.8                , 14.920000000000002  , 10.093333333333334  , 18.871111111111112  , 13.897777777777778  , 13.897777777777778  ,  4.55               ,  8.296666666666667  ,  8.296666666666667  , 12.15               ,  7.6                , 11.56               ,  7.813333333333333  , 14.591111111111111  , 10.737777777777778  , 10.737777777777778  ,  4.55               ,  8.296666666666667  ,  8.296666666666667  , 12.15               ,  7.6                , 11.56               ,  7.813333333333333  , 14.591111111111111  , 10.737777777777778  , 10.737777777777778  ,  2.5625             ,  4.6625             ,  4.6625             ,  6.8125             ,  4.25               ,  6.45               ,  4.35               ,  8.1                ,  5.95               ,  5.95               ,  4.862500000000001  ,  8.842500000000001  ,  8.842500000000001  , 12.912500000000001  ,  8.05               , 12.21               ,  8.23               , 15.313333333333334  , 11.243333333333334  , 11.243333333333334  ,  4.862500000000001  ,  8.842500000000001  ,  8.842500000000001  , 12.912500000000001  ,  8.05               , 12.21               ,  8.23               , 15.313333333333334  , 11.243333333333334  , 11.243333333333334  ,  7.412500000000001  , 13.472500000000002  , 13.472500000000002  , 19.662500000000005  , 12.25               , 18.57               , 12.510000000000002  , 23.26               , 17.07               , 17.07               ,  4.8500000000000005 ,  8.81               ,  8.81               , 12.850000000000001  ,  8.                 , 12.120000000000001  ,  8.16               , 15.159999999999998  , 11.12               , 11.12               ,  9.516666666666666  , 17.276666666666667  , 17.276666666666667  , 25.183333333333334  , 15.666666666666668  , 23.720000000000002  , 15.96               , 29.626666666666665  , 21.72               , 21.72               ,  7.216666666666667  , 13.096666666666668  , 13.096666666666668  , 19.083333333333336  , 11.866666666666667  , 17.96               , 12.08               , 22.413333333333334  , 16.426666666666666  , 16.426666666666666  ,  7.216666666666667  , 13.096666666666668  , 13.096666666666668  , 19.083333333333336  , 11.866666666666667  , 17.96               , 12.08               , 22.413333333333334  , 16.426666666666666  , 16.426666666666666  };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.16               , 0.16               , 0.36               , 0.36               , 0.6                , 0.44               , 0.44               , 0.24               , 0.24               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.68               , 0.68               , 1.44               , 1.44               , 2.2800000000000002 , 1.5999999999999999 , 1.5999999999999999 , 0.84               , 0.84               , 0.                 , 0.68               , 0.68               , 1.44               , 1.44               , 2.2800000000000002 , 1.5999999999999999 , 1.5999999999999999 , 0.84               , 0.84               , 0.                 , 0.68               , 0.68               , 1.44               , 1.44               , 2.2800000000000002 , 1.5999999999999999 , 1.5999999999999999 , 0.84               , 0.84               , 0.                 , 0.4                , 0.4                , 0.8400000000000001 , 0.8400000000000001 , 1.32               , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.4                , 0.4                , 0.8400000000000001 , 0.8400000000000001 , 1.32               , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.52               , 1.08               , 1.08               , 1.6800000000000002 , 1.1600000000000001 , 1.1600000000000001 , 0.6                , 0.6                , 0.                 , 0.52               , 0.52               , 1.08               , 1.08               , 1.6800000000000002 , 1.1600000000000001 , 1.1600000000000001 , 0.6                , 0.6                , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 0.64               , 0.64               , 1.32               , 1.32               , 2.04               , 1.4                , 1.4                , 0.72               , 0.72               , 0.                 , 0.64               , 0.64               , 1.32               , 1.32               , 2.04               , 1.4                , 1.4                , 0.72               , 0.72               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.75               ,  0.9                ,  0.6000000000000001 ,  0.7000000000000001 ,  1.35               ,  1.5333333333333332 ,  1.1                ,  1.2333333333333334 ,  1.1                ,  1.2333333333333334 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  1.6625             ,  1.8250000000000002 ,  3.2525000000000004 ,  3.545              ,  3.2525000000000004 ,  3.545              ,  5.1025             ,  5.525              ,  3.44               ,  3.7                ,  5.550000000000001  ,  5.94               ,  3.9600000000000004 ,  4.220000000000001  ,  7.91               ,  8.386666666666667  ,  6.0600000000000005 ,  6.406666666666666  ,  6.0600000000000005 ,  6.406666666666666  ,  1.6                ,  1.7000000000000002 ,  3.04               ,  3.22               ,  3.04               ,  3.22               ,  4.64               ,  4.9                ,  3.04               ,  3.2                ,  4.800000000000001  ,  5.04               ,  3.3600000000000003 ,  3.52               ,  6.5600000000000005 ,  6.8533333333333335 ,  4.96               ,  5.173333333333334  ,  4.96               ,  5.173333333333334  ,  4.183333333333334  ,  4.366666666666667  ,  7.823333333333333  ,  8.153333333333332  ,  7.823333333333333  ,  8.153333333333332  , 11.756666666666666  , 12.233333333333333  ,  7.573333333333334  ,  7.866666666666667  , 11.8                , 12.24               ,  8.16               ,  8.453333333333333  , 15.693333333333335  , 16.23111111111111   , 11.76               , 12.151111111111112  , 11.76               , 12.151111111111112  ,  3.633333333333333  ,  3.7666666666666666 ,  6.753333333333333  ,  6.993333333333333  ,  6.753333333333333  ,  6.993333333333333  , 10.086666666666666  , 10.433333333333334  ,  6.453333333333333  ,  6.666666666666666  , 10.                 , 10.32               ,  6.880000000000001  ,  7.093333333333334  , 13.146666666666668  , 13.537777777777778  ,  9.813333333333333  , 10.097777777777779  ,  9.813333333333333  , 10.097777777777779  ,  3.633333333333333  ,  3.7666666666666666 ,  6.753333333333333  ,  6.993333333333333  ,  6.753333333333333  ,  6.993333333333333  , 10.086666666666666  , 10.433333333333334  ,  6.453333333333333  ,  6.666666666666666  , 10.                 , 10.32               ,  6.880000000000001  ,  7.093333333333334  , 13.146666666666668  , 13.537777777777778  ,  9.813333333333333  , 10.097777777777779  ,  9.813333333333333  , 10.097777777777779  ,  2.5625             ,  2.625              ,  4.7125             ,  4.825              ,  4.7125             ,  4.825              ,  6.9625             ,  7.125              ,  4.4                ,  4.5                ,  6.75               ,  6.9                ,  4.6                ,  4.700000000000001  ,  8.683333333333334  ,  8.866666666666667  ,  6.433333333333334  ,  6.566666666666666  ,  6.433333333333334  ,  6.566666666666666  ,  5.112500000000001  ,  5.225              ,  9.3825             ,  9.585              ,  9.3825             ,  9.585              , 13.8325             , 14.125              ,  8.72               ,  8.9                , 13.350000000000001  , 13.620000000000001  ,  9.08               ,  9.260000000000002  , 17.096666666666668  , 17.42666666666667   , 12.646666666666668  , 12.886666666666667  , 12.646666666666668  , 12.886666666666667  ,  5.112500000000001  ,  5.225              ,  9.3825             ,  9.585              ,  9.3825             ,  9.585              , 13.8325             , 14.125              ,  8.72               ,  8.9                , 13.350000000000001  , 13.620000000000001  ,  9.08               ,  9.260000000000002  , 17.096666666666668  , 17.42666666666667   , 12.646666666666668  , 12.886666666666667  , 12.646666666666668  , 12.886666666666667  ,  8.162500000000001  ,  8.325              , 14.9525             , 15.245000000000001  , 14.9525             , 15.245000000000001  , 22.0025             , 22.425              , 13.84               , 14.100000000000001  , 21.150000000000002  , 21.54               , 14.36               , 14.620000000000003  , 26.976666666666667  , 27.453333333333337  , 19.92666666666667   , 20.273333333333333  , 19.92666666666667   , 20.273333333333333  ,  5.6000000000000005 ,  5.7                , 10.24               , 10.42               , 10.24               , 10.42               , 15.04               , 15.3                ,  9.44               ,  9.600000000000001  , 14.4                , 14.640000000000002  ,  9.76               ,  9.920000000000002  , 18.293333333333333  , 18.58666666666667   , 13.493333333333332  , 13.706666666666667  , 13.493333333333332  , 13.706666666666667  , 11.516666666666666  , 11.7                , 21.023333333333333  , 21.353333333333335  , 21.023333333333333  , 21.353333333333335  , 30.82333333333333   , 31.3                , 19.306666666666665  , 19.6                , 29.4                , 29.840000000000003  , 19.89333333333333   , 20.186666666666667  , 37.20444444444444   , 37.742222222222225  , 27.404444444444444  , 27.795555555555556  , 27.404444444444444  , 27.795555555555556  ,  8.966666666666667  ,  9.1                , 16.35333333333333   , 16.593333333333334  , 16.35333333333333   , 16.593333333333334  , 23.953333333333333  , 24.3                , 14.986666666666666  , 15.2                , 22.8                , 23.12               , 15.413333333333334  , 15.626666666666665  , 28.791111111111107  , 29.182222222222222  , 21.19111111111111   , 21.475555555555555  , 21.19111111111111   , 21.475555555555555  ,  8.966666666666667  ,  9.1                , 16.35333333333333   , 16.593333333333334  , 16.35333333333333   , 16.593333333333334  , 23.953333333333333  , 24.3                , 14.986666666666666  , 15.2                , 22.8                , 23.12               , 15.413333333333334  , 15.626666666666665  , 28.791111111111107  , 29.182222222222222  , 21.19111111111111   , 21.475555555555555  , 21.19111111111111   , 21.475555555555555  ,  5.0625             ,  5.125              ,  9.2125             ,  9.325              ,  9.2125             ,  9.325              , 13.4625             , 13.625              ,  8.4                ,  8.5                , 12.75               , 12.9                ,  8.600000000000001  ,  8.7                , 16.016666666666666  , 16.2                , 11.766666666666666  , 11.9                , 11.766666666666666  , 11.9                ,  9.6125             ,  9.725000000000001  , 17.482499999999998  , 17.685000000000002  , 17.482499999999998  , 17.685000000000002  , 25.5325             , 25.825000000000003  , 15.920000000000002  , 16.1                , 24.15               , 24.42               , 16.28               , 16.46               , 30.296666666666667  , 30.62666666666667   , 22.246666666666663  , 22.486666666666668  , 22.246666666666663  , 22.486666666666668  ,  9.6125             ,  9.725000000000001  , 17.482499999999998  , 17.685000000000002  , 17.482499999999998  , 17.685000000000002  , 25.5325             , 25.825000000000003  , 15.920000000000002  , 16.1                , 24.15               , 24.42               , 16.28               , 16.46               , 30.296666666666667  , 30.62666666666667   , 22.246666666666663  , 22.486666666666668  , 22.246666666666663  , 22.486666666666668  , 14.662500000000001  , 14.825000000000003  , 26.6525             , 26.945000000000004  , 26.6525             , 26.945000000000004  , 38.9025             , 39.32500000000001   , 24.240000000000002  , 24.5                , 36.75               , 37.14               , 24.76               , 25.020000000000003  , 46.04333333333334   , 46.52               , 33.79333333333333   , 34.14               , 33.79333333333333   , 34.14               ,  9.600000000000001  ,  9.700000000000001  , 17.44               , 17.62               , 17.44               , 17.62               , 25.44               , 25.700000000000003  , 15.84               , 16.                 , 24.                 , 24.240000000000002  , 16.16               , 16.32               , 30.026666666666667  , 30.319999999999997  , 22.026666666666667  , 22.24               , 22.026666666666667  , 22.24               , 18.85               , 19.03333333333333   , 34.223333333333336  , 34.553333333333335  , 34.223333333333336  , 34.553333333333335  , 49.88999999999999   , 50.36666666666667   , 31.040000000000003  , 31.333333333333336  , 46.99999999999999   , 47.440000000000005  , 31.62666666666667   , 31.92               , 58.715555555555554  , 59.25333333333333   , 43.04888888888889   , 43.44               , 43.04888888888889   , 43.44               , 14.3                , 14.433333333333334  , 25.953333333333333  , 26.193333333333335  , 25.953333333333333  , 26.193333333333335  , 37.82               , 38.16666666666667   , 23.52               , 23.733333333333334  , 35.6                , 35.92               , 23.94666666666667   , 24.16               , 44.43555555555555   , 44.82666666666667   , 32.56888888888889   , 32.85333333333333   , 32.56888888888889   , 32.85333333333333   , 14.3                , 14.433333333333334  , 25.953333333333333  , 26.193333333333335  , 25.953333333333333  , 26.193333333333335  , 37.82               , 38.16666666666667   , 23.52               , 23.733333333333334  , 35.6                , 35.92               , 23.94666666666667   , 24.16               , 44.43555555555555   , 44.82666666666667   , 32.56888888888889   , 32.85333333333333   , 32.56888888888889   , 32.85333333333333   };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.04              , 0.08              , 0.04              , 0.08              , 0.16              , 0.24              , 0.16              , 0.24              , 0.36              , 0.48              , 0.32              , 0.4               , 0.32              , 0.4               , 0.2               , 0.24              , 0.2               , 0.24              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.32              , 0.4               , 0.32              , 0.4               , 0.8               , 0.9600000000000001, 0.8               , 0.9600000000000001, 1.44              , 1.6800000000000002, 1.1199999999999999, 1.28              , 1.1199999999999999, 1.28              , 0.64              , 0.72              , 0.64              , 0.72              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.28              , 0.32              , 0.28              , 0.32              , 0.64              , 0.72              , 0.64              , 0.72              , 1.08              , 1.2               , 0.8               , 0.88              , 0.8               , 0.88              , 0.44              , 0.48              , 0.44              , 0.48              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.52              , 0.56              , 0.52              , 0.56              , 1.12              , 1.2000000000000002, 1.12              , 1.2000000000000002, 1.8000000000000003, 1.9200000000000002, 1.28              , 1.3599999999999999, 1.28              , 1.3599999999999999, 0.68              , 0.72              , 0.68              , 0.72              , 0.                , 0.                , 0.52              , 0.56              , 0.52              , 0.56              , 1.12              , 1.2000000000000002, 1.12              , 1.2000000000000002, 1.8000000000000003, 1.9200000000000002, 1.28              , 1.3599999999999999, 1.28              , 1.3599999999999999, 0.68              , 0.72              , 0.68              , 0.72              , 0.                , 0.                , 1.28              , 1.36              , 1.28              , 1.36              , 2.72              , 2.88              , 2.72              , 2.88              , 4.32              , 4.5600000000000005, 3.04              , 3.1999999999999997, 3.04              , 3.1999999999999997, 1.6               , 1.68              , 1.6               , 1.68              , 0.                , 0.                , 1.28              , 1.36              , 1.28              , 1.36              , 2.72              , 2.88              , 2.72              , 2.88              , 4.32              , 4.5600000000000005, 3.04              , 3.1999999999999997, 3.04              , 3.1999999999999997, 1.6               , 1.68              , 1.6               , 1.68              , 0.                , 0.                , 1.28              , 1.36              , 1.28              , 1.36              , 2.72              , 2.88              , 2.72              , 2.88              , 4.32              , 4.5600000000000005, 3.04              , 3.1999999999999997, 3.04              , 3.1999999999999997, 1.6               , 1.68              , 1.6               , 1.68              , 0.                , 0.                , 0.76              , 0.8               , 0.76              , 0.8               , 1.6               , 1.6800000000000002, 1.6               , 1.6800000000000002, 2.52              , 2.64              , 1.76              , 1.8399999999999999, 1.76              , 1.8399999999999999, 0.92              , 0.96              , 0.92              , 0.96              , 0.                , 0.                , 0.76              , 0.8               , 0.76              , 0.8               , 1.6               , 1.6800000000000002, 1.6               , 1.6800000000000002, 2.52              , 2.64              , 1.76              , 1.8399999999999999, 1.76              , 1.8399999999999999, 0.92              , 0.96              , 0.92              , 0.96              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 1.                , 1.04              , 1.                , 1.04              , 2.08              , 2.16              , 2.08              , 2.16              , 3.24              , 3.3600000000000003, 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 1.16              , 1.2               , 1.16              , 1.2               , 0.                , 0.                , 1.                , 1.04              , 1.                , 1.04              , 2.08              , 2.16              , 2.08              , 2.16              , 3.24              , 3.3600000000000003, 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 1.16              , 1.2               , 1.16              , 1.2               , 0.                , 0.                , 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 4.640000000000001 , 4.800000000000001 , 4.640000000000001 , 4.800000000000001 , 7.200000000000001 , 7.440000000000001 , 4.960000000000001 , 5.120000000000001 , 4.960000000000001 , 5.120000000000001 , 2.56              , 2.6399999999999997, 2.56              , 2.6399999999999997, 0.                , 0.                , 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 4.640000000000001 , 4.800000000000001 , 4.640000000000001 , 4.800000000000001 , 7.200000000000001 , 7.440000000000001 , 4.960000000000001 , 5.120000000000001 , 4.960000000000001 , 5.120000000000001 , 2.56              , 2.6399999999999997, 2.56              , 2.6399999999999997, 0.                , 0.                , 2.24              , 2.3200000000000003, 2.24              , 2.3200000000000003, 4.640000000000001 , 4.800000000000001 , 4.640000000000001 , 4.800000000000001 , 7.200000000000001 , 7.440000000000001 , 4.960000000000001 , 5.120000000000001 , 4.960000000000001 , 5.120000000000001 , 2.56              , 2.6399999999999997, 2.56              , 2.6399999999999997, 0.                , 0.                , 1.24              , 1.28              , 1.24              , 1.28              , 2.56              , 2.64              , 2.56              , 2.64              , 3.96              , 4.08              , 2.72              , 2.8               , 2.72              , 2.8               , 1.4000000000000001, 1.44              , 1.4000000000000001, 1.44              , 0.                , 0.                , 1.24              , 1.28              , 1.24              , 1.28              , 2.56              , 2.64              , 2.56              , 2.64              , 3.96              , 4.08              , 2.72              , 2.8               , 2.72              , 2.8               , 1.4000000000000001, 1.44              , 1.4000000000000001, 1.44              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  0.0625             ,   0.125              ,   0.1875             ,   0.25               ,   0.3125             ,   0.42500000000000004,   0.5375000000000001 ,   0.65               ,   0.3125             ,   0.42500000000000004,   0.5375000000000001 ,   0.65               ,   0.7625             ,   0.925              ,   1.0875000000000001 ,   1.25               ,   0.7                ,   0.8                ,   0.9000000000000001 ,   1.                 ,   1.35               ,   1.5                ,   1.6500000000000001 ,   1.8                ,   1.1                ,   1.2000000000000002 ,   1.3                ,   1.4000000000000001 ,   2.5166666666666666 ,   2.7                ,   2.8833333333333333 ,   3.0666666666666664 ,   2.0666666666666664 ,   2.2                ,   2.333333333333333  ,   2.466666666666667  ,   2.0666666666666664 ,   2.2                ,   2.333333333333333  ,   2.466666666666667  ,   1.1125             ,   1.225              ,   1.3375000000000001 ,   1.4500000000000002 ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   3.9725             ,   4.265000000000001  ,   4.5575             ,   4.8500000000000005 ,   2.86               ,   3.04               ,   3.22               ,   3.4000000000000004 ,   4.83               ,   5.1000000000000005 ,   5.370000000000001  ,   5.640000000000001  ,   3.58               ,   3.7600000000000007 ,   3.9400000000000004 ,   4.12               ,   7.463333333333334  ,   7.793333333333334  ,   8.123333333333333  ,   8.453333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   1.1125             ,   1.225              ,   1.3375000000000001 ,   1.4500000000000002 ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   3.9725             ,   4.265000000000001  ,   4.5575             ,   4.8500000000000005 ,   2.86               ,   3.04               ,   3.22               ,   3.4000000000000004 ,   4.83               ,   5.1000000000000005 ,   5.370000000000001  ,   5.640000000000001  ,   3.58               ,   3.7600000000000007 ,   3.9400000000000004 ,   4.12               ,   7.463333333333334  ,   7.793333333333334  ,   8.123333333333333  ,   8.453333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   3.1625000000000005 ,   3.325              ,   3.4875             ,   3.6500000000000004 ,   6.2124999999999995 ,   6.505000000000001  ,   6.7975             ,   7.09               ,   6.2124999999999995 ,   6.505000000000001  ,   6.7975             ,   7.09               ,   9.7825             ,  10.205              ,  10.627500000000001  ,  11.05               ,   6.62               ,   6.88               ,   7.140000000000001  ,   7.4                ,  10.71               ,  11.100000000000001  ,  11.490000000000002  ,  11.88               ,   7.66               ,   7.920000000000001  ,   8.18               ,   8.440000000000001  ,  15.343333333333334  ,  15.82               ,  16.296666666666667  ,  16.773333333333333  ,  11.773333333333333  ,  12.120000000000001  ,  12.466666666666669  ,  12.813333333333333  ,  11.773333333333333  ,  12.120000000000001  ,  12.466666666666669  ,  12.813333333333333  ,   3.1000000000000005 ,   3.2                ,   3.3                ,   3.4000000000000004 ,   5.8999999999999995 ,   6.08               ,   6.260000000000001  ,   6.44               ,   5.8999999999999995 ,   6.08               ,   6.260000000000001  ,   6.44               ,   9.02               ,   9.28               ,   9.540000000000001  ,   9.8                ,   5.92               ,   6.08               ,   6.24               ,   6.4                ,   9.36               ,   9.600000000000001  ,   9.84               ,  10.08               ,   6.56               ,   6.720000000000001  ,   6.88               ,   7.04               ,  12.826666666666668  ,  13.120000000000001  ,  13.413333333333334  ,  13.706666666666667  ,   9.706666666666667  ,   9.92               ,  10.133333333333333  ,  10.346666666666668  ,   9.706666666666667  ,   9.92               ,  10.133333333333333  ,  10.346666666666668  ,   8.183333333333334  ,   8.366666666666667  ,   8.55               ,   8.733333333333334  ,  15.316666666666666  ,  15.646666666666667  ,  15.976666666666668  ,  16.306666666666665  ,  15.316666666666666  ,  15.646666666666667  ,  15.976666666666668  ,  16.306666666666665  ,  23.03666666666666   ,  23.513333333333332  ,  23.990000000000002  ,  24.466666666666665  ,  14.853333333333333  ,  15.146666666666668  ,  15.440000000000001  ,  15.733333333333334  ,  23.159999999999997  ,  23.6                ,  24.04               ,  24.48               ,  16.026666666666667  ,  16.32               ,  16.613333333333333  ,  16.906666666666666  ,  30.848888888888894  ,  31.38666666666667   ,  31.924444444444447  ,  32.46222222222222   ,  23.128888888888888  ,  23.52               ,  23.91111111111111   ,  24.302222222222223  ,  23.128888888888888  ,  23.52               ,  23.91111111111111   ,  24.302222222222223  ,   7.133333333333333  ,   7.266666666666666  ,   7.4                ,   7.533333333333333  ,  13.266666666666666  ,  13.506666666666666  ,  13.746666666666668  ,  13.986666666666666  ,  13.266666666666666  ,  13.506666666666666  ,  13.746666666666668  ,  13.986666666666666  ,  19.826666666666668  ,  20.173333333333332  ,  20.52               ,  20.866666666666667  ,  12.693333333333333  ,  12.906666666666666  ,  13.120000000000001  ,  13.333333333333332  ,  19.68               ,  20.                 ,  20.32               ,  20.64               ,  13.546666666666667  ,  13.760000000000002  ,  13.973333333333333  ,  14.186666666666667  ,  25.90222222222222   ,  26.293333333333337  ,  26.684444444444445  ,  27.075555555555557  ,  19.34222222222222   ,  19.626666666666665  ,  19.91111111111111   ,  20.195555555555558  ,  19.34222222222222   ,  19.626666666666665  ,  19.91111111111111   ,  20.195555555555558  ,   7.133333333333333  ,   7.266666666666666  ,   7.4                ,   7.533333333333333  ,  13.266666666666666  ,  13.506666666666666  ,  13.746666666666668  ,  13.986666666666666  ,  13.266666666666666  ,  13.506666666666666  ,  13.746666666666668  ,  13.986666666666666  ,  19.826666666666668  ,  20.173333333333332  ,  20.52               ,  20.866666666666667  ,  12.693333333333333  ,  12.906666666666666  ,  13.120000000000001  ,  13.333333333333332  ,  19.68               ,  20.                 ,  20.32               ,  20.64               ,  13.546666666666667  ,  13.760000000000002  ,  13.973333333333333  ,  14.186666666666667  ,  25.90222222222222   ,  26.293333333333337  ,  26.684444444444445  ,  27.075555555555557  ,  19.34222222222222   ,  19.626666666666665  ,  19.91111111111111   ,  20.195555555555558  ,  19.34222222222222   ,  19.626666666666665  ,  19.91111111111111   ,  20.195555555555558  ,   5.0625             ,   5.125              ,   5.1875             ,   5.25               ,   9.3125             ,   9.425              ,   9.537500000000001  ,   9.65               ,   9.3125             ,   9.425              ,   9.537500000000001  ,   9.65               ,  13.7625             ,  13.925              ,  14.087500000000002  ,  14.25               ,   8.7                ,   8.8                ,   8.9                ,   9.                 ,  13.35               ,  13.5                ,  13.65               ,  13.8                ,   9.100000000000001  ,   9.2                ,   9.3                ,   9.400000000000002  ,  17.183333333333334  ,  17.366666666666667  ,  17.55               ,  17.733333333333334  ,  12.733333333333333  ,  12.866666666666667  ,  13.                 ,  13.133333333333333  ,  12.733333333333333  ,  12.866666666666667  ,  13.                 ,  13.133333333333333  ,  10.1125             ,  10.225000000000001  ,  10.3375             ,  10.45               ,  18.5625             ,  18.765              ,  18.9675             ,  19.17               ,  18.5625             ,  18.765              ,  18.9675             ,  19.17               ,  27.3725             ,  27.665              ,  27.957500000000007  ,  28.25               ,  17.259999999999998  ,  17.44               ,  17.62               ,  17.8                ,  26.43               ,  26.700000000000003  ,  26.970000000000002  ,  27.240000000000002  ,  17.98               ,  18.16               ,  18.340000000000003  ,  18.520000000000003  ,  33.86333333333333   ,  34.193333333333335  ,  34.52333333333334   ,  34.85333333333334   ,  25.053333333333335  ,  25.293333333333337  ,  25.533333333333335  ,  25.773333333333333  ,  25.053333333333335  ,  25.293333333333337  ,  25.533333333333335  ,  25.773333333333333  ,  10.1125             ,  10.225000000000001  ,  10.3375             ,  10.45               ,  18.5625             ,  18.765              ,  18.9675             ,  19.17               ,  18.5625             ,  18.765              ,  18.9675             ,  19.17               ,  27.3725             ,  27.665              ,  27.957500000000007  ,  28.25               ,  17.259999999999998  ,  17.44               ,  17.62               ,  17.8                ,  26.43               ,  26.700000000000003  ,  26.970000000000002  ,  27.240000000000002  ,  17.98               ,  18.16               ,  18.340000000000003  ,  18.520000000000003  ,  33.86333333333333   ,  34.193333333333335  ,  34.52333333333334   ,  34.85333333333334   ,  25.053333333333335  ,  25.293333333333337  ,  25.533333333333335  ,  25.773333333333333  ,  25.053333333333335  ,  25.293333333333337  ,  25.533333333333335  ,  25.773333333333333  ,  16.1625             ,  16.325000000000003  ,  16.4875             ,  16.65               ,  29.6125             ,  29.905              ,  30.197499999999998  ,  30.490000000000002  ,  29.6125             ,  29.905              ,  30.197499999999998  ,  30.490000000000002  ,  43.582499999999996  ,  44.005              ,  44.42750000000001   ,  44.85               ,  27.419999999999998  ,  27.68               ,  27.940000000000005  ,  28.200000000000003  ,  41.910000000000004  ,  42.300000000000004  ,  42.690000000000005  ,  43.08               ,  28.46               ,  28.72               ,  28.980000000000004  ,  29.240000000000006  ,  53.47666666666666   ,  53.95333333333333   ,  54.43000000000001   ,  54.90666666666667   ,  39.50666666666667   ,  39.85333333333334   ,  40.2                ,  40.54666666666667   ,  39.50666666666667   ,  39.85333333333334   ,  40.2                ,  40.54666666666667   ,  11.100000000000001  ,  11.200000000000001  ,  11.3                ,  11.4                ,  20.3                ,  20.48               ,  20.66               ,  20.84               ,  20.3                ,  20.48               ,  20.66               ,  20.84               ,  29.82               ,  30.08               ,  30.340000000000003  ,  30.6                ,  18.72               ,  18.88               ,  19.04               ,  19.200000000000003  ,  28.560000000000002  ,  28.8                ,  29.04               ,  29.280000000000005  ,  19.36               ,  19.52               ,  19.68               ,  19.840000000000003  ,  36.29333333333334   ,  36.586666666666666  ,  36.88               ,  37.17333333333334   ,  26.773333333333333  ,  26.986666666666665  ,  27.200000000000003  ,  27.413333333333334  ,  26.773333333333333  ,  26.986666666666665  ,  27.200000000000003  ,  27.413333333333334  ,  22.85               ,  23.03333333333333   ,  23.21666666666667   ,  23.4                ,  41.71666666666666   ,  42.04666666666667   ,  42.376666666666665  ,  42.70666666666667   ,  41.71666666666666   ,  42.04666666666667   ,  42.376666666666665  ,  42.70666666666667   ,  61.17               ,  61.64666666666666   ,  62.123333333333335  ,  62.6                ,  38.31999999999999   ,  38.61333333333333   ,  38.906666666666666  ,  39.2                ,  58.36               ,  58.8                ,  59.24               ,  59.68000000000001   ,  39.49333333333333   ,  39.78666666666666   ,  40.08               ,  40.373333333333335  ,  73.87111111111112   ,  74.40888888888888   ,  74.94666666666667   ,  75.48444444444445   ,  54.41777777777777   ,  54.80888888888889   ,  55.2                ,  55.59111111111111   ,  54.41777777777777   ,  54.80888888888889   ,  55.2                ,  55.59111111111111   ,  17.8                ,  17.933333333333334  ,  18.066666666666666  ,  18.2                ,  32.46666666666667   ,  32.70666666666666   ,  32.94666666666667   ,  33.18666666666667   ,  32.46666666666667   ,  32.70666666666666   ,  32.94666666666667   ,  33.18666666666667   ,  47.56               ,  47.906666666666666  ,  48.25333333333333   ,  48.6                ,  29.76               ,  29.973333333333333  ,  30.186666666666667  ,  30.4                ,  45.28               ,  45.6                ,  45.92000000000001   ,  46.24               ,  30.613333333333333  ,  30.826666666666668  ,  31.04               ,  31.25333333333333   ,  57.19111111111111   ,  57.582222222222214  ,  57.97333333333333   ,  58.364444444444445  ,  42.09777777777778   ,  42.38222222222222   ,  42.666666666666664  ,  42.95111111111111   ,  42.09777777777778   ,  42.38222222222222   ,  42.666666666666664  ,  42.95111111111111   ,  17.8                ,  17.933333333333334  ,  18.066666666666666  ,  18.2                ,  32.46666666666667   ,  32.70666666666666   ,  32.94666666666667   ,  33.18666666666667   ,  32.46666666666667   ,  32.70666666666666   ,  32.94666666666667   ,  33.18666666666667   ,  47.56               ,  47.906666666666666  ,  48.25333333333333   ,  48.6                ,  29.76               ,  29.973333333333333  ,  30.186666666666667  ,  30.4                ,  45.28               ,  45.6                ,  45.92000000000001   ,  46.24               ,  30.613333333333333  ,  30.826666666666668  ,  31.04               ,  31.25333333333333   ,  57.19111111111111   ,  57.582222222222214  ,  57.97333333333333   ,  58.364444444444445  ,  42.09777777777778   ,  42.38222222222222   ,  42.666666666666664  ,  42.95111111111111   ,  42.09777777777778   ,  42.38222222222222   ,  42.666666666666664  ,  42.95111111111111   ,  10.0625             ,  10.125              ,  10.1875             ,  10.25               ,  18.3125             ,  18.425              ,  18.5375             ,  18.65               ,  18.3125             ,  18.425              ,  18.5375             ,  18.65               ,  26.762500000000003  ,  26.925              ,  27.087500000000002  ,  27.25               ,  16.700000000000003  ,  16.8                ,  16.9                ,  17.                 ,  25.35               ,  25.5                ,  25.65               ,  25.8                ,  17.1                ,  17.200000000000003  ,  17.3                ,  17.4                ,  31.85               ,  32.03333333333333   ,  32.21666666666667   ,  32.4                ,  23.4                ,  23.53333333333333   ,  23.666666666666664  ,  23.8                ,  23.4                ,  23.53333333333333   ,  23.666666666666664  ,  23.8                ,  19.1125             ,  19.225              ,  19.3375             ,  19.450000000000003  ,  34.7625             ,  34.964999999999996  ,  35.167500000000004  ,  35.370000000000005  ,  34.7625             ,  34.964999999999996  ,  35.167500000000004  ,  35.370000000000005  ,  50.7725             ,  51.065              ,  51.3575             ,  51.650000000000006  ,  31.660000000000004  ,  31.840000000000003  ,  32.019999999999996  ,  32.2                ,  48.03               ,  48.3                ,  48.56999999999999   ,  48.84               ,  32.38               ,  32.56               ,  32.74               ,  32.92               ,  60.263333333333335  ,  60.593333333333334  ,  60.92333333333333   ,  61.25333333333334   ,  44.25333333333333   ,  44.493333333333325  ,  44.733333333333334  ,  44.973333333333336  ,  44.25333333333333   ,  44.493333333333325  ,  44.733333333333334  ,  44.973333333333336  ,  19.1125             ,  19.225              ,  19.3375             ,  19.450000000000003  ,  34.7625             ,  34.964999999999996  ,  35.167500000000004  ,  35.370000000000005  ,  34.7625             ,  34.964999999999996  ,  35.167500000000004  ,  35.370000000000005  ,  50.7725             ,  51.065              ,  51.3575             ,  51.650000000000006  ,  31.660000000000004  ,  31.840000000000003  ,  32.019999999999996  ,  32.2                ,  48.03               ,  48.3                ,  48.56999999999999   ,  48.84               ,  32.38               ,  32.56               ,  32.74               ,  32.92               ,  60.263333333333335  ,  60.593333333333334  ,  60.92333333333333   ,  61.25333333333334   ,  44.25333333333333   ,  44.493333333333325  ,  44.733333333333334  ,  44.973333333333336  ,  44.25333333333333   ,  44.493333333333325  ,  44.733333333333334  ,  44.973333333333336  ,  29.1625             ,  29.325000000000003  ,  29.487499999999997  ,  29.650000000000006  ,  53.0125             ,  53.305              ,  53.597500000000004  ,  53.89000000000001   ,  53.0125             ,  53.305              ,  53.597500000000004  ,  53.89000000000001   ,  77.38250000000001   ,  77.805              ,  78.22749999999999   ,  78.65000000000002   ,  48.22               ,  48.480000000000004  ,  48.739999999999995  ,  49.                 ,  73.11               ,  73.5                ,  73.88999999999999   ,  74.28               ,  49.260000000000005  ,  49.52               ,  49.78               ,  50.040000000000006  ,  91.61               ,  92.08666666666667   ,  92.56333333333332   ,  93.04               ,  67.24               ,  67.58666666666666   ,  67.93333333333334   ,  68.28               ,  67.24               ,  67.58666666666666   ,  67.93333333333334   ,  68.28               ,  19.1                ,  19.200000000000003  ,  19.3                ,  19.400000000000002  ,  34.7                ,  34.88               ,  35.06               ,  35.24               ,  34.7                ,  34.88               ,  35.06               ,  35.24               ,  50.620000000000005  ,  50.88               ,  51.14               ,  51.400000000000006  ,  31.52               ,  31.68               ,  31.839999999999996  ,  32.                 ,  47.75999999999999   ,  48.                 ,  48.24               ,  48.480000000000004  ,  32.16               ,  32.32               ,  32.480000000000004  ,  32.64               ,  59.760000000000005  ,  60.053333333333335  ,  60.34666666666667   ,  60.63999999999999   ,  43.839999999999996  ,  44.053333333333335  ,  44.266666666666666  ,  44.48               ,  43.839999999999996  ,  44.053333333333335  ,  44.266666666666666  ,  44.48               ,  37.516666666666666  ,  37.7                ,  37.88333333333333   ,  38.06666666666666   ,  68.11666666666667   ,  68.44666666666667   ,  68.77666666666667   ,  69.10666666666667   ,  68.11666666666667   ,  68.44666666666667   ,  68.77666666666667   ,  69.10666666666667   ,  99.30333333333333   ,  99.77999999999999   , 100.25666666666666   , 100.73333333333333   ,  61.78666666666666   ,  62.080000000000005  ,  62.37333333333333   ,  62.66666666666667   ,  93.55999999999999   ,  93.99999999999999   ,  94.44000000000001   ,  94.88000000000001   ,  62.959999999999994  ,  63.25333333333334   ,  63.54666666666667   ,  63.84               , 116.89333333333333   , 117.43111111111111   , 117.9688888888889    , 118.50666666666666   ,  85.70666666666666   ,  86.09777777777778   ,  86.48888888888888   ,  86.88               ,  85.70666666666666   ,  86.09777777777778   ,  86.48888888888888   ,  86.88               ,  28.466666666666665  ,  28.6                ,  28.733333333333334  ,  28.866666666666667  ,  51.666666666666664  ,  51.906666666666666  ,  52.14666666666667   ,  52.38666666666667   ,  51.666666666666664  ,  51.906666666666666  ,  52.14666666666667   ,  52.38666666666667   ,  75.29333333333332   ,  75.64               ,  75.98666666666666   ,  76.33333333333334   ,  46.82666666666667   ,  47.04               ,  47.25333333333333   ,  47.46666666666667   ,  70.88               ,  71.2                ,  71.52               ,  71.84               ,  47.67999999999999   ,  47.89333333333334   ,  48.10666666666666   ,  48.32               ,  88.47999999999999   ,  88.8711111111111    ,  89.26222222222222   ,  89.65333333333334   ,  64.85333333333332   ,  65.13777777777779   ,  65.42222222222222   ,  65.70666666666666   ,  64.85333333333332   ,  65.13777777777779   ,  65.42222222222222   ,  65.70666666666666   ,  28.466666666666665  ,  28.6                ,  28.733333333333334  ,  28.866666666666667  ,  51.666666666666664  ,  51.906666666666666  ,  52.14666666666667   ,  52.38666666666667   ,  51.666666666666664  ,  51.906666666666666  ,  52.14666666666667   ,  52.38666666666667   ,  75.29333333333332   ,  75.64               ,  75.98666666666666   ,  76.33333333333334   ,  46.82666666666667   ,  47.04               ,  47.25333333333333   ,  47.46666666666667   ,  70.88               ,  71.2                ,  71.52               ,  71.84               ,  47.67999999999999   ,  47.89333333333334   ,  48.10666666666666   ,  48.32               ,  88.47999999999999   ,  88.8711111111111    ,  89.26222222222222   ,  89.65333333333334   ,  64.85333333333332   ,  65.13777777777779   ,  65.42222222222222   ,  65.70666666666666   ,  64.85333333333332   ,  65.13777777777779   ,  65.42222222222222   ,  65.70666666666666   };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.6                ,  0.72               ,  0.8400000000000001 ,  0.96               ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.6                ,  0.72               ,  0.8400000000000001 ,  0.96               ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  2.04               ,  2.16               ,  2.28               ,  2.4                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  0.52               ,  0.56               ,  0.6                ,  0.64               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  1.2000000000000002 ,  1.28               ,  1.3599999999999999 ,  1.44               ,  2.04               ,  2.16               ,  2.28               ,  2.4                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  3.4800000000000004 ,  3.6000000000000005 ,  3.7200000000000006 ,  3.8400000000000003 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  3.4800000000000004 ,  3.6000000000000005 ,  3.7200000000000006 ,  3.8400000000000003 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  2.48               ,  2.56               ,  2.64               ,  2.72               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  5.28               ,  5.44               ,  5.6000000000000005 ,  5.76               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  5.92               ,  6.08               ,  6.24               ,  6.3999999999999995 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  4.92               ,  5.04               ,  5.16               ,  5.28               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  4.92               ,  5.04               ,  5.16               ,  5.28               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  6.36               ,  6.48               ,  6.6                ,  6.720000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  6.36               ,  6.48               ,  6.6                ,  6.720000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  2.2800000000000002 ,  2.32               ,  2.36               ,  2.4                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  7.800000000000001  ,  7.92               ,  8.04               ,  8.16               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  7.800000000000001  ,  7.92               ,  8.04               ,  8.16               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.18333333333333335,  0.18333333333333335,  0.33333333333333337,  0.25               ,  0.5833333333333333 ,  0.48333333333333334,  0.48333333333333334,  0.7566666666666666 ,  0.7566666666666666 ,  1.1866666666666668 ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  0.7566666666666666 ,  0.7566666666666666 ,  1.1866666666666668 ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  1.7566666666666664 ,  1.7566666666666664 ,  2.6266666666666665 ,  1.6099999999999999 ,  3.2766666666666664 ,  2.536666666666667  ,  2.536666666666667  ,  1.5733333333333333 ,  1.5733333333333333 ,  2.293333333333333  ,  1.36               ,  2.6933333333333334 ,  2.0533333333333337 ,  2.0533333333333337 ,  3.                 ,  3.                 ,  4.319999999999999  ,  2.52               ,  4.92               ,  3.7200000000000006 ,  3.7200000000000006 ,  2.4266666666666667 ,  2.4266666666666667 ,  3.466666666666667  ,  2.                 ,  3.866666666666667  ,  2.9066666666666663 ,  2.9066666666666663 ,  5.515555555555555  ,  5.515555555555555  ,  7.822222222222223  ,  4.466666666666667  ,  8.555555555555557  ,  6.395555555555555  ,  6.395555555555555  ,  4.515555555555555  ,  4.515555555555555  ,  6.3822222222222225 ,  3.626666666666667  ,  6.915555555555556  ,  5.155555555555555  ,  5.155555555555555  ,  4.515555555555555  ,  4.515555555555555  ,  6.3822222222222225 ,  3.626666666666667  ,  6.915555555555556  ,  5.155555555555555  ,  5.155555555555555  ,  2.85               ,  2.85               ,  4.                 ,  2.25               ,  4.25               ,  3.1500000000000004 ,  3.1500000000000004 ,  5.556666666666667  ,  5.556666666666667  ,  7.786666666666667  ,  4.37               ,  8.236666666666666  ,  6.096666666666668  ,  6.096666666666668  ,  5.556666666666667  ,  5.556666666666667  ,  7.786666666666667  ,  4.37               ,  8.236666666666666  ,  6.096666666666668  ,  6.096666666666668  ,  8.69               ,  8.69               , 12.16               ,  6.8100000000000005 , 12.809999999999999  ,  9.47               ,  9.47               ,  5.840000000000001  ,  5.840000000000001  ,  8.16               ,  4.5600000000000005 ,  8.56               ,  6.32               ,  6.32               ,  9.4                ,  9.4                , 13.12               ,  7.320000000000001  , 13.72               , 10.120000000000001  , 10.120000000000001  ,  6.693333333333334  ,  6.693333333333334  ,  9.333333333333334  ,  5.2                ,  9.733333333333334  ,  7.173333333333334  ,  7.173333333333334  , 13.337777777777779  , 13.337777777777779  , 18.57777777777778   , 10.333333333333334  , 19.31111111111111   , 14.217777777777778  , 14.217777777777778  , 10.204444444444444  , 10.204444444444444  , 14.204444444444444  ,  7.893333333333333  , 14.737777777777778  , 10.844444444444445  , 10.844444444444445  , 10.204444444444444  , 10.204444444444444  , 14.204444444444444  ,  7.893333333333333  , 14.737777777777778  , 10.844444444444445  , 10.844444444444445  ,  5.516666666666667  ,  5.516666666666667  ,  7.666666666666666  ,  4.25               ,  7.916666666666666  ,  5.816666666666666  ,  5.816666666666666  , 10.356666666666666  , 10.356666666666666  , 14.386666666666667  ,  7.97               , 14.836666666666666  , 10.896666666666667  , 10.896666666666667  , 10.356666666666666  , 10.356666666666666  , 14.386666666666667  ,  7.97               , 14.836666666666666  , 10.896666666666667  , 10.896666666666667  , 15.623333333333331  , 15.623333333333331  , 21.69333333333333   , 12.009999999999998  , 22.343333333333334  , 16.403333333333336  , 16.403333333333336  , 10.106666666666666  , 10.106666666666666  , 14.026666666666667  ,  7.760000000000001  , 14.426666666666668  , 10.586666666666666  , 10.586666666666666  , 15.799999999999999  , 15.799999999999999  , 21.92               , 12.120000000000001  , 22.52               , 16.52               , 16.52               , 10.96               , 10.96               , 15.2                ,  8.4                , 15.600000000000001  , 11.440000000000001  , 11.440000000000001  , 21.16               , 21.16               , 29.333333333333332  , 16.2                , 30.06666666666667   , 22.04               , 22.04               , 15.893333333333334  , 15.893333333333334  , 22.026666666666667  , 12.16               , 22.560000000000002  , 16.53333333333333   , 16.53333333333333   , 15.893333333333334  , 15.893333333333334  , 22.026666666666667  , 12.16               , 22.560000000000002  , 16.53333333333333   , 16.53333333333333   };
  const std::array<int, 4> in_shape = {{ 3, 10, 7, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.36              , 0.36              , 0.8400000000000001, 0.8400000000000001, 0.8400000000000001, 0.48              , 0.48              , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.28              , 0.28              , 0.6000000000000001, 0.6000000000000001, 0.6000000000000001, 0.32              , 0.32              , 0.28              , 0.28              , 0.6000000000000001, 0.6000000000000001, 0.6000000000000001, 0.32              , 0.32              , 0.64              , 0.64              , 1.36              , 1.36              , 1.36              , 0.72              , 0.72              , 0.64              , 0.64              , 1.36              , 1.36              , 1.36              , 0.72              , 0.72              , 1.08              , 1.08              , 2.2800000000000002, 2.2800000000000002, 2.2800000000000002, 1.2               , 1.2               , 0.8               , 0.8               , 1.68              , 1.68              , 1.68              , 0.88              , 0.88              , 0.8               , 0.8               , 1.68              , 1.68              , 1.68              , 0.88              , 0.88              , 0.44              , 0.44              , 0.9199999999999999, 0.9199999999999999, 0.9199999999999999, 0.48              , 0.48              , 0.44              , 0.44              , 0.9199999999999999, 0.9199999999999999, 0.9199999999999999, 0.48              , 0.48              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.52              , 0.52              , 1.08              , 1.08              , 1.08              , 0.56              , 0.56              , 0.52              , 0.52              , 1.08              , 1.08              , 1.08              , 0.56              , 0.56              , 1.12              , 1.12              , 2.3200000000000003, 2.3200000000000003, 2.3200000000000003, 1.2000000000000002, 1.2000000000000002, 1.12              , 1.12              , 2.3200000000000003, 2.3200000000000003, 2.3200000000000003, 1.2000000000000002, 1.2000000000000002, 1.8000000000000003, 1.8000000000000003, 3.7200000000000006, 3.7200000000000006, 3.7200000000000006, 1.9200000000000002, 1.9200000000000002, 1.28              , 1.28              , 2.6399999999999997, 2.6399999999999997, 2.6399999999999997, 1.3599999999999999, 1.3599999999999999, 1.28              , 1.28              , 2.6399999999999997, 2.6399999999999997, 2.6399999999999997, 1.3599999999999999, 1.3599999999999999, 0.68              , 0.68              , 1.4               , 1.4               , 1.4               , 0.72              , 0.72              , 0.68              , 0.68              , 1.4               , 1.4               , 1.4               , 0.72              , 0.72              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 3, 10, 7, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.23333333333333334,  0.3666666666666667 ,  0.23333333333333334,  0.3666666666666667 ,  0.48333333333333334,  0.6666666666666667 ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.2733333333333332 ,  1.5133333333333332 ,  1.2733333333333332 ,  1.5133333333333332 ,  2.043333333333333  ,  2.3733333333333335 ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  3.166666666666666  ,  3.5133333333333328 ,  3.166666666666666  ,  3.5133333333333328 ,  4.776666666666666  ,  5.253333333333333  ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  2.9333333333333336 ,  3.1466666666666665 ,  2.9333333333333336 ,  3.1466666666666665 ,  4.293333333333333  ,  4.586666666666666  ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  5.680000000000001  ,  6.                 ,  5.680000000000001  ,  6.                 ,  8.2                ,  8.639999999999999  ,  4.8                ,  5.04               ,  9.399999999999999  ,  9.84               ,  7.119999999999999  ,  7.440000000000001  ,  7.119999999999999  ,  7.440000000000001  ,  4.640000000000001  ,  4.8533333333333335 ,  4.640000000000001  ,  4.8533333333333335 ,  6.640000000000001  ,  6.933333333333334  ,  3.84               ,  4.                 ,  7.4399999999999995 ,  7.733333333333334  ,  5.6                ,  5.813333333333333  ,  5.6                ,  5.813333333333333  , 10.64               , 11.03111111111111   , 10.64               , 11.03111111111111   , 15.106666666666667  , 15.644444444444446  ,  8.64               ,  8.933333333333334  , 16.573333333333334  , 17.111111111111114  , 12.399999999999999  , 12.79111111111111   , 12.399999999999999  , 12.79111111111111   ,  8.746666666666668  ,  9.03111111111111   ,  8.746666666666668  ,  9.03111111111111   , 12.373333333333335  , 12.764444444444445  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   ,  8.746666666666668  ,  9.03111111111111   ,  8.746666666666668  ,  9.03111111111111   , 12.373333333333335  , 12.764444444444445  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   ,  5.566666666666666  ,  5.7                ,  5.566666666666666  ,  5.7                ,  7.816666666666666  ,  8.                 ,  4.4                ,  4.5                ,  8.316666666666666  ,  8.5                ,  6.166666666666666  ,  6.300000000000001  ,  6.166666666666666  ,  6.300000000000001  , 10.873333333333331  , 11.113333333333333  , 10.873333333333331  , 11.113333333333333  , 15.243333333333332  , 15.573333333333334  ,  8.56               ,  8.74               , 16.143333333333334  , 16.473333333333333  , 11.953333333333331  , 12.193333333333335  , 11.953333333333331  , 12.193333333333335  , 10.873333333333331  , 11.113333333333333  , 10.873333333333331  , 11.113333333333333  , 15.243333333333332  , 15.573333333333334  ,  8.56               ,  8.74               , 16.143333333333334  , 16.473333333333333  , 11.953333333333331  , 12.193333333333335  , 11.953333333333331  , 12.193333333333335  , 17.03333333333333   , 17.38               , 17.03333333333333   , 17.38               , 23.843333333333334  , 24.32               , 13.36               , 13.620000000000001  , 25.143333333333334  , 25.619999999999997  , 18.59333333333333   , 18.94               , 18.59333333333333   , 18.94               , 11.466666666666665  , 11.680000000000001  , 11.466666666666665  , 11.680000000000001  , 16.026666666666667  , 16.32               ,  8.959999999999999  ,  9.120000000000001  , 16.826666666666664  , 17.12               , 12.426666666666666  , 12.64               , 12.426666666666666  , 12.64               , 18.479999999999997  , 18.8                , 18.479999999999997  , 18.8                , 25.8                , 26.24               , 14.399999999999999  , 14.640000000000002  , 27.                 , 27.44               , 19.919999999999998  , 20.240000000000002  , 19.919999999999998  , 20.240000000000002  , 13.173333333333332  , 13.386666666666668  , 13.173333333333332  , 13.386666666666668  , 18.373333333333335  , 18.666666666666668  , 10.24               , 10.4                , 19.173333333333332  , 19.46666666666667   , 14.133333333333333  , 14.346666666666668  , 14.133333333333333  , 14.346666666666668  , 26.284444444444443  , 26.675555555555558  , 26.284444444444443  , 26.675555555555558  , 36.617777777777775  , 37.15555555555556   , 20.373333333333335  , 20.666666666666668  , 38.08444444444444   , 38.62222222222222   , 28.044444444444444  , 28.435555555555556  , 28.044444444444444  , 28.435555555555556  , 20.124444444444443  , 20.40888888888889   , 20.124444444444443  , 20.40888888888889   , 28.017777777777777  , 28.40888888888889   , 15.573333333333334  , 15.786666666666665  , 29.084444444444443  , 29.475555555555555  , 21.404444444444444  , 21.68888888888889   , 21.404444444444444  , 21.68888888888889   , 20.124444444444443  , 20.40888888888889   , 20.124444444444443  , 20.40888888888889   , 28.017777777777777  , 28.40888888888889   , 15.573333333333334  , 15.786666666666665  , 29.084444444444443  , 29.475555555555555  , 21.404444444444444  , 21.68888888888889   , 21.404444444444444  , 21.68888888888889   , 10.9                , 11.033333333333333  , 10.9                , 11.033333333333333  , 15.15               , 15.333333333333332  ,  8.4                ,  8.5                , 15.65               , 15.833333333333332  , 11.5                , 11.633333333333333  , 11.5                , 11.633333333333333  , 20.473333333333336  , 20.71333333333333   , 20.473333333333336  , 20.71333333333333   , 28.443333333333335  , 28.773333333333333  , 15.760000000000002  , 15.94               , 29.34333333333333   , 29.673333333333332  , 21.553333333333335  , 21.793333333333333  , 21.553333333333335  , 21.793333333333333  , 20.473333333333336  , 20.71333333333333   , 20.473333333333336  , 20.71333333333333   , 28.443333333333335  , 28.773333333333333  , 15.760000000000002  , 15.94               , 29.34333333333333   , 29.673333333333332  , 21.553333333333335  , 21.793333333333333  , 21.553333333333335  , 21.793333333333333  , 30.900000000000006  , 31.246666666666663  , 30.900000000000006  , 31.246666666666663  , 42.910000000000004  , 43.38666666666666   , 23.76               , 24.019999999999996  , 44.209999999999994  , 44.68666666666667   , 32.46               , 32.80666666666667   , 32.46               , 32.80666666666667   , 20.                 , 20.21333333333333   , 20.                 , 20.21333333333333   , 27.76               , 28.053333333333335  , 15.36               , 15.520000000000001  , 28.56               , 28.853333333333335  , 20.96               , 21.173333333333332  , 20.96               , 21.173333333333332  , 31.28               , 31.599999999999998  , 31.28               , 31.599999999999998  , 43.400000000000006  , 43.84               , 24.                 , 24.240000000000002  , 44.599999999999994  , 45.04               , 32.72               , 33.04               , 32.72               , 33.04               , 21.706666666666667  , 21.92               , 21.706666666666667  , 21.92               , 30.106666666666666  , 30.4                , 16.64               , 16.8                , 30.906666666666666  , 31.200000000000003  , 22.666666666666664  , 22.880000000000003  , 22.666666666666664  , 22.880000000000003  , 41.928888888888885  , 42.32               , 41.928888888888885  , 42.32               , 58.12888888888888   , 58.666666666666664  , 32.10666666666667   , 32.4                , 59.59555555555555   , 60.13333333333334   , 43.68888888888888   , 44.08               , 43.68888888888888   , 44.08               , 31.502222222222226  , 31.78666666666667   , 31.502222222222226  , 31.78666666666667   , 43.66222222222222   , 44.053333333333335  , 24.10666666666667   , 24.32               , 44.72888888888889   , 45.120000000000005  , 32.78222222222222   , 33.06666666666666   , 32.78222222222222   , 33.06666666666666   , 31.502222222222226  , 31.78666666666667   , 31.502222222222226  , 31.78666666666667   , 43.66222222222222   , 44.053333333333335  , 24.10666666666667   , 24.32               , 44.72888888888889   , 45.120000000000005  , 32.78222222222222   , 33.06666666666666   , 32.78222222222222   , 33.06666666666666   };
  const std::array<int, 4> in_shape = {{ 3, 10, 7, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.6                , 0.72               , 0.6                , 0.72               , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 0.8400000000000001 , 0.96               , 0.8400000000000001 , 0.96               , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 1.2000000000000002 , 1.28               , 1.2000000000000002 , 1.28               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 1.3599999999999999 , 1.44               , 1.3599999999999999 , 1.44               , 1.2000000000000002 , 1.28               , 1.2000000000000002 , 1.28               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 1.3599999999999999 , 1.44               , 1.3599999999999999 , 1.44               , 2.04               , 2.16               , 2.04               , 2.16               , 4.32               , 4.5600000000000005 , 4.32               , 4.5600000000000005 , 4.32               , 4.5600000000000005 , 2.28               , 2.4                , 2.28               , 2.4                , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.                 , 1.04               , 2.08               , 2.16               , 2.08               , 2.16               , 2.08               , 2.16               , 1.08               , 1.12               , 1.08               , 1.12               , 1.                 , 1.04               , 1.                 , 1.04               , 2.08               , 2.16               , 2.08               , 2.16               , 2.08               , 2.16               , 1.08               , 1.12               , 1.08               , 1.12               , 2.16               , 2.24               , 2.16               , 2.24               , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 2.3200000000000003 , 2.4000000000000004 , 2.3200000000000003 , 2.4000000000000004 , 2.16               , 2.24               , 2.16               , 2.24               , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 2.3200000000000003 , 2.4000000000000004 , 2.3200000000000003 , 2.4000000000000004 , 3.4800000000000004 , 3.6000000000000005 , 3.4800000000000004 , 3.6000000000000005 , 7.200000000000001  , 7.440000000000001  , 7.200000000000001  , 7.440000000000001  , 7.200000000000001  , 7.440000000000001  , 3.7200000000000006 , 3.8400000000000003 , 3.7200000000000006 , 3.8400000000000003 , 2.48               , 2.56               , 2.48               , 2.56               , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 2.64               , 2.7199999999999998 , 2.64               , 2.7199999999999998 , 2.48               , 2.56               , 2.48               , 2.56               , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 2.64               , 2.7199999999999998 , 2.64               , 2.7199999999999998 , 1.32               , 1.36               , 1.32               , 1.36               , 2.72               , 2.8                , 2.72               , 2.8                , 2.72               , 2.8                , 1.4000000000000001 , 1.44               , 1.4000000000000001 , 1.44               , 1.32               , 1.36               , 1.32               , 1.36               , 2.72               , 2.8                , 2.72               , 2.8                , 2.72               , 2.8                , 1.4000000000000001 , 1.44               , 1.4000000000000001 , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 10, 7, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  0.3333333333333333,   0.4666666666666667,   0.6000000000000001,   0.7333333333333334,   0.3333333333333333,   0.4666666666666667,   0.6000000000000001,   0.7333333333333334,   0.7833333333333333,   0.9666666666666667,   1.1500000000000001,   1.3333333333333335,   0.7               ,   0.8               ,   0.9000000000000001,   1.                ,   1.7833333333333332,   1.9666666666666666,   2.1500000000000004,   2.333333333333333 ,   1.5333333333333332,   1.6666666666666665,   1.8               ,   1.9333333333333333,   1.5333333333333332,   1.6666666666666665,   1.8               ,   1.9333333333333333,   2.3066666666666666,   2.5466666666666664,   2.7866666666666666,   3.0266666666666664,   2.3066666666666666,   2.5466666666666664,   2.7866666666666666,   3.0266666666666664,   3.7566666666666664,   4.086666666666666 ,   4.416666666666667 ,   4.746666666666667 ,   2.54              ,   2.72              ,   2.9000000000000004,   3.08              ,   5.556666666666667 ,   5.886666666666667 ,   6.216666666666667 ,   6.546666666666667 ,   4.466666666666667 ,   4.706666666666667 ,   4.946666666666666 ,   5.186666666666667 ,   4.466666666666667 ,   4.706666666666667 ,   4.946666666666666 ,   5.186666666666667 ,   2.3066666666666666,   2.5466666666666664,   2.7866666666666666,   3.0266666666666664,   2.3066666666666666,   2.5466666666666664,   2.7866666666666666,   3.0266666666666664,   3.7566666666666664,   4.086666666666666 ,   4.416666666666667 ,   4.746666666666667 ,   2.54              ,   2.72              ,   2.9000000000000004,   3.08              ,   5.556666666666667 ,   5.886666666666667 ,   6.216666666666667 ,   6.546666666666667 ,   4.466666666666667 ,   4.706666666666667 ,   4.946666666666666 ,   5.186666666666667 ,   4.466666666666667 ,   4.706666666666667 ,   4.946666666666666 ,   5.186666666666667 ,   5.986666666666666 ,   6.333333333333332 ,   6.68              ,   7.0266666666666655,   5.986666666666666 ,   6.333333333333332 ,   6.68              ,   7.0266666666666655,   9.076666666666668 ,   9.553333333333333 ,  10.030000000000001 ,  10.506666666666666 ,   5.66              ,   5.92              ,   6.180000000000001 ,   6.4399999999999995,  11.676666666666668 ,  12.153333333333332 ,  12.63              ,  13.106666666666666 ,   9.106666666666667 ,   9.453333333333333 ,   9.799999999999999 ,  10.146666666666668 ,   9.106666666666667 ,   9.453333333333333 ,   9.799999999999999 ,  10.146666666666668 ,   5.653333333333334 ,   5.866666666666667 ,   6.08              ,   6.293333333333333 ,   5.653333333333334 ,   5.866666666666667 ,   6.08              ,   6.293333333333333 ,   8.293333333333335 ,   8.586666666666666 ,   8.88              ,   9.173333333333332 ,   4.96              ,   5.12              ,   5.28              ,   5.44              ,   9.893333333333334 ,  10.186666666666666 ,  10.48              ,  10.773333333333333 ,   7.573333333333334 ,   7.786666666666666 ,   8.                ,   8.213333333333335 ,   7.573333333333334 ,   7.786666666666666 ,   8.                ,   8.213333333333335 ,  11.040000000000003 ,  11.360000000000001 ,  11.68              ,  12.                ,  11.040000000000003 ,  11.360000000000001 ,  11.68              ,  12.                ,  15.960000000000004 ,  16.4               ,  16.84              ,  17.279999999999998 ,   9.36              ,   9.6               ,   9.84              ,  10.08              ,  18.360000000000003 ,  18.799999999999997 ,  19.24              ,  19.68              ,  13.920000000000002 ,  14.239999999999998 ,  14.559999999999999 ,  14.880000000000003 ,  13.920000000000002 ,  14.239999999999998 ,  14.559999999999999 ,  14.880000000000003 ,   9.066666666666666 ,   9.280000000000001 ,   9.493333333333332 ,   9.706666666666667 ,   9.066666666666666 ,   9.280000000000001 ,   9.493333333333332 ,   9.706666666666667 ,  12.986666666666668 ,  13.280000000000001 ,  13.573333333333334 ,  13.866666666666667 ,   7.5200000000000005,   7.68              ,   7.84              ,   8.                ,  14.586666666666666 ,  14.879999999999999 ,  15.173333333333332 ,  15.466666666666669 ,  10.986666666666668 ,  11.2               ,  11.413333333333334 ,  11.626666666666665 ,  10.986666666666668 ,  11.2               ,  11.413333333333334 ,  11.626666666666665 ,  20.888888888888886 ,  21.28              ,  21.67111111111111  ,  22.06222222222222  ,  20.888888888888886 ,  21.28              ,  21.67111111111111  ,  22.06222222222222  ,  29.675555555555555 ,  30.213333333333335 ,  30.75111111111111  ,  31.28888888888889  ,  16.986666666666668 ,  17.28              ,  17.573333333333334 ,  17.866666666666667 ,  32.60888888888889  ,  33.14666666666667  ,  33.684444444444445 ,  34.22222222222223  ,  24.40888888888889  ,  24.799999999999997 ,  25.191111111111113 ,  25.58222222222222  ,  24.40888888888889  ,  24.799999999999997 ,  25.191111111111113 ,  25.58222222222222  ,  17.208888888888886 ,  17.493333333333336 ,  17.77777777777778  ,  18.06222222222222  ,  17.208888888888886 ,  17.493333333333336 ,  17.77777777777778  ,  18.06222222222222  ,  24.355555555555554 ,  24.74666666666667  ,  25.137777777777778 ,  25.52888888888889  ,  13.866666666666667 ,  14.080000000000002 ,  14.293333333333333 ,  14.506666666666668 ,  26.488888888888887 ,  26.880000000000003 ,  27.27111111111111  ,  27.662222222222223 ,  19.76888888888889  ,  20.053333333333335 ,  20.337777777777777 ,  20.62222222222222  ,  19.76888888888889  ,  20.053333333333335 ,  20.337777777777777 ,  20.62222222222222  ,  17.208888888888886 ,  17.493333333333336 ,  17.77777777777778  ,  18.06222222222222  ,  17.208888888888886 ,  17.493333333333336 ,  17.77777777777778  ,  18.06222222222222  ,  24.355555555555554 ,  24.74666666666667  ,  25.137777777777778 ,  25.52888888888889  ,  13.866666666666667 ,  14.080000000000002 ,  14.293333333333333 ,  14.506666666666668 ,  26.488888888888887 ,  26.880000000000003 ,  27.27111111111111  ,  27.662222222222223 ,  19.76888888888889  ,  20.053333333333335 ,  20.337777777777777 ,  20.62222222222222  ,  19.76888888888889  ,  20.053333333333335 ,  20.337777777777777 ,  20.62222222222222  ,  11.                ,  11.133333333333333 ,  11.266666666666666 ,  11.4               ,  11.                ,  11.133333333333333 ,  11.266666666666666 ,  11.4               ,  15.45              ,  15.633333333333333 ,  15.816666666666666 ,  16.                ,   8.7               ,   8.8               ,   8.9               ,   9.                ,  16.45              ,  16.633333333333333 ,  16.816666666666666 ,  17.                ,  12.2               ,  12.333333333333332 ,  12.466666666666665 ,  12.600000000000001 ,  12.2               ,  12.333333333333332 ,  12.466666666666665 ,  12.600000000000001 ,  21.506666666666668 ,  21.746666666666663 ,  21.986666666666668 ,  22.226666666666667 ,  21.506666666666668 ,  21.746666666666663 ,  21.986666666666668 ,  22.226666666666667 ,  30.156666666666663 ,  30.486666666666665 ,  30.816666666666666 ,  31.14666666666667  ,  16.939999999999998 ,  17.12              ,  17.3               ,  17.48              ,  31.956666666666663 ,  32.28666666666667  ,  32.61666666666667  ,  32.946666666666665 ,  23.666666666666664 ,  23.906666666666663 ,  24.146666666666665 ,  24.38666666666667  ,  23.666666666666664 ,  23.906666666666663 ,  24.146666666666665 ,  24.38666666666667  ,  21.506666666666668 ,  21.746666666666663 ,  21.986666666666668 ,  22.226666666666667 ,  21.506666666666668 ,  21.746666666666663 ,  21.986666666666668 ,  22.226666666666667 ,  30.156666666666663 ,  30.486666666666665 ,  30.816666666666666 ,  31.14666666666667  ,  16.939999999999998 ,  17.12              ,  17.3               ,  17.48              ,  31.956666666666663 ,  32.28666666666667  ,  32.61666666666667  ,  32.946666666666665 ,  23.666666666666664 ,  23.906666666666663 ,  24.146666666666665 ,  24.38666666666667  ,  23.666666666666664 ,  23.906666666666663 ,  24.146666666666665 ,  24.38666666666667  ,  33.72              ,  34.06666666666666  ,  34.413333333333334 ,  34.76              ,  33.72              ,  34.06666666666666  ,  34.413333333333334 ,  34.76              ,  47.209999999999994 ,  47.68666666666667  ,  48.163333333333334 ,  48.64              ,  26.459999999999997 ,  26.72              ,  26.980000000000004 ,  27.240000000000002 ,  49.809999999999995 ,  50.28666666666667  ,  50.763333333333335 ,  51.239999999999995 ,  36.839999999999996 ,  37.18666666666666  ,  37.53333333333333  ,  37.88              ,  36.839999999999996 ,  37.18666666666666  ,  37.53333333333333  ,  37.88              ,  22.72              ,  22.93333333333333  ,  23.14666666666667  ,  23.360000000000003 ,  22.72              ,  22.93333333333333  ,  23.14666666666667  ,  23.360000000000003 ,  31.76              ,  32.053333333333335 ,  32.34666666666667  ,  32.64              ,  17.759999999999998 ,  17.919999999999998 ,  18.08              ,  18.240000000000002 ,  33.36              ,  33.65333333333333  ,  33.94666666666667  ,  34.24              ,  24.64              ,  24.85333333333333  ,  25.06666666666667  ,  25.28              ,  24.64              ,  24.85333333333333  ,  25.06666666666667  ,  25.28              ,  36.64              ,  36.959999999999994 ,  37.28              ,  37.6               ,  36.64              ,  36.959999999999994 ,  37.28              ,  37.6               ,  51.16              ,  51.6               ,  52.040000000000006 ,  52.48              ,  28.56              ,  28.799999999999997 ,  29.04              ,  29.280000000000005 ,  53.559999999999995 ,  54.                ,  54.440000000000005 ,  54.88              ,  39.52              ,  39.839999999999996 ,  40.160000000000004 ,  40.480000000000004 ,  39.52              ,  39.839999999999996 ,  40.160000000000004 ,  40.480000000000004 ,  26.133333333333333 ,  26.346666666666664 ,  26.559999999999995 ,  26.773333333333337 ,  26.133333333333333 ,  26.346666666666664 ,  26.559999999999995 ,  26.773333333333337 ,  36.45333333333333  ,  36.74666666666667  ,  37.04              ,  37.333333333333336 ,  20.32              ,  20.48              ,  20.64              ,  20.8               ,  38.053333333333335 ,  38.346666666666664 ,  38.64              ,  38.93333333333334  ,  28.053333333333335 ,  28.266666666666666 ,  28.479999999999997 ,  28.693333333333335 ,  28.053333333333335 ,  28.266666666666666 ,  28.479999999999997 ,  28.693333333333335 ,  52.17777777777778  ,  52.568888888888885 ,  52.959999999999994 ,  53.351111111111116 ,  52.17777777777778  ,  52.568888888888885 ,  52.959999999999994 ,  53.351111111111116 ,  72.69777777777779  ,  73.23555555555555  ,  73.77333333333333  ,  74.31111111111112  ,  40.45333333333333  ,  40.74666666666667  ,  41.04              ,  41.333333333333336 ,  75.63111111111111  ,  76.16888888888889  ,  76.70666666666666  ,  77.24444444444444  ,  55.69777777777777  ,  56.08888888888889  ,  56.48              ,  56.87111111111111  ,  55.69777777777777  ,  56.08888888888889  ,  56.48              ,  56.87111111111111  ,  39.96444444444444  ,  40.248888888888885 ,  40.53333333333333  ,  40.81777777777778  ,  39.96444444444444  ,  40.248888888888885 ,  40.53333333333333  ,  40.81777777777778  ,  55.644444444444446 ,  56.035555555555554 ,  56.42666666666667  ,  56.81777777777778  ,  30.933333333333334 ,  31.14666666666667  ,  31.36              ,  31.57333333333333  ,  57.77777777777778  ,  58.16888888888889  ,  58.559999999999995 ,  58.95111111111111  ,  42.52444444444444  ,  42.80888888888889  ,  43.093333333333334 ,  43.37777777777778  ,  42.52444444444444  ,  42.80888888888889  ,  43.093333333333334 ,  43.37777777777778  ,  39.96444444444444  ,  40.248888888888885 ,  40.53333333333333  ,  40.81777777777778  ,  39.96444444444444  ,  40.248888888888885 ,  40.53333333333333  ,  40.81777777777778  ,  55.644444444444446 ,  56.035555555555554 ,  56.42666666666667  ,  56.81777777777778  ,  30.933333333333334 ,  31.14666666666667  ,  31.36              ,  31.57333333333333  ,  57.77777777777778  ,  58.16888888888889  ,  58.559999999999995 ,  58.95111111111111  ,  42.52444444444444  ,  42.80888888888889  ,  43.093333333333334 ,  43.37777777777778  ,  42.52444444444444  ,  42.80888888888889  ,  43.093333333333334 ,  43.37777777777778  ,  21.666666666666664 ,  21.8               ,  21.93333333333333  ,  22.066666666666666 ,  21.666666666666664 ,  21.8               ,  21.93333333333333  ,  22.066666666666666 ,  30.116666666666667 ,  30.3               ,  30.48333333333333  ,  30.666666666666664 ,  16.700000000000003 ,  16.8               ,  16.9               ,  17.                ,  31.116666666666667 ,  31.3               ,  31.48333333333333  ,  31.666666666666664 ,  22.866666666666667 ,  23.                ,  23.133333333333333 ,  23.266666666666666 ,  22.866666666666667 ,  23.                ,  23.133333333333333 ,  23.266666666666666 ,  40.70666666666667  ,  40.94666666666667  ,  41.18666666666666  ,  41.42666666666666  ,  40.70666666666667  ,  40.94666666666667  ,  41.18666666666666  ,  41.42666666666666  ,  56.55666666666667  ,  56.88666666666667  ,  57.21666666666667  ,  57.54666666666667  ,  31.340000000000003 ,  31.520000000000003 ,  31.7               ,  31.88              ,  58.35666666666667  ,  58.68666666666666  ,  59.016666666666666 ,  59.346666666666664 ,  42.86666666666667  ,  43.10666666666667  ,  43.346666666666664 ,  43.586666666666666 ,  42.86666666666667  ,  43.10666666666667  ,  43.346666666666664 ,  43.586666666666666 ,  40.70666666666667  ,  40.94666666666667  ,  41.18666666666666  ,  41.42666666666666  ,  40.70666666666667  ,  40.94666666666667  ,  41.18666666666666  ,  41.42666666666666  ,  56.55666666666667  ,  56.88666666666667  ,  57.21666666666667  ,  57.54666666666667  ,  31.340000000000003 ,  31.520000000000003 ,  31.7               ,  31.88              ,  58.35666666666667  ,  58.68666666666666  ,  59.016666666666666 ,  59.346666666666664 ,  42.86666666666667  ,  43.10666666666667  ,  43.346666666666664 ,  43.586666666666666 ,  42.86666666666667  ,  43.10666666666667  ,  43.346666666666664 ,  43.586666666666666 ,  61.45333333333334  ,  61.80000000000001  ,  62.14666666666666  ,  62.493333333333325 ,  61.45333333333334  ,  61.80000000000001  ,  62.14666666666666  ,  62.493333333333325 ,  85.34333333333335  ,  85.82000000000001  ,  86.29666666666667  ,  86.77333333333333  ,  47.260000000000005 ,  47.52              ,  47.78              ,  48.03999999999999  ,  87.94333333333334  ,  88.41999999999999  ,  88.89666666666666  ,  89.37333333333333  ,  64.57333333333334  ,  64.92              ,  65.26666666666667  ,  65.61333333333334  ,  64.57333333333334  ,  64.92              ,  65.26666666666667  ,  65.61333333333334  ,  39.78666666666667  ,  40.                ,  40.21333333333333  ,  40.42666666666666  ,  39.78666666666667  ,  40.                ,  40.21333333333333  ,  40.42666666666666  ,  55.22666666666667  ,  55.52              ,  55.81333333333333  ,  56.10666666666667  ,  30.560000000000002 ,  30.72              ,  30.880000000000003 ,  31.040000000000003 ,  56.82666666666667  ,  57.12              ,  57.41333333333333  ,  57.70666666666667  ,  41.70666666666666  ,  41.92              ,  42.13333333333333  ,  42.346666666666664 ,  41.70666666666666  ,  41.92              ,  42.13333333333333  ,  42.346666666666664 ,  62.239999999999995 ,  62.56              ,  62.88              ,  63.199999999999996 ,  62.239999999999995 ,  62.56              ,  62.88              ,  63.199999999999996 ,  86.35999999999999  ,  86.80000000000001  ,  87.24              ,  87.68              ,  47.76              ,  48.                ,  48.24              ,  48.480000000000004 ,  88.76              ,  89.19999999999999  ,  89.63999999999999  ,  90.08              ,  65.11999999999999  ,  65.44              ,  65.75999999999999  ,  66.08              ,  65.11999999999999  ,  65.44              ,  65.75999999999999  ,  66.08              ,  43.2               ,  43.413333333333334 ,  43.62666666666667  ,  43.84              ,  43.2               ,  43.413333333333334 ,  43.62666666666667  ,  43.84              ,  59.919999999999995 ,  60.21333333333333  ,  60.50666666666667  ,  60.8               ,  33.120000000000005 ,  33.28              ,  33.44              ,  33.6               ,  61.52              ,  61.81333333333333  ,  62.10666666666667  ,  62.400000000000006 ,  45.12              ,  45.33333333333333  ,  45.54666666666667  ,  45.760000000000005 ,  45.12              ,  45.33333333333333  ,  45.54666666666667  ,  45.760000000000005 ,  83.46666666666667  ,  83.85777777777777  ,  84.2488888888889   ,  84.64              ,  83.46666666666667  ,  83.85777777777777  ,  84.2488888888889   ,  84.64              , 115.71999999999998  , 116.25777777777776  , 116.79555555555557  , 117.33333333333333  ,  63.92              ,  64.21333333333334  ,  64.50666666666666  ,  64.8               , 118.65333333333332  , 119.1911111111111   , 119.7288888888889   , 120.26666666666668  ,  86.98666666666666  ,  87.37777777777777  ,  87.76888888888888  ,  88.16              ,  86.98666666666666  ,  87.37777777777777  ,  87.76888888888888  ,  88.16              ,  62.72              ,  63.00444444444445  ,  63.288888888888884 ,  63.57333333333334  ,  62.72              ,  63.00444444444445  ,  63.288888888888884 ,  63.57333333333334  ,  86.93333333333334  ,  87.32444444444444  ,  87.71555555555555  ,  88.10666666666667  ,  48.                ,  48.21333333333334  ,  48.42666666666666  ,  48.64              ,  89.06666666666666  ,  89.45777777777778  ,  89.84888888888888  ,  90.24000000000001  ,  65.28              ,  65.56444444444443  ,  65.84888888888888  ,  66.13333333333333  ,  65.28              ,  65.56444444444443  ,  65.84888888888888  ,  66.13333333333333  ,  62.72              ,  63.00444444444445  ,  63.288888888888884 ,  63.57333333333334  ,  62.72              ,  63.00444444444445  ,  63.288888888888884 ,  63.57333333333334  ,  86.93333333333334  ,  87.32444444444444  ,  87.71555555555555  ,  88.10666666666667  ,  48.                ,  48.21333333333334  ,  48.42666666666666  ,  48.64              ,  89.06666666666666  ,  89.45777777777778  ,  89.84888888888888  ,  90.24000000000001  ,  65.28              ,  65.56444444444443  ,  65.84888888888888  ,  66.13333333333333  ,  65.28              ,  65.56444444444443  ,  65.84888888888888  ,  66.13333333333333  };
  const std::array<int, 4> in_shape = {{ 3, 10, 7, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  1.08               ,  1.2                ,  1.32               ,  1.44               ,  1.08               ,  1.2                ,  1.32               ,  1.44               ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  1.56               ,  1.6800000000000002 ,  1.8                ,  1.92               ,  1.56               ,  1.6800000000000002 ,  1.8                ,  1.92               ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  3.9600000000000004 ,  4.08               ,  4.2                ,  4.32               ,  3.9600000000000004 ,  4.08               ,  4.2                ,  4.32               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  4.4399999999999995 ,  4.56               ,  4.68               ,  4.8                ,  4.4399999999999995 ,  4.56               ,  4.68               ,  4.8                ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  6.84               ,  6.960000000000001  ,  7.08               ,  7.200000000000001  ,  6.84               ,  6.960000000000001  ,  7.08               ,  7.200000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  7.32               ,  7.440000000000001  ,  7.5600000000000005 ,  7.680000000000001  ,  7.32               ,  7.440000000000001  ,  7.5600000000000005 ,  7.680000000000001  ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 };
  const std::array<int, 4> in_shape = {{ 3, 10, 7, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.1625             ,  0.1625             ,  0.3125             ,  0.25               ,  0.5833333333333333 ,  0.48333333333333334,  0.48333333333333334,  0.3125             ,  0.6525             ,  0.6525             ,  1.0825             ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  0.3125             ,  0.6525             ,  0.6525             ,  1.0825             ,  0.77               ,  1.6366666666666667 ,  1.2966666666666669 ,  1.2966666666666669 ,  0.7625             ,  1.5025             ,  1.5025             ,  2.3725             ,  1.6099999999999999 ,  3.2766666666666664 ,  2.536666666666667  ,  2.536666666666667  ,  0.7                ,  1.3399999999999999 ,  1.3399999999999999 ,  2.06               ,  1.36               ,  2.6933333333333334 ,  2.0533333333333337 ,  2.0533333333333337 ,  1.35               ,  2.55               ,  2.55               ,  3.87               ,  2.52               ,  4.92               ,  3.7200000000000006 ,  3.7200000000000006 ,  1.1                ,  2.06               ,  2.06               ,  3.1                ,  2.                 ,  3.866666666666667  ,  2.9066666666666663 ,  2.9066666666666663 ,  2.5166666666666666 ,  4.676666666666667  ,  4.676666666666667  ,  6.983333333333333  ,  4.466666666666667  ,  8.555555555555557  ,  6.395555555555555  ,  6.395555555555555  ,  2.0666666666666664 ,  3.826666666666666  ,  3.826666666666666  ,  5.693333333333333  ,  3.626666666666667  ,  6.915555555555556  ,  5.155555555555555  ,  5.155555555555555  ,  2.0666666666666664 ,  3.826666666666666  ,  3.826666666666666  ,  5.693333333333333  ,  3.626666666666667  ,  6.915555555555556  ,  5.155555555555555  ,  5.155555555555555  ,  1.3125             ,  2.4125             ,  2.4125             ,  3.5625             ,  2.25               ,  4.25               ,  3.1500000000000004 ,  3.1500000000000004 ,  2.5625             ,  4.702500000000001  ,  4.702500000000001  ,  6.9325             ,  4.37               ,  8.236666666666666  ,  6.096666666666668  ,  6.096666666666668  ,  2.5625             ,  4.702500000000001  ,  4.702500000000001  ,  6.9325             ,  4.37               ,  8.236666666666666  ,  6.096666666666668  ,  6.096666666666668  ,  4.0125             ,  7.352500000000001  ,  7.352500000000001  , 10.8225             ,  6.8100000000000005 , 12.809999999999999  ,  9.47               ,  9.47               ,  2.7                ,  4.94               ,  4.94               ,  7.260000000000001  ,  4.5600000000000005 ,  8.56               ,  6.32               ,  6.32               ,  4.3500000000000005 ,  7.950000000000001  ,  7.950000000000001  , 11.67               ,  7.320000000000001  , 13.72               , 10.120000000000001  , 10.120000000000001  ,  3.1000000000000005 ,  5.660000000000001  ,  5.660000000000001  ,  8.3                ,  5.2                ,  9.733333333333334  ,  7.173333333333334  ,  7.173333333333334  ,  6.183333333333334  , 11.276666666666667  , 11.276666666666667  , 16.516666666666666  , 10.333333333333334  , 19.31111111111111   , 14.217777777777778  , 14.217777777777778  ,  4.733333333333333  ,  8.626666666666667  ,  8.626666666666667  , 12.626666666666667  ,  7.893333333333333  , 14.737777777777778  , 10.844444444444445  , 10.844444444444445  ,  4.733333333333333  ,  8.626666666666667  ,  8.626666666666667  , 12.626666666666667  ,  7.893333333333333  , 14.737777777777778  , 10.844444444444445  , 10.844444444444445  ,  2.5625             ,  4.6625             ,  4.6625             ,  6.8125             ,  4.25               ,  7.916666666666666  ,  5.816666666666666  ,  5.816666666666666  ,  4.8125             ,  8.7525             ,  8.7525             , 12.7825             ,  7.97               , 14.836666666666666  , 10.896666666666667  , 10.896666666666667  ,  4.8125             ,  8.7525             ,  8.7525             , 12.7825             ,  7.97               , 14.836666666666666  , 10.896666666666667  , 10.896666666666667  ,  7.2625             , 13.2025             , 13.2025             , 19.2725             , 12.009999999999998  , 22.343333333333334  , 16.403333333333336  , 16.403333333333336  ,  4.7                ,  8.54               ,  8.54               , 12.46               ,  7.760000000000001  , 14.426666666666668  , 10.586666666666666  , 10.586666666666666  ,  7.3500000000000005 , 13.35               , 13.35               , 19.470000000000002  , 12.120000000000001  , 22.52               , 16.52               , 16.52               ,  5.1000000000000005 ,  9.260000000000002  ,  9.260000000000002  , 13.5                ,  8.4                , 15.600000000000001  , 11.440000000000001  , 11.440000000000001  ,  9.850000000000001  , 17.87666666666667   , 17.87666666666667   , 26.05               , 16.2                , 30.06666666666667   , 22.04               , 22.04               ,  7.4                , 13.426666666666668  , 13.426666666666668  , 19.560000000000002  , 12.16               , 22.560000000000002  , 16.53333333333333   , 16.53333333333333   ,  7.4                , 13.426666666666668  , 13.426666666666668  , 19.560000000000002  , 12.16               , 22.560000000000002  , 16.53333333333333   , 16.53333333333333   };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.                , 0.04              , 0.04              , 0.12              , 0.12              , 0.12              , 0.08              , 0.08              , 0.                , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.                , 0.16              , 0.16              , 0.4               , 0.4               , 0.4               , 0.24              , 0.24              , 0.                , 0.36              , 0.36              , 0.8400000000000001, 0.8400000000000001, 0.8400000000000001, 0.48              , 0.48              , 0.                , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.                , 0.32              , 0.32              , 0.72              , 0.72              , 0.72              , 0.4               , 0.4               , 0.                , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.                , 0.2               , 0.2               , 0.44              , 0.44              , 0.44              , 0.24              , 0.24              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.28              , 0.28              , 0.6000000000000001, 0.6000000000000001, 0.6000000000000001, 0.32              , 0.32              , 0.                , 0.28              , 0.28              , 0.6000000000000001, 0.6000000000000001, 0.6000000000000001, 0.32              , 0.32              , 0.                , 0.64              , 0.64              , 1.36              , 1.36              , 1.36              , 0.72              , 0.72              , 0.                , 0.64              , 0.64              , 1.36              , 1.36              , 1.36              , 0.72              , 0.72              , 0.                , 1.08              , 1.08              , 2.2800000000000002, 2.2800000000000002, 2.2800000000000002, 1.2               , 1.2               , 0.                , 0.8               , 0.8               , 1.68              , 1.68              , 1.68              , 0.88              , 0.88              , 0.                , 0.8               , 0.8               , 1.68              , 1.68              , 1.68              , 0.88              , 0.88              , 0.                , 0.44              , 0.44              , 0.9199999999999999, 0.9199999999999999, 0.9199999999999999, 0.48              , 0.48              , 0.                , 0.44              , 0.44              , 0.9199999999999999, 0.9199999999999999, 0.9199999999999999, 0.48              , 0.48              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.52              , 0.52              , 1.08              , 1.08              , 1.08              , 0.56              , 0.56              , 0.                , 0.52              , 0.52              , 1.08              , 1.08              , 1.08              , 0.56              , 0.56              , 0.                , 1.12              , 1.12              , 2.3200000000000003, 2.3200000000000003, 2.3200000000000003, 1.2000000000000002, 1.2000000000000002, 0.                , 1.12              , 1.12              , 2.3200000000000003, 2.3200000000000003, 2.3200000000000003, 1.2000000000000002, 1.2000000000000002, 0.                , 1.8000000000000003, 1.8000000000000003, 3.7200000000000006, 3.7200000000000006, 3.7200000000000006, 1.9200000000000002, 1.9200000000000002, 0.                , 1.28              , 1.28              , 2.6399999999999997, 2.6399999999999997, 2.6399999999999997, 1.3599999999999999, 1.3599999999999999, 0.                , 1.28              , 1.28              , 2.6399999999999997, 2.6399999999999997, 2.6399999999999997, 1.3599999999999999, 1.3599999999999999, 0.                , 0.68              , 0.68              , 1.4               , 1.4               , 1.4               , 0.72              , 0.72              , 0.                , 0.68              , 0.68              , 1.4               , 1.4               , 1.4               , 0.72              , 0.72              , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                , 0.                };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.9833333333333333 ,  1.1666666666666665 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.8333333333333333 ,  0.9666666666666667 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  0.5125             ,  0.625              ,  1.1025             ,  1.305              ,  1.1025             ,  1.305              ,  1.8725             ,  2.165              ,  1.36               ,  1.54               ,  2.9433333333333334 ,  3.2733333333333334 ,  2.3533333333333335 ,  2.5933333333333337 ,  2.3533333333333335 ,  2.5933333333333337 ,  1.3625             ,  1.525              ,  2.7125000000000004 ,  3.005              ,  2.7125000000000004 ,  3.005              ,  4.3225             ,  4.745              ,  2.96               ,  3.2199999999999998 ,  6.076666666666666  ,  6.553333333333333  ,  4.726666666666667  ,  5.073333333333334  ,  4.726666666666667  ,  5.073333333333334  ,  1.3                ,  1.4                ,  2.5                ,  2.6799999999999997 ,  2.5                ,  2.6799999999999997 ,  3.8600000000000003 ,  4.12               ,  2.56               ,  2.72               ,  5.093333333333333  ,  5.386666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  3.893333333333333  ,  4.106666666666667  ,  2.55               ,  2.7                ,  4.83               ,  5.1                ,  4.83               ,  5.1                ,  7.3500000000000005 ,  7.74               ,  4.8                ,  5.04               ,  9.399999999999999  ,  9.84               ,  7.119999999999999  ,  7.440000000000001  ,  7.119999999999999  ,  7.440000000000001  ,  2.1                ,  2.2                ,  3.9400000000000004 ,  4.12               ,  3.9400000000000004 ,  4.12               ,  5.94               ,  6.2                ,  3.84               ,  4.                 ,  7.4399999999999995 ,  7.733333333333334  ,  5.6                ,  5.813333333333333  ,  5.6                ,  5.813333333333333  ,  4.85               ,  5.033333333333333  ,  9.023333333333333  ,  9.353333333333333  ,  9.023333333333333  ,  9.353333333333333  , 13.490000000000002  , 13.966666666666667  ,  8.64               ,  8.933333333333334  , 16.573333333333334  , 17.111111111111114  , 12.399999999999999  , 12.79111111111111   , 12.399999999999999  , 12.79111111111111   ,  4.                 ,  4.133333333333333  ,  7.413333333333334  ,  7.653333333333332  ,  7.413333333333334  ,  7.653333333333332  , 11.040000000000001  , 11.386666666666667  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   ,  4.                 ,  4.133333333333333  ,  7.413333333333334  ,  7.653333333333332  ,  7.413333333333334  ,  7.653333333333332  , 11.040000000000001  , 11.386666666666667  ,  7.040000000000001  ,  7.253333333333334  , 13.440000000000001  , 13.831111111111111  , 10.026666666666667  , 10.31111111111111   , 10.026666666666667  , 10.31111111111111   ,  2.5625             ,  2.625              ,  4.7125             ,  4.825              ,  4.7125             ,  4.825              ,  6.9625             ,  7.125              ,  4.4                ,  4.5                ,  8.316666666666666  ,  8.5                ,  6.166666666666666  ,  6.300000000000001  ,  6.166666666666666  ,  6.300000000000001  ,  5.0125             ,  5.125              ,  9.2025             ,  9.405000000000001  ,  9.2025             ,  9.405000000000001  , 13.572500000000002  , 13.865              ,  8.56               ,  8.74               , 16.143333333333334  , 16.473333333333333  , 11.953333333333331  , 12.193333333333335  , 11.953333333333331  , 12.193333333333335  ,  5.0125             ,  5.125              ,  9.2025             ,  9.405000000000001  ,  9.2025             ,  9.405000000000001  , 13.572500000000002  , 13.865              ,  8.56               ,  8.74               , 16.143333333333334  , 16.473333333333333  , 11.953333333333331  , 12.193333333333335  , 11.953333333333331  , 12.193333333333335  ,  7.862500000000001  ,  8.025              , 14.4125             , 14.705000000000002  , 14.4125             , 14.705000000000002  , 21.222500000000004  , 21.645              , 13.36               , 13.620000000000001  , 25.143333333333334  , 25.619999999999997  , 18.59333333333333   , 18.94               , 18.59333333333333   , 18.94               ,  5.300000000000001  ,  5.4                ,  9.7                ,  9.88               ,  9.7                ,  9.88               , 14.26               , 14.520000000000001  ,  8.959999999999999  ,  9.120000000000001  , 16.826666666666664  , 17.12               , 12.426666666666666  , 12.64               , 12.426666666666666  , 12.64               ,  8.55               ,  8.700000000000001  , 15.629999999999999  , 15.900000000000002  , 15.629999999999999  , 15.900000000000002  , 22.95               , 23.34               , 14.399999999999999  , 14.640000000000002  , 27.                 , 27.44               , 19.919999999999998  , 20.240000000000002  , 19.919999999999998  , 20.240000000000002  ,  6.1                ,  6.200000000000001  , 11.14               , 11.320000000000002  , 11.14               , 11.320000000000002  , 16.34               , 16.6                , 10.24               , 10.4                , 19.173333333333332  , 19.46666666666667   , 14.133333333333333  , 14.346666666666668  , 14.133333333333333  , 14.346666666666668  , 12.183333333333334  , 12.366666666666667  , 22.223333333333333  , 22.553333333333335  , 22.223333333333333  , 22.553333333333335  , 32.556666666666665  , 33.03333333333333   , 20.373333333333335  , 20.666666666666668  , 38.08444444444444   , 38.62222222222222   , 28.044444444444444  , 28.435555555555556  , 28.044444444444444  , 28.435555555555556  ,  9.333333333333332  ,  9.466666666666667  , 17.013333333333332  , 17.253333333333334  , 17.013333333333332  , 17.253333333333334  , 24.906666666666666  , 25.253333333333334  , 15.573333333333334  , 15.786666666666665  , 29.084444444444443  , 29.475555555555555  , 21.404444444444444  , 21.68888888888889   , 21.404444444444444  , 21.68888888888889   ,  9.333333333333332  ,  9.466666666666667  , 17.013333333333332  , 17.253333333333334  , 17.013333333333332  , 17.253333333333334  , 24.906666666666666  , 25.253333333333334  , 15.573333333333334  , 15.786666666666665  , 29.084444444444443  , 29.475555555555555  , 21.404444444444444  , 21.68888888888889   , 21.404444444444444  , 21.68888888888889   ,  5.0625             ,  5.125              ,  9.2125             ,  9.325              ,  9.2125             ,  9.325              , 13.4625             , 13.625              ,  8.4                ,  8.5                , 15.65               , 15.833333333333332  , 11.5                , 11.633333333333333  , 11.5                , 11.633333333333333  ,  9.5125             ,  9.625              , 17.302500000000002  , 17.505              , 17.302500000000002  , 17.505              , 25.2725             , 25.565              , 15.760000000000002  , 15.94               , 29.34333333333333   , 29.673333333333332  , 21.553333333333335  , 21.793333333333333  , 21.553333333333335  , 21.793333333333333  ,  9.5125             ,  9.625              , 17.302500000000002  , 17.505              , 17.302500000000002  , 17.505              , 25.2725             , 25.565              , 15.760000000000002  , 15.94               , 29.34333333333333   , 29.673333333333332  , 21.553333333333335  , 21.793333333333333  , 21.553333333333335  , 21.793333333333333  , 14.3625             , 14.525              , 26.112500000000004  , 26.405              , 26.112500000000004  , 26.405              , 38.1225             , 38.545              , 23.76               , 24.019999999999996  , 44.209999999999994  , 44.68666666666667   , 32.46               , 32.80666666666667   , 32.46               , 32.80666666666667   ,  9.3                ,  9.4                , 16.900000000000002  , 17.08               , 16.900000000000002  , 17.08               , 24.66               , 24.92               , 15.36               , 15.520000000000001  , 28.56               , 28.853333333333335  , 20.96               , 21.173333333333332  , 20.96               , 21.173333333333332  , 14.55               , 14.700000000000001  , 26.430000000000003  , 26.7                , 26.430000000000003  , 26.7                , 38.55               , 38.940000000000005  , 24.                 , 24.240000000000002  , 44.599999999999994  , 45.04               , 32.72               , 33.04               , 32.72               , 33.04               , 10.100000000000001  , 10.200000000000001  , 18.34               , 18.520000000000003  , 18.34               , 18.520000000000003  , 26.740000000000002  , 27.                 , 16.64               , 16.8                , 30.906666666666666  , 31.200000000000003  , 22.666666666666664  , 22.880000000000003  , 22.666666666666664  , 22.880000000000003  , 19.516666666666666  , 19.700000000000003  , 35.42333333333333   , 35.75333333333334   , 35.42333333333333   , 35.75333333333334   , 51.62333333333333   , 52.1                , 32.10666666666667   , 32.4                , 59.59555555555555   , 60.13333333333334   , 43.68888888888888   , 44.08               , 43.68888888888888   , 44.08               , 14.666666666666666  , 14.8                , 26.613333333333333  , 26.853333333333335  , 26.613333333333333  , 26.853333333333335  , 38.77333333333333   , 39.120000000000005  , 24.10666666666667   , 24.32               , 44.72888888888889   , 45.120000000000005  , 32.78222222222222   , 33.06666666666666   , 32.78222222222222   , 33.06666666666666   , 14.666666666666666  , 14.8                , 26.613333333333333  , 26.853333333333335  , 26.613333333333333  , 26.853333333333335  , 38.77333333333333   , 39.120000000000005  , 24.10666666666667   , 24.32               , 44.72888888888889   , 45.120000000000005  , 32.78222222222222   , 33.06666666666666   , 32.78222222222222   , 33.06666666666666   };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.04               , 0.08               , 0.04               , 0.08               , 0.16               , 0.24               , 0.16               , 0.24               , 0.16               , 0.24               , 0.12               , 0.16               , 0.12               , 0.16               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.24000000000000002, 0.32               , 0.24000000000000002, 0.32               , 0.64               , 0.8                , 0.64               , 0.8                , 0.64               , 0.8                , 0.4                , 0.48               , 0.4                , 0.48               , 0.                 , 0.                 , 0.6                , 0.72               , 0.6                , 0.72               , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 1.44               , 1.6800000000000002 , 0.8400000000000001 , 0.96               , 0.8400000000000001 , 0.96               , 0.                 , 0.                 , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.                 , 0.                 , 0.56               , 0.64               , 0.56               , 0.64               , 1.28               , 1.44               , 1.28               , 1.44               , 1.28               , 1.44               , 0.72               , 0.8                , 0.72               , 0.8                , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.36               , 0.4                , 0.36               , 0.4                , 0.8                , 0.88               , 0.8                , 0.88               , 0.8                , 0.88               , 0.44               , 0.48               , 0.44               , 0.48               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 0.52               , 0.56               , 0.52               , 0.56               , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 1.12               , 1.2000000000000002 , 0.6                , 0.64               , 0.6                , 0.64               , 0.                 , 0.                 , 1.2000000000000002 , 1.28               , 1.2000000000000002 , 1.28               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 1.3599999999999999 , 1.44               , 1.3599999999999999 , 1.44               , 0.                 , 0.                 , 1.2000000000000002 , 1.28               , 1.2000000000000002 , 1.28               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 2.5600000000000005 , 2.72               , 1.3599999999999999 , 1.44               , 1.3599999999999999 , 1.44               , 0.                 , 0.                 , 2.04               , 2.16               , 2.04               , 2.16               , 4.32               , 4.5600000000000005 , 4.32               , 4.5600000000000005 , 4.32               , 4.5600000000000005 , 2.28               , 2.4                , 2.28               , 2.4                , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 1.52               , 1.6                , 1.52               , 1.6                , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 3.1999999999999997 , 3.36               , 1.6800000000000002 , 1.76               , 1.6800000000000002 , 1.76               , 0.                 , 0.                 , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.84               , 0.88               , 0.84               , 0.88               , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 1.76               , 1.8399999999999999 , 0.92               , 0.96               , 0.92               , 0.96               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 1.                 , 1.04               , 1.                 , 1.04               , 2.08               , 2.16               , 2.08               , 2.16               , 2.08               , 2.16               , 1.08               , 1.12               , 1.08               , 1.12               , 0.                 , 0.                 , 1.                 , 1.04               , 1.                 , 1.04               , 2.08               , 2.16               , 2.08               , 2.16               , 2.08               , 2.16               , 1.08               , 1.12               , 1.08               , 1.12               , 0.                 , 0.                 , 2.16               , 2.24               , 2.16               , 2.24               , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 2.3200000000000003 , 2.4000000000000004 , 2.3200000000000003 , 2.4000000000000004 , 0.                 , 0.                 , 2.16               , 2.24               , 2.16               , 2.24               , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 4.48               , 4.640000000000001  , 2.3200000000000003 , 2.4000000000000004 , 2.3200000000000003 , 2.4000000000000004 , 0.                 , 0.                 , 3.4800000000000004 , 3.6000000000000005 , 3.4800000000000004 , 3.6000000000000005 , 7.200000000000001  , 7.440000000000001  , 7.200000000000001  , 7.440000000000001  , 7.200000000000001  , 7.440000000000001  , 3.7200000000000006 , 3.8400000000000003 , 3.7200000000000006 , 3.8400000000000003 , 0.                 , 0.                 , 2.48               , 2.56               , 2.48               , 2.56               , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 2.64               , 2.7199999999999998 , 2.64               , 2.7199999999999998 , 0.                 , 0.                 , 2.48               , 2.56               , 2.48               , 2.56               , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 5.12               , 5.279999999999999  , 2.64               , 2.7199999999999998 , 2.64               , 2.7199999999999998 , 0.                 , 0.                 , 1.32               , 1.36               , 1.32               , 1.36               , 2.72               , 2.8                , 2.72               , 2.8                , 2.72               , 2.8                , 1.4000000000000001 , 1.44               , 1.4000000000000001 , 1.44               , 0.                 , 0.                 , 1.32               , 1.36               , 1.32               , 1.36               , 2.72               , 2.8                , 2.72               , 2.8                , 2.72               , 2.8                , 1.4000000000000001 , 1.44               , 1.4000000000000001 , 1.44               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  0.0625             ,   0.125              ,   0.1875             ,   0.25               ,   0.3125             ,   0.42500000000000004,   0.5375000000000001 ,   0.65               ,   0.3125             ,   0.42500000000000004,   0.5375000000000001 ,   0.65               ,   0.7625             ,   0.925              ,   1.0875000000000001 ,   1.25               ,   0.7                ,   0.8                ,   0.9000000000000001 ,   1.                 ,   1.7833333333333332 ,   1.9666666666666666 ,   2.1500000000000004 ,   2.333333333333333  ,   1.5333333333333332 ,   1.6666666666666665 ,   1.8                ,   1.9333333333333333 ,   1.5333333333333332 ,   1.6666666666666665 ,   1.8                ,   1.9333333333333333 ,   0.9125000000000001 ,   1.025              ,   1.1375000000000002 ,   1.25               ,   2.0025             ,   2.205              ,   2.4075             ,   2.61               ,   2.0025             ,   2.205              ,   2.4075             ,   2.61               ,   3.4525             ,   3.745              ,   4.0375             ,   4.33               ,   2.54               ,   2.72               ,   2.9000000000000004 ,   3.08               ,   5.556666666666667  ,   5.886666666666667  ,   6.216666666666667  ,   6.546666666666667  ,   4.466666666666667  ,   4.706666666666667  ,   4.946666666666666  ,   5.186666666666667  ,   4.466666666666667  ,   4.706666666666667  ,   4.946666666666666  ,   5.186666666666667  ,   0.9125000000000001 ,   1.025              ,   1.1375000000000002 ,   1.25               ,   2.0025             ,   2.205              ,   2.4075             ,   2.61               ,   2.0025             ,   2.205              ,   2.4075             ,   2.61               ,   3.4525             ,   3.745              ,   4.0375             ,   4.33               ,   2.54               ,   2.72               ,   2.9000000000000004 ,   3.08               ,   5.556666666666667  ,   5.886666666666667  ,   6.216666666666667  ,   6.546666666666667  ,   4.466666666666667  ,   4.706666666666667  ,   4.946666666666666  ,   5.186666666666667  ,   4.466666666666667  ,   4.706666666666667  ,   4.946666666666666  ,   5.186666666666667  ,   2.5625             ,   2.725              ,   2.8875             ,   3.05               ,   5.1325             ,   5.425000000000001  ,   5.717500000000001  ,   6.01               ,   5.1325             ,   5.425000000000001  ,   5.717500000000001  ,   6.01               ,   8.2225             ,   8.645              ,   9.0675             ,   9.49               ,   5.66               ,   5.92               ,   6.180000000000001  ,   6.4399999999999995 ,  11.676666666666668  ,  12.153333333333332  ,  12.63               ,  13.106666666666666  ,   9.106666666666667  ,   9.453333333333333  ,   9.799999999999999  ,  10.146666666666668  ,   9.106666666666667  ,   9.453333333333333  ,   9.799999999999999  ,  10.146666666666668  ,   2.5                ,   2.6                ,   2.7                ,   2.8                ,   4.82               ,   5.                 ,   5.18               ,   5.359999999999999  ,   4.82               ,   5.                 ,   5.18               ,   5.359999999999999  ,   7.460000000000001  ,   7.720000000000001  ,   7.9799999999999995 ,   8.24               ,   4.96               ,   5.12               ,   5.28               ,   5.44               ,   9.893333333333334  ,  10.186666666666666  ,  10.48               ,  10.773333333333333  ,   7.573333333333334  ,   7.786666666666666  ,   8.                 ,   8.213333333333335  ,   7.573333333333334  ,   7.786666666666666  ,   8.                 ,   8.213333333333335  ,   4.95               ,   5.1                ,   5.25               ,   5.4                ,   9.39               ,   9.66               ,   9.93               ,  10.2                ,   9.39               ,   9.66               ,   9.93               ,  10.2                ,  14.310000000000002  ,  14.700000000000001  ,  15.09               ,  15.48               ,   9.36               ,   9.6                ,   9.84               ,  10.08               ,  18.360000000000003  ,  18.799999999999997  ,  19.24               ,  19.68               ,  13.920000000000002  ,  14.239999999999998  ,  14.559999999999999  ,  14.880000000000003  ,  13.920000000000002  ,  14.239999999999998  ,  14.559999999999999  ,  14.880000000000003  ,   4.1000000000000005 ,   4.2                ,   4.300000000000001  ,   4.4                ,   7.7                ,   7.880000000000001  ,   8.06               ,   8.24               ,   7.7                ,   7.880000000000001  ,   8.06               ,   8.24               ,  11.620000000000001  ,  11.88               ,  12.14               ,  12.4                ,   7.5200000000000005 ,   7.68               ,   7.84               ,   8.                 ,  14.586666666666666  ,  14.879999999999999  ,  15.173333333333332  ,  15.466666666666669  ,  10.986666666666668  ,  11.2                ,  11.413333333333334  ,  11.626666666666665  ,  10.986666666666668  ,  11.2                ,  11.413333333333334  ,  11.626666666666665  ,   9.516666666666666  ,   9.7                ,   9.883333333333333  ,  10.066666666666666  ,  17.71666666666667   ,  18.046666666666667  ,  18.37666666666667   ,  18.706666666666667  ,  17.71666666666667   ,  18.046666666666667  ,  18.37666666666667   ,  18.706666666666667  ,  26.503333333333337  ,  26.980000000000004  ,  27.456666666666667  ,  27.933333333333334  ,  16.986666666666668  ,  17.28               ,  17.573333333333334  ,  17.866666666666667  ,  32.60888888888889   ,  33.14666666666667   ,  33.684444444444445  ,  34.22222222222223   ,  24.40888888888889   ,  24.799999999999997  ,  25.191111111111113  ,  25.58222222222222   ,  24.40888888888889   ,  24.799999999999997  ,  25.191111111111113  ,  25.58222222222222   ,   7.866666666666666  ,   8.                 ,   8.133333333333333  ,   8.266666666666666  ,  14.586666666666666  ,  14.826666666666668  ,  15.066666666666666  ,  15.306666666666665  ,  14.586666666666666  ,  14.826666666666668  ,  15.066666666666666  ,  15.306666666666665  ,  21.733333333333334  ,  22.080000000000002  ,  22.426666666666666  ,  22.773333333333333  ,  13.866666666666667  ,  14.080000000000002  ,  14.293333333333333  ,  14.506666666666668  ,  26.488888888888887  ,  26.880000000000003  ,  27.27111111111111   ,  27.662222222222223  ,  19.76888888888889   ,  20.053333333333335  ,  20.337777777777777  ,  20.62222222222222   ,  19.76888888888889   ,  20.053333333333335  ,  20.337777777777777  ,  20.62222222222222   ,   7.866666666666666  ,   8.                 ,   8.133333333333333  ,   8.266666666666666  ,  14.586666666666666  ,  14.826666666666668  ,  15.066666666666666  ,  15.306666666666665  ,  14.586666666666666  ,  14.826666666666668  ,  15.066666666666666  ,  15.306666666666665  ,  21.733333333333334  ,  22.080000000000002  ,  22.426666666666666  ,  22.773333333333333  ,  13.866666666666667  ,  14.080000000000002  ,  14.293333333333333  ,  14.506666666666668  ,  26.488888888888887  ,  26.880000000000003  ,  27.27111111111111   ,  27.662222222222223  ,  19.76888888888889   ,  20.053333333333335  ,  20.337777777777777  ,  20.62222222222222   ,  19.76888888888889   ,  20.053333333333335  ,  20.337777777777777  ,  20.62222222222222   ,   5.0625             ,   5.125              ,   5.1875             ,   5.25               ,   9.3125             ,   9.425              ,   9.537500000000001  ,   9.65               ,   9.3125             ,   9.425              ,   9.537500000000001  ,   9.65               ,  13.7625             ,  13.925              ,  14.087500000000002  ,  14.25               ,   8.7                ,   8.8                ,   8.9                ,   9.                 ,  16.45               ,  16.633333333333333  ,  16.816666666666666  ,  17.                 ,  12.2                ,  12.333333333333332  ,  12.466666666666665  ,  12.600000000000001  ,  12.2                ,  12.333333333333332  ,  12.466666666666665  ,  12.600000000000001  ,   9.912500000000001  ,  10.025              ,  10.1375             ,  10.25               ,  18.2025             ,  18.405              ,  18.6075             ,  18.810000000000002  ,  18.2025             ,  18.405              ,  18.6075             ,  18.810000000000002  ,  26.8525             ,  27.145000000000003  ,  27.437500000000004  ,  27.73               ,  16.939999999999998  ,  17.12               ,  17.3                ,  17.48               ,  31.956666666666663  ,  32.28666666666667   ,  32.61666666666667   ,  32.946666666666665  ,  23.666666666666664  ,  23.906666666666663  ,  24.146666666666665  ,  24.38666666666667   ,  23.666666666666664  ,  23.906666666666663  ,  24.146666666666665  ,  24.38666666666667   ,   9.912500000000001  ,  10.025              ,  10.1375             ,  10.25               ,  18.2025             ,  18.405              ,  18.6075             ,  18.810000000000002  ,  18.2025             ,  18.405              ,  18.6075             ,  18.810000000000002  ,  26.8525             ,  27.145000000000003  ,  27.437500000000004  ,  27.73               ,  16.939999999999998  ,  17.12               ,  17.3                ,  17.48               ,  31.956666666666663  ,  32.28666666666667   ,  32.61666666666667   ,  32.946666666666665  ,  23.666666666666664  ,  23.906666666666663  ,  24.146666666666665  ,  24.38666666666667   ,  23.666666666666664  ,  23.906666666666663  ,  24.146666666666665  ,  24.38666666666667   ,  15.562500000000002  ,  15.725000000000001  ,  15.8875             ,  16.05               ,  28.5325             ,  28.825              ,  29.1175             ,  29.410000000000004  ,  28.5325             ,  28.825              ,  29.1175             ,  29.410000000000004  ,  42.022499999999994  ,  42.44500000000001   ,  42.8675             ,  43.29               ,  26.459999999999997  ,  26.72               ,  26.980000000000004  ,  27.240000000000002  ,  49.809999999999995  ,  50.28666666666667   ,  50.763333333333335  ,  51.239999999999995  ,  36.839999999999996  ,  37.18666666666666   ,  37.53333333333333   ,  37.88               ,  36.839999999999996  ,  37.18666666666666   ,  37.53333333333333   ,  37.88               ,  10.5                ,  10.600000000000001  ,  10.7                ,  10.8                ,  19.22               ,  19.4                ,  19.58               ,  19.76               ,  19.22               ,  19.4                ,  19.58               ,  19.76               ,  28.26               ,  28.52               ,  28.78               ,  29.040000000000003  ,  17.759999999999998  ,  17.919999999999998  ,  18.08               ,  18.240000000000002  ,  33.36               ,  33.65333333333333   ,  33.94666666666667   ,  34.24               ,  24.64               ,  24.85333333333333   ,  25.06666666666667   ,  25.28               ,  24.64               ,  24.85333333333333   ,  25.06666666666667   ,  25.28               ,  16.95               ,  17.1                ,  17.25               ,  17.400000000000002  ,  30.99               ,  31.259999999999998  ,  31.53               ,  31.800000000000004  ,  30.99               ,  31.259999999999998  ,  31.53               ,  31.800000000000004  ,  45.510000000000005  ,  45.9                ,  46.29               ,  46.68               ,  28.56               ,  28.799999999999997  ,  29.04               ,  29.280000000000005  ,  53.559999999999995  ,  54.                 ,  54.440000000000005  ,  54.88               ,  39.52               ,  39.839999999999996  ,  40.160000000000004  ,  40.480000000000004  ,  39.52               ,  39.839999999999996  ,  40.160000000000004  ,  40.480000000000004  ,  12.100000000000001  ,  12.2                ,  12.3                ,  12.400000000000002  ,  22.1                ,  22.28               ,  22.46               ,  22.640000000000004  ,  22.1                ,  22.28               ,  22.46               ,  22.640000000000004  ,  32.42               ,  32.68               ,  32.940000000000005  ,  33.2                ,  20.32               ,  20.48               ,  20.64               ,  20.8                ,  38.053333333333335  ,  38.346666666666664  ,  38.64               ,  38.93333333333334   ,  28.053333333333335  ,  28.266666666666666  ,  28.479999999999997  ,  28.693333333333335  ,  28.053333333333335  ,  28.266666666666666  ,  28.479999999999997  ,  28.693333333333335  ,  24.183333333333334  ,  24.366666666666667  ,  24.55               ,  24.733333333333334  ,  44.116666666666674  ,  44.446666666666665  ,  44.77666666666667   ,  45.10666666666667   ,  44.116666666666674  ,  44.446666666666665  ,  44.77666666666667   ,  45.10666666666667   ,  64.63666666666667   ,  65.11333333333333   ,  65.59               ,  66.06666666666666   ,  40.45333333333333   ,  40.74666666666667   ,  41.04               ,  41.333333333333336  ,  75.63111111111111   ,  76.16888888888889   ,  76.70666666666666   ,  77.24444444444444   ,  55.69777777777777   ,  56.08888888888889   ,  56.48               ,  56.87111111111111   ,  55.69777777777777   ,  56.08888888888889   ,  56.48               ,  56.87111111111111   ,  18.53333333333333   ,  18.666666666666664  ,  18.8                ,  18.933333333333334  ,  33.78666666666666   ,  34.026666666666664  ,  34.266666666666666  ,  34.50666666666667   ,  33.78666666666666   ,  34.026666666666664  ,  34.266666666666666  ,  34.50666666666667   ,  49.46666666666667   ,  49.81333333333333   ,  50.160000000000004  ,  50.50666666666667   ,  30.933333333333334  ,  31.14666666666667   ,  31.36               ,  31.57333333333333   ,  57.77777777777778   ,  58.16888888888889   ,  58.559999999999995  ,  58.95111111111111   ,  42.52444444444444   ,  42.80888888888889   ,  43.093333333333334  ,  43.37777777777778   ,  42.52444444444444   ,  42.80888888888889   ,  43.093333333333334  ,  43.37777777777778   ,  18.53333333333333   ,  18.666666666666664  ,  18.8                ,  18.933333333333334  ,  33.78666666666666   ,  34.026666666666664  ,  34.266666666666666  ,  34.50666666666667   ,  33.78666666666666   ,  34.026666666666664  ,  34.266666666666666  ,  34.50666666666667   ,  49.46666666666667   ,  49.81333333333333   ,  50.160000000000004  ,  50.50666666666667   ,  30.933333333333334  ,  31.14666666666667   ,  31.36               ,  31.57333333333333   ,  57.77777777777778   ,  58.16888888888889   ,  58.559999999999995  ,  58.95111111111111   ,  42.52444444444444   ,  42.80888888888889   ,  43.093333333333334  ,  43.37777777777778   ,  42.52444444444444   ,  42.80888888888889   ,  43.093333333333334  ,  43.37777777777778   ,  10.0625             ,  10.125              ,  10.1875             ,  10.25               ,  18.3125             ,  18.425              ,  18.5375             ,  18.65               ,  18.3125             ,  18.425              ,  18.5375             ,  18.65               ,  26.762500000000003  ,  26.925              ,  27.087500000000002  ,  27.25               ,  16.700000000000003  ,  16.8                ,  16.9                ,  17.                 ,  31.116666666666667  ,  31.3                ,  31.48333333333333   ,  31.666666666666664  ,  22.866666666666667  ,  23.                 ,  23.133333333333333  ,  23.266666666666666  ,  22.866666666666667  ,  23.                 ,  23.133333333333333  ,  23.266666666666666  ,  18.9125             ,  19.025              ,  19.137500000000003  ,  19.25               ,  34.4025             ,  34.605000000000004  ,  34.807500000000005  ,  35.01               ,  34.4025             ,  34.605000000000004  ,  34.807500000000005  ,  35.01               ,  50.252500000000005  ,  50.545              ,  50.837500000000006  ,  51.13               ,  31.340000000000003  ,  31.520000000000003  ,  31.7                ,  31.88               ,  58.35666666666667   ,  58.68666666666666   ,  59.016666666666666  ,  59.346666666666664  ,  42.86666666666667   ,  43.10666666666667   ,  43.346666666666664  ,  43.586666666666666  ,  42.86666666666667   ,  43.10666666666667   ,  43.346666666666664  ,  43.586666666666666  ,  18.9125             ,  19.025              ,  19.137500000000003  ,  19.25               ,  34.4025             ,  34.605000000000004  ,  34.807500000000005  ,  35.01               ,  34.4025             ,  34.605000000000004  ,  34.807500000000005  ,  35.01               ,  50.252500000000005  ,  50.545              ,  50.837500000000006  ,  51.13               ,  31.340000000000003  ,  31.520000000000003  ,  31.7                ,  31.88               ,  58.35666666666667   ,  58.68666666666666   ,  59.016666666666666  ,  59.346666666666664  ,  42.86666666666667   ,  43.10666666666667   ,  43.346666666666664  ,  43.586666666666666  ,  42.86666666666667   ,  43.10666666666667   ,  43.346666666666664  ,  43.586666666666666  ,  28.5625             ,  28.725              ,  28.887500000000003  ,  29.05               ,  51.932500000000005  ,  52.22500000000001   ,  52.517500000000005  ,  52.81               ,  51.932500000000005  ,  52.22500000000001   ,  52.517500000000005  ,  52.81               ,  75.8225             ,  76.245              ,  76.6675             ,  77.09               ,  47.260000000000005  ,  47.52               ,  47.78               ,  48.03999999999999   ,  87.94333333333334   ,  88.41999999999999   ,  88.89666666666666   ,  89.37333333333333   ,  64.57333333333334   ,  64.92               ,  65.26666666666667   ,  65.61333333333334   ,  64.57333333333334   ,  64.92               ,  65.26666666666667   ,  65.61333333333334   ,  18.5                ,  18.6                ,  18.700000000000003  ,  18.8                ,  33.620000000000005  ,  33.800000000000004  ,  33.980000000000004  ,  34.16               ,  33.620000000000005  ,  33.800000000000004  ,  33.980000000000004  ,  34.16               ,  49.06               ,  49.32               ,  49.58               ,  49.84               ,  30.560000000000002  ,  30.72               ,  30.880000000000003  ,  31.040000000000003  ,  56.82666666666667   ,  57.12               ,  57.41333333333333   ,  57.70666666666667   ,  41.70666666666666   ,  41.92               ,  42.13333333333333   ,  42.346666666666664  ,  41.70666666666666   ,  41.92               ,  42.13333333333333   ,  42.346666666666664  ,  28.950000000000003  ,  29.1                ,  29.250000000000004  ,  29.400000000000002  ,  52.59               ,  52.86000000000001   ,  53.13               ,  53.4                ,  52.59               ,  52.86000000000001   ,  53.13               ,  53.4                ,  76.71000000000001   ,  77.1                ,  77.49               ,  77.88000000000001   ,  47.76               ,  48.                 ,  48.24               ,  48.480000000000004  ,  88.76               ,  89.19999999999999   ,  89.63999999999999   ,  90.08               ,  65.11999999999999   ,  65.44               ,  65.75999999999999   ,  66.08               ,  65.11999999999999   ,  65.44               ,  65.75999999999999   ,  66.08               ,  20.1                ,  20.200000000000003  ,  20.3                ,  20.400000000000002  ,  36.5                ,  36.68               ,  36.86               ,  37.040000000000006  ,  36.5                ,  36.68               ,  36.86               ,  37.040000000000006  ,  53.220000000000006  ,  53.480000000000004  ,  53.74               ,  54.                 ,  33.120000000000005  ,  33.28               ,  33.44               ,  33.6                ,  61.52               ,  61.81333333333333   ,  62.10666666666667   ,  62.400000000000006  ,  45.12               ,  45.33333333333333   ,  45.54666666666667   ,  45.760000000000005  ,  45.12               ,  45.33333333333333   ,  45.54666666666667   ,  45.760000000000005  ,  38.85               ,  39.03333333333333   ,  39.21666666666667   ,  39.400000000000006  ,  70.51666666666667   ,  70.84666666666666   ,  71.17666666666666   ,  71.50666666666667   ,  70.51666666666667   ,  70.84666666666666   ,  71.17666666666666   ,  71.50666666666667   , 102.77               , 103.24666666666666   , 103.72333333333334   , 104.2                ,  63.92               ,  64.21333333333334   ,  64.50666666666666   ,  64.8                , 118.65333333333332   , 119.1911111111111    , 119.7288888888889    , 120.26666666666668   ,  86.98666666666666   ,  87.37777777777777   ,  87.76888888888888   ,  88.16               ,  86.98666666666666   ,  87.37777777777777   ,  87.76888888888888   ,  88.16               ,  29.200000000000003  ,  29.333333333333332  ,  29.466666666666665  ,  29.6                ,  52.986666666666665  ,  53.22666666666667   ,  53.46666666666666   ,  53.70666666666667   ,  52.986666666666665  ,  53.22666666666667   ,  53.46666666666666   ,  53.70666666666667   ,  77.2                ,  77.54666666666667   ,  77.89333333333333   ,  78.24000000000001   ,  48.                 ,  48.21333333333334   ,  48.42666666666666   ,  48.64               ,  89.06666666666666   ,  89.45777777777778   ,  89.84888888888888   ,  90.24000000000001   ,  65.28               ,  65.56444444444443   ,  65.84888888888888   ,  66.13333333333333   ,  65.28               ,  65.56444444444443   ,  65.84888888888888   ,  66.13333333333333   ,  29.200000000000003  ,  29.333333333333332  ,  29.466666666666665  ,  29.6                ,  52.986666666666665  ,  53.22666666666667   ,  53.46666666666666   ,  53.70666666666667   ,  52.986666666666665  ,  53.22666666666667   ,  53.46666666666666   ,  53.70666666666667   ,  77.2                ,  77.54666666666667   ,  77.89333333333333   ,  78.24000000000001   ,  48.                 ,  48.21333333333334   ,  48.42666666666666   ,  48.64               ,  89.06666666666666   ,  89.45777777777778   ,  89.84888888888888   ,  90.24000000000001   ,  65.28               ,  65.56444444444443   ,  65.84888888888888   ,  66.13333333333333   ,  65.28               ,  65.56444444444443   ,  65.84888888888888   ,  66.13333333333333   };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.2                ,  0.24               ,  0.28               ,  0.32               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  0.39999999999999997,  0.48000000000000004,  0.56               ,  0.64               ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  1.12               ,  1.28               ,  1.44               ,  1.6                ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.72               ,  0.8                ,  0.88               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.08               ,  1.2                ,  1.32               ,  1.44               ,  1.08               ,  1.2                ,  1.32               ,  1.44               ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  1.56               ,  1.6800000000000002 ,  1.8                ,  1.92               ,  1.56               ,  1.6800000000000002 ,  1.8                ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  1.04               ,  1.12               ,  1.2                ,  1.28               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  2.4                ,  2.56               ,  2.72               ,  2.88               ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  1.3599999999999999 ,  1.44               ,  1.52               ,  1.6                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  0.68               ,  0.72               ,  0.76               ,  0.8                ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.76               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.84               ,  0.88               ,  0.92               ,  0.96               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  1.16               ,  1.2                ,  1.24               ,  1.28               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.4800000000000004 ,  2.56               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  4.960000000000001  ,  5.120000000000001  ,  5.280000000000001  ,  5.44               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  2.6399999999999997 ,  2.7199999999999998 ,  2.8                ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  3.9600000000000004 ,  4.08               ,  4.2                ,  4.32               ,  3.9600000000000004 ,  4.08               ,  4.2                ,  4.32               ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  8.400000000000002  ,  8.64               ,  8.88               ,  9.120000000000001  ,  4.4399999999999995 ,  4.56               ,  4.68               ,  4.8                ,  4.4399999999999995 ,  4.56               ,  4.68               ,  4.8                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  2.96               ,  3.04               ,  3.12               ,  3.2                ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  6.239999999999999  ,  6.3999999999999995 ,  6.56               ,  6.72               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  3.2800000000000002 ,  3.3600000000000003 ,  3.4400000000000004 ,  3.52               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  1.6400000000000001 ,  1.68               ,  1.72               ,  1.76               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  1.96               ,  2.                 ,  2.04               ,  2.08               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  2.12               ,  2.16               ,  2.2                ,  2.24               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  4.24               ,  4.32               ,  4.4                ,  4.48               ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  8.8                ,  8.96               ,  9.12               ,  9.280000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  4.5600000000000005 ,  4.640000000000001  ,  4.720000000000001  ,  4.800000000000001  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  6.84               ,  6.960000000000001  ,  7.08               ,  7.200000000000001  ,  6.84               ,  6.960000000000001  ,  7.08               ,  7.200000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  7.32               ,  7.440000000000001  ,  7.5600000000000005 ,  7.680000000000001  ,  7.32               ,  7.440000000000001  ,  7.5600000000000005 ,  7.680000000000001  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               ,  4.880000000000001  ,  4.96               ,  5.04               ,  5.12               , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  , 10.08               , 10.24               , 10.4                , 10.559999999999999  ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  5.2                ,  5.28               ,  5.359999999999999  ,  5.4399999999999995 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  2.6                ,  2.64               ,  2.68               ,  2.72               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.1625             ,  0.1625             ,  0.3125             ,  0.25               ,  0.45               ,  0.35000000000000003,  0.7666666666666666 ,  0.6166666666666667 ,  0.6166666666666667 ,  0.36250000000000004,  0.7425             ,  0.7425             ,  1.2125000000000001 ,  0.8500000000000001 ,  1.4100000000000001 ,  1.03               ,  2.1133333333333333 ,  1.6433333333333333 ,  1.6433333333333333 ,  0.36250000000000004,  0.7425             ,  0.7425             ,  1.2125000000000001 ,  0.8500000000000001 ,  1.4100000000000001 ,  1.03               ,  2.1133333333333333 ,  1.6433333333333333 ,  1.6433333333333333 ,  0.9125000000000001 ,  1.7725             ,  1.7725             ,  2.7625             ,  1.85               ,  2.97               ,  2.1100000000000003 ,  4.193333333333333  ,  3.203333333333333  ,  3.203333333333333  ,  0.8500000000000001 ,  1.61               ,  1.61               ,  2.45               ,  1.6                ,  2.52               ,  1.76               ,  3.4266666666666667 ,  2.586666666666667  ,  2.586666666666667  ,  1.6500000000000001 ,  3.0900000000000003 ,  3.0900000000000003 ,  4.65               ,  3.                 ,  4.68               ,  3.24               ,  6.239999999999999  ,  4.68               ,  4.68               ,  1.35               ,  2.5100000000000002 ,  2.5100000000000002 ,  3.75               ,  2.4000000000000004 ,  3.7199999999999998 ,  2.56               ,  4.893333333333333  ,  3.6533333333333333 ,  3.6533333333333333 ,  3.1                ,  5.726666666666667  ,  5.726666666666667  ,  8.5                ,  5.4                ,  8.32               ,  5.693333333333333  , 10.804444444444442  ,  8.031111111111112  ,  8.031111111111112  ,  2.55               ,  4.696666666666666  ,  4.696666666666666  ,  6.95               ,  4.3999999999999995 ,  6.76               ,  4.613333333333333  ,  8.724444444444444  ,  6.471111111111111  ,  6.471111111111111  ,  2.55               ,  4.696666666666666  ,  4.696666666666666  ,  6.95               ,  4.3999999999999995 ,  6.76               ,  4.613333333333333  ,  8.724444444444444  ,  6.471111111111111  ,  6.471111111111111  ,  1.625              ,  2.975              ,  2.975              ,  4.375              ,  2.75               ,  4.2                ,  2.8500000000000005 ,  5.3500000000000005 ,  3.95               ,  3.95               ,  3.175              ,  5.805000000000001  ,  5.805000000000001  ,  8.525              ,  5.3500000000000005 ,  8.16               ,  5.530000000000001  , 10.363333333333335  ,  7.643333333333334  ,  7.643333333333334  ,  3.175              ,  5.805000000000001  ,  5.805000000000001  ,  8.525              ,  5.3500000000000005 ,  8.16               ,  5.530000000000001  , 10.363333333333335  ,  7.643333333333334  ,  7.643333333333334  ,  4.975              ,  9.085              ,  9.085              , 13.325000000000001  ,  8.35               , 12.72               ,  8.610000000000001  , 16.110000000000003  , 11.870000000000001  , 11.870000000000001  ,  3.35               ,  6.109999999999999  ,  6.109999999999999  ,  8.95               ,  5.6                ,  8.52               ,  5.76               , 10.76               ,  7.92               ,  7.92               ,  5.4                ,  9.84               ,  9.84               , 14.4                ,  9.                 , 13.68               ,  9.24               , 17.240000000000002  , 12.68               , 12.68               ,  3.8500000000000005 ,  7.01               ,  7.01               , 10.250000000000002  ,  6.3999999999999995 ,  9.72               ,  6.56               , 12.226666666666667  ,  8.986666666666666  ,  8.986666666666666  ,  7.683333333333334  , 13.976666666666667  , 13.976666666666667  , 20.416666666666668  , 12.733333333333334  , 19.32               , 13.026666666666667  , 24.248888888888885  , 17.808888888888887  , 17.808888888888887  ,  5.883333333333333  , 10.696666666666667  , 10.696666666666667  , 15.616666666666667  ,  9.733333333333334  , 14.759999999999998  ,  9.946666666666665  , 18.502222222222223  , 13.582222222222223  , 13.582222222222223  ,  5.883333333333333  , 10.696666666666667  , 10.696666666666667  , 15.616666666666667  ,  9.733333333333334  , 14.759999999999998  ,  9.946666666666665  , 18.502222222222223  , 13.582222222222223  , 13.582222222222223  ,  3.1875             ,  5.7875             ,  5.7875             ,  8.4375             ,  5.25               ,  7.95               ,  5.3500000000000005 ,  9.933333333333334  ,  7.283333333333333  ,  7.283333333333333  ,  5.987500000000001  , 10.8675             , 10.8675             , 15.837500000000002  ,  9.85               , 14.91               , 10.03               , 18.613333333333333  , 13.643333333333333  , 13.643333333333333  ,  5.987500000000001  , 10.8675             , 10.8675             , 15.837500000000002  ,  9.85               , 14.91               , 10.03               , 18.613333333333333  , 13.643333333333333  , 13.643333333333333  ,  9.037500000000001  , 16.3975             , 16.3975             , 23.887500000000003  , 14.85               , 22.47               , 15.11               , 28.026666666666664  , 20.536666666666665  , 20.536666666666665  ,  5.8500000000000005 , 10.610000000000001  , 10.610000000000001  , 15.450000000000001  ,  9.6                , 14.52               ,  9.76               , 18.093333333333334  , 13.253333333333334  , 13.253333333333334  ,  9.15               , 16.590000000000003  , 16.590000000000003  , 24.15               , 15.                 , 22.68               , 15.24               , 28.240000000000002  , 20.680000000000003  , 20.680000000000003  ,  6.3500000000000005 , 11.51               , 11.51               , 16.75               , 10.4                , 15.72               , 10.56               , 19.560000000000002  , 14.32               , 14.32               , 12.266666666666666  , 22.226666666666667  , 22.226666666666667  , 32.33333333333333   , 20.066666666666666  , 30.32               , 20.36               , 37.693333333333335  , 27.586666666666666  , 27.586666666666666  ,  9.216666666666667  , 16.696666666666665  , 16.696666666666665  , 24.283333333333335  , 15.066666666666666  , 22.76               , 15.280000000000001  , 28.28               , 20.693333333333335  , 20.693333333333335  ,  9.216666666666667  , 16.696666666666665  , 16.696666666666665  , 24.283333333333335  , 15.066666666666666  , 22.76               , 15.280000000000001  , 28.28               , 20.693333333333335  , 20.693333333333335  };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.04               , 0.04               , 0.12               , 0.12               , 0.24               , 0.2                , 0.2                , 0.12               , 0.12               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.2                , 0.2                , 0.48000000000000004, 0.48000000000000004, 0.8400000000000001 , 0.64               , 0.64               , 0.36               , 0.36               , 0.                 , 0.48000000000000004, 0.48000000000000004, 1.08               , 1.08               , 1.8000000000000003 , 1.3199999999999998 , 1.3199999999999998 , 0.72               , 0.72               , 0.                 , 0.44000000000000006, 0.44000000000000006, 0.96               , 0.96               , 1.56               , 1.12               , 1.12               , 0.6                , 0.6                , 0.                 , 0.44000000000000006, 0.44000000000000006, 0.96               , 0.96               , 1.56               , 1.12               , 1.12               , 0.6                , 0.6                , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.28               , 0.28               , 0.6000000000000001 , 0.6000000000000001 , 0.9600000000000001 , 0.6799999999999999 , 0.6799999999999999 , 0.36               , 0.36               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.4                , 0.4                , 0.8400000000000001 , 0.8400000000000001 , 1.32               , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.4                , 0.4                , 0.8400000000000001 , 0.8400000000000001 , 1.32               , 0.9199999999999999 , 0.9199999999999999 , 0.48               , 0.48               , 0.                 , 0.92               , 0.92               , 1.9200000000000002 , 1.9200000000000002 , 3.0000000000000004 , 2.08               , 2.08               , 1.08               , 1.08               , 0.                 , 0.92               , 0.92               , 1.9200000000000002 , 1.9200000000000002 , 3.0000000000000004 , 2.08               , 2.08               , 1.08               , 1.08               , 0.                 , 1.56               , 1.56               , 3.24               , 3.24               , 5.04               , 3.4800000000000004 , 3.4800000000000004 , 1.8                , 1.8                , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 1.1600000000000001 , 1.1600000000000001 , 2.4000000000000004 , 2.4000000000000004 , 3.7200000000000006 , 2.5600000000000005 , 2.5600000000000005 , 1.3199999999999998 , 1.3199999999999998 , 0.                 , 0.64               , 0.64               , 1.32               , 1.32               , 2.04               , 1.4                , 1.4                , 0.72               , 0.72               , 0.                 , 0.64               , 0.64               , 1.32               , 1.32               , 2.04               , 1.4                , 1.4                , 0.72               , 0.72               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.76               , 0.76               , 1.56               , 1.56               , 2.4                , 1.6400000000000001 , 1.6400000000000001 , 0.84               , 0.84               , 0.                 , 0.76               , 0.76               , 1.56               , 1.56               , 2.4                , 1.6400000000000001 , 1.6400000000000001 , 0.84               , 0.84               , 0.                 , 1.6400000000000001 , 1.6400000000000001 , 3.36               , 3.36               , 5.16               , 3.52               , 3.52               , 1.7999999999999998 , 1.7999999999999998 , 0.                 , 1.6400000000000001 , 1.6400000000000001 , 3.36               , 3.36               , 5.16               , 3.52               , 3.52               , 1.7999999999999998 , 1.7999999999999998 , 0.                 , 2.64               , 2.64               , 5.3999999999999995 , 5.3999999999999995 , 8.280000000000001  , 5.640000000000001  , 5.640000000000001  , 2.88               , 2.88               , 0.                 , 1.88               , 1.88               , 3.84               , 3.84               , 5.88               , 4.                 , 4.                 , 2.04               , 2.04               , 0.                 , 1.88               , 1.88               , 3.84               , 3.84               , 5.88               , 4.                 , 4.                 , 2.04               , 2.04               , 0.                 , 1.                 , 1.                 , 2.04               , 2.04               , 3.12               , 2.12               , 2.12               , 1.08               , 1.08               , 0.                 , 1.                 , 1.                 , 2.04               , 2.04               , 3.12               , 2.12               , 2.12               , 1.08               , 1.08               , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 , 0.                 };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.0625             ,  0.125              ,  0.21250000000000002,  0.325              ,  0.21250000000000002,  0.325              ,  0.4625             ,  0.625              ,  0.4                ,  0.5                ,  0.75               ,  0.9                ,  0.6000000000000001 ,  0.7000000000000001 ,  1.35               ,  1.5333333333333332 ,  1.1                ,  1.2333333333333334 ,  1.1                ,  1.2333333333333334 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  0.6125             ,  0.7250000000000001 ,  1.2825000000000002 ,  1.485              ,  1.2825000000000002 ,  1.485              ,  2.1325000000000003 ,  2.4250000000000003 ,  1.52               ,  1.7000000000000002 ,  2.5500000000000003 ,  2.8200000000000003 ,  1.8800000000000003 ,  2.06               ,  3.896666666666667  ,  4.226666666666667  ,  3.046666666666667  ,  3.2866666666666666 ,  3.046666666666667  ,  3.2866666666666666 ,  1.6625             ,  1.8250000000000002 ,  3.2525000000000004 ,  3.545              ,  3.2525000000000004 ,  3.545              ,  5.1025             ,  5.525              ,  3.44               ,  3.7                ,  5.550000000000001  ,  5.94               ,  3.9600000000000004 ,  4.220000000000001  ,  7.91               ,  8.386666666666667  ,  6.0600000000000005 ,  6.406666666666666  ,  6.0600000000000005 ,  6.406666666666666  ,  1.6                ,  1.7000000000000002 ,  3.04               ,  3.22               ,  3.04               ,  3.22               ,  4.64               ,  4.9                ,  3.04               ,  3.2                ,  4.800000000000001  ,  5.04               ,  3.3600000000000003 ,  3.52               ,  6.5600000000000005 ,  6.8533333333333335 ,  4.96               ,  5.173333333333334  ,  4.96               ,  5.173333333333334  ,  3.1500000000000004 ,  3.3000000000000003 ,  5.91               ,  6.180000000000001  ,  5.91               ,  6.180000000000001  ,  8.91               ,  9.3                ,  5.760000000000001  ,  6.                 ,  9.000000000000002  ,  9.36               ,  6.24               ,  6.48               , 12.040000000000001  , 12.479999999999999  ,  9.04               ,  9.36               ,  9.04               ,  9.36               ,  2.6                ,  2.7                ,  4.840000000000001  ,  5.0200000000000005 ,  4.840000000000001  ,  5.0200000000000005 ,  7.240000000000001  ,  7.5                ,  4.640000000000001  ,  4.800000000000001  ,  7.200000000000001  ,  7.4399999999999995 ,  4.960000000000001  ,  5.12               ,  9.493333333333334  ,  9.786666666666665  ,  7.093333333333334  ,  7.306666666666667  ,  7.093333333333334  ,  7.306666666666667  ,  6.016666666666667  ,  6.2                , 11.123333333333335  , 11.453333333333333  , 11.123333333333335  , 11.453333333333333  , 16.523333333333333  , 17.                 , 10.506666666666668  , 10.8                , 16.200000000000003  , 16.64               , 11.093333333333334  , 11.386666666666667  , 21.07111111111111   , 21.608888888888885  , 15.67111111111111   , 16.062222222222225  , 15.67111111111111   , 16.062222222222225  ,  4.966666666666667  ,  5.1                ,  9.153333333333334  ,  9.393333333333333  ,  9.153333333333334  ,  9.393333333333333  , 13.553333333333335  , 13.9                ,  8.586666666666666  ,  8.799999999999999  , 13.2                , 13.52               ,  9.013333333333334  ,  9.226666666666667  , 17.057777777777776  , 17.448888888888888  , 12.657777777777778  , 12.942222222222222  , 12.657777777777778  , 12.942222222222222  ,  4.966666666666667  ,  5.1                ,  9.153333333333334  ,  9.393333333333333  ,  9.153333333333334  ,  9.393333333333333  , 13.553333333333335  , 13.9                ,  8.586666666666666  ,  8.799999999999999  , 13.2                , 13.52               ,  9.013333333333334  ,  9.226666666666667  , 17.057777777777776  , 17.448888888888888  , 12.657777777777778  , 12.942222222222222  , 12.657777777777778  , 12.942222222222222  ,  3.1875             ,  3.25               ,  5.8375             ,  5.95               ,  5.8375             ,  5.95               ,  8.5875             ,  8.75               ,  5.4                ,  5.5                ,  8.25               ,  8.4                ,  5.6                ,  5.700000000000001  , 10.516666666666666  , 10.700000000000001  ,  7.766666666666666  ,  7.9                ,  7.766666666666666  ,  7.9                ,  6.237500000000001  ,  6.35               , 11.4075             , 11.610000000000001  , 11.4075             , 11.610000000000001  , 16.7575             , 17.05               , 10.52               , 10.700000000000001  , 16.05               , 16.32               , 10.879999999999999  , 11.060000000000002  , 20.396666666666665  , 20.72666666666667   , 15.046666666666665  , 15.286666666666669  , 15.046666666666665  , 15.286666666666669  ,  6.237500000000001  ,  6.35               , 11.4075             , 11.610000000000001  , 11.4075             , 11.610000000000001  , 16.7575             , 17.05               , 10.52               , 10.700000000000001  , 16.05               , 16.32               , 10.879999999999999  , 11.060000000000002  , 20.396666666666665  , 20.72666666666667   , 15.046666666666665  , 15.286666666666669  , 15.046666666666665  , 15.286666666666669  ,  9.787500000000001  ,  9.95               , 17.8775             , 18.17               , 17.8775             , 18.17               , 26.2275             , 26.650000000000002  , 16.439999999999998  , 16.7                , 25.049999999999997  , 25.44               , 16.96               , 17.220000000000002  , 31.743333333333332  , 32.220000000000006  , 23.39333333333333   , 23.740000000000002  , 23.39333333333333   , 23.740000000000002  ,  6.6000000000000005 ,  6.7                , 12.040000000000001  , 12.219999999999999  , 12.040000000000001  , 12.219999999999999  , 17.64               , 17.9                , 11.04               , 11.2                , 16.8                , 17.04               , 11.360000000000001  , 11.52               , 21.226666666666667  , 21.52               , 15.626666666666665  , 15.84               , 15.626666666666665  , 15.84               , 10.65               , 10.8                , 19.41               , 19.68               , 19.41               , 19.68               , 28.41               , 28.8                , 17.759999999999998  , 18.                 , 27.                 , 27.36               , 18.240000000000002  , 18.48               , 34.04               , 34.480000000000004  , 25.04               , 25.36               , 25.04               , 25.36               ,  7.6                ,  7.700000000000001  , 13.84               , 14.02               , 13.84               , 14.02               , 20.24               , 20.500000000000004  , 12.64               , 12.799999999999999  , 19.2                , 19.44               , 12.96               , 13.12               , 24.16               , 24.453333333333333  , 17.76               , 17.973333333333333  , 17.76               , 17.973333333333333  , 15.183333333333334  , 15.366666666666667  , 27.62333333333333   , 27.953333333333333  , 27.62333333333333   , 27.953333333333333  , 40.35666666666667   , 40.833333333333336  , 25.173333333333332  , 25.46666666666667   , 38.199999999999996  , 38.64               , 25.759999999999998  , 26.053333333333335  , 47.96               , 48.49777777777777   , 35.22666666666667   , 35.617777777777775  , 35.22666666666667   , 35.617777777777775  , 11.633333333333333  , 11.766666666666666  , 21.153333333333332  , 21.393333333333334  , 21.153333333333332  , 21.393333333333334  , 30.886666666666663  , 31.233333333333334  , 19.253333333333334  , 19.46666666666667   , 29.200000000000003  , 29.519999999999996  , 19.68               , 19.89333333333333   , 36.61333333333333   , 37.004444444444445  , 26.880000000000003  , 27.164444444444445  , 26.880000000000003  , 27.164444444444445  , 11.633333333333333  , 11.766666666666666  , 21.153333333333332  , 21.393333333333334  , 21.153333333333332  , 21.393333333333334  , 30.886666666666663  , 31.233333333333334  , 19.253333333333334  , 19.46666666666667   , 29.200000000000003  , 29.519999999999996  , 19.68               , 19.89333333333333   , 36.61333333333333   , 37.004444444444445  , 26.880000000000003  , 27.164444444444445  , 26.880000000000003  , 27.164444444444445  ,  6.3125             ,  6.375              , 11.4625             , 11.575              , 11.4625             , 11.575              , 16.7125             , 16.875              , 10.4                , 10.5                , 15.75               , 15.9                , 10.600000000000001  , 10.700000000000001  , 19.683333333333334  , 19.866666666666667  , 14.433333333333334  , 14.566666666666666  , 14.433333333333334  , 14.566666666666666  , 11.8625             , 11.975000000000001  , 21.532500000000002  , 21.735              , 21.532500000000002  , 21.735              , 31.3825             , 31.675000000000004  , 19.520000000000003  , 19.7                , 29.55               , 29.82               , 19.880000000000003  , 20.06               , 36.89666666666667   , 37.22666666666667   , 27.046666666666667  , 27.286666666666665  , 27.046666666666667  , 27.286666666666665  , 11.8625             , 11.975000000000001  , 21.532500000000002  , 21.735              , 21.532500000000002  , 21.735              , 31.3825             , 31.675000000000004  , 19.520000000000003  , 19.7                , 29.55               , 29.82               , 19.880000000000003  , 20.06               , 36.89666666666667   , 37.22666666666667   , 27.046666666666667  , 27.286666666666665  , 27.046666666666667  , 27.286666666666665  , 17.9125             , 18.075000000000003  , 32.502500000000005  , 32.795              , 32.502500000000005  , 32.795              , 47.352500000000006  , 47.775000000000006  , 29.440000000000005  , 29.7                , 44.55               , 44.94               , 29.96               , 30.22               , 55.57666666666667   , 56.05333333333333   , 40.72666666666667   , 41.07333333333333   , 40.72666666666667   , 41.07333333333333   , 11.600000000000001  , 11.700000000000001  , 21.04               , 21.220000000000002  , 21.04               , 21.220000000000002  , 30.64               , 30.900000000000002  , 19.04               , 19.2                , 28.799999999999997  , 29.04               , 19.36               , 19.52               , 35.89333333333334   , 36.18666666666667   , 26.293333333333337  , 26.506666666666668  , 26.293333333333337  , 26.506666666666668  , 18.150000000000002  , 18.3                , 32.91               , 33.18000000000001   , 32.91               , 33.18000000000001   , 47.91               , 48.3                , 29.759999999999998  , 30.                 , 45.                 , 45.36               , 30.24               , 30.48               , 56.040000000000006  , 56.480000000000004  , 41.040000000000006  , 41.36000000000001   , 41.040000000000006  , 41.36000000000001   , 12.600000000000001  , 12.700000000000001  , 22.840000000000003  , 23.02               , 22.840000000000003  , 23.02               , 33.24               , 33.5                , 20.64               , 20.8                , 31.2                , 31.44               , 20.96               , 21.12               , 38.82666666666667   , 39.120000000000005  , 28.426666666666666  , 28.64               , 28.426666666666666  , 28.64               , 24.35               , 24.53333333333333   , 44.123333333333335  , 44.45333333333333   , 44.123333333333335  , 44.45333333333333   , 64.19               , 64.66666666666666   , 39.839999999999996  , 40.13333333333333   , 60.2                , 60.64               , 40.42666666666666   , 40.72               , 74.8488888888889    , 75.38666666666667   , 54.78222222222222   , 55.17333333333333   , 54.78222222222222   , 55.17333333333333   , 18.3                , 18.433333333333334  , 33.153333333333336  , 33.39333333333333   , 33.153333333333336  , 33.39333333333333   , 48.22               , 48.56666666666667   , 29.92               , 30.133333333333333  , 45.2                , 45.52               , 30.346666666666668  , 30.560000000000002  , 56.16888888888889   , 56.56               , 41.102222222222224  , 41.38666666666667   , 41.102222222222224  , 41.38666666666667   , 18.3                , 18.433333333333334  , 33.153333333333336  , 33.39333333333333   , 33.153333333333336  , 33.39333333333333   , 48.22               , 48.56666666666667   , 29.92               , 30.133333333333333  , 45.2                , 45.52               , 30.346666666666668  , 30.560000000000002  , 56.16888888888889   , 56.56               , 41.102222222222224  , 41.38666666666667   , 41.102222222222224  , 41.38666666666667   };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.04              ,  0.08              ,  0.04              ,  0.08              ,  0.16              ,  0.24              ,  0.16              ,  0.24              ,  0.36              ,  0.48              ,  0.32              ,  0.4               ,  0.32              ,  0.4               ,  0.2               ,  0.24              ,  0.2               ,  0.24              ,  0.                ,  0.                ,  0.04              ,  0.08              ,  0.04              ,  0.08              ,  0.16              ,  0.24              ,  0.16              ,  0.24              ,  0.36              ,  0.48              ,  0.32              ,  0.4               ,  0.32              ,  0.4               ,  0.2               ,  0.24              ,  0.2               ,  0.24              ,  0.                ,  0.                ,  0.32              ,  0.4               ,  0.32              ,  0.4               ,  0.8               ,  0.9600000000000001,  0.8               ,  0.9600000000000001,  1.44              ,  1.6800000000000002,  1.1199999999999999,  1.28              ,  1.1199999999999999,  1.28              ,  0.64              ,  0.72              ,  0.64              ,  0.72              ,  0.                ,  0.                ,  0.32              ,  0.4               ,  0.32              ,  0.4               ,  0.8               ,  0.9600000000000001,  0.8               ,  0.9600000000000001,  1.44              ,  1.6800000000000002,  1.1199999999999999,  1.28              ,  1.1199999999999999,  1.28              ,  0.64              ,  0.72              ,  0.64              ,  0.72              ,  0.                ,  0.                ,  0.8400000000000001,  0.9600000000000001,  0.8400000000000001,  0.9600000000000001,  1.92              ,  2.16              ,  1.92              ,  2.16              ,  3.24              ,  3.6000000000000005,  2.4               ,  2.6399999999999997,  2.4               ,  2.6399999999999997,  1.32              ,  1.44              ,  1.32              ,  1.44              ,  0.                ,  0.                ,  0.8               ,  0.8800000000000001,  0.8               ,  0.8800000000000001,  1.7600000000000002,  1.92              ,  1.7600000000000002,  1.92              ,  2.8800000000000003,  3.12              ,  2.08              ,  2.24              ,  2.08              ,  2.24              ,  1.12              ,  1.2               ,  1.12              ,  1.2               ,  0.                ,  0.                ,  0.8               ,  0.8800000000000001,  0.8               ,  0.8800000000000001,  1.7600000000000002,  1.92              ,  1.7600000000000002,  1.92              ,  2.8800000000000003,  3.12              ,  2.08              ,  2.24              ,  2.08              ,  2.24              ,  1.12              ,  1.2               ,  1.12              ,  1.2               ,  0.                ,  0.                ,  0.52              ,  0.56              ,  0.52              ,  0.56              ,  1.12              ,  1.2000000000000002,  1.12              ,  1.2000000000000002,  1.8000000000000003,  1.9200000000000002,  1.28              ,  1.3599999999999999,  1.28              ,  1.3599999999999999,  0.68              ,  0.72              ,  0.68              ,  0.72              ,  0.                ,  0.                ,  0.52              ,  0.56              ,  0.52              ,  0.56              ,  1.12              ,  1.2000000000000002,  1.12              ,  1.2000000000000002,  1.8000000000000003,  1.9200000000000002,  1.28              ,  1.3599999999999999,  1.28              ,  1.3599999999999999,  0.68              ,  0.72              ,  0.68              ,  0.72              ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.76              ,  0.8               ,  0.76              ,  0.8               ,  1.6               ,  1.6800000000000002,  1.6               ,  1.6800000000000002,  2.52              ,  2.64              ,  1.76              ,  1.8399999999999999,  1.76              ,  1.8399999999999999,  0.92              ,  0.96              ,  0.92              ,  0.96              ,  0.                ,  0.                ,  0.76              ,  0.8               ,  0.76              ,  0.8               ,  1.6               ,  1.6800000000000002,  1.6               ,  1.6800000000000002,  2.52              ,  2.64              ,  1.76              ,  1.8399999999999999,  1.76              ,  1.8399999999999999,  0.92              ,  0.96              ,  0.92              ,  0.96              ,  0.                ,  0.                ,  1.76              ,  1.84              ,  1.76              ,  1.84              ,  3.68              ,  3.8400000000000003,  3.68              ,  3.8400000000000003,  5.76              ,  6.000000000000001 ,  4.                ,  4.16              ,  4.                ,  4.16              ,  2.08              ,  2.16              ,  2.08              ,  2.16              ,  0.                ,  0.                ,  1.76              ,  1.84              ,  1.76              ,  1.84              ,  3.68              ,  3.8400000000000003,  3.68              ,  3.8400000000000003,  5.76              ,  6.000000000000001 ,  4.                ,  4.16              ,  4.                ,  4.16              ,  2.08              ,  2.16              ,  2.08              ,  2.16              ,  0.                ,  0.                ,  3.                ,  3.12              ,  3.                ,  3.12              ,  6.24              ,  6.48              ,  6.24              ,  6.48              ,  9.72              , 10.08              ,  6.720000000000001 ,  6.960000000000001 ,  6.720000000000001 ,  6.960000000000001 ,  3.4800000000000004,  3.6               ,  3.4800000000000004,  3.6               ,  0.                ,  0.                ,  2.24              ,  2.3200000000000003,  2.24              ,  2.3200000000000003,  4.640000000000001 ,  4.800000000000001 ,  4.640000000000001 ,  4.800000000000001 ,  7.200000000000001 ,  7.440000000000001 ,  4.960000000000001 ,  5.120000000000001 ,  4.960000000000001 ,  5.120000000000001 ,  2.56              ,  2.6399999999999997,  2.56              ,  2.6399999999999997,  0.                ,  0.                ,  2.24              ,  2.3200000000000003,  2.24              ,  2.3200000000000003,  4.640000000000001 ,  4.800000000000001 ,  4.640000000000001 ,  4.800000000000001 ,  7.200000000000001 ,  7.440000000000001 ,  4.960000000000001 ,  5.120000000000001 ,  4.960000000000001 ,  5.120000000000001 ,  2.56              ,  2.6399999999999997,  2.56              ,  2.6399999999999997,  0.                ,  0.                ,  1.24              ,  1.28              ,  1.24              ,  1.28              ,  2.56              ,  2.64              ,  2.56              ,  2.64              ,  3.96              ,  4.08              ,  2.72              ,  2.8               ,  2.72              ,  2.8               ,  1.4000000000000001,  1.44              ,  1.4000000000000001,  1.44              ,  0.                ,  0.                ,  1.24              ,  1.28              ,  1.24              ,  1.28              ,  2.56              ,  2.64              ,  2.56              ,  2.64              ,  3.96              ,  4.08              ,  2.72              ,  2.8               ,  2.72              ,  2.8               ,  1.4000000000000001,  1.44              ,  1.4000000000000001,  1.44              ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  1.48              ,  1.52              ,  1.48              ,  1.52              ,  3.04              ,  3.12              ,  3.04              ,  3.12              ,  4.68              ,  4.8               ,  3.2               ,  3.2800000000000002,  3.2               ,  3.2800000000000002,  1.6400000000000001,  1.68              ,  1.6400000000000001,  1.68              ,  0.                ,  0.                ,  1.48              ,  1.52              ,  1.48              ,  1.52              ,  3.04              ,  3.12              ,  3.04              ,  3.12              ,  4.68              ,  4.8               ,  3.2               ,  3.2800000000000002,  3.2               ,  3.2800000000000002,  1.6400000000000001,  1.68              ,  1.6400000000000001,  1.68              ,  0.                ,  0.                ,  3.2               ,  3.2800000000000002,  3.2               ,  3.2800000000000002,  6.56              ,  6.72              ,  6.56              ,  6.72              , 10.08              , 10.32              ,  6.88              ,  7.04              ,  6.88              ,  7.04              ,  3.5200000000000005,  3.5999999999999996,  3.5200000000000005,  3.5999999999999996,  0.                ,  0.                ,  3.2               ,  3.2800000000000002,  3.2               ,  3.2800000000000002,  6.56              ,  6.72              ,  6.56              ,  6.72              , 10.08              , 10.32              ,  6.88              ,  7.04              ,  6.88              ,  7.04              ,  3.5200000000000005,  3.5999999999999996,  3.5200000000000005,  3.5999999999999996,  0.                ,  0.                ,  5.16              ,  5.28              ,  5.16              ,  5.28              , 10.559999999999999 , 10.799999999999999 , 10.559999999999999 , 10.799999999999999 , 16.2               , 16.560000000000002 , 11.04              , 11.280000000000001 , 11.04              , 11.280000000000001 ,  5.640000000000001 ,  5.76              ,  5.640000000000001 ,  5.76              ,  0.                ,  0.                ,  3.6799999999999997,  3.76              ,  3.6799999999999997,  3.76              ,  7.5200000000000005,  7.68              ,  7.5200000000000005,  7.68              , 11.52              , 11.76              ,  7.840000000000001 ,  8.                ,  7.840000000000001 ,  8.                ,  4.                ,  4.08              ,  4.                ,  4.08              ,  0.                ,  0.                ,  3.6799999999999997,  3.76              ,  3.6799999999999997,  3.76              ,  7.5200000000000005,  7.68              ,  7.5200000000000005,  7.68              , 11.52              , 11.76              ,  7.840000000000001 ,  8.                ,  7.840000000000001 ,  8.                ,  4.                ,  4.08              ,  4.                ,  4.08              ,  0.                ,  0.                ,  1.96              ,  2.                ,  1.96              ,  2.                ,  4.                ,  4.08              ,  4.                ,  4.08              ,  6.12              ,  6.24              ,  4.16              ,  4.24              ,  4.16              ,  4.24              ,  2.12              ,  2.16              ,  2.12              ,  2.16              ,  0.                ,  0.                ,  1.96              ,  2.                ,  1.96              ,  2.                ,  4.                ,  4.08              ,  4.                ,  4.08              ,  6.12              ,  6.24              ,  4.16              ,  4.24              ,  4.16              ,  4.24              ,  2.12              ,  2.16              ,  2.12              ,  2.16              ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                ,  0.                };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, SAME3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  0.0625             ,   0.125              ,   0.1875             ,   0.25               ,   0.3125             ,   0.42500000000000004,   0.5375000000000001 ,   0.65               ,   0.3125             ,   0.42500000000000004,   0.5375000000000001 ,   0.65               ,   0.7625             ,   0.925              ,   1.0875000000000001 ,   1.25               ,   0.7                ,   0.8                ,   0.9000000000000001 ,   1.                 ,   1.35               ,   1.5                ,   1.6500000000000001 ,   1.8                ,   1.1                ,   1.2000000000000002 ,   1.3                ,   1.4000000000000001 ,   2.5166666666666666 ,   2.7                ,   2.8833333333333333 ,   3.0666666666666664 ,   2.0666666666666664 ,   2.2                ,   2.333333333333333  ,   2.466666666666667  ,   2.0666666666666664 ,   2.2                ,   2.333333333333333  ,   2.466666666666667  ,   1.1125             ,   1.225              ,   1.3375000000000001 ,   1.4500000000000002 ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   3.9725             ,   4.265000000000001  ,   4.5575             ,   4.8500000000000005 ,   2.86               ,   3.04               ,   3.22               ,   3.4000000000000004 ,   4.83               ,   5.1000000000000005 ,   5.370000000000001  ,   5.640000000000001  ,   3.58               ,   3.7600000000000007 ,   3.9400000000000004 ,   4.12               ,   7.463333333333334  ,   7.793333333333334  ,   8.123333333333333  ,   8.453333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   1.1125             ,   1.225              ,   1.3375000000000001 ,   1.4500000000000002 ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   2.3625             ,   2.5650000000000004 ,   2.7675             ,   2.97               ,   3.9725             ,   4.265000000000001  ,   4.5575             ,   4.8500000000000005 ,   2.86               ,   3.04               ,   3.22               ,   3.4000000000000004 ,   4.83               ,   5.1000000000000005 ,   5.370000000000001  ,   5.640000000000001  ,   3.58               ,   3.7600000000000007 ,   3.9400000000000004 ,   4.12               ,   7.463333333333334  ,   7.793333333333334  ,   8.123333333333333  ,   8.453333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   5.8533333333333335 ,   6.093333333333334  ,   6.333333333333334  ,   6.573333333333333  ,   3.1625000000000005 ,   3.325              ,   3.4875             ,   3.6500000000000004 ,   6.2124999999999995 ,   6.505000000000001  ,   6.7975             ,   7.09               ,   6.2124999999999995 ,   6.505000000000001  ,   6.7975             ,   7.09               ,   9.7825             ,  10.205              ,  10.627500000000001  ,  11.05               ,   6.62               ,   6.88               ,   7.140000000000001  ,   7.4                ,  10.71               ,  11.100000000000001  ,  11.490000000000002  ,  11.88               ,   7.66               ,   7.920000000000001  ,   8.18               ,   8.440000000000001  ,  15.343333333333334  ,  15.82               ,  16.296666666666667  ,  16.773333333333333  ,  11.773333333333333  ,  12.120000000000001  ,  12.466666666666669  ,  12.813333333333333  ,  11.773333333333333  ,  12.120000000000001  ,  12.466666666666669  ,  12.813333333333333  ,   3.1000000000000005 ,   3.2                ,   3.3                ,   3.4000000000000004 ,   5.8999999999999995 ,   6.08               ,   6.260000000000001  ,   6.44               ,   5.8999999999999995 ,   6.08               ,   6.260000000000001  ,   6.44               ,   9.02               ,   9.28               ,   9.540000000000001  ,   9.8                ,   5.92               ,   6.08               ,   6.24               ,   6.4                ,   9.36               ,   9.600000000000001  ,   9.84               ,  10.08               ,   6.56               ,   6.720000000000001  ,   6.88               ,   7.04               ,  12.826666666666668  ,  13.120000000000001  ,  13.413333333333334  ,  13.706666666666667  ,   9.706666666666667  ,   9.92               ,  10.133333333333333  ,  10.346666666666668  ,   9.706666666666667  ,   9.92               ,  10.133333333333333  ,  10.346666666666668  ,   6.15               ,   6.300000000000001  ,   6.45               ,   6.6000000000000005 ,  11.549999999999999  ,  11.82               ,  12.09               ,  12.360000000000001  ,  11.549999999999999  ,  11.82               ,  12.09               ,  12.360000000000001  ,  17.43               ,  17.82               ,  18.21               ,  18.6                ,  11.28               ,  11.520000000000001  ,  11.76               ,  12.                 ,  17.64               ,  18.000000000000004  ,  18.36               ,  18.72               ,  12.24               ,  12.48               ,  12.719999999999999  ,  12.96               ,  23.64               ,  24.080000000000002  ,  24.52               ,  24.959999999999997  ,  17.759999999999998  ,  18.08               ,  18.4                ,  18.72               ,  17.759999999999998  ,  18.08               ,  18.4                ,  18.72               ,   5.1000000000000005 ,   5.2                ,   5.300000000000001  ,   5.4                ,   9.5                ,   9.680000000000001  ,   9.860000000000001  ,  10.040000000000001  ,   9.5                ,   9.680000000000001  ,   9.860000000000001  ,  10.040000000000001  ,  14.22               ,  14.480000000000002  ,  14.74               ,  15.                 ,   9.12               ,   9.280000000000001  ,   9.44               ,   9.600000000000001  ,  14.16               ,  14.400000000000002  ,  14.64               ,  14.879999999999999  ,   9.76               ,   9.920000000000002  ,  10.08               ,  10.24               ,  18.693333333333335  ,  18.986666666666668  ,  19.28               ,  19.57333333333333   ,  13.973333333333333  ,  14.186666666666667  ,  14.399999999999999  ,  14.613333333333333  ,  13.973333333333333  ,  14.186666666666667  ,  14.399999999999999  ,  14.613333333333333  ,  11.850000000000001  ,  12.033333333333333  ,  12.216666666666667  ,  12.4                ,  21.916666666666668  ,  22.24666666666667   ,  22.576666666666668  ,  22.906666666666666  ,  21.916666666666668  ,  22.24666666666667   ,  22.576666666666668  ,  22.906666666666666  ,  32.57               ,  33.04666666666667   ,  33.52333333333333   ,  34.                 ,  20.72               ,  21.013333333333335  ,  21.306666666666665  ,  21.6                ,  31.96               ,  32.400000000000006  ,  32.84               ,  33.28               ,  21.893333333333334  ,  22.186666666666667  ,  22.48               ,  22.773333333333333  ,  41.60444444444445   ,  42.14222222222222   ,  42.68               ,  43.21777777777777   ,  30.95111111111111   ,  31.34222222222222   ,  31.73333333333333   ,  32.12444444444445   ,  30.95111111111111   ,  31.34222222222222   ,  31.73333333333333   ,  32.12444444444445   ,   9.8                ,   9.933333333333334  ,  10.066666666666666  ,  10.2                ,  18.066666666666666  ,  18.30666666666667   ,  18.546666666666667  ,  18.786666666666665  ,  18.066666666666666  ,  18.30666666666667   ,  18.546666666666667  ,  18.786666666666665  ,  26.76               ,  27.10666666666667   ,  27.453333333333333  ,  27.8                ,  16.96               ,  17.173333333333332  ,  17.386666666666667  ,  17.599999999999998  ,  26.080000000000002  ,  26.4                ,  26.72               ,  27.04               ,  17.813333333333333  ,  18.026666666666667  ,  18.24               ,  18.453333333333333  ,  33.724444444444444  ,  34.11555555555555   ,  34.50666666666666   ,  34.897777777777776  ,  25.03111111111111   ,  25.315555555555555  ,  25.599999999999998  ,  25.884444444444444  ,  25.03111111111111   ,  25.315555555555555  ,  25.599999999999998  ,  25.884444444444444  ,   9.8                ,   9.933333333333334  ,  10.066666666666666  ,  10.2                ,  18.066666666666666  ,  18.30666666666667   ,  18.546666666666667  ,  18.786666666666665  ,  18.066666666666666  ,  18.30666666666667   ,  18.546666666666667  ,  18.786666666666665  ,  26.76               ,  27.10666666666667   ,  27.453333333333333  ,  27.8                ,  16.96               ,  17.173333333333332  ,  17.386666666666667  ,  17.599999999999998  ,  26.080000000000002  ,  26.4                ,  26.72               ,  27.04               ,  17.813333333333333  ,  18.026666666666667  ,  18.24               ,  18.453333333333333  ,  33.724444444444444  ,  34.11555555555555   ,  34.50666666666666   ,  34.897777777777776  ,  25.03111111111111   ,  25.315555555555555  ,  25.599999999999998  ,  25.884444444444444  ,  25.03111111111111   ,  25.315555555555555  ,  25.599999999999998  ,  25.884444444444444  ,   6.3125             ,   6.375              ,   6.4375             ,   6.5                ,  11.5625             ,  11.675              ,  11.787500000000001  ,  11.9                ,  11.5625             ,  11.675              ,  11.787500000000001  ,  11.9                ,  17.0125             ,  17.175              ,  17.337500000000002  ,  17.5                ,  10.7                ,  10.8                ,  10.900000000000002  ,  11.                 ,  16.35               ,  16.5                ,  16.650000000000002  ,  16.8                ,  11.100000000000001  ,  11.2                ,  11.3                ,  11.400000000000002  ,  20.85               ,  21.03333333333333   ,  21.21666666666667   ,  21.400000000000002  ,  15.4                ,  15.533333333333331  ,  15.666666666666666  ,  15.8                ,  15.4                ,  15.533333333333331  ,  15.666666666666666  ,  15.8                ,  12.3625             ,  12.475000000000001  ,  12.5875             ,  12.7                ,  22.6125             ,  22.815              ,  23.0175             ,  23.220000000000002  ,  22.6125             ,  22.815              ,  23.0175             ,  23.220000000000002  ,  33.2225             ,  33.515              ,  33.807500000000005  ,  34.1                ,  20.86               ,  21.04               ,  21.220000000000002  ,  21.400000000000002  ,  31.830000000000002  ,  32.1                ,  32.370000000000005  ,  32.64               ,  21.580000000000002  ,  21.759999999999998  ,  21.939999999999998  ,  22.120000000000005  ,  40.46333333333334   ,  40.79333333333333   ,  41.123333333333335  ,  41.45333333333334   ,  29.85333333333333   ,  30.09333333333333   ,  30.333333333333332  ,  30.573333333333338  ,  29.85333333333333   ,  30.09333333333333   ,  30.333333333333332  ,  30.573333333333338  ,  12.3625             ,  12.475000000000001  ,  12.5875             ,  12.7                ,  22.6125             ,  22.815              ,  23.0175             ,  23.220000000000002  ,  22.6125             ,  22.815              ,  23.0175             ,  23.220000000000002  ,  33.2225             ,  33.515              ,  33.807500000000005  ,  34.1                ,  20.86               ,  21.04               ,  21.220000000000002  ,  21.400000000000002  ,  31.830000000000002  ,  32.1                ,  32.370000000000005  ,  32.64               ,  21.580000000000002  ,  21.759999999999998  ,  21.939999999999998  ,  22.120000000000005  ,  40.46333333333334   ,  40.79333333333333   ,  41.123333333333335  ,  41.45333333333334   ,  29.85333333333333   ,  30.09333333333333   ,  30.333333333333332  ,  30.573333333333338  ,  29.85333333333333   ,  30.09333333333333   ,  30.333333333333332  ,  30.573333333333338  ,  19.4125             ,  19.575000000000003  ,  19.7375             ,  19.9                ,  35.4625             ,  35.755              ,  36.0475             ,  36.34               ,  35.4625             ,  35.755              ,  36.0475             ,  36.34               ,  52.03249999999999   ,  52.455              ,  52.877500000000005  ,  53.300000000000004  ,  32.62               ,  32.879999999999995  ,  33.14               ,  33.4                ,  49.71               ,  50.099999999999994  ,  50.49000000000001   ,  50.88               ,  33.660000000000004  ,  33.92               ,  34.18               ,  34.440000000000005  ,  63.010000000000005  ,  63.486666666666665  ,  63.96333333333334   ,  64.44000000000001   ,  46.44               ,  46.78666666666666   ,  47.13333333333333   ,  47.480000000000004  ,  46.44               ,  46.78666666666666   ,  47.13333333333333   ,  47.480000000000004  ,  13.100000000000001  ,  13.200000000000001  ,  13.3                ,  13.4                ,  23.900000000000002  ,  24.080000000000002  ,  24.26               ,  24.439999999999998  ,  23.900000000000002  ,  24.080000000000002  ,  24.26               ,  24.439999999999998  ,  35.02               ,  35.28               ,  35.54               ,  35.8                ,  21.92               ,  22.08               ,  22.24               ,  22.4                ,  33.36               ,  33.6                ,  33.84               ,  34.08               ,  22.560000000000002  ,  22.720000000000002  ,  22.88               ,  23.04               ,  42.160000000000004  ,  42.45333333333333   ,  42.74666666666667   ,  43.04               ,  31.04               ,  31.25333333333333   ,  31.46666666666667   ,  31.68               ,  31.04               ,  31.25333333333333   ,  31.46666666666667   ,  31.68               ,  21.150000000000002  ,  21.3                ,  21.450000000000003  ,  21.6                ,  38.550000000000004  ,  38.82               ,  39.09               ,  39.36               ,  38.550000000000004  ,  38.82               ,  39.09               ,  39.36               ,  56.43000000000001   ,  56.82               ,  57.209999999999994  ,  57.6                ,  35.28               ,  35.519999999999996  ,  35.76               ,  36.                 ,  53.64               ,  54.                 ,  54.36               ,  54.72               ,  36.24               ,  36.480000000000004  ,  36.72               ,  36.96               ,  67.64               ,  68.08               ,  68.52000000000001   ,  68.96000000000001   ,  49.760000000000005  ,  50.08               ,  50.400000000000006  ,  50.72               ,  49.760000000000005  ,  50.08               ,  50.400000000000006  ,  50.72               ,  15.100000000000001  ,  15.2                ,  15.3                ,  15.400000000000002  ,  27.500000000000004  ,  27.68               ,  27.86               ,  28.04               ,  27.500000000000004  ,  27.68               ,  27.86               ,  28.04               ,  40.22               ,  40.48               ,  40.739999999999995  ,  41.00000000000001   ,  25.119999999999997  ,  25.28               ,  25.44               ,  25.599999999999998  ,  38.160000000000004  ,  38.4                ,  38.64               ,  38.88               ,  25.759999999999998  ,  25.92               ,  26.08               ,  26.24               ,  48.02666666666667   ,  48.32               ,  48.61333333333333   ,  48.906666666666666  ,  35.30666666666667   ,  35.52               ,  35.733333333333334  ,  35.946666666666665  ,  35.30666666666667   ,  35.52               ,  35.733333333333334  ,  35.946666666666665  ,  30.183333333333334  ,  30.366666666666667  ,  30.55               ,  30.733333333333334  ,  54.91666666666667   ,  55.24666666666666   ,  55.57666666666667   ,  55.906666666666666  ,  54.91666666666667   ,  55.24666666666666   ,  55.57666666666667   ,  55.906666666666666  ,  80.23666666666665   ,  80.71333333333334   ,  81.19               ,  81.66666666666667   ,  50.053333333333335  ,  50.346666666666664  ,  50.64               ,  50.93333333333334   ,  75.96000000000001   ,  76.39999999999999   ,  76.84               ,  77.28               ,  51.22666666666667   ,  51.519999999999996  ,  51.81333333333333   ,  52.10666666666667   ,  95.38222222222223   ,  95.92               ,  96.45777777777778   ,  96.99555555555554   ,  70.06222222222223   ,  70.45333333333333   ,  70.84444444444445   ,  71.23555555555555   ,  70.06222222222223   ,  70.45333333333333   ,  70.84444444444445   ,  71.23555555555555   ,  23.133333333333333  ,  23.266666666666666  ,  23.4                ,  23.53333333333333   ,  42.06666666666667   ,  42.306666666666665  ,  42.54666666666667   ,  42.78666666666667   ,  42.06666666666667   ,  42.306666666666665  ,  42.54666666666667   ,  42.78666666666667   ,  61.42666666666668   ,  61.773333333333326  ,  62.120000000000005  ,  62.46666666666667   ,  38.29333333333334   ,  38.50666666666667   ,  38.72               ,  38.93333333333334   ,  58.080000000000005  ,  58.400000000000006  ,  58.72               ,  59.03999999999999   ,  39.14666666666667   ,  39.36               ,  39.57333333333333   ,  39.78666666666666   ,  72.83555555555556   ,  73.22666666666666   ,  73.61777777777777   ,  74.00888888888889   ,  53.47555555555556   ,  53.760000000000005  ,  54.044444444444444  ,  54.32888888888889   ,  53.47555555555556   ,  53.760000000000005  ,  54.044444444444444  ,  54.32888888888889   ,  23.133333333333333  ,  23.266666666666666  ,  23.4                ,  23.53333333333333   ,  42.06666666666667   ,  42.306666666666665  ,  42.54666666666667   ,  42.78666666666667   ,  42.06666666666667   ,  42.306666666666665  ,  42.54666666666667   ,  42.78666666666667   ,  61.42666666666668   ,  61.773333333333326  ,  62.120000000000005  ,  62.46666666666667   ,  38.29333333333334   ,  38.50666666666667   ,  38.72               ,  38.93333333333334   ,  58.080000000000005  ,  58.400000000000006  ,  58.72               ,  59.03999999999999   ,  39.14666666666667   ,  39.36               ,  39.57333333333333   ,  39.78666666666666   ,  72.83555555555556   ,  73.22666666666666   ,  73.61777777777777   ,  74.00888888888889   ,  53.47555555555556   ,  53.760000000000005  ,  54.044444444444444  ,  54.32888888888889   ,  53.47555555555556   ,  53.760000000000005  ,  54.044444444444444  ,  54.32888888888889   ,  12.5625             ,  12.625              ,  12.6875             ,  12.75               ,  22.8125             ,  22.925              ,  23.0375             ,  23.15               ,  22.8125             ,  22.925              ,  23.0375             ,  23.15               ,  33.2625             ,  33.425              ,  33.587500000000006  ,  33.75               ,  20.700000000000003  ,  20.8                ,  20.900000000000002  ,  21.                 ,  31.35               ,  31.5                ,  31.650000000000002  ,  31.8                ,  21.1                ,  21.200000000000003  ,  21.3                ,  21.400000000000002  ,  39.18333333333334   ,  39.36666666666667   ,  39.55               ,  39.733333333333334  ,  28.733333333333334  ,  28.866666666666667  ,  29.                 ,  29.133333333333333  ,  28.733333333333334  ,  28.866666666666667  ,  29.                 ,  29.133333333333333  ,  23.6125             ,  23.725              ,  23.8375             ,  23.950000000000003  ,  42.8625             ,  43.065000000000005  ,  43.2675             ,  43.47               ,  42.8625             ,  43.065000000000005  ,  43.2675             ,  43.47               ,  62.4725             ,  62.765              ,  63.057500000000005  ,  63.35000000000001   ,  38.86               ,  39.040000000000006  ,  39.220000000000006  ,  39.4                ,  58.830000000000005  ,  59.1                ,  59.370000000000005  ,  59.64               ,  39.58               ,  39.760000000000005  ,  39.94               ,  40.12               ,  73.46333333333334   ,  73.79333333333334   ,  74.12333333333333   ,  74.45333333333333   ,  53.85333333333333   ,  54.093333333333334  ,  54.33333333333333   ,  54.57333333333333   ,  53.85333333333333   ,  54.093333333333334  ,  54.33333333333333   ,  54.57333333333333   ,  23.6125             ,  23.725              ,  23.8375             ,  23.950000000000003  ,  42.8625             ,  43.065000000000005  ,  43.2675             ,  43.47               ,  42.8625             ,  43.065000000000005  ,  43.2675             ,  43.47               ,  62.4725             ,  62.765              ,  63.057500000000005  ,  63.35000000000001   ,  38.86               ,  39.040000000000006  ,  39.220000000000006  ,  39.4                ,  58.830000000000005  ,  59.1                ,  59.370000000000005  ,  59.64               ,  39.58               ,  39.760000000000005  ,  39.94               ,  40.12               ,  73.46333333333334   ,  73.79333333333334   ,  74.12333333333333   ,  74.45333333333333   ,  53.85333333333333   ,  54.093333333333334  ,  54.33333333333333   ,  54.57333333333333   ,  53.85333333333333   ,  54.093333333333334  ,  54.33333333333333   ,  54.57333333333333   ,  35.6625             ,  35.825              ,  35.9875             ,  36.150000000000006  ,  64.71249999999999   ,  65.00500000000001   ,  65.2975             ,  65.59               ,  64.71249999999999   ,  65.00500000000001   ,  65.2975             ,  65.59               ,  94.2825             ,  94.70500000000001   ,  95.12750000000001   ,  95.55000000000001   ,  58.62               ,  58.88000000000001   ,  59.14000000000001   ,  59.4                ,  88.71000000000001   ,  89.1                ,  89.49000000000001   ,  89.88               ,  59.66               ,  59.92               ,  60.18               ,  60.44               , 110.67666666666668   , 111.15333333333334   , 111.63000000000001   , 112.10666666666665   ,  81.10666666666665   ,  81.45333333333333   ,  81.8                ,  82.14666666666666   ,  81.10666666666665   ,  81.45333333333333   ,  81.8                ,  82.14666666666666   ,  23.1                ,  23.200000000000003  ,  23.3                ,  23.400000000000002  ,  41.900000000000006  ,  42.08               ,  42.260000000000005  ,  42.440000000000005  ,  41.900000000000006  ,  42.08               ,  42.260000000000005  ,  42.440000000000005  ,  61.02               ,  61.28               ,  61.54               ,  61.800000000000004  ,  37.92               ,  38.08               ,  38.24               ,  38.4                ,  57.36               ,  57.599999999999994  ,  57.84               ,  58.08               ,  38.56               ,  38.72               ,  38.88               ,  39.04               ,  71.49333333333334   ,  71.78666666666668   ,  72.08000000000001   ,  72.37333333333333   ,  52.37333333333333   ,  52.58666666666667   ,  52.800000000000004  ,  53.013333333333335  ,  52.37333333333333   ,  52.58666666666667   ,  52.800000000000004  ,  53.013333333333335  ,  36.150000000000006  ,  36.300000000000004  ,  36.45               ,  36.6                ,  65.55               ,  65.82               ,  66.09               ,  66.36000000000001   ,  65.55               ,  65.82               ,  66.09               ,  66.36000000000001   ,  95.43               ,  95.82               ,  96.21000000000001   ,  96.6                ,  59.28               ,  59.519999999999996  ,  59.760000000000005  ,  60.                 ,  89.64               ,  90.                 ,  90.36000000000001   ,  90.72               ,  60.24               ,  60.48               ,  60.72               ,  60.96               , 111.64000000000001   , 112.08000000000001   , 112.52000000000001   , 112.96000000000001   ,  81.75999999999999   ,  82.08000000000001   ,  82.4                ,  82.72000000000001   ,  81.75999999999999   ,  82.08000000000001   ,  82.4                ,  82.72000000000001   ,  25.1                ,  25.200000000000003  ,  25.3                ,  25.400000000000002  ,  45.50000000000001   ,  45.68000000000001   ,  45.86               ,  46.04               ,  45.50000000000001   ,  45.68000000000001   ,  45.86               ,  46.04               ,  66.22               ,  66.48               ,  66.74               ,  67.                 ,  41.12               ,  41.28               ,  41.44               ,  41.6                ,  62.160000000000004  ,  62.4                ,  62.64               ,  62.88               ,  41.760000000000005  ,  41.92               ,  42.08               ,  42.24               ,  77.36               ,  77.65333333333334   ,  77.94666666666666   ,  78.24000000000001   ,  56.64               ,  56.85333333333333   ,  57.06666666666667   ,  57.28               ,  56.64               ,  56.85333333333333   ,  57.06666666666667   ,  57.28               ,  48.516666666666666  ,  48.7                ,  48.88333333333333   ,  49.06666666666666   ,  87.91666666666667   ,  88.24666666666667   ,  88.57666666666665   ,  88.90666666666667   ,  87.91666666666667   ,  88.24666666666667   ,  88.57666666666665   ,  88.90666666666667   , 127.90333333333332   , 128.38               , 128.85666666666665   , 129.33333333333331   ,  79.38666666666666   ,  79.67999999999999   ,  79.97333333333333   ,  80.26666666666667   , 119.96               , 120.4                , 120.84000000000002   , 121.28               ,  80.56               ,  80.85333333333332   ,  81.14666666666666   ,  81.44               , 149.16               , 149.6977777777778    , 150.23555555555555   , 150.77333333333334   , 109.17333333333333   , 109.56444444444443   , 109.95555555555555   , 110.34666666666666   , 109.17333333333333   , 109.56444444444443   , 109.95555555555555   , 110.34666666666666   ,  36.46666666666667   ,  36.6                ,  36.733333333333334  ,  36.86666666666667   ,  66.06666666666666   ,  66.30666666666667   ,  66.54666666666665   ,  66.78666666666666   ,  66.06666666666666   ,  66.30666666666667   ,  66.54666666666665   ,  66.78666666666666   ,  96.09333333333332   ,  96.44               ,  96.78666666666666   ,  97.13333333333334   ,  59.626666666666665  ,  59.84               ,  60.053333333333335  ,  60.266666666666666  ,  90.08               ,  90.4                ,  90.72               ,  91.04               ,  60.48               ,  60.693333333333335  ,  60.906666666666666  ,  61.120000000000005  , 111.94666666666666   , 112.33777777777777   , 112.72888888888889   , 113.12               ,  81.91999999999999   ,  82.20444444444445   ,  82.48888888888888   ,  82.77333333333334   ,  81.91999999999999   ,  82.20444444444445   ,  82.48888888888888   ,  82.77333333333334   ,  36.46666666666667   ,  36.6                ,  36.733333333333334  ,  36.86666666666667   ,  66.06666666666666   ,  66.30666666666667   ,  66.54666666666665   ,  66.78666666666666   ,  66.06666666666666   ,  66.30666666666667   ,  66.54666666666665   ,  66.78666666666666   ,  96.09333333333332   ,  96.44               ,  96.78666666666666   ,  97.13333333333334   ,  59.626666666666665  ,  59.84               ,  60.053333333333335  ,  60.266666666666666  ,  90.08               ,  90.4                ,  90.72               ,  91.04               ,  60.48               ,  60.693333333333335  ,  60.906666666666666  ,  61.120000000000005  , 111.94666666666666   , 112.33777777777777   , 112.72888888888889   , 113.12               ,  81.91999999999999   ,  82.20444444444445   ,  82.48888888888888   ,  82.77333333333334   ,  81.91999999999999   ,  82.20444444444445   ,  82.48888888888888   ,  82.77333333333334   };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride2Grad, VALID3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.6                ,  0.72               ,  0.8400000000000001 ,  0.96               ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.04               ,  0.08               ,  0.12               ,  0.16               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.24000000000000002,  0.32               ,  0.4                ,  0.48               ,  0.6                ,  0.72               ,  0.8400000000000001 ,  0.96               ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.36               ,  0.4                ,  0.44               ,  0.48               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  0.56               ,  0.64               ,  0.72               ,  0.8                ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  1.44               ,  1.6                ,  1.76               ,  1.9200000000000002 ,  2.64               ,  2.88               ,  3.12               ,  3.3600000000000003 ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  2.08               ,  2.2399999999999998 ,  2.4                ,  2.56               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  1.2                ,  1.28               ,  1.36               ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.56               ,  1.6800000000000002 ,  1.8                ,  1.9200000000000002 ,  1.56               ,  1.6800000000000002 ,  1.8                ,  1.9200000000000002 ,  3.5999999999999996 ,  3.84               ,  4.08               ,  4.32               ,  3.5999999999999996 ,  3.84               ,  4.08               ,  4.32               ,  6.12               ,  6.48               ,  6.840000000000001  ,  7.200000000000001  ,  4.5600000000000005 ,  4.8                ,  5.04               ,  5.279999999999999  ,  4.5600000000000005 ,  4.8                ,  5.04               ,  5.279999999999999  ,  2.52               ,  2.64               ,  2.7600000000000002 ,  2.88               ,  2.52               ,  2.64               ,  2.7600000000000002 ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.7600000000000002 ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.7600000000000002 ,  3.3600000000000003 ,  3.5200000000000005 ,  3.6799999999999997 ,  3.84               ,  3.3600000000000003 ,  3.5200000000000005 ,  3.6799999999999997 ,  3.84               ,  5.5200000000000005 ,  5.760000000000001  ,  6.                 ,  6.24               ,  4.                 ,  4.16               ,  4.32               ,  4.48               ,  4.                 ,  4.16               ,  4.32               ,  4.48               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4                ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.7600000000000002 ,  1.52               ,  1.6                ,  1.6800000000000002 ,  1.7600000000000002 ,  3.3600000000000003 ,  3.5200000000000005 ,  3.6799999999999997 ,  3.84               ,  3.3600000000000003 ,  3.5200000000000005 ,  3.6799999999999997 ,  3.84               ,  5.5200000000000005 ,  5.760000000000001  ,  6.                 ,  6.24               ,  4.                 ,  4.16               ,  4.32               ,  4.48               ,  4.                 ,  4.16               ,  4.32               ,  4.48               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4                ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  3.4800000000000004 ,  3.6000000000000005 ,  3.7200000000000006 ,  3.8400000000000003 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  1.                 ,  1.04               ,  1.08               ,  1.12               ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  2.16               ,  2.24               ,  2.3200000000000003 ,  2.4000000000000004 ,  3.4800000000000004 ,  3.6000000000000005 ,  3.7200000000000006 ,  3.8400000000000003 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  2.48               ,  2.56               ,  2.64               ,  2.7199999999999998 ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  1.32               ,  1.36               ,  1.4000000000000001 ,  1.44               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  4.92               ,  5.04               ,  5.16               ,  5.28               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  1.48               ,  1.52               ,  1.56               ,  1.6                ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  3.12               ,  3.2                ,  3.2800000000000002 ,  3.3600000000000003 ,  4.92               ,  5.04               ,  5.16               ,  5.28               ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  3.4400000000000004 ,  3.52               ,  3.6                ,  3.6799999999999997 ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  1.8                ,  1.84               ,  1.8800000000000001 ,  1.92               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  3.44               ,  3.52               ,  3.6                ,  3.68               ,  3.44               ,  3.52               ,  3.6                ,  3.68               ,  7.2                ,  7.36               ,  7.5200000000000005 ,  7.680000000000001  ,  7.2                ,  7.36               ,  7.5200000000000005 ,  7.680000000000001  , 11.280000000000001  , 11.52               , 11.76               , 12.000000000000002  ,  7.840000000000001  ,  8.                 ,  8.16               ,  8.32               ,  7.840000000000001  ,  8.                 ,  8.16               ,  8.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  3.44               ,  3.52               ,  3.6                ,  3.68               ,  3.44               ,  3.52               ,  3.6                ,  3.68               ,  7.2                ,  7.36               ,  7.5200000000000005 ,  7.680000000000001  ,  7.2                ,  7.36               ,  7.5200000000000005 ,  7.680000000000001  , 11.280000000000001  , 11.52               , 11.76               , 12.000000000000002  ,  7.840000000000001  ,  8.                 ,  8.16               ,  8.32               ,  7.840000000000001  ,  8.                 ,  8.16               ,  8.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  4.08               ,  4.16               ,  4.24               ,  4.32               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  5.88               ,  6.                 ,  6.12               ,  6.24               ,  5.88               ,  6.                 ,  6.12               ,  6.24               , 12.24               , 12.48               , 12.72               , 12.96               , 12.24               , 12.48               , 12.72               , 12.96               , 19.080000000000002  , 19.44               , 19.8                , 20.16               , 13.200000000000001  , 13.440000000000001  , 13.68               , 13.920000000000002  , 13.200000000000001  , 13.440000000000001  , 13.68               , 13.920000000000002  ,  6.84               ,  6.960000000000001  ,  7.08               ,  7.2                ,  6.84               ,  6.960000000000001  ,  7.08               ,  7.2                ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  4.4                ,  4.48               ,  4.5600000000000005 ,  4.640000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  ,  9.12               ,  9.280000000000001  ,  9.44               ,  9.600000000000001  , 14.16               , 14.400000000000002  , 14.639999999999999  , 14.880000000000003  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  9.76               ,  9.920000000000002  , 10.08               , 10.240000000000002  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  5.040000000000001  ,  5.12               ,  5.199999999999999  ,  5.279999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  7.800000000000001  ,  7.92               ,  8.04               ,  8.16               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  2.44               ,  2.48               ,  2.52               ,  2.56               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  5.04               ,  5.12               ,  5.2                ,  5.28               ,  7.800000000000001  ,  7.92               ,  8.04               ,  8.16               ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  5.36               ,  5.44               ,  5.52               ,  5.6                ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  2.7600000000000002 ,  2.8000000000000003 ,  2.84               ,  2.88               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.92               ,  2.96               ,  3.                 ,  3.04               ,  2.92               ,  2.96               ,  3.                 ,  3.04               ,  6.                 ,  6.08               ,  6.16               ,  6.24               ,  6.                 ,  6.08               ,  6.16               ,  6.24               ,  9.24               ,  9.36               ,  9.48               ,  9.6                ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 ,  3.24               ,  3.2800000000000002 ,  3.3200000000000003 ,  3.36               ,  3.24               ,  3.2800000000000002 ,  3.3200000000000003 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  2.92               ,  2.96               ,  3.                 ,  3.04               ,  2.92               ,  2.96               ,  3.                 ,  3.04               ,  6.                 ,  6.08               ,  6.16               ,  6.24               ,  6.                 ,  6.08               ,  6.16               ,  6.24               ,  9.24               ,  9.36               ,  9.48               ,  9.6                ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 ,  3.24               ,  3.2800000000000002 ,  3.3200000000000003 ,  3.36               ,  3.24               ,  3.2800000000000002 ,  3.3200000000000003 ,  3.36               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 , 12.96               , 13.12               , 13.280000000000001  , 13.44               , 12.96               , 13.12               , 13.280000000000001  , 13.44               , 19.919999999999998  , 20.16               , 20.400000000000002  , 20.64               , 13.600000000000001  , 13.76               , 13.920000000000002  , 14.08               , 13.600000000000001  , 13.76               , 13.920000000000002  , 14.08               ,  6.960000000000001  ,  7.040000000000001  ,  7.120000000000001  ,  7.199999999999999  ,  6.960000000000001  ,  7.040000000000001  ,  7.120000000000001  ,  7.199999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 ,  6.32               ,  6.4                ,  6.48               ,  6.5600000000000005 , 12.96               , 13.12               , 13.280000000000001  , 13.44               , 12.96               , 13.12               , 13.280000000000001  , 13.44               , 19.919999999999998  , 20.16               , 20.400000000000002  , 20.64               , 13.600000000000001  , 13.76               , 13.920000000000002  , 14.08               , 13.600000000000001  , 13.76               , 13.920000000000002  , 14.08               ,  6.960000000000001  ,  7.040000000000001  ,  7.120000000000001  ,  7.199999999999999  ,  6.960000000000001  ,  7.040000000000001  ,  7.120000000000001  ,  7.199999999999999  ,  0.                 ,  0.                 ,  0.                 ,  0.                 , 10.2                , 10.32               , 10.440000000000001  , 10.56               , 10.2                , 10.32               , 10.440000000000001  , 10.56               , 20.88               , 21.119999999999997  , 21.360000000000003  , 21.599999999999998  , 20.88               , 21.119999999999997  , 21.360000000000003  , 21.599999999999998  , 32.04               , 32.4                , 32.760000000000005  , 33.120000000000005  , 21.84               , 22.08               , 22.320000000000004  , 22.560000000000002  , 21.84               , 22.08               , 22.320000000000004  , 22.560000000000002  , 11.16               , 11.280000000000001  , 11.400000000000002  , 11.52               , 11.16               , 11.280000000000001  , 11.400000000000002  , 11.52               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  7.279999999999999  ,  7.359999999999999  ,  7.4399999999999995 ,  7.52               ,  7.279999999999999  ,  7.359999999999999  ,  7.4399999999999995 ,  7.52               , 14.879999999999999  , 15.040000000000001  , 15.2                , 15.36               , 14.879999999999999  , 15.040000000000001  , 15.2                , 15.36               , 22.799999999999997  , 23.04               , 23.28               , 23.52               , 15.52               , 15.680000000000001  , 15.84               , 16.                 , 15.52               , 15.680000000000001  , 15.84               , 16.                 ,  7.92               ,  8.                 ,  8.08               ,  8.16               ,  7.92               ,  8.                 ,  8.08               ,  8.16               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  7.279999999999999  ,  7.359999999999999  ,  7.4399999999999995 ,  7.52               ,  7.279999999999999  ,  7.359999999999999  ,  7.4399999999999995 ,  7.52               , 14.879999999999999  , 15.040000000000001  , 15.2                , 15.36               , 14.879999999999999  , 15.040000000000001  , 15.2                , 15.36               , 22.799999999999997  , 23.04               , 23.28               , 23.52               , 15.52               , 15.680000000000001  , 15.84               , 16.                 , 15.52               , 15.680000000000001  , 15.84               , 16.                 ,  7.92               ,  8.                 ,  8.08               ,  8.16               ,  7.92               ,  8.                 ,  8.08               ,  8.16               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  3.88               ,  3.92               ,  3.96               ,  4.                 ,  3.88               ,  3.92               ,  3.96               ,  4.                 ,  7.92               ,  8.                 ,  8.08               ,  8.16               ,  7.92               ,  8.                 ,  8.08               ,  8.16               , 12.120000000000001  , 12.24               , 12.36               , 12.48               ,  8.24               ,  8.32               ,  8.4                ,  8.48               ,  8.24               ,  8.32               ,  8.4                ,  8.48               ,  4.2                ,  4.24               ,  4.28               ,  4.32               ,  4.2                ,  4.24               ,  4.28               ,  4.32               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  3.88               ,  3.92               ,  3.96               ,  4.                 ,  3.88               ,  3.92               ,  3.96               ,  4.                 ,  7.92               ,  8.                 ,  8.08               ,  8.16               ,  7.92               ,  8.                 ,  8.08               ,  8.16               , 12.120000000000001  , 12.24               , 12.36               , 12.48               ,  8.24               ,  8.32               ,  8.4                ,  8.48               ,  8.24               ,  8.32               ,  8.4                ,  8.48               ,  4.2                ,  4.24               ,  4.28               ,  4.32               ,  4.2                ,  4.24               ,  4.28               ,  4.32               ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 ,  0.                 };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 2>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}

