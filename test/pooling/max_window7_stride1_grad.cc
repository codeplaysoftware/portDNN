/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.13.2.

#include <gtest/gtest.h>

#include "sycldnn/padding_mode.h"

#include "sycldnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/kernel_data_types.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using GTestTypePairs = sycldnn::types::ToGTestTypes<SNNTypePairs>::type;

template <typename Pair>
using MaxWindow7Stride1Grad =
    PoolingFixture<typename Pair::FirstType, typename Pair::SecondType,
                   pooling::Max, pooling::Backpropagate>;
TYPED_TEST_SUITE(MaxWindow7Stride1Grad, GTestTypePairs);
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,   0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,
      0.,  0.,  0.,  0.,   0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,
      0.,  1.,  2.,  3.,   4.,  26., 0.,  0.,   0.,   9.,   10.,  11., 12.,
      58., 0.,  0.,  0.,   17., 18., 19., 20.,  90.,  0.,   0.,   0.,  25.,
      26., 27., 28., 122., 0.,  0.,  0.,  180., 184., 188., 192., 808.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 1., 2., 0., 0., 0., 0., 0., 0., 3., 4.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   1.,    2.,   3.,  4.,  5.,   6.,
      7.,   8.,   48.,  52.,  0.,   0.,   0.,    0.,   0.,  0.,  17.,  18.,
      19.,  20.,  21.,  22.,  23.,  24.,  112.,  116., 0.,  0.,  0.,   0.,
      0.,   0.,   33.,  34.,  35.,  36.,  37.,   38.,  39., 40., 176., 180.,
      0.,   0.,   0.,   0.,   0.,   0.,   49.,   50.,  51., 52., 53.,  54.,
      55.,  56.,  240., 244., 0.,   0.,   0.,    0.,   0.,  0.,  356., 360.,
      364., 368., 372., 376., 380., 384., 1600., 1616.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 2., 3., 4.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5., 6., 7., 8.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      1.,    2.,    3.,    4.,   5.,   6.,   7.,   8.,   9.,   10.,  11.,  12.,
      13.,   14.,   15.,   16.,  92.,  96.,  100., 104., 0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   33.,  34.,  35.,  36.,
      37.,   38.,   39.,   40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,  48.,
      220.,  224.,  228.,  232., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   65.,  66.,  67.,  68.,  69.,  70.,  71.,  72.,
      73.,   74.,   75.,   76.,  77.,  78.,  79.,  80.,  348., 352., 356., 360.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      97.,   98.,   99.,   100., 101., 102., 103., 104., 105., 106., 107., 108.,
      109.,  110.,  111.,  112., 476., 480., 484., 488., 0.,   0.,   0.,   0.,
      0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   708., 712., 716., 720.,
      724.,  728.,  732.,  736., 740., 744., 748., 752., 756., 760., 764., 768.,
      3184., 3200., 3216., 3232.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1., 2.,  3.,  4.,  5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12., 13., 14., 15., 16.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,  0.,  0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,  0.,  0.,   0.,  0.,  0.,   1.,   2.,   3.,   4.,   5.,   30.,
      0.,  0.,  0.,   10., 11., 12.,  13.,  14.,  66.,  0.,   0.,   0.,
      19., 20., 21.,  22., 23., 102., 0.,   0.,   0.,   28.,  29.,  30.,
      31., 32., 138., 0.,  0.,  0.,   202., 206., 210., 214., 218., 912.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 1., 2., 3., 0., 0., 0., 0., 0., 0., 4., 5., 6.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,   10.,  56.,   60.,
      0.,   0.,   0.,   0.,   0.,   0.,   19.,  20.,  21.,  22.,  23.,   24.,
      25.,  26.,  27.,  28.,  128., 132., 0.,   0.,   0.,   0.,   0.,    0.,
      37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  200.,  204.,
      0.,   0.,   0.,   0.,   0.,   0.,   55.,  56.,  57.,  58.,  59.,   60.,
      61.,  62.,  63.,  64.,  272., 276., 0.,   0.,   0.,   0.,   0.,    0.,
      400., 404., 408., 412., 416., 420., 424., 428., 432., 436., 1808., 1824.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1., 2., 3., 4., 5., 6.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 7., 8., 9., 10., 11., 12.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    1.,
      2.,    3.,   4.,   5.,   6.,   7.,   8.,   9.,   10.,  11.,   12.,
      13.,   14.,  15.,  16.,  17.,  18.,  19.,  20.,  108., 112.,  116.,
      120.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,   45.,
      46.,   47.,  48.,  49.,  50.,  51.,  52.,  53.,  54.,  55.,   56.,
      252.,  256., 260., 264., 0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   73.,  74.,  75.,  76.,  77.,   78.,
      79.,   80.,  81.,  82.,  83.,  84.,  85.,  86.,  87.,  88.,   89.,
      90.,   91.,  92.,  396., 400., 404., 408., 0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   109., 110.,  111.,
      112.,  113., 114., 115., 116., 117., 118., 119., 120., 121.,  122.,
      123.,  124., 125., 126., 127., 128., 540., 544., 548., 552.,  0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      796.,  800., 804., 808., 812., 816., 820., 824., 828., 832.,  836.,
      840.,  844., 848., 852., 856., 860., 864., 868., 872., 3600., 3616.,
      3632., 3648.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      1.,  2.,  3., 4., 5., 6., 7.,  8.,  9.,  10., 11., 12., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 13., 14., 15., 16., 17., 18., 19., 20., 21.,
      22., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 8, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  1.,   2.,  3.,
      4.,  5.,   6.,   34.,  0.,   0.,   0.,   11.,  12., 13.,  14., 15.,
      16., 74.,  0.,   0.,   0.,   21.,  22.,  23.,  24., 25.,  26., 114.,
      0.,  0.,   0.,   31.,  32.,  33.,  34.,  35.,  36., 154., 0.,  0.,
      0.,  224., 228., 232., 236., 240., 244., 1016.};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 1., 2., 3., 4., 0., 0., 0., 0., 0., 0., 5., 6., 7., 8.};
  const std::array<int, 4> in_shape = {{1, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,   1.,   2.,   3.,   4.,   5.,   6.,
      7.,   8.,   9.,    10.,  11.,  12.,  64.,  68.,  0.,   0.,   0.,   0.,
      0.,   0.,   21.,   22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,  30.,
      31.,  32.,  144.,  148., 0.,   0.,   0.,   0.,   0.,   0.,   41.,  42.,
      43.,  44.,  45.,   46.,  47.,  48.,  49.,  50.,  51.,  52.,  224., 228.,
      0.,   0.,   0.,    0.,   0.,   0.,   61.,  62.,  63.,  64.,  65.,  66.,
      67.,  68.,  69.,   70.,  71.,  72.,  304., 308., 0.,   0.,   0.,   0.,
      0.,   0.,   444.,  448., 452., 456., 460., 464., 468., 472., 476., 480.,
      484., 488., 2016., 2032.};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 1., 2., 3., 4., 5., 6.,  7.,  8.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12., 13., 14., 15., 16.};
  const std::array<int, 4> in_shape = {{1, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,   4.,   5.,    6.,    7.,    8.,   9.,   10.,  11.,  12.,
      13.,  14.,  15.,  16.,  17.,   18.,   19.,   20.,  21.,  22.,  23.,  24.,
      124., 128., 132., 136., 0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   41.,   42.,   43.,   44.,  45.,  46.,  47.,  48.,
      49.,  50.,  51.,  52.,  53.,   54.,   55.,   56.,  57.,  58.,  59.,  60.,
      61.,  62.,  63.,  64.,  284.,  288.,  292.,  296., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   81.,  82.,  83.,  84.,
      85.,  86.,  87.,  88.,  89.,   90.,   91.,   92.,  93.,  94.,  95.,  96.,
      97.,  98.,  99.,  100., 101.,  102.,  103.,  104., 444., 448., 452., 456.,
      0.,   0.,   0.,   0.,   0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      121., 122., 123., 124., 125.,  126.,  127.,  128., 129., 130., 131., 132.,
      133., 134., 135., 136., 137.,  138.,  139.,  140., 141., 142., 143., 144.,
      604., 608., 612., 616., 0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   884.,  888.,  892.,  896., 900., 904., 908., 912.,
      916., 920., 924., 928., 932.,  936.,  940.,  944., 948., 952., 956., 960.,
      964., 968., 972., 976., 4016., 4032., 4048., 4064.};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  3.,  4.,  5.,  6.,
      7.,  8.,  9.,  10., 11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27.,
      28., 29., 30., 31., 32.};
  const std::array<int, 4> in_shape = {{1, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,   0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,
      0.,  0.,  0.,  0.,   0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,
      0.,  0.,  0.,  1.,   2.,  3.,  4.,  26.,  0.,   0.,   0.,   9.,
      10., 11., 12., 58.,  0.,  0.,  0.,  17.,  18.,  19.,  20.,  90.,
      0.,  0.,  0.,  25.,  26., 27., 28., 122., 0.,   0.,   0.,   33.,
      34., 35., 36., 154., 0.,  0.,  0.,  212., 216., 220., 224., 936.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 5., 6.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,  0.,  0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,   5.,    6.,
      7.,  8.,  48.,  52.,  0.,   0.,   0.,   0.,   0.,   0.,   17.,   18.,
      19., 20., 21.,  22.,  23.,  24.,  112., 116., 0.,   0.,   0.,    0.,
      0.,  0.,  33.,  34.,  35.,  36.,  37.,  38.,  39.,  40.,  176.,  180.,
      0.,  0.,  0.,   0.,   0.,   0.,   49.,  50.,  51.,  52.,  53.,   54.,
      55., 56., 240., 244., 0.,   0.,   0.,   0.,   0.,   0.,   65.,   66.,
      67., 68., 69.,  70.,  71.,  72.,  304., 308., 0.,   0.,   0.,    0.,
      0.,  0.,  420., 424., 428., 432., 436., 440., 444., 448., 1856., 1872.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 2.,  3.,  4.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5., 6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,    2.,
      3.,    4.,   5.,   6.,   7.,   8.,   9.,   10.,  11.,  12.,   13.,
      14.,   15.,  16.,  92.,  96.,  100., 104., 0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   33.,  34.,   35.,
      36.,   37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,   46.,
      47.,   48.,  220., 224., 228., 232., 0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   65.,  66.,  67.,   68.,
      69.,   70.,  71.,  72.,  73.,  74.,  75.,  76.,  77.,  78.,   79.,
      80.,   348., 352., 356., 360., 0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   97.,  98.,  99.,  100.,  101.,
      102.,  103., 104., 105., 106., 107., 108., 109., 110., 111.,  112.,
      476.,  480., 484., 488., 0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   0.,   129., 130., 131., 132., 133.,  134.,
      135.,  136., 137., 138., 139., 140., 141., 142., 143., 144.,  604.,
      608.,  612., 616., 0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,    0.,   0.,   0.,   836., 840., 844., 848., 852., 856.,  860.,
      864.,  868., 872., 876., 880., 884., 888., 892., 896., 3696., 3712.,
      3728., 3744.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20., 21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 9, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,  5.,  30.,
      0.,  0.,  0.,   10.,  11.,  12.,  13.,  14.,  66.,  0.,  0.,  0.,
      19., 20., 21.,  22.,  23.,  102., 0.,   0.,   0.,   28., 29., 30.,
      31., 32., 138., 0.,   0.,   0.,   37.,  38.,  39.,  40., 41., 174.,
      0.,  0.,  0.,   238., 242., 246., 250., 254., 1056.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 2., 3., 0., 0., 0., 0., 0.,
      0., 4., 5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 9.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,   4.,   5.,    6.,   7.,   8.,   9.,   10.,  56.,  60.,
      0.,   0.,   0.,   0.,   0.,    0.,   19.,  20.,  21.,  22.,  23.,  24.,
      25.,  26.,  27.,  28.,  128.,  132., 0.,   0.,   0.,   0.,   0.,   0.,
      37.,  38.,  39.,  40.,  41.,   42.,  43.,  44.,  45.,  46.,  200., 204.,
      0.,   0.,   0.,   0.,   0.,    0.,   55.,  56.,  57.,  58.,  59.,  60.,
      61.,  62.,  63.,  64.,  272.,  276., 0.,   0.,   0.,   0.,   0.,   0.,
      73.,  74.,  75.,  76.,  77.,   78.,  79.,  80.,  81.,  82.,  344., 348.,
      0.,   0.,   0.,   0.,   0.,    0.,   472., 476., 480., 484., 488., 492.,
      496., 500., 504., 508., 2096., 2112.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 1., 2., 3.,  4.,  5.,  6.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 7., 8.,  9.,  10., 11., 12., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 13., 14., 15., 16., 17., 18.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    1.,
      2.,    3.,    4.,    5.,    6.,   7.,   8.,   9.,    10.,   11.,   12.,
      13.,   14.,   15.,   16.,   17.,  18.,  19.,  20.,   108.,  112.,  116.,
      120.,  0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    37.,   38.,   39.,  40.,  41.,  42.,   43.,   44.,   45.,
      46.,   47.,   48.,   49.,   50.,  51.,  52.,  53.,   54.,   55.,   56.,
      252.,  256.,  260.,  264.,  0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   73.,  74.,  75.,   76.,   77.,   78.,
      79.,   80.,   81.,   82.,   83.,  84.,  85.,  86.,   87.,   88.,   89.,
      90.,   91.,   92.,   396.,  400., 404., 408., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    109.,  110.,  111.,
      112.,  113.,  114.,  115.,  116., 117., 118., 119.,  120.,  121.,  122.,
      123.,  124.,  125.,  126.,  127., 128., 540., 544.,  548.,  552.,  0.,
      0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      145.,  146.,  147.,  148.,  149., 150., 151., 152.,  153.,  154.,  155.,
      156.,  157.,  158.,  159.,  160., 161., 162., 163.,  164.,  684.,  688.,
      692.,  696.,  0.,    0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,    940.,  944., 948., 952., 956.,  960.,  964.,  968.,
      972.,  976.,  980.,  984.,  988., 992., 996., 1000., 1004., 1008., 1012.,
      1016., 4176., 4192., 4208., 4224.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.,  10., 11., 12., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  13., 14., 15., 16., 17., 18., 19., 20., 21.,
      22., 23., 24., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  25., 26., 27.,
      28., 29., 30., 31., 32., 33., 34., 35., 36.};
  const std::array<int, 4> in_shape = {{1, 9, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,  0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,  0.,   0.,  0.,  0.,   0.,   0.,   1.,   2.,   3.,   4.,   5.,   6.,
      34., 0.,   0.,  0.,  11.,  12.,  13.,  14.,  15.,  16.,  74.,  0.,   0.,
      0.,  21.,  22., 23., 24.,  25.,  26.,  114., 0.,   0.,   0.,   31.,  32.,
      33., 34.,  35., 36., 154., 0.,   0.,   0.,   41.,  42.,  43.,  44.,  45.,
      46., 194., 0.,  0.,  0.,   264., 268., 272., 276., 280., 284., 1176.};
  const std::array<int, 4> in_shape = {{1, 9, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 1., 2., 3., 4., 0., 0., 0.,  0.,  0.,
      0., 5., 6., 7., 8., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12.};
  const std::array<int, 4> in_shape = {{1, 9, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,   5.,    6.,
      7.,   8.,   9.,   10.,  11.,  12.,  64.,  68.,  0.,   0.,   0.,    0.,
      0.,   0.,   21.,  22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,   30.,
      31.,  32.,  144., 148., 0.,   0.,   0.,   0.,   0.,   0.,   41.,   42.,
      43.,  44.,  45.,  46.,  47.,  48.,  49.,  50.,  51.,  52.,  224.,  228.,
      0.,   0.,   0.,   0.,   0.,   0.,   61.,  62.,  63.,  64.,  65.,   66.,
      67.,  68.,  69.,  70.,  71.,  72.,  304., 308., 0.,   0.,   0.,    0.,
      0.,   0.,   81.,  82.,  83.,  84.,  85.,  86.,  87.,  88.,  89.,   90.,
      91.,  92.,  384., 388., 0.,   0.,   0.,   0.,   0.,   0.,   524.,  528.,
      532., 536., 540., 544., 548., 552., 556., 560., 564., 568., 2336., 2352.};
  const std::array<int, 4> in_shape = {{1, 9, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  3.,
      4., 5., 6., 7.,  8.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 9., 10., 11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  17., 18., 19., 20., 21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 9, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,
      9.,    10.,   11.,   12.,   13.,   14.,   15.,   16.,   17.,   18.,
      19.,   20.,   21.,   22.,   23.,   24.,   124.,  128.,  132.,  136.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    41.,   42.,   43.,   44.,   45.,   46.,   47.,   48.,
      49.,   50.,   51.,   52.,   53.,   54.,   55.,   56.,   57.,   58.,
      59.,   60.,   61.,   62.,   63.,   64.,   284.,  288.,  292.,  296.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    81.,   82.,   83.,   84.,   85.,   86.,   87.,   88.,
      89.,   90.,   91.,   92.,   93.,   94.,   95.,   96.,   97.,   98.,
      99.,   100.,  101.,  102.,  103.,  104.,  444.,  448.,  452.,  456.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,
      129.,  130.,  131.,  132.,  133.,  134.,  135.,  136.,  137.,  138.,
      139.,  140.,  141.,  142.,  143.,  144.,  604.,  608.,  612.,  616.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    161.,  162.,  163.,  164.,  165.,  166.,  167.,  168.,
      169.,  170.,  171.,  172.,  173.,  174.,  175.,  176.,  177.,  178.,
      179.,  180.,  181.,  182.,  183.,  184.,  764.,  768.,  772.,  776.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1044., 1048., 1052., 1056., 1060., 1064., 1068., 1072.,
      1076., 1080., 1084., 1088., 1092., 1096., 1100., 1104., 1108., 1112.,
      1116., 1120., 1124., 1128., 1132., 1136., 4656., 4672., 4688., 4704.};
  const std::array<int, 4> in_shape = {{1, 9, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,
      3.,  4.,  5.,  6.,  7.,  8.,  9.,  10., 11., 12., 13., 14., 15., 16.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  17., 18., 19., 20.,
      21., 22., 23., 24., 25., 26., 27., 28., 29., 30., 31., 32., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  33., 34., 35., 36., 37., 38.,
      39., 40., 41., 42., 43., 44., 45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{1, 9, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,
      0.,  0.,  0.,  1.,   2.,   3.,   4.,   26.,  0.,  0.,  0.,  9.,
      10., 11., 12., 58.,  0.,   0.,   0.,   17.,  18., 19., 20., 90.,
      0.,  0.,  0.,  25.,  26.,  27.,  28.,  122., 0.,  0.,  0.,  33.,
      34., 35., 36., 154., 0.,   0.,   0.,   41.,  42., 43., 44., 186.,
      0.,  0.,  0.,  244., 248., 252., 256., 1064.};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 1., 2., 0., 0., 0., 0., 0., 0., 3., 4.,
      0., 0., 0., 0., 0., 0., 5., 6., 0., 0., 0., 0., 0., 0., 7., 8.};
  const std::array<int, 4> in_shape = {{1, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,  0.,  1.,   2.,   3.,   4.,   5.,   6.,
      7.,   8.,   48.,   52.,  0.,  0.,  0.,   0.,   0.,   0.,   17.,  18.,
      19.,  20.,  21.,   22.,  23., 24., 112., 116., 0.,   0.,   0.,   0.,
      0.,   0.,   33.,   34.,  35., 36., 37.,  38.,  39.,  40.,  176., 180.,
      0.,   0.,   0.,    0.,   0.,  0.,  49.,  50.,  51.,  52.,  53.,  54.,
      55.,  56.,  240.,  244., 0.,  0.,  0.,   0.,   0.,   0.,   65.,  66.,
      67.,  68.,  69.,   70.,  71., 72., 304., 308., 0.,   0.,   0.,   0.,
      0.,   0.,   81.,   82.,  83., 84., 85.,  86.,  87.,  88.,  368., 372.,
      0.,   0.,   0.,    0.,   0.,  0.,  484., 488., 492., 496., 500., 504.,
      508., 512., 2112., 2128.};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16.};
  const std::array<int, 4> in_shape = {{1, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    1.,    2.,
      3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,   11.,   12.,
      13.,   14.,   15.,   16.,   92.,   96.,   100.,  104.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      33.,   34.,   35.,   36.,   37.,   38.,   39.,   40.,   41.,   42.,
      43.,   44.,   45.,   46.,   47.,   48.,   220.,  224.,  228.,  232.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    65.,   66.,   67.,   68.,   69.,   70.,   71.,   72.,
      73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,   348.,  352.,
      356.,  360.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    97.,   98.,   99.,   100.,  101.,  102.,
      103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,  111.,  112.,
      476.,  480.,  484.,  488.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    129.,  130.,  131.,  132.,
      133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,  141.,  142.,
      143.,  144.,  604.,  608.,  612.,  616.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    161.,  162.,
      163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,  171.,  172.,
      173.,  174.,  175.,  176.,  732.,  736.,  740.,  744.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      964.,  968.,  972.,  976.,  980.,  984.,  988.,  992.,  996.,  1000.,
      1004., 1008., 1012., 1016., 1020., 1024., 4208., 4224., 4240., 4256.};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20., 21., 22., 23., 24.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 25., 26., 27., 28., 29., 30., 31., 32.};
  const std::array<int, 4> in_shape = {{1, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,   0.,   0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,  0.,   0.,   0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,  0.,   0.,   0.,  1.,  2.,  3.,   4.,   5.,   30.,  0.,   0.,   0.,
      10., 11.,  12.,  13., 14., 66., 0.,   0.,   0.,   19.,  20.,  21.,  22.,
      23., 102., 0.,   0.,  0.,  28., 29.,  30.,  31.,  32.,  138., 0.,   0.,
      0.,  37.,  38.,  39., 40., 41., 174., 0.,   0.,   0.,   46.,  47.,  48.,
      49., 50.,  210., 0.,  0.,  0.,  274., 278., 282., 286., 290., 1200.};
  const std::array<int, 4> in_shape = {{1, 10, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,
      1., 2., 3., 0., 0., 0., 0., 0., 0., 4., 5., 6., 0.,  0.,  0.,
      0., 0., 0., 7., 8., 9., 0., 0., 0., 0., 0., 0., 10., 11., 12.};
  const std::array<int, 4> in_shape = {{1, 10, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,
      1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,   10.,  56.,   60.,
      0.,   0.,   0.,   0.,   0.,   0.,   19.,  20.,  21.,  22.,  23.,   24.,
      25.,  26.,  27.,  28.,  128., 132., 0.,   0.,   0.,   0.,   0.,    0.,
      37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  200.,  204.,
      0.,   0.,   0.,   0.,   0.,   0.,   55.,  56.,  57.,  58.,  59.,   60.,
      61.,  62.,  63.,  64.,  272., 276., 0.,   0.,   0.,   0.,   0.,    0.,
      73.,  74.,  75.,  76.,  77.,  78.,  79.,  80.,  81.,  82.,  344.,  348.,
      0.,   0.,   0.,   0.,   0.,   0.,   91.,  92.,  93.,  94.,  95.,   96.,
      97.,  98.,  99.,  100., 416., 420., 0.,   0.,   0.,   0.,   0.,    0.,
      544., 548., 552., 556., 560., 564., 568., 572., 576., 580., 2384., 2400.};
  const std::array<int, 4> in_shape = {{1, 10, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 1., 2., 3.,  4.,  5.,  6.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 7., 8.,  9.,  10., 11., 12., 0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 13., 14., 15., 16., 17., 18., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  19., 20., 21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 10, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      11.,   12.,   13.,   14.,   15.,   16.,   17.,   18.,   19.,   20.,
      108.,  112.,  116.,  120.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    37.,   38.,   39.,   40.,
      41.,   42.,   43.,   44.,   45.,   46.,   47.,   48.,   49.,   50.,
      51.,   52.,   53.,   54.,   55.,   56.,   252.,  256.,  260.,  264.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      81.,   82.,   83.,   84.,   85.,   86.,   87.,   88.,   89.,   90.,
      91.,   92.,   396.,  400.,  404.,  408.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    109.,  110.,
      111.,  112.,  113.,  114.,  115.,  116.,  117.,  118.,  119.,  120.,
      121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,  540.,  544.,
      548.,  552.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    145.,  146.,  147.,  148.,  149.,  150.,
      151.,  152.,  153.,  154.,  155.,  156.,  157.,  158.,  159.,  160.,
      161.,  162.,  163.,  164.,  684.,  688.,  692.,  696.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,  189.,  190.,
      191.,  192.,  193.,  194.,  195.,  196.,  197.,  198.,  199.,  200.,
      828.,  832.,  836.,  840.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    1084., 1088., 1092., 1096.,
      1100., 1104., 1108., 1112., 1116., 1120., 1124., 1128., 1132., 1136.,
      1140., 1144., 1148., 1152., 1156., 1160., 4752., 4768., 4784., 4800.};
  const std::array<int, 4> in_shape = {{1, 10, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.,  10., 11., 12.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  13., 14., 15., 16.,
      17., 18., 19., 20., 21., 22., 23., 24., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  25., 26., 27., 28., 29., 30., 31., 32., 33., 34.,
      35., 36., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  37., 38.,
      39., 40., 41., 42., 43., 44., 45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{1, 10, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,   0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,   0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,  4.,  5.,   6.,
      34., 0.,   0.,   0.,   11.,  12.,  13.,  14.,  15.,  16., 74., 0.,   0.,
      0.,  21.,  22.,  23.,  24.,  25.,  26.,  114., 0.,   0.,  0.,  31.,  32.,
      33., 34.,  35.,  36.,  154., 0.,   0.,   0.,   41.,  42., 43., 44.,  45.,
      46., 194., 0.,   0.,   0.,   51.,  52.,  53.,  54.,  55., 56., 234., 0.,
      0.,  0.,   304., 308., 312., 316., 320., 324., 1336.};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0., 1., 2.,
      3., 4., 0.,  0.,  0.,  0., 0., 0., 5., 6., 7., 8.,  0.,  0.,  0., 0., 0.,
      0., 9., 10., 11., 12., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16.};
  const std::array<int, 4> in_shape = {{1, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   1.,    2.,   3.,   4.,   5.,   6.,
      7.,   8.,   9.,   10.,  11.,  12.,  64.,   68.,  0.,   0.,   0.,   0.,
      0.,   0.,   21.,  22.,  23.,  24.,  25.,   26.,  27.,  28.,  29.,  30.,
      31.,  32.,  144., 148., 0.,   0.,   0.,    0.,   0.,   0.,   41.,  42.,
      43.,  44.,  45.,  46.,  47.,  48.,  49.,   50.,  51.,  52.,  224., 228.,
      0.,   0.,   0.,   0.,   0.,   0.,   61.,   62.,  63.,  64.,  65.,  66.,
      67.,  68.,  69.,  70.,  71.,  72.,  304.,  308., 0.,   0.,   0.,   0.,
      0.,   0.,   81.,  82.,  83.,  84.,  85.,   86.,  87.,  88.,  89.,  90.,
      91.,  92.,  384., 388., 0.,   0.,   0.,    0.,   0.,   0.,   101., 102.,
      103., 104., 105., 106., 107., 108., 109.,  110., 111., 112., 464., 468.,
      0.,   0.,   0.,   0.,   0.,   0.,   604.,  608., 612., 616., 620., 624.,
      628., 632., 636., 640., 644., 648., 2656., 2672.};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  3.,
      4.,  5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  9.,  10., 11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  17., 18., 19., 20., 21., 22., 23., 24.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  25., 26., 27.,
      28., 29., 30., 31., 32.};
  const std::array<int, 4> in_shape = {{1, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,
      9.,    10.,   11.,   12.,   13.,   14.,   15.,   16.,   17.,   18.,
      19.,   20.,   21.,   22.,   23.,   24.,   124.,  128.,  132.,  136.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    41.,   42.,   43.,   44.,   45.,   46.,   47.,   48.,
      49.,   50.,   51.,   52.,   53.,   54.,   55.,   56.,   57.,   58.,
      59.,   60.,   61.,   62.,   63.,   64.,   284.,  288.,  292.,  296.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    81.,   82.,   83.,   84.,   85.,   86.,   87.,   88.,
      89.,   90.,   91.,   92.,   93.,   94.,   95.,   96.,   97.,   98.,
      99.,   100.,  101.,  102.,  103.,  104.,  444.,  448.,  452.,  456.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,
      129.,  130.,  131.,  132.,  133.,  134.,  135.,  136.,  137.,  138.,
      139.,  140.,  141.,  142.,  143.,  144.,  604.,  608.,  612.,  616.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    161.,  162.,  163.,  164.,  165.,  166.,  167.,  168.,
      169.,  170.,  171.,  172.,  173.,  174.,  175.,  176.,  177.,  178.,
      179.,  180.,  181.,  182.,  183.,  184.,  764.,  768.,  772.,  776.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    201.,  202.,  203.,  204.,  205.,  206.,  207.,  208.,
      209.,  210.,  211.,  212.,  213.,  214.,  215.,  216.,  217.,  218.,
      219.,  220.,  221.,  222.,  223.,  224.,  924.,  928.,  932.,  936.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1204., 1208., 1212., 1216., 1220., 1224., 1228., 1232.,
      1236., 1240., 1244., 1248., 1252., 1256., 1260., 1264., 1268., 1272.,
      1276., 1280., 1284., 1288., 1292., 1296., 5296., 5312., 5328., 5344.};
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  3.,  4.,  5.,  6.,
      7.,  8.,  9.,  10., 11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27.,
      28., 29., 30., 31., 32., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  33.,
      34., 35., 36., 37., 38., 39., 40., 41., 42., 43., 44., 45., 46., 47., 48.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  49., 50., 51., 52., 53., 54.,
      55., 56., 57., 58., 59., 60., 61., 62., 63., 64.};
  const std::array<int, 4> in_shape = {{1, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,
      0.,   0.,   0.,   1.,   2.,   3.,   4.,   26.,   0.,   0.,   0.,   9.,
      10.,  11.,  12.,  58.,  0.,   0.,   0.,   17.,   18.,  19.,  20.,  90.,
      0.,   0.,   0.,   25.,  26.,  27.,  28.,  122.,  0.,   0.,   0.,   180.,
      184., 188., 192., 808., 0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   65.,   66.,  67.,  68.,  282.,
      0.,   0.,   0.,   73.,  74.,  75.,  76.,  314.,  0.,   0.,   0.,   81.,
      82.,  83.,  84.,  346., 0.,   0.,   0.,   89.,   90.,  91.,  92.,  378.,
      0.,   0.,   0.,   436., 440., 444., 448., 1832., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,   129.,
      130., 131., 132., 538., 0.,   0.,   0.,   137.,  138., 139., 140., 570.,
      0.,   0.,   0.,   145., 146., 147., 148., 602.,  0.,   0.,   0.,   153.,
      154., 155., 156., 634., 0.,   0.,   0.,   692.,  696., 700., 704., 2856.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0.,  0., 0., 0., 0., 3., 4., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 5.,  6., 0., 0., 0., 0., 0., 0.,
      7., 8., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0.,
      0., 0., 9., 10., 0., 0., 0., 0., 0., 0., 11., 12.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   1.,    2.,    3.,    4.,    5.,    6.,
      7.,    8.,    48.,   52.,  0.,    0.,    0.,    0.,    0.,    0.,
      17.,   18.,   19.,   20.,  21.,   22.,   23.,   24.,   112.,  116.,
      0.,    0.,    0.,    0.,   0.,    0.,    33.,   34.,   35.,   36.,
      37.,   38.,   39.,   40.,  176.,  180.,  0.,    0.,    0.,    0.,
      0.,    0.,    49.,   50.,  51.,   52.,   53.,   54.,   55.,   56.,
      240.,  244.,  0.,    0.,   0.,    0.,    0.,    0.,    356.,  360.,
      364.,  368.,  372.,  376., 380.,  384.,  1600., 1616., 0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    129.,  130., 131.,  132.,  133.,  134.,  135.,  136.,
      560.,  564.,  0.,    0.,   0.,    0.,    0.,    0.,    145.,  146.,
      147.,  148.,  149.,  150., 151.,  152.,  624.,  628.,  0.,    0.,
      0.,    0.,    0.,    0.,   161.,  162.,  163.,  164.,  165.,  166.,
      167.,  168.,  688.,  692., 0.,    0.,    0.,    0.,    0.,    0.,
      177.,  178.,  179.,  180., 181.,  182.,  183.,  184.,  752.,  756.,
      0.,    0.,    0.,    0.,   0.,    0.,    868.,  872.,  876.,  880.,
      884.,  888.,  892.,  896., 3648., 3664., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,   0.,    0.,    0.,    0.,    0.,    0.,
      257.,  258.,  259.,  260., 261.,  262.,  263.,  264.,  1072., 1076.,
      0.,    0.,    0.,    0.,   0.,    0.,    273.,  274.,  275.,  276.,
      277.,  278.,  279.,  280., 1136., 1140., 0.,    0.,    0.,    0.,
      0.,    0.,    289.,  290., 291.,  292.,  293.,  294.,  295.,  296.,
      1200., 1204., 0.,    0.,   0.,    0.,    0.,    0.,    305.,  306.,
      307.,  308.,  309.,  310., 311.,  312.,  1264., 1268., 0.,    0.,
      0.,    0.,    0.,    0.,   1380., 1384., 1388., 1392., 1396., 1400.,
      1404., 1408., 5696., 5712.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    1.,    2.,
      3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,   11.,   12.,
      13.,   14.,   15.,   16.,   92.,   96.,   100.,  104.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      33.,   34.,   35.,   36.,   37.,   38.,   39.,   40.,   41.,   42.,
      43.,   44.,   45.,   46.,   47.,   48.,   220.,  224.,  228.,  232.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    65.,   66.,   67.,   68.,   69.,   70.,   71.,   72.,
      73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,   348.,  352.,
      356.,  360.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    97.,   98.,   99.,   100.,  101.,  102.,
      103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,  111.,  112.,
      476.,  480.,  484.,  488.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    708.,  712.,  716.,  720.,
      724.,  728.,  732.,  736.,  740.,  744.,  748.,  752.,  756.,  760.,
      764.,  768.,  3184., 3200., 3216., 3232., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    257.,  258.,  259.,  260.,  261.,  262.,
      263.,  264.,  265.,  266.,  267.,  268.,  269.,  270.,  271.,  272.,
      1116., 1120., 1124., 1128., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    289.,  290.,  291.,  292.,
      293.,  294.,  295.,  296.,  297.,  298.,  299.,  300.,  301.,  302.,
      303.,  304.,  1244., 1248., 1252., 1256., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    321.,  322.,
      323.,  324.,  325.,  326.,  327.,  328.,  329.,  330.,  331.,  332.,
      333.,  334.,  335.,  336.,  1372., 1376., 1380., 1384., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      353.,  354.,  355.,  356.,  357.,  358.,  359.,  360.,  361.,  362.,
      363.,  364.,  365.,  366.,  367.,  368.,  1500., 1504., 1508., 1512.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1732., 1736., 1740., 1744., 1748., 1752., 1756., 1760.,
      1764., 1768., 1772., 1776., 1780., 1784., 1788., 1792., 7280., 7296.,
      7312., 7328., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      11.,   12.,   13.,   14.,   15.,   16.,   92.,   96.,   100.,  104.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    33.,   34.,   35.,   36.,   37.,   38.,   39.,   40.,
      41.,   42.,   43.,   44.,   45.,   46.,   47.,   48.,   220.,  224.,
      228.,  232.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    65.,   66.,   67.,   68.,   69.,   70.,
      71.,   72.,   73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      348.,  352.,  356.,  360.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    97.,   98.,   99.,   100.,
      101.,  102.,  103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,
      111.,  112.,  476.,  480.,  484.,  488.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    708.,  712.,
      716.,  720.,  724.,  728.,  732.,  736.,  740.,  744.,  748.,  752.,
      756.,  760.,  764.,  768.,  3184., 3200., 3216., 3232.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20., 21., 22., 23., 24.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 25., 26., 27., 28., 29., 30., 31., 32.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 33., 34., 35., 36., 37., 38., 39., 40.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 41., 42., 43., 44., 45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,   5.,   30.,
      0.,   0.,   0.,   10.,  11.,  12.,  13.,  14.,  66.,  0.,   0.,   0.,
      19.,  20.,  21.,  22.,  23.,  102., 0.,   0.,   0.,   28.,  29.,  30.,
      31.,  32.,  138., 0.,   0.,   0.,   202., 206., 210., 214., 218., 912.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   73.,  74.,  75.,  76.,  77.,  318.,
      0.,   0.,   0.,   82.,  83.,  84.,  85.,  86.,  354., 0.,   0.,   0.,
      91.,  92.,  93.,  94.,  95.,  390., 0.,   0.,   0.,   100., 101., 102.,
      103., 104., 426., 0.,   0.,   0.,   490., 494., 498., 502., 506., 2064.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   145., 146., 147., 148., 149., 606.,
      0.,   0.,   0.,   154., 155., 156., 157., 158., 642., 0.,   0.,   0.,
      163., 164., 165., 166., 167., 678., 0.,   0.,   0.,   172., 173., 174.,
      175., 176., 714., 0.,   0.,   0.,   778., 782., 786., 790., 794., 3216.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 1.,  2.,  3.,  0.,
      0., 0., 0., 0., 0., 4.,  5.,  6., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 7., 8.,  9.,  0., 0., 0., 0., 0., 0.,  10., 11., 12.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 13., 14., 15., 0.,
      0., 0., 0., 0., 0., 16., 17., 18.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      56.,   60.,   0.,    0.,    0.,    0.,    0.,    0.,    19.,   20.,
      21.,   22.,   23.,   24.,   25.,   26.,   27.,   28.,   128.,  132.,
      0.,    0.,    0.,    0.,    0.,    0.,    37.,   38.,   39.,   40.,
      41.,   42.,   43.,   44.,   45.,   46.,   200.,  204.,  0.,    0.,
      0.,    0.,    0.,    0.,    55.,   56.,   57.,   58.,   59.,   60.,
      61.,   62.,   63.,   64.,   272.,  276.,  0.,    0.,    0.,    0.,
      0.,    0.,    400.,  404.,  408.,  412.,  416.,  420.,  424.,  428.,
      432.,  436.,  1808., 1824., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    145.,  146.,  147.,  148.,  149.,  150.,
      151.,  152.,  153.,  154.,  632.,  636.,  0.,    0.,    0.,    0.,
      0.,    0.,    163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,
      171.,  172.,  704.,  708.,  0.,    0.,    0.,    0.,    0.,    0.,
      181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,  189.,  190.,
      776.,  780.,  0.,    0.,    0.,    0.,    0.,    0.,    199.,  200.,
      201.,  202.,  203.,  204.,  205.,  206.,  207.,  208.,  848.,  852.,
      0.,    0.,    0.,    0.,    0.,    0.,    976.,  980.,  984.,  988.,
      992.,  996.,  1000., 1004., 1008., 1012., 4112., 4128., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    289.,  290.,
      291.,  292.,  293.,  294.,  295.,  296.,  297.,  298.,  1208., 1212.,
      0.,    0.,    0.,    0.,    0.,    0.,    307.,  308.,  309.,  310.,
      311.,  312.,  313.,  314.,  315.,  316.,  1280., 1284., 0.,    0.,
      0.,    0.,    0.,    0.,    325.,  326.,  327.,  328.,  329.,  330.,
      331.,  332.,  333.,  334.,  1352., 1356., 0.,    0.,    0.,    0.,
      0.,    0.,    343.,  344.,  345.,  346.,  347.,  348.,  349.,  350.,
      351.,  352.,  1424., 1428., 0.,    0.,    0.,    0.,    0.,    0.,
      1552., 1556., 1560., 1564., 1568., 1572., 1576., 1580., 1584., 1588.,
      6416., 6432.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  5.,  6.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  7.,  8.,  9.,  10., 11., 12.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16., 17., 18., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  19., 20., 21., 22., 23., 24.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 25., 26., 27., 28., 29., 30., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  31., 32., 33., 34., 35., 36.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      11.,   12.,   13.,   14.,   15.,   16.,   17.,   18.,   19.,   20.,
      108.,  112.,  116.,  120.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    37.,   38.,   39.,   40.,
      41.,   42.,   43.,   44.,   45.,   46.,   47.,   48.,   49.,   50.,
      51.,   52.,   53.,   54.,   55.,   56.,   252.,  256.,  260.,  264.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      81.,   82.,   83.,   84.,   85.,   86.,   87.,   88.,   89.,   90.,
      91.,   92.,   396.,  400.,  404.,  408.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    109.,  110.,
      111.,  112.,  113.,  114.,  115.,  116.,  117.,  118.,  119.,  120.,
      121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,  540.,  544.,
      548.,  552.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    796.,  800.,  804.,  808.,  812.,  816.,
      820.,  824.,  828.,  832.,  836.,  840.,  844.,  848.,  852.,  856.,
      860.,  864.,  868.,  872.,  3600., 3616., 3632., 3648., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    289.,  290.,
      291.,  292.,  293.,  294.,  295.,  296.,  297.,  298.,  299.,  300.,
      301.,  302.,  303.,  304.,  305.,  306.,  307.,  308.,  1260., 1264.,
      1268., 1272., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    325.,  326.,  327.,  328.,  329.,  330.,
      331.,  332.,  333.,  334.,  335.,  336.,  337.,  338.,  339.,  340.,
      341.,  342.,  343.,  344.,  1404., 1408., 1412., 1416., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      361.,  362.,  363.,  364.,  365.,  366.,  367.,  368.,  369.,  370.,
      371.,  372.,  373.,  374.,  375.,  376.,  377.,  378.,  379.,  380.,
      7352., 7376., 7400., 7424., 0.,    0.,    0.,    0.,    7829., 7854.,
      7879., 7904., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    65.,   66.,   67.,   68.,
      69.,   70.,   71.,   72.,   73.,   74.,   75.,   76.,   77.,   78.,
      79.,   80.,   81.,   82.,   83.,   84.,   364.,  368.,  372.,  376.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    101.,  102.,  103.,  104.,  105.,  106.,  107.,  108.,
      109.,  110.,  111.,  112.,  113.,  114.,  115.,  116.,  117.,  118.,
      119.,  120.,  508.,  512.,  516.,  520.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    137.,  138.,
      139.,  140.,  141.,  142.,  143.,  144.,  145.,  146.,  147.,  148.,
      149.,  150.,  151.,  152.,  153.,  154.,  155.,  156.,  652.,  656.,
      660.,  664.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    173.,  174.,  175.,  176.,  177.,  178.,
      179.,  180.,  181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,
      189.,  190.,  191.,  192.,  796.,  800.,  804.,  808.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1052., 1056., 1060., 1064., 1068., 1072., 1076., 1080., 1084., 1088.,
      1092., 1096., 1100., 1104., 1108., 1112., 1116., 1120., 1124., 1128.,
      4624., 4640., 4656., 4672.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  1.,  2.,  3.,   4.,   5.,   6.,   7.,  8.,  9.,  10., 11., 12.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  13., 14., 15., 16.,
      17., 18., 19., 20., 21.,  22.,  23.,  24.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  78., 80., 82., 84.,
      0.,  0.,  0.,  0.,  132., 136., 140., 144., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  49.,  50.,  51.,  52.,  53., 54., 55., 56., 57., 58.,
      59., 60., 0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  61., 62.,
      63., 64., 65., 66., 67.,  68.,  69.,  70.,  71., 72.};
  const std::array<int, 4> in_shape = {{3, 8, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,    4.,   5.,   6.,    34.,  0.,   0.,   0.,   11.,
      12.,  13.,  14.,   15.,  16.,  74.,   0.,   0.,   0.,   21.,  22.,
      23.,  24.,  25.,   26.,  114., 0.,    0.,   0.,   31.,  32.,  33.,
      34.,  35.,  36.,   154., 0.,   0.,    0.,   224., 228., 232., 236.,
      240., 244., 1016., 0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    81.,  82.,  83.,   84.,  85.,  86.,  354., 0.,
      0.,   0.,   91.,   92.,  93.,  94.,   95.,  96.,  394., 0.,   0.,
      0.,   101., 102.,  103., 104., 105.,  106., 434., 0.,   0.,   0.,
      111., 112., 113.,  114., 115., 116.,  474., 0.,   0.,   0.,   544.,
      548., 552., 556.,  560., 564., 2296., 0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    161., 162., 163., 164., 165.,
      166., 674., 0.,    0.,   0.,   171.,  172., 173., 174., 175., 176.,
      714., 0.,   0.,    0.,   181., 182.,  183., 184., 185., 186., 754.,
      0.,   0.,   0.,    191., 192., 193.,  194., 195., 196., 794., 0.,
      0.,   0.,   864.,  868., 872., 876.,  880., 884., 3576.};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 1.,  2.,  3.,  4.,  0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 9.,  10., 11., 12., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 17., 18., 19., 20., 0., 0., 0., 0., 0., 0., 21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{3, 8, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    1.,    2.,    3.,    4.,
      5.,    6.,    7.,    8.,    9.,    10.,   11.,   12.,   64.,   68.,
      0.,    0.,    0.,    0.,    0.,    0.,    21.,   22.,   23.,   24.,
      25.,   26.,   27.,   28.,   29.,   30.,   31.,   32.,   144.,  148.,
      0.,    0.,    0.,    0.,    0.,    0.,    41.,   42.,   43.,   44.,
      45.,   46.,   47.,   48.,   49.,   50.,   51.,   52.,   224.,  228.,
      0.,    0.,    0.,    0.,    0.,    0.,    61.,   62.,   63.,   64.,
      65.,   66.,   67.,   68.,   69.,   70.,   71.,   72.,   304.,  308.,
      0.,    0.,    0.,    0.,    0.,    0.,    444.,  448.,  452.,  456.,
      460.,  464.,  468.,  472.,  476.,  480.,  484.,  488.,  2016., 2032.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    161.,  162.,  163.,  164.,
      165.,  166.,  167.,  168.,  169.,  170.,  171.,  172.,  704.,  708.,
      0.,    0.,    0.,    0.,    0.,    0.,    181.,  182.,  183.,  184.,
      185.,  186.,  187.,  188.,  189.,  190.,  191.,  192.,  784.,  788.,
      0.,    0.,    0.,    0.,    0.,    0.,    201.,  202.,  203.,  204.,
      205.,  206.,  207.,  208.,  209.,  210.,  211.,  212.,  864.,  868.,
      0.,    0.,    0.,    0.,    0.,    0.,    221.,  222.,  223.,  224.,
      225.,  226.,  227.,  228.,  229.,  230.,  231.,  232.,  944.,  948.,
      0.,    0.,    0.,    0.,    0.,    0.,    1084., 1088., 1092., 1096.,
      1100., 1104., 1108., 1112., 1116., 1120., 1124., 1128., 4576., 4592.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    321.,  322.,  323.,  324.,
      325.,  326.,  327.,  328.,  329.,  330.,  331.,  332.,  1344., 1348.,
      0.,    0.,    0.,    0.,    0.,    0.,    341.,  342.,  343.,  344.,
      345.,  346.,  347.,  348.,  349.,  350.,  351.,  352.,  1424., 1428.,
      0.,    0.,    0.,    0.,    0.,    0.,    361.,  362.,  363.,  364.,
      365.,  366.,  367.,  368.,  369.,  370.,  371.,  372.,  1504., 1508.,
      0.,    0.,    0.,    0.,    0.,    0.,    381.,  382.,  383.,  384.,
      385.,  386.,  387.,  388.,  389.,  390.,  391.,  392.,  1584., 1588.,
      0.,    0.,    0.,    0.,    0.,    0.,    1724., 1728., 1732., 1736.,
      1740., 1744., 1748., 1752., 1756., 1760., 1764., 1768., 7136., 7152.};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  9.,  10.,
      11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  17., 18.,
      19., 20., 21., 22., 23., 24., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  25., 26., 27., 28., 29., 30., 31., 32., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  33., 34., 35., 36., 37., 38., 39., 40., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  41., 42., 43., 44.,
      45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{3, 8, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     1.,    2.,    3.,    4.,    5.,    6.,    7.,     8.,
      9.,     10.,    11.,   12.,   13.,   14.,   15.,   16.,   17.,    18.,
      19.,    20.,    21.,   22.,   23.,   24.,   124.,  128.,  132.,   136.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     41.,   42.,   43.,   44.,   45.,   46.,   47.,    48.,
      49.,    50.,    51.,   52.,   53.,   54.,   55.,   56.,   57.,    58.,
      59.,    60.,    61.,   62.,   63.,   64.,   284.,  288.,  292.,   296.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     81.,   82.,   83.,   84.,   85.,   86.,   87.,    88.,
      89.,    90.,    91.,   92.,   93.,   94.,   95.,   96.,   97.,    98.,
      99.,    100.,   101.,  102.,  103.,  104.,  444.,  448.,  452.,   456.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     121.,  122.,  123.,  124.,  125.,  126.,  127.,   128.,
      129.,   130.,   131.,  132.,  133.,  134.,  135.,  136.,  137.,   138.,
      139.,   140.,   141.,  142.,  143.,  144.,  604.,  608.,  612.,   616.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     884.,  888.,  892.,  896.,  900.,  904.,  908.,   912.,
      916.,   920.,   924.,  928.,  932.,  936.,  940.,  944.,  948.,   952.,
      956.,   960.,   964.,  968.,  972.,  976.,  4016., 4032., 4048.,  4064.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     321.,  322.,  323.,  324.,  325.,  326.,  327.,   328.,
      329.,   330.,   331.,  332.,  333.,  334.,  335.,  336.,  337.,   338.,
      339.,   340.,   341.,  342.,  343.,  344.,  1404., 1408., 1412.,  1416.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     1831., 1838., 1845., 1852., 1859., 1866., 1873.,  1880.,
      1887.,  1894.,  1901., 1908., 1915., 1922., 1929., 1936., 11054., 11096.,
      11138., 11180., 0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     129.,  130.,  131.,  132.,  133.,  134.,  135.,   136.,
      137.,   138.,   139.,  140.,  141.,  142.,  143.,  144.,  145.,   146.,
      147.,   148.,   149.,  150.,  151.,  152.,  636.,  640.,  644.,   648.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     169.,  170.,  171.,  172.,  173.,  174.,  175.,   176.,
      177.,   178.,   179.,  180.,  181.,  182.,  183.,  184.,  185.,   186.,
      187.,   188.,   189.,  190.,  191.,  192.,  796.,  800.,  804.,   808.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     209.,  210.,  211.,  212.,  213.,  214.,  215.,   216.,
      217.,   218.,   219.,  220.,  221.,  222.,  223.,  224.,  225.,   226.,
      227.,   228.,   229.,  230.,  231.,  232.,  956.,  960.,  964.,   968.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     249.,  250.,  251.,  252.,  253.,  254.,  255.,   256.,
      257.,   258.,   259.,  260.,  261.,  262.,  263.,  264.,  265.,   266.,
      267.,   268.,   269.,  270.,  271.,  272.,  1116., 1120., 1124.,  1128.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,     0.,
      0.,     0.,     1396., 1400., 1404., 1408., 1412., 1416., 1420.,  1424.,
      1428.,  1432.,  1436., 1440., 1444., 1448., 1452., 1456., 1460.,  1464.,
      1468.,  1472.,  1476., 1480., 1484., 1488., 6064., 6080., 6096.,  6112.};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  1.,  2.,
      3.,  4.,  5.,  6.,  7.,   8.,   9.,   10.,  11., 12., 13., 14., 15., 16.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  17., 18., 19., 20.,
      21., 22., 23., 24., 25.,  26.,  27.,  28.,  29., 30., 31., 32., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      82., 84., 86., 88., 294., 300., 306., 312., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   65., 66., 67., 68., 69., 70.,
      71., 72., 73., 74., 75.,  76.,  77.,  78.,  79., 80., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   81.,  82.,  83., 84., 85., 86., 87., 88.,
      89., 90., 91., 92., 93.,  94.,  95.,  96.};
  const std::array<int, 4> in_shape = {{3, 8, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   1.,   2.,   3.,   4.,   26.,  0.,   0.,   0.,   9.,
      10.,  11.,  12.,  58.,  0.,   0.,   0.,   17.,  18.,  19.,  20.,  90.,
      0.,   0.,   0.,   25.,  26.,  27.,  28.,  122., 0.,   0.,   0.,   33.,
      34.,  35.,  36.,  154., 0.,   0.,   0.,   212., 216., 220., 224., 936.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   73.,  74.,  75.,  76.,  314., 0.,   0.,   0.,   81.,
      82.,  83.,  84.,  346., 0.,   0.,   0.,   89.,  90.,  91.,  92.,  378.,
      0.,   0.,   0.,   97.,  98.,  99.,  100., 410., 0.,   0.,   0.,   105.,
      106., 107., 108., 442., 0.,   0.,   0.,   500., 504., 508., 512., 2088.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   145., 146., 147., 148., 602., 0.,   0.,   0.,   153.,
      154., 155., 156., 634., 0.,   0.,   0.,   161., 162., 163., 164., 666.,
      0.,   0.,   0.,   169., 170., 171., 172., 698., 0.,   0.,   0.,   177.,
      178., 179., 180., 730., 0.,   0.,   0.,   788., 792., 796., 800., 3240.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 1.,  2.,  0., 0., 0., 0., 0., 0., 3.,  4.,
      0., 0., 0., 0., 0., 0., 5.,  6.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 7.,  8.,
      0., 0., 0., 0., 0., 0., 9.,  10., 0., 0., 0., 0., 0., 0., 11., 12.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 13., 14., 0., 0., 0., 0., 0., 0., 15., 16.,
      0., 0., 0., 0., 0., 0., 17., 18.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    1.,    2.,    3.,    4.,    5.,    6.,
      7.,    8.,    48.,   52.,   0.,    0.,    0.,    0.,    0.,    0.,
      17.,   18.,   19.,   20.,   21.,   22.,   23.,   24.,   112.,  116.,
      0.,    0.,    0.,    0.,    0.,    0.,    33.,   34.,   35.,   36.,
      37.,   38.,   39.,   40.,   176.,  180.,  0.,    0.,    0.,    0.,
      0.,    0.,    49.,   50.,   51.,   52.,   53.,   54.,   55.,   56.,
      240.,  244.,  0.,    0.,    0.,    0.,    0.,    0.,    65.,   66.,
      67.,   68.,   69.,   70.,   71.,   72.,   304.,  308.,  0.,    0.,
      0.,    0.,    0.,    0.,    420.,  424.,  428.,  432.,  436.,  440.,
      444.,  448.,  1856., 1872., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    145.,  146.,
      147.,  148.,  149.,  150.,  151.,  152.,  624.,  628.,  0.,    0.,
      0.,    0.,    0.,    0.,    161.,  162.,  163.,  164.,  165.,  166.,
      167.,  168.,  688.,  692.,  0.,    0.,    0.,    0.,    0.,    0.,
      177.,  178.,  179.,  180.,  181.,  182.,  183.,  184.,  752.,  756.,
      0.,    0.,    0.,    0.,    0.,    0.,    193.,  194.,  195.,  196.,
      197.,  198.,  199.,  200.,  816.,  820.,  0.,    0.,    0.,    0.,
      0.,    0.,    209.,  210.,  211.,  212.,  213.,  214.,  215.,  216.,
      880.,  884.,  0.,    0.,    0.,    0.,    0.,    0.,    996.,  1000.,
      1004., 1008., 1012., 1016., 1020., 1024., 4160., 4176., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    289.,  290.,  291.,  292.,  293.,  294.,  295.,  296.,
      1200., 1204., 0.,    0.,    0.,    0.,    0.,    0.,    305.,  306.,
      307.,  308.,  309.,  310.,  311.,  312.,  1264., 1268., 0.,    0.,
      0.,    0.,    0.,    0.,    321.,  322.,  323.,  324.,  325.,  326.,
      327.,  328.,  1328., 1332., 0.,    0.,    0.,    0.,    0.,    0.,
      337.,  338.,  339.,  340.,  341.,  342.,  343.,  344.,  1392., 1396.,
      0.,    0.,    0.,    0.,    0.,    0.,    353.,  354.,  355.,  356.,
      357.,  358.,  359.,  360.,  1456., 1460., 0.,    0.,    0.,    0.,
      0.,    0.,    1572., 1576., 1580., 1584., 1588., 1592., 1596., 1600.,
      6464., 6480.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 21., 22., 23., 24.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 25., 26., 27., 28.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 29., 30., 31., 32.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 33., 34., 35., 36.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    1.,    2.,
      3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,   11.,   12.,
      13.,   14.,   15.,   16.,   92.,   96.,   100.,  104.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      33.,   34.,   35.,   36.,   37.,   38.,   39.,   40.,   41.,   42.,
      43.,   44.,   45.,   46.,   47.,   48.,   220.,  224.,  228.,  232.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    65.,   66.,   67.,   68.,   69.,   70.,   71.,   72.,
      73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,   348.,  352.,
      356.,  360.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    97.,   98.,   99.,   100.,  101.,  102.,
      103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,  111.,  112.,
      476.,  480.,  484.,  488.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    129.,  130.,  131.,  132.,
      133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,  141.,  142.,
      143.,  144.,  604.,  608.,  612.,  616.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    836.,  840.,
      844.,  848.,  852.,  856.,  860.,  864.,  868.,  872.,  876.,  880.,
      884.,  888.,  892.,  896.,  3696., 3712., 3728., 3744., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    289.,  290.,  291.,  292.,
      293.,  294.,  295.,  296.,  297.,  298.,  299.,  300.,  301.,  302.,
      303.,  304.,  1244., 1248., 1252., 1256., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    321.,  322.,
      323.,  324.,  325.,  326.,  327.,  328.,  329.,  330.,  331.,  332.,
      333.,  334.,  335.,  336.,  1372., 1376., 1380., 1384., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      353.,  354.,  355.,  356.,  357.,  358.,  359.,  360.,  361.,  362.,
      363.,  364.,  365.,  366.,  367.,  368.,  1500., 1504., 1508., 1512.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1766., 1772., 1778., 1784., 1790., 1796., 1802., 1808.,
      1814., 1820., 1826., 1832., 1838., 1844., 1850., 1856., 7592., 7616.,
      7640., 7664., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    65.,   66.,   67.,   68.,   69.,   70.,
      71.,   72.,   73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      348.,  352.,  356.,  360.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    97.,   98.,   99.,   100.,
      101.,  102.,  103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,
      111.,  112.,  476.,  480.,  484.,  488.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    129.,  130.,
      131.,  132.,  133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,
      141.,  142.,  143.,  144.,  604.,  608.,  612.,  616.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      161.,  162.,  163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,
      171.,  172.,  173.,  174.,  175.,  176.,  732.,  736.,  740.,  744.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    193.,  194.,  195.,  196.,  197.,  198.,  199.,  200.,
      201.,  202.,  203.,  204.,  205.,  206.,  207.,  208.,  860.,  864.,
      868.,  872.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    1092., 1096., 1100., 1104., 1108., 1112.,
      1116., 1120., 1124., 1128., 1132., 1136., 1140., 1144., 1148., 1152.,
      4720., 4736., 4752., 4768.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  1.,  2.,  3.,  4.,   5.,
      6.,   7.,   8.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   9.,   10.,  11.,  12.,  13., 14., 15., 16., 0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  17., 18., 19., 20., 21.,  22.,
      23.,  24.,  0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  99., 102., 105.,
      108., 111., 114., 117., 120., 0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   49.,
      50.,  51.,  52.,  53.,  54.,  55., 56., 0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   57., 58., 59., 60., 61., 62., 63.,  64.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,  65.,  66.,
      67.,  68.,  69.,  70.,  71.,  72.};
  const std::array<int, 4> in_shape = {{3, 9, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,    1.,   2.,   3.,    4.,   5.,   30.,
      0.,   0.,   0.,   10.,  11.,  12.,   13.,  14.,  66.,   0.,   0.,   0.,
      19.,  20.,  21.,  22.,  23.,  102.,  0.,   0.,   0.,    28.,  29.,  30.,
      31.,  32.,  138., 0.,   0.,   0.,    37.,  38.,  39.,   40.,  41.,  174.,
      0.,   0.,   0.,   238., 242., 246.,  250., 254., 1056., 0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,
      0.,   0.,   0.,   82.,  83.,  84.,   85.,  86.,  354.,  0.,   0.,   0.,
      91.,  92.,  93.,  94.,  95.,  390.,  0.,   0.,   0.,    100., 101., 102.,
      103., 104., 426., 0.,   0.,   0.,    109., 110., 111.,  112., 113., 462.,
      0.,   0.,   0.,   118., 119., 120.,  121., 122., 498.,  0.,   0.,   0.,
      562., 566., 570., 574., 578., 2352., 0.,   0.,   0.,    0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,
      163., 164., 165., 166., 167., 678.,  0.,   0.,   0.,    172., 173., 174.,
      175., 176., 714., 0.,   0.,   0.,    181., 182., 183.,  184., 185., 750.,
      0.,   0.,   0.,   190., 191., 192.,  193., 194., 786.,  0.,   0.,   0.,
      199., 200., 201., 202., 203., 822.,  0.,   0.,   0.,    886., 890., 894.,
      898., 902., 3648.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 1., 2.,  3.,  0.,
      0.,  0.,  0., 0., 0., 4., 5.,  6.,  0.,  0.,  0., 0., 0., 0.,  7.,  8.,
      9.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 10., 11., 12.,
      0.,  0.,  0., 0., 0., 0., 13., 14., 15., 0.,  0., 0., 0., 0.,  0.,  16.,
      17., 18., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,  19., 20.,
      21., 0.,  0., 0., 0., 0., 0.,  22., 23., 24., 0., 0., 0., 0.,  0.,  0.,
      25., 26., 27.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      56.,   60.,   0.,    0.,    0.,    0.,    0.,    0.,    19.,   20.,
      21.,   22.,   23.,   24.,   25.,   26.,   27.,   28.,   128.,  132.,
      0.,    0.,    0.,    0.,    0.,    0.,    37.,   38.,   39.,   40.,
      41.,   42.,   43.,   44.,   45.,   46.,   200.,  204.,  0.,    0.,
      0.,    0.,    0.,    0.,    55.,   56.,   57.,   58.,   59.,   60.,
      61.,   62.,   63.,   64.,   272.,  276.,  0.,    0.,    0.,    0.,
      0.,    0.,    73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      81.,   82.,   344.,  348.,  0.,    0.,    0.,    0.,    0.,    0.,
      472.,  476.,  480.,  484.,  488.,  492.,  496.,  500.,  504.,  508.,
      2096., 2112., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,
      171.,  172.,  704.,  708.,  0.,    0.,    0.,    0.,    0.,    0.,
      181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,  189.,  190.,
      776.,  780.,  0.,    0.,    0.,    0.,    0.,    0.,    199.,  200.,
      201.,  202.,  203.,  204.,  205.,  206.,  207.,  208.,  848.,  852.,
      0.,    0.,    0.,    0.,    0.,    0.,    217.,  218.,  219.,  220.,
      221.,  222.,  223.,  224.,  225.,  226.,  920.,  924.,  0.,    0.,
      0.,    0.,    0.,    0.,    235.,  236.,  237.,  238.,  239.,  240.,
      241.,  242.,  243.,  244.,  992.,  996.,  0.,    0.,    0.,    0.,
      0.,    0.,    1120., 1124., 1128., 1132., 1136., 1140., 1144., 1148.,
      1152., 1156., 4688., 4704., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    325.,  326.,  327.,  328.,  329.,  330.,
      331.,  332.,  333.,  334.,  1352., 1356., 0.,    0.,    0.,    0.,
      0.,    0.,    343.,  344.,  345.,  346.,  347.,  348.,  349.,  350.,
      351.,  352.,  1424., 1428., 0.,    0.,    0.,    0.,    0.,    0.,
      361.,  362.,  363.,  364.,  365.,  366.,  367.,  368.,  369.,  370.,
      1496., 1500., 0.,    0.,    0.,    0.,    0.,    0.,    379.,  380.,
      381.,  382.,  383.,  384.,  385.,  386.,  387.,  388.,  1568., 1572.,
      0.,    0.,    0.,    0.,    0.,    0.,    397.,  398.,  399.,  400.,
      401.,  402.,  403.,  404.,  405.,  406.,  1640., 1644., 0.,    0.,
      0.,    0.,    0.,    0.,    1768., 1772., 1776., 1780., 1784., 1788.,
      1792., 1796., 1800., 1804., 7280., 7296.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 1., 2., 3.,  4.,  5.,  6.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 7.,  8.,  9.,  10., 11., 12.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  13., 14., 15., 16.,
      17., 18., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 19., 20., 21., 22., 23., 24.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  25., 26., 27., 28.,
      29., 30., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  31., 32.,
      33., 34., 35., 36., 0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  37., 38., 39., 40.,
      41., 42., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  43., 44.,
      45., 46., 47., 48., 0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      49., 50., 51., 52., 53., 54.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,    2.,    3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      11.,   12.,   13.,   14.,   15.,   16.,   17.,   18.,   19.,   20.,
      108.,  112.,  116.,  120.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    37.,   38.,   39.,   40.,
      41.,   42.,   43.,   44.,   45.,   46.,   47.,   48.,   49.,   50.,
      51.,   52.,   53.,   54.,   55.,   56.,   252.,  256.,  260.,  264.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      81.,   82.,   83.,   84.,   85.,   86.,   87.,   88.,   89.,   90.,
      91.,   92.,   396.,  400.,  404.,  408.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    109.,  110.,
      111.,  112.,  113.,  114.,  115.,  116.,  117.,  118.,  119.,  120.,
      121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,  540.,  544.,
      548.,  552.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    145.,  146.,  147.,  148.,  149.,  150.,
      151.,  152.,  153.,  154.,  155.,  156.,  157.,  158.,  159.,  160.,
      161.,  162.,  163.,  164.,  684.,  688.,  692.,  696.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      940.,  944.,  948.,  952.,  956.,  960.,  964.,  968.,  972.,  976.,
      980.,  984.,  988.,  992.,  996.,  1000., 1004., 1008., 1012., 1016.,
      4176., 4192., 4208., 4224., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    325.,  326.,  327.,  328.,  329.,  330.,
      331.,  332.,  333.,  334.,  335.,  336.,  337.,  338.,  339.,  340.,
      341.,  342.,  343.,  344.,  1404., 1408., 1412., 1416., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      361.,  362.,  363.,  364.,  365.,  366.,  367.,  368.,  369.,  370.,
      371.,  372.,  373.,  374.,  375.,  376.,  377.,  378.,  379.,  380.,
      7716., 7744., 7772., 7800., 0.,    0.,    0.,    0.,    8739., 8774.,
      8809., 8844., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    508.,  512.,  516.,  520.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    137.,  138.,
      139.,  140.,  141.,  142.,  143.,  144.,  145.,  146.,  147.,  148.,
      149.,  150.,  151.,  152.,  153.,  154.,  155.,  156.,  652.,  656.,
      660.,  664.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    173.,  174.,  175.,  176.,  177.,  178.,
      179.,  180.,  181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,
      189.,  190.,  191.,  192.,  796.,  800.,  804.,  808.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      209.,  210.,  211.,  212.,  213.,  214.,  215.,  216.,  217.,  218.,
      219.,  220.,  221.,  222.,  223.,  224.,  225.,  226.,  227.,  228.,
      940.,  944.,  948.,  952.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    245.,  246.,  247.,  248.,
      249.,  250.,  251.,  252.,  253.,  254.,  255.,  256.,  257.,  258.,
      259.,  260.,  261.,  262.,  263.,  264.,  1084., 1088., 1092., 1096.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    281.,  282.,  283.,  284.,  285.,  286.,  287.,  288.,
      289.,  290.,  291.,  292.,  293.,  294.,  295.,  296.,  297.,  298.,
      299.,  300.,  1228., 1232., 1236., 1240., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    1484., 1488.,
      1492., 1496., 1500., 1504., 1508., 1512., 1516., 1520., 1524., 1528.,
      1532., 1536., 1540., 1544., 1548., 1552., 1556., 1560., 6352., 6368.,
      6384., 6400.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,   5.,  6.,  7.,
      8.,  9.,   10.,  11.,  12.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   13.,  14.,  15.,  16.,  17.,  18.,  19.,  20., 21., 22.,
      23., 24.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      25., 26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35., 36., 0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   171., 174., 177., 180., 0.,  0.,  0.,
      0.,  306., 312., 318., 324., 0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   73.,  74.,  75.,  76.,  77.,  78.,  79., 80., 81.,
      82., 83.,  84.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  85.,  86.,  87.,  88.,  89.,  90.,  91.,  92.,  93.,  94., 95., 96.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,
      0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  97., 98.,
      99., 100., 101., 102., 103., 104., 105., 106., 107., 108.};
  const std::array<int, 4> in_shape = {{3, 9, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      1.,   2.,    3.,   4.,    5.,    6.,   34.,  0.,   0.,   0.,   11.,
      12.,  13.,   14.,  15.,   16.,   74.,  0.,   0.,   0.,   21.,  22.,
      23.,  24.,   25.,  26.,   114.,  0.,   0.,   0.,   31.,  32.,  33.,
      34.,  35.,   36.,  154.,  0.,    0.,   0.,   41.,  42.,  43.,  44.,
      45.,  46.,   194., 0.,    0.,    0.,   264., 268., 272., 276., 280.,
      284., 1176., 0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    91.,  92.,   93.,   94.,  95.,  96.,  394., 0.,   0.,
      0.,   101.,  102., 103.,  104.,  105., 106., 434., 0.,   0.,   0.,
      111., 112.,  113., 114.,  115.,  116., 474., 0.,   0.,   0.,   121.,
      122., 123.,  124., 125.,  126.,  514., 0.,   0.,   0.,   131., 132.,
      133., 134.,  135., 136.,  554.,  0.,   0.,   0.,   624., 628., 632.,
      636., 640.,  644., 2616., 0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,   0.,    181.,  182., 183., 184., 185., 186., 754.,
      0.,   0.,    0.,   191.,  192.,  193., 194., 195., 196., 794., 0.,
      0.,   0.,    201., 202.,  203.,  204., 205., 206., 834., 0.,   0.,
      0.,   211.,  212., 213.,  214.,  215., 216., 874., 0.,   0.,   0.,
      221., 222.,  223., 224.,  225.,  226., 914., 0.,   0.,   0.,   984.,
      988., 992.,  996., 1000., 1004., 4056.};
  const std::array<int, 4> in_shape = {{3, 9, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 1.,  2.,  3.,  4.,  0., 0.,  0.,  0.,  0.,
      0., 5.,  6.,  7.,  8.,  0., 0.,  0.,  0.,  0.,  0., 9.,  10., 11., 12.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 13., 14., 15., 16., 0., 0.,  0.,  0.,  0.,
      0., 17., 18., 19., 20., 0., 0.,  0.,  0.,  0.,  0., 21., 22., 23., 24.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 25., 26., 27., 28., 0., 0.,  0.,  0.,  0.,
      0., 29., 30., 31., 32., 0., 0.,  0.,  0.,  0.,  0., 33., 34., 35., 36.};
  const std::array<int, 4> in_shape = {{3, 9, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    1.,    2.,    3.,    4.,
      5.,     6.,     7.,    8.,    9.,    10.,   11.,   12.,   64.,   68.,
      0.,     0.,     0.,    0.,    0.,    0.,    21.,   22.,   23.,   24.,
      25.,    26.,    27.,   28.,   29.,   30.,   31.,   32.,   144.,  148.,
      0.,     0.,     0.,    0.,    0.,    0.,    41.,   42.,   43.,   44.,
      45.,    46.,    47.,   48.,   49.,   50.,   51.,   52.,   224.,  228.,
      0.,     0.,     0.,    0.,    0.,    0.,    61.,   62.,   63.,   64.,
      65.,    66.,    67.,   68.,   69.,   70.,   71.,   72.,   304.,  308.,
      0.,     0.,     0.,    0.,    0.,    0.,    81.,   82.,   83.,   84.,
      85.,    86.,    87.,   88.,   89.,   90.,   91.,   92.,   384.,  388.,
      0.,     0.,     0.,    0.,    0.,    0.,    524.,  528.,  532.,  536.,
      540.,   544.,   548.,  552.,  556.,  560.,  564.,  568.,  2336., 2352.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    181.,  182.,  183.,  184.,
      185.,   186.,   187.,  188.,  189.,  190.,  191.,  192.,  784.,  788.,
      0.,     0.,     0.,    0.,    0.,    0.,    201.,  202.,  203.,  204.,
      205.,   206.,   207.,  208.,  209.,  210.,  211.,  212.,  864.,  868.,
      0.,     0.,     0.,    0.,    0.,    0.,    221.,  222.,  223.,  224.,
      225.,   226.,   227.,  228.,  229.,  230.,  231.,  232.,  944.,  948.,
      0.,     0.,     0.,    0.,    0.,    0.,    241.,  242.,  243.,  244.,
      245.,   246.,   247.,  248.,  249.,  250.,  251.,  252.,  1024., 1028.,
      0.,     0.,     0.,    0.,    0.,    0.,    261.,  262.,  263.,  264.,
      265.,   266.,   267.,  268.,  269.,  270.,  271.,  272.,  1104., 1108.,
      0.,     0.,     0.,    0.,    0.,    0.,    1244., 1248., 1252., 1256.,
      1260.,  1264.,  1268., 1272., 1276., 1280., 1284., 1288., 5216., 5232.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    361.,  362.,  363.,  364.,
      365.,   366.,   367.,  368.,  369.,  370.,  371.,  372.,  1504., 1508.,
      0.,     0.,     0.,    0.,    0.,    0.,    381.,  382.,  383.,  384.,
      385.,   386.,   387.,  388.,  389.,  390.,  391.,  392.,  1584., 1588.,
      0.,     0.,     0.,    0.,    0.,    0.,    401.,  402.,  403.,  404.,
      405.,   406.,   407.,  408.,  409.,  410.,  411.,  412.,  1664., 1668.,
      0.,     0.,     0.,    0.,    0.,    0.,    421.,  422.,  423.,  424.,
      425.,   426.,   427.,  428.,  429.,  430.,  431.,  432.,  3215., 3224.,
      0.,     0.,     0.,    0.,    0.,    0.,    1893., 1898., 1903., 1908.,
      12065., 12100., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.};
  const std::array<int, 4> in_shape = {{3, 9, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  1.,   2.,   3.,  4.,  5.,  6.,  7.,  8.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  9.,  10.,
      11., 12., 13., 14., 15., 16., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  17., 18., 19.,  20.,  21., 22., 23., 24., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  25., 26., 27.,  28.,  29., 30., 31., 32., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  33., 34., 35., 36.,
      37., 38., 39., 40., 0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  41., 42., 43., 44., 45.,  46.,  47., 48., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  49., 50., 51., 52., 53.,  54.,  55., 56., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  512., 520., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.};
  const std::array<int, 4> in_shape = {{3, 9, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     1.,     2.,     3.,
      4.,    5.,    6.,    7.,     8.,     9.,     10.,    11.,    12.,
      13.,   14.,   15.,   16.,    17.,    18.,    19.,    20.,    21.,
      22.,   23.,   24.,   124.,   128.,   132.,   136.,   0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    41.,   42.,   43.,    44.,    45.,    46.,    47.,    48.,
      49.,   50.,   51.,   52.,    53.,    54.,    55.,    56.,    57.,
      58.,   59.,   60.,   61.,    62.,    63.,    64.,    284.,   288.,
      292.,  296.,  0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     81.,    82.,    83.,    84.,
      85.,   86.,   87.,   88.,    89.,    90.,    91.,    92.,    93.,
      94.,   95.,   96.,   97.,    98.,    99.,    100.,   101.,   102.,
      103.,  104.,  444.,  448.,   452.,   456.,   0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      121.,  122.,  123.,  124.,   125.,   126.,   127.,   128.,   129.,
      130.,  131.,  132.,  133.,   134.,   135.,   136.,   137.,   138.,
      139.,  140.,  141.,  142.,   143.,   144.,   604.,   608.,   612.,
      616.,  0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     161.,   162.,   163.,   164.,   165.,
      166.,  167.,  168.,  169.,   170.,   171.,   172.,   173.,   174.,
      175.,  176.,  177.,  178.,   179.,   180.,   181.,   182.,   183.,
      184.,  764.,  768.,  772.,   776.,   0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     1044.,
      1048., 1052., 1056., 1060.,  1064.,  1068.,  1072.,  1076.,  1080.,
      1084., 1088., 1092., 1096.,  1100.,  1104.,  1108.,  1112.,  1116.,
      1120., 1124., 1128., 1132.,  1136.,  4656.,  4672.,  4688.,  4704.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     1831.,  1838.,  1845.,
      1852., 1859., 1866., 1873.,  1880.,  1887.,  1894.,  1901.,  1908.,
      1915., 1922., 1929., 1936.,  11054., 11096., 11138., 11180., 0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     298.,
      300.,  302.,  304.,  306.,   308.,   310.,   312.,   314.,   316.,
      318.,  320.,  322.,  324.,   326.,   328.,   330.,   332.,   334.,
      336.,  338.,  340.,  342.,   344.,   1432.,  1440.,  1448.,  1456.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     209.,   210.,   211.,
      212.,  213.,  214.,  215.,   216.,   217.,   218.,   219.,   220.,
      221.,  222.,  223.,  224.,   225.,   226.,   227.,   228.,   229.,
      230.,  231.,  232.,  956.,   960.,   964.,   968.,   0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    249.,  250.,  251.,   252.,   253.,   254.,   255.,   256.,
      257.,  258.,  259.,  260.,   261.,   262.,   263.,   264.,   265.,
      266.,  267.,  268.,  269.,   270.,   271.,   272.,   1116.,  1120.,
      1124., 1128., 0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     289.,   290.,   291.,   292.,
      293.,  294.,  295.,  296.,   297.,   298.,   299.,   300.,   301.,
      302.,  303.,  304.,  305.,   306.,   307.,   308.,   309.,   310.,
      311.,  312.,  1276., 1280.,  1284.,  1288.,  0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      329.,  330.,  331.,  332.,   333.,   334.,   335.,   336.,   337.,
      338.,  339.,  340.,  341.,   342.,   343.,   344.,   345.,   346.,
      347.,  348.,  349.,  350.,   351.,   352.,   2837.,  2846.,  2855.,
      2864., 0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     1733.,  1738.,  1743.,  1748.,  1753.,
      1758., 1763., 1768., 11295., 11330., 11365., 11400., 0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.,
      0.,    0.,    0.,    0.,     0.,     0.,     0.,     0.,     0.};
  const std::array<int, 4> in_shape = {{3, 9, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      1.,    2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,    10.,   11.,
      12.,   13.,  14.,  15.,  16.,  0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   17.,  18.,   19.,   20.,
      21.,   22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,   30.,   31.,
      32.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   33.,  34.,  35.,  36.,  37.,  38.,   39.,   40.,
      41.,   42.,  43.,  44.,  45.,  46.,  47.,  48.,  0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    195.,  198.,
      201.,  204., 657., 666., 675., 684., 0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   97.,  98.,  99.,  100.,  101.,  102.,
      103.,  104., 105., 106., 107., 108., 109., 110., 111.,  112.,  0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   1016., 1024., 1032.,
      1040., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.};
  const std::array<int, 4> in_shape = {{3, 9, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   1.,    2.,   3.,   4.,   26.,  0.,
      0.,   0.,   9.,    10.,  11.,  12.,   58.,  0.,   0.,   0.,   17.,
      18.,  19.,  20.,   90.,  0.,   0.,    0.,   25.,  26.,  27.,  28.,
      122., 0.,   0.,    0.,   33.,  34.,   35.,  36.,  154., 0.,   0.,
      0.,   41.,  42.,   43.,  44.,  186.,  0.,   0.,   0.,   244., 248.,
      252., 256., 1064., 0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   81.,  82.,  83.,
      84.,  346., 0.,    0.,   0.,   89.,   90.,  91.,  92.,  378., 0.,
      0.,   0.,   97.,   98.,  99.,  100.,  410., 0.,   0.,   0.,   105.,
      106., 107., 108.,  442., 0.,   0.,    0.,   113., 114., 115., 116.,
      474., 0.,   0.,    0.,   121., 122.,  123., 124., 506., 0.,   0.,
      0.,   564., 568.,  572., 576., 2344., 0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,    0.,   0.,   0.,    0.,   0.,   0.,   0.,   0.,
      161., 162., 163.,  164., 666., 0.,    0.,   0.,   169., 170., 171.,
      172., 698., 0.,    0.,   0.,   177.,  178., 179., 180., 730., 0.,
      0.,   0.,   185.,  186., 187., 188.,  762., 0.,   0.,   0.,   193.,
      194., 195., 196.,  794., 0.,   0.,    0.,   201., 202., 203., 204.,
      826., 0.,   0.,    0.,   884., 888.,  892., 896., 3624.};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 1.,  2.,  0., 0., 0., 0., 0., 0., 3.,  4.,
      0., 0., 0., 0., 0., 0., 5.,  6.,  0., 0., 0., 0., 0., 0., 7.,  8.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 9.,  10., 0., 0., 0., 0., 0., 0., 11., 12.,
      0., 0., 0., 0., 0., 0., 13., 14., 0., 0., 0., 0., 0., 0., 15., 16.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 17., 18., 0., 0., 0., 0., 0., 0., 19., 20.,
      0., 0., 0., 0., 0., 0., 21., 22., 0., 0., 0., 0., 0., 0., 23., 24.};
  const std::array<int, 4> in_shape = {{3, 10, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    1.,    2.,    3.,    4.,    5.,    6.,
      7.,    8.,    48.,   52.,   0.,    0.,    0.,    0.,    0.,    0.,
      17.,   18.,   19.,   20.,   21.,   22.,   23.,   24.,   112.,  116.,
      0.,    0.,    0.,    0.,    0.,    0.,    33.,   34.,   35.,   36.,
      37.,   38.,   39.,   40.,   176.,  180.,  0.,    0.,    0.,    0.,
      0.,    0.,    49.,   50.,   51.,   52.,   53.,   54.,   55.,   56.,
      240.,  244.,  0.,    0.,    0.,    0.,    0.,    0.,    65.,   66.,
      67.,   68.,   69.,   70.,   71.,   72.,   304.,  308.,  0.,    0.,
      0.,    0.,    0.,    0.,    81.,   82.,   83.,   84.,   85.,   86.,
      87.,   88.,   368.,  372.,  0.,    0.,    0.,    0.,    0.,    0.,
      484.,  488.,  492.,  496.,  500.,  504.,  508.,  512.,  2112., 2128.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    161.,  162.,  163.,  164.,  165.,  166.,
      167.,  168.,  688.,  692.,  0.,    0.,    0.,    0.,    0.,    0.,
      177.,  178.,  179.,  180.,  181.,  182.,  183.,  184.,  752.,  756.,
      0.,    0.,    0.,    0.,    0.,    0.,    193.,  194.,  195.,  196.,
      197.,  198.,  199.,  200.,  816.,  820.,  0.,    0.,    0.,    0.,
      0.,    0.,    209.,  210.,  211.,  212.,  213.,  214.,  215.,  216.,
      880.,  884.,  0.,    0.,    0.,    0.,    0.,    0.,    225.,  226.,
      227.,  228.,  229.,  230.,  231.,  232.,  944.,  948.,  0.,    0.,
      0.,    0.,    0.,    0.,    241.,  242.,  243.,  244.,  245.,  246.,
      247.,  248.,  1008., 1012., 0.,    0.,    0.,    0.,    0.,    0.,
      1124., 1128., 1132., 1136., 1140., 1144., 1148., 1152., 4672., 4688.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    321.,  322.,  323.,  324.,  325.,  326.,
      327.,  328.,  1328., 1332., 0.,    0.,    0.,    0.,    0.,    0.,
      337.,  338.,  339.,  340.,  341.,  342.,  343.,  344.,  1392., 1396.,
      0.,    0.,    0.,    0.,    0.,    0.,    353.,  354.,  355.,  356.,
      357.,  358.,  359.,  360.,  1456., 1460., 0.,    0.,    0.,    0.,
      0.,    0.,    369.,  370.,  371.,  372.,  373.,  374.,  375.,  376.,
      1520., 1524., 0.,    0.,    0.,    0.,    0.,    0.,    385.,  386.,
      387.,  388.,  389.,  390.,  391.,  392.,  1584., 1588., 0.,    0.,
      0.,    0.,    0.,    0.,    401.,  402.,  403.,  404.,  405.,  406.,
      407.,  408.,  1648., 1652., 0.,    0.,    0.,    0.,    0.,    0.,
      1764., 1768., 1772., 1776., 1780., 1784., 1788., 1792., 7232., 7248.};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 21., 22., 23., 24.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 25., 26., 27., 28.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 29., 30., 31., 32.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 33., 34., 35., 36.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 37., 38., 39., 40.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 41., 42., 43., 44.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{3, 10, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    1.,    2.,
      3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,   11.,   12.,
      13.,   14.,   15.,   16.,   92.,   96.,   100.,  104.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      33.,   34.,   35.,   36.,   37.,   38.,   39.,   40.,   41.,   42.,
      43.,   44.,   45.,   46.,   47.,   48.,   220.,  224.,  228.,  232.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    65.,   66.,   67.,   68.,   69.,   70.,   71.,   72.,
      73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,   348.,  352.,
      356.,  360.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    97.,   98.,   99.,   100.,  101.,  102.,
      103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,  111.,  112.,
      476.,  480.,  484.,  488.,  0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    129.,  130.,  131.,  132.,
      133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,  141.,  142.,
      143.,  144.,  604.,  608.,  612.,  616.,  0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    161.,  162.,
      163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,  171.,  172.,
      173.,  174.,  175.,  176.,  732.,  736.,  740.,  744.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      964.,  968.,  972.,  976.,  980.,  984.,  988.,  992.,  996.,  1000.,
      1004., 1008., 1012., 1016., 1020., 1024., 4208., 4224., 4240., 4256.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    321.,  322.,
      323.,  324.,  325.,  326.,  327.,  328.,  329.,  330.,  331.,  332.,
      333.,  334.,  335.,  336.,  1372., 1376., 1380., 1384., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      353.,  354.,  355.,  356.,  357.,  358.,  359.,  360.,  361.,  362.,
      363.,  364.,  365.,  366.,  367.,  368.,  1500., 1504., 1508., 1512.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    1831., 1838., 1845., 1852., 1859., 1866., 1873., 1880.,
      1887., 1894., 1901., 1908., 1915., 1922., 1929., 1936., 7940., 7968.,
      7996., 8024., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      97.,   98.,   99.,   100.,  101.,  102.,  103.,  104.,  105.,  106.,
      107.,  108.,  109.,  110.,  111.,  112.,  476.,  480.,  484.,  488.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    129.,  130.,
      131.,  132.,  133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,
      141.,  142.,  143.,  144.,  604.,  608.,  612.,  616.,  0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      161.,  162.,  163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,
      171.,  172.,  173.,  174.,  175.,  176.,  732.,  736.,  740.,  744.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    193.,  194.,  195.,  196.,  197.,  198.,  199.,  200.,
      201.,  202.,  203.,  204.,  205.,  206.,  207.,  208.,  860.,  864.,
      868.,  872.,  0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    225.,  226.,  227.,  228.,  229.,  230.,
      231.,  232.,  233.,  234.,  235.,  236.,  237.,  238.,  239.,  240.,
      988.,  992.,  996.,  1000., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    257.,  258.,  259.,  260.,
      261.,  262.,  263.,  264.,  265.,  266.,  267.,  268.,  269.,  270.,
      271.,  272.,  1116., 1120., 1124., 1128., 0.,    0.,    0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    289.,  290.,
      291.,  292.,  293.,  294.,  295.,  296.,  297.,  298.,  299.,  300.,
      301.,  302.,  303.,  304.,  1244., 1248., 1252., 1256., 0.,    0.,
      0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1476., 1480., 1484., 1488., 1492., 1496., 1500., 1504., 1508., 1512.,
      1516., 1520., 1524., 1528., 1532., 1536., 6256., 6272., 6288., 6304.};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  1.,  2.,  3.,   4.,   5.,
      6.,   7.,   8.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   9.,   10.,  11.,  12.,  13., 14., 15., 16., 0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  17., 18., 19., 20.,  21.,  22.,
      23.,  24.,  0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      25.,  26.,  27.,  28.,  29.,  30., 31., 32., 0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  180., 184., 188.,
      192., 196., 200., 204., 208., 0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   65.,  66.,
      67.,  68.,  69.,  70.,  71.,  72., 0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   73.,  74., 75., 76., 77., 78., 79.,  80.,  0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  81.,  82.,  83.,
      84.,  85.,  86.,  87.,  88.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,
      0.,   0.,   0.,   89.,  90.,  91., 92., 93., 94., 95., 96.};
  const std::array<int, 4> in_shape = {{3, 10, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   1.,   2.,   3.,
      4.,   5.,    30.,   0.,    0.,    0.,   10.,  11.,  12.,  13.,  14.,
      66.,  0.,    0.,    0.,    19.,   20.,  21.,  22.,  23.,  102., 0.,
      0.,   0.,    28.,   29.,   30.,   31.,  32.,  138., 0.,   0.,   0.,
      37.,  38.,   39.,   40.,   41.,   174., 0.,   0.,   0.,   46.,  47.,
      48.,  49.,   50.,   210.,  0.,    0.,   0.,   274., 278., 282., 286.,
      290., 1200., 0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   91.,
      92.,  93.,   94.,   95.,   390.,  0.,   0.,   0.,   100., 101., 102.,
      103., 104.,  426.,  0.,    0.,    0.,   109., 110., 111., 112., 113.,
      462., 0.,    0.,    0.,    118.,  119., 120., 121., 122., 498., 0.,
      0.,   0.,    127.,  128.,  129.,  130., 131., 534., 0.,   0.,   0.,
      136., 137.,  138.,  139.,  140.,  570., 0.,   0.,   0.,   634., 638.,
      642., 646.,  650.,  2640., 0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,    0.,    0.,    0.,    0.,   0.,   0.,   0.,   0.,   0.,
      0.,   181.,  182.,  183.,  184.,  185., 750., 0.,   0.,   0.,   190.,
      191., 192.,  193.,  194.,  786.,  0.,   0.,   0.,   199., 200., 201.,
      202., 203.,  822.,  0.,    0.,    0.,   208., 209., 210., 211., 212.,
      858., 0.,    0.,    0.,    217.,  218., 219., 220., 221., 894., 0.,
      0.,   0.,    226.,  227.,  228.,  229., 230., 930., 0.,   0.,   0.,
      994., 998.,  1002., 1006., 1010., 4080.};
  const std::array<int, 4> in_shape = {{3, 10, 9, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      1.,  2.,  3.,  0.,  0.,  0.,  0., 0., 0., 4.,  5.,  6.,  0.,  0.,  0.,
      0.,  0.,  0.,  7.,  8.,  9.,  0., 0., 0., 0.,  0.,  0.,  10., 11., 12.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      13., 14., 15., 0.,  0.,  0.,  0., 0., 0., 16., 17., 18., 0.,  0.,  0.,
      0.,  0.,  0.,  19., 20., 21., 0., 0., 0., 0.,  0.,  0.,  22., 23., 24.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      25., 26., 27., 0.,  0.,  0.,  0., 0., 0., 28., 29., 30., 0.,  0.,  0.,
      0.,  0.,  0.,  31., 32., 33., 0., 0., 0., 0.,  0.,  0.,  34., 35., 36.};
  const std::array<int, 4> in_shape = {{3, 10, 9, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      1.,     2.,     3.,    4.,    5.,    6.,    7.,    8.,    9.,    10.,
      56.,    60.,    0.,    0.,    0.,    0.,    0.,    0.,    19.,   20.,
      21.,    22.,    23.,   24.,   25.,   26.,   27.,   28.,   128.,  132.,
      0.,     0.,     0.,    0.,    0.,    0.,    37.,   38.,   39.,   40.,
      41.,    42.,    43.,   44.,   45.,   46.,   200.,  204.,  0.,    0.,
      0.,     0.,     0.,    0.,    55.,   56.,   57.,   58.,   59.,   60.,
      61.,    62.,    63.,   64.,   272.,  276.,  0.,    0.,    0.,    0.,
      0.,     0.,     73.,   74.,   75.,   76.,   77.,   78.,   79.,   80.,
      81.,    82.,    344.,  348.,  0.,    0.,    0.,    0.,    0.,    0.,
      91.,    92.,    93.,   94.,   95.,   96.,   97.,   98.,   99.,   100.,
      416.,   420.,   0.,    0.,    0.,    0.,    0.,    0.,    544.,  548.,
      552.,   556.,   560.,  564.,  568.,  572.,  576.,  580.,  2384., 2400.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      181.,   182.,   183.,  184.,  185.,  186.,  187.,  188.,  189.,  190.,
      776.,   780.,   0.,    0.,    0.,    0.,    0.,    0.,    199.,  200.,
      201.,   202.,   203.,  204.,  205.,  206.,  207.,  208.,  848.,  852.,
      0.,     0.,     0.,    0.,    0.,    0.,    217.,  218.,  219.,  220.,
      221.,   222.,   223.,  224.,  225.,  226.,  920.,  924.,  0.,    0.,
      0.,     0.,     0.,    0.,    235.,  236.,  237.,  238.,  239.,  240.,
      241.,   242.,   243.,  244.,  992.,  996.,  0.,    0.,    0.,    0.,
      0.,     0.,     253.,  254.,  255.,  256.,  257.,  258.,  259.,  260.,
      261.,   262.,   1064., 1068., 0.,    0.,    0.,    0.,    0.,    0.,
      271.,   272.,   273.,  274.,  275.,  276.,  277.,  278.,  279.,  280.,
      1136.,  1140.,  0.,    0.,    0.,    0.,    0.,    0.,    1264., 1268.,
      1272.,  1276.,  1280., 1284., 1288., 1292., 1296., 1300., 5264., 5280.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      361.,   362.,   363.,  364.,  365.,  366.,  367.,  368.,  369.,  370.,
      1496.,  1500.,  0.,    0.,    0.,    0.,    0.,    0.,    379.,  380.,
      381.,   382.,   383.,  384.,  385.,  386.,  387.,  388.,  1568., 1572.,
      0.,     0.,     0.,    0.,    0.,    0.,    397.,  398.,  399.,  400.,
      401.,   402.,   403.,  404.,  405.,  406.,  1640., 1644., 0.,    0.,
      0.,     0.,     0.,    0.,    415.,  416.,  417.,  418.,  419.,  420.,
      421.,   422.,   423.,  424.,  1712., 1716., 0.,    0.,    0.,    0.,
      0.,     0.,     433.,  434.,  435.,  436.,  437.,  438.,  439.,  440.,
      441.,   442.,   4756., 4770., 0.,    0.,    0.,    0.,    0.,    0.,
      12135., 12170., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.};
  const std::array<int, 4> in_shape = {{3, 10, 9, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   1.,  2.,  3.,  4.,  5.,  6.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  7.,  8.,
      9.,  10., 11., 12., 0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  13., 14., 15., 16., 17.,  18.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  19.,  20.,  21., 22., 23., 24., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  25.,  26.,  27., 28., 29., 30., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  31., 32., 33., 34.,
      35., 36., 0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      37., 38., 39., 40., 41., 42., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  43., 44., 45.,  46.,  47., 48., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  49., 50., 51.,  52.,  53., 54., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   55., 56., 57., 58., 59., 60.,
      0.,  0.,  0.,  0.,  0.,  0.,  396., 402., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,   0.};
  const std::array<int, 4> in_shape = {{3, 10, 9, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      1.,     2.,     3.,     4.,     5.,    6.,    7.,    8.,    9.,    10.,
      11.,    12.,    13.,    14.,    15.,   16.,   17.,   18.,   19.,   20.,
      108.,   112.,   116.,   120.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    37.,   38.,   39.,   40.,
      41.,    42.,    43.,    44.,    45.,   46.,   47.,   48.,   49.,   50.,
      51.,    52.,    53.,    54.,    55.,   56.,   252.,  256.,  260.,  264.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     73.,    74.,    75.,   76.,   77.,   78.,   79.,   80.,
      81.,    82.,    83.,    84.,    85.,   86.,   87.,   88.,   89.,   90.,
      91.,    92.,    396.,   400.,   404.,  408.,  0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    109.,  110.,
      111.,   112.,   113.,   114.,   115.,  116.,  117.,  118.,  119.,  120.,
      121.,   122.,   123.,   124.,   125.,  126.,  127.,  128.,  540.,  544.,
      548.,   552.,   0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     145.,  146.,  147.,  148.,  149.,  150.,
      151.,   152.,   153.,   154.,   155.,  156.,  157.,  158.,  159.,  160.,
      161.,   162.,   163.,   164.,   684.,  688.,  692.,  696.,  0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      181.,   182.,   183.,   184.,   185.,  186.,  187.,  188.,  189.,  190.,
      191.,   192.,   193.,   194.,   195.,  196.,  197.,  198.,  199.,  200.,
      828.,   832.,   836.,   840.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    1084., 1088., 1092., 1096.,
      1100.,  1104.,  1108.,  1112.,  1116., 1120., 1124., 1128., 1132., 1136.,
      1140.,  1144.,  1148.,  1152.,  1156., 1160., 4752., 4768., 4784., 4800.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      361.,   362.,   363.,   364.,   365.,  366.,  367.,  368.,  369.,  370.,
      371.,   372.,   373.,   374.,   375.,  376.,  377.,  378.,  379.,  380.,
      7716.,  7744.,  7772.,  7800.,  0.,    0.,    0.,    0.,    8739., 8774.,
      8809.,  8844.,  0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    310.,  312.,  314.,  316.,
      318.,   320.,   322.,   324.,   326.,  328.,  330.,  332.,  334.,  336.,
      338.,   340.,   342.,   344.,   346.,  348.,  1956., 1968., 1980., 1992.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      209.,   210.,   211.,   212.,   213.,  214.,  215.,  216.,  217.,  218.,
      219.,   220.,   221.,   222.,   223.,  224.,  225.,  226.,  227.,  228.,
      940.,   944.,   948.,   952.,   0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    245.,  246.,  247.,  248.,
      249.,   250.,   251.,   252.,   253.,  254.,  255.,  256.,  257.,  258.,
      259.,   260.,   261.,   262.,   263.,  264.,  1084., 1088., 1092., 1096.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     281.,   282.,   283.,  284.,  285.,  286.,  287.,  288.,
      289.,   290.,   291.,   292.,   293.,  294.,  295.,  296.,  297.,  298.,
      299.,   300.,   1228.,  1232.,  1236., 1240., 0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    317.,  318.,
      319.,   320.,   321.,   322.,   323.,  324.,  325.,  326.,  327.,  328.,
      329.,   330.,   331.,   332.,   333.,  334.,  335.,  336.,  1372., 1376.,
      1380.,  1384.,  0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     353.,  354.,  355.,  356.,  357.,  358.,
      359.,   360.,   361.,   362.,   363.,  364.,  365.,  366.,  367.,  368.,
      369.,   370.,   371.,   372.,   4378., 4392., 4406., 4420., 0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      11435., 11470., 11505., 11540., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.};
  const std::array<int, 4> in_shape = {{3, 10, 9, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,   10.,  11.,  12.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      13.,  14.,  15.,  16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,  24.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      25.,  26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35.,  36.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,  48.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   300., 304., 308., 312.,
      0.,   0.,   0.,   0.,   552., 560., 568., 576., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      97.,  98.,  99.,  100., 101., 102., 103., 104., 105., 106., 107., 108.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      109., 110., 111., 112., 113., 114., 115., 116., 117., 118., 119., 120.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      786., 792., 798., 804., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.};
  const std::array<int, 4> in_shape = {{3, 10, 9, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      1.,    2.,    3.,   4.,    5.,   6.,   34.,  0.,    0.,    0.,    11.,
      12.,   13.,   14.,  15.,   16.,  74.,  0.,   0.,    0.,    21.,   22.,
      23.,   24.,   25.,  26.,   114., 0.,   0.,   0.,    31.,   32.,   33.,
      34.,   35.,   36.,  154.,  0.,   0.,   0.,   41.,   42.,   43.,   44.,
      45.,   46.,   194., 0.,    0.,   0.,   51.,  52.,   53.,   54.,   55.,
      56.,   234.,  0.,   0.,    0.,   304., 308., 312.,  316.,  320.,  324.,
      1336., 0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    101.,  102., 103.,  104., 105., 106., 434.,  0.,    0.,    0.,
      111.,  112.,  113., 114.,  115., 116., 474., 0.,    0.,    0.,    121.,
      122.,  123.,  124., 125.,  126., 514., 0.,   0.,    0.,    131.,  132.,
      133.,  134.,  135., 136.,  554., 0.,   0.,   0.,    141.,  142.,  143.,
      144.,  145.,  146., 594.,  0.,   0.,   0.,   151.,  152.,  153.,  154.,
      155.,  156.,  634., 0.,    0.,   0.,   704., 708.,  712.,  716.,  720.,
      724.,  2936., 0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    0.,   0.,    0.,   0.,   0.,   0.,    0.,    0.,    0.,
      0.,    0.,    201., 202.,  203., 204., 205., 206.,  834.,  0.,    0.,
      0.,    211.,  212., 213.,  214., 215., 216., 874.,  0.,    0.,    0.,
      221.,  222.,  223., 224.,  225., 226., 914., 0.,    0.,    0.,    231.,
      232.,  233.,  234., 235.,  236., 954., 0.,   0.,    0.,    241.,  242.,
      243.,  244.,  245., 246.,  994., 0.,   0.,   0.,    251.,  252.,  253.,
      254.,  255.,  256., 1034., 0.,   0.,   0.,   1104., 1108., 1112., 1116.,
      1120., 1124., 4536.};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 1.,  2.,  3.,  4.,  0., 0.,  0.,  0.,  0.,
      0., 5.,  6.,  7.,  8.,  0., 0.,  0.,  0.,  0.,  0., 9.,  10., 11., 12.,
      0., 0.,  0.,  0.,  0.,  0., 13., 14., 15., 16., 0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 17., 18., 19., 20., 0., 0.,  0.,  0.,  0.,  0., 21., 22., 23., 24.,
      0., 0.,  0.,  0.,  0.,  0., 25., 26., 27., 28., 0., 0.,  0.,  0.,  0.,
      0., 29., 30., 31., 32., 0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,
      0., 0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0., 33., 34., 35., 36.,
      0., 0.,  0.,  0.,  0.,  0., 37., 38., 39., 40., 0., 0.,  0.,  0.,  0.,
      0., 41., 42., 43., 44., 0., 0.,  0.,  0.,  0.,  0., 45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{3, 10, 10, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    1.,    2.,    3.,    4.,
      5.,     6.,     7.,    8.,    9.,    10.,   11.,   12.,   64.,   68.,
      0.,     0.,     0.,    0.,    0.,    0.,    21.,   22.,   23.,   24.,
      25.,    26.,    27.,   28.,   29.,   30.,   31.,   32.,   144.,  148.,
      0.,     0.,     0.,    0.,    0.,    0.,    41.,   42.,   43.,   44.,
      45.,    46.,    47.,   48.,   49.,   50.,   51.,   52.,   224.,  228.,
      0.,     0.,     0.,    0.,    0.,    0.,    61.,   62.,   63.,   64.,
      65.,    66.,    67.,   68.,   69.,   70.,   71.,   72.,   304.,  308.,
      0.,     0.,     0.,    0.,    0.,    0.,    81.,   82.,   83.,   84.,
      85.,    86.,    87.,   88.,   89.,   90.,   91.,   92.,   384.,  388.,
      0.,     0.,     0.,    0.,    0.,    0.,    101.,  102.,  103.,  104.,
      105.,   106.,   107.,  108.,  109.,  110.,  111.,  112.,  464.,  468.,
      0.,     0.,     0.,    0.,    0.,    0.,    604.,  608.,  612.,  616.,
      620.,   624.,   628.,  632.,  636.,  640.,  644.,  648.,  2656., 2672.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    201.,  202.,  203.,  204.,
      205.,   206.,   207.,  208.,  209.,  210.,  211.,  212.,  864.,  868.,
      0.,     0.,     0.,    0.,    0.,    0.,    221.,  222.,  223.,  224.,
      225.,   226.,   227.,  228.,  229.,  230.,  231.,  232.,  944.,  948.,
      0.,     0.,     0.,    0.,    0.,    0.,    241.,  242.,  243.,  244.,
      245.,   246.,   247.,  248.,  249.,  250.,  251.,  252.,  1024., 1028.,
      0.,     0.,     0.,    0.,    0.,    0.,    261.,  262.,  263.,  264.,
      265.,   266.,   267.,  268.,  269.,  270.,  271.,  272.,  1104., 1108.,
      0.,     0.,     0.,    0.,    0.,    0.,    281.,  282.,  283.,  284.,
      285.,   286.,   287.,  288.,  289.,  290.,  291.,  292.,  1184., 1188.,
      0.,     0.,     0.,    0.,    0.,    0.,    301.,  302.,  303.,  304.,
      305.,   306.,   307.,  308.,  309.,  310.,  311.,  312.,  1264., 1268.,
      0.,     0.,     0.,    0.,    0.,    0.,    1404., 1408., 1412., 1416.,
      1420.,  1424.,  1428., 1432., 1436., 1440., 1444., 1448., 5856., 5872.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    401.,  402.,  403.,  404.,
      405.,   406.,   407.,  408.,  409.,  410.,  411.,  412.,  1664., 1668.,
      0.,     0.,     0.,    0.,    0.,    0.,    421.,  422.,  423.,  424.,
      425.,   426.,   427.,  428.,  429.,  430.,  431.,  432.,  3262., 3272.,
      0.,     0.,     0.,    0.,    0.,    0.,    1971., 1978., 1985., 1992.,
      12751., 12800., 0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,    0.,    0.,    0.,    69.,   70.,   71.,   72.,
      73.,    74.,    75.,   76.,   77.,   78.,   79.,   80.,   403.,  408.};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  1.,    2.,    3.,  4.,  5.,  6.,  7.,  8.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  9.,  10.,
      11., 12., 13., 14., 15., 16., 0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  17., 18., 19.,   20.,   21., 22., 23., 24., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  25., 26., 27., 28.,
      29., 30., 31., 32., 0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  33., 34., 35., 36.,
      37., 38., 39., 40., 0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  41., 42., 43., 44., 45.,   46.,   47., 48., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    49., 50., 51., 52., 53., 54.,
      55., 56., 0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      57., 58., 59., 60., 61., 62., 63.,   64.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  1280., 1296., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,    0.,    0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 10, 10, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, SAME3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     1.,     2.,     3.,    4.,    5.,    6.,    7.,    8.,
      9.,     10.,    11.,    12.,    13.,   14.,   15.,   16.,   17.,   18.,
      19.,    20.,    21.,    22.,    23.,   24.,   124.,  128.,  132.,  136.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     41.,    42.,    43.,   44.,   45.,   46.,   47.,   48.,
      49.,    50.,    51.,    52.,    53.,   54.,   55.,   56.,   57.,   58.,
      59.,    60.,    61.,    62.,    63.,   64.,   284.,  288.,  292.,  296.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     81.,    82.,    83.,   84.,   85.,   86.,   87.,   88.,
      89.,    90.,    91.,    92.,    93.,   94.,   95.,   96.,   97.,   98.,
      99.,    100.,   101.,   102.,   103.,  104.,  444.,  448.,  452.,  456.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     121.,   122.,   123.,  124.,  125.,  126.,  127.,  128.,
      129.,   130.,   131.,   132.,   133.,  134.,  135.,  136.,  137.,  138.,
      139.,   140.,   141.,   142.,   143.,  144.,  604.,  608.,  612.,  616.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     161.,   162.,   163.,  164.,  165.,  166.,  167.,  168.,
      169.,   170.,   171.,   172.,   173.,  174.,  175.,  176.,  177.,  178.,
      179.,   180.,   181.,   182.,   183.,  184.,  764.,  768.,  772.,  776.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     201.,   202.,   203.,  204.,  205.,  206.,  207.,  208.,
      209.,   210.,   211.,   212.,   213.,  214.,  215.,  216.,  217.,  218.,
      219.,   220.,   221.,   222.,   223.,  224.,  924.,  928.,  932.,  936.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     1204.,  1208.,  1212., 1216., 1220., 1224., 1228., 1232.,
      1236.,  1240.,  1244.,  1248.,  1252., 1256., 1260., 1264., 1268., 1272.,
      1276.,  1280.,  1284.,  1288.,  1292., 1296., 5296., 5312., 5328., 5344.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     1470.,  1476.,  1482., 1488., 1494., 1500., 1506., 1512.,
      1518.,  1524.,  1530.,  1536.,  1542., 1548., 1554., 1560., 8732., 8768.,
      8804.,  8840.,  0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     756.,   760.,   764.,  768.,  772.,  776.,  780.,  784.,
      788.,   792.,   796.,   800.,   804.,  808.,  812.,  816.,  820.,  824.,
      828.,   832.,   836.,   840.,   844.,  848.,  3504., 3520., 3536., 3552.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     289.,   290.,   291.,  292.,  293.,  294.,  295.,  296.,
      297.,   298.,   299.,   300.,   301.,  302.,  303.,  304.,  305.,  306.,
      307.,   308.,   309.,   310.,   311.,  312.,  1276., 1280., 1284., 1288.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     329.,   330.,   331.,  332.,  333.,  334.,  335.,  336.,
      337.,   338.,   339.,   340.,   341.,  342.,  343.,  344.,  345.,  346.,
      347.,   348.,   349.,   350.,   351.,  352.,  2930., 2940., 2950., 2960.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     1887.,  1894.,  1901., 1908., 1915., 1922., 1929., 1936.,
      12653., 12702., 12751., 12800., 0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     0.,     0.,     0.,    0.,    0.,    0.,    0.,    0.,
      0.,     0.,     137.,   138.,   139.,  140.,  141.,  142.,  143.,  144.,
      145.,   146.,   147.,   148.,   149.,  150.,  151.,  152.,  153.,  154.,
      155.,   156.,   157.,   158.,   159.,  160.,  801.,  806.,  811.,  816.};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride1Grad, VALID3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      1.,    2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,    10.,   11.,
      12.,   13.,  14.,  15.,  16.,  0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   17.,  18.,   19.,   20.,
      21.,   22.,  23.,  24.,  25.,  26.,  27.,  28.,  29.,   30.,   31.,
      32.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   33.,  34.,  35.,  36.,  37.,  38.,   39.,   40.,
      41.,   42.,  43.,  44.,  45.,  46.,  47.,  48.,  0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    49.,
      50.,   51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,   59.,   60.,
      61.,   62.,  63.,  64.,  0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    243.,  246.,
      249.,  252., 801., 810., 819., 828., 0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   113., 114., 115., 116., 117., 118.,  119.,  120.,
      121.,  122., 123., 124., 125., 126., 127., 128., 0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   2544., 2560., 2576.,
      2592., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.,    0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,    0.,    0.,
      0.};
  const std::array<int, 4> in_shape = {{3, 10, 10, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
