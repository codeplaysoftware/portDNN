/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.13.2.

#include <gtest/gtest.h>

#include "sycldnn/padding_mode.h"

#include "sycldnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/kernel_data_types.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn; // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using GTestTypePairs = sycldnn::types::ToGTestTypes<SNNTypePairs>::type;

template <typename Pair>
using AvgWindow7Stride1Grad =
    PoolingFixture<typename Pair::FirstType, typename Pair::SecondType,
                   pooling::Average, pooling::Backpropagate>;
TYPED_TEST_SUITE(AvgWindow7Stride1Grad, GTestTypePairs);
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 7.15218253968254 ,  8.794019274376419, 10.836082766439908, 13.43846371882086 , 14.767630385487529, 12.924773242630383, 11.262471655328797,  9.729138321995464, 10.870209750566895, 13.2671485260771  , 16.213973922902493, 19.93064058956916 , 21.509807256235824, 18.69552154195011 , 16.19988662131519 , 13.931859410430839, 16.22060657596372 , 19.6889739229025  , 23.913577097505666, 29.196910430838997, 31.06774376417233 , 26.85345804988662 , 23.163378684807256, 19.847732426303853, 23.856320861678007, 28.838973922902497, 34.86357709750566 , 42.346910430839   , 44.567743764172334, 38.35345804988661 , 32.96337868480725 , 28.16201814058957 , 34.48965419501134 , 41.47230725623584 , 49.83024376417234 , 60.113577097505676, 62.33441043083901 , 53.32012471655329 , 45.59671201814059 , 38.7953514739229  , 32.93013038548752 , 39.54135487528345 , 47.43262471655329 , 57.11595804988662 , 58.98679138321995 , 50.372505668934245, 43.01575963718821 , 36.557256235827666, 30.61782879818594 , 36.72905328798186 , 44.0092120181406  , 52.925878684807266, 54.505045351473925, 46.49075963718821 , 39.66179138321995 , 33.679478458049886, 27.76782879818594 , 33.287216553287976, 39.85308956916101 , 47.884041950113385, 49.21320861678005 , 41.94178004535147 , 35.75566893424036 , 30.344784580498867};
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.04081632653061224 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.061224489795918366, 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.08163265306122448 };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 13.72748866213152 ,  14.30436507936508 ,  16.90265873015873 ,  17.588038548752838,  20.860198412698413,  21.672165532879816,  25.91305555555556 ,  26.87692743764172 ,  28.571388888888887,  29.535260770975057,  25.037579365079367,  25.849546485260767,  21.839563492063494,  22.524943310657594,  18.88140022675737 ,  19.458276643990928,  21.055039682539682,  21.74041950113379 ,  25.720005668934242,  26.5342970521542  ,  31.46325963718821 ,  32.42794784580499 ,  38.716116780045354,  39.86128117913832 ,  41.874450113378686,  43.01961451247165 ,  36.426354875283444,  37.39104308390022 ,  31.58548185941043 ,  32.39977324263038 ,  27.17833900226757 ,  27.863718820861678,  31.629246031746028,  32.44121315192744 ,  38.41325963718821 ,  39.377947845805   ,  46.68429138321996 ,  47.82715419501133 ,  57.037148526077104,  58.393820861677995,  60.77881519274377 ,  62.13548752834466 ,  52.564053287981864,  53.70691609977324 ,  45.362069160997734,  46.32675736961451 ,  38.88349773242631 ,  39.69546485260771 ,  46.74876984126984 ,  47.712641723356015,  56.532783446712024,  57.677947845804994,  68.37048185941043 ,  69.72715419501132 ,  83.08333900226756 ,  84.693820861678   ,  87.52500566893423 ,  89.13548752834467 ,  75.35024376417233 ,  76.70691609977322 ,  64.78159297052154 ,  65.9267573696145  ,  55.360164399092966,  56.32403628117914 ,  68.0154365079365  ,  68.97930839002268 ,  81.79945011337868 ,  82.94461451247167 ,  98.30381519274377 ,  99.66048752834467 , 118.6166723356009  , 120.22715419501135 , 123.05833900226756 , 124.66882086167801 , 105.28357709750567 , 106.64024943310658 ,  90.04825963718821 ,  91.19342403628119 ,  76.62683106575963 ,  77.5907029478458  ,  65.04829365079365 ,  65.86026077097505 ,  78.11802154195011 ,  79.0827097505669  ,  93.7223866213152  ,  94.86524943310658 , 112.87524376417234 , 114.23191609977324 , 116.616910430839   , 117.9735827664399  ,  99.6021485260771  , 100.74501133786849 ,  85.06683106575963 ,  86.03151927437642 ,  72.30254535147392 ,  73.11451247165533 ,  60.55027777777778 ,  61.23565759637188 ,  72.64381519274376 ,  73.45810657596373 ,  87.0537358276644  ,  88.0184240362812  , 104.70659297052154 , 105.85175736961453 , 107.86492630385487 , 109.01009070294785 ,  92.01683106575963 ,  92.98151927437642 ,  78.50929138321995 ,  79.3235827664399  ,  66.67357709750567 ,  67.35895691609977 ,  54.95878117913832 ,  55.53565759637188 ,  65.88905328798187 ,  66.57443310657595 ,  78.89421201814059 ,  79.70617913832201 ,  94.80421201814059 ,  95.76808390022677 ,  97.46254535147392 ,  98.4264172335601  ,  83.07159297052154 ,  83.88356009070294 ,  70.82595804988662 ,  71.51133786848072 ,  60.11269274376417 ,  60.689569160997735};
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.14285714285714285 , 0.16326530612244897 };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  62.446524943310656,  63.258492063492056,  64.07045918367346 ,  64.88242630385488 ,  75.86183106575963 ,  76.82651927437642 ,  77.79120748299319 ,  78.75589569161    ,  92.2257199546485  ,  93.36858276643991 ,  94.51144557823127 ,  95.65430839002266 , 112.71762471655326 , 114.07429705215421 , 115.4309693877551  , 116.78764172335599 , 120.20095804988661 , 121.55763038548754 , 122.91430272108843 , 124.27097505668932 , 103.98524376417232 , 105.12810657596373 , 106.27096938775509 , 107.41383219954648 ,  89.75945011337868 ,  90.72413832199547 ,  91.68882653061223 ,  92.65351473922902 ,  76.9550283446712  ,  77.76699546485261 ,  78.578962585034   ,  79.39092970521541 ,  92.53366780045351 ,  93.49753968253968 ,  94.46141156462583 ,  95.42528344671203 , 111.92040249433107 , 113.06556689342405 , 114.21073129251698 , 115.35589569160999 , 135.38429138321993 , 136.74096371882086 , 138.09763605442174 , 139.45430839002265 , 164.5561961451247  , 166.16667800453513 , 167.77715986394557 , 169.387641723356   , 173.43952947845804 , 175.05001133786845 , 176.66049319727892 , 178.27097505668934 , 149.3438151927438  , 150.70048752834467 , 152.05715986394554 , 153.41383219954645 , 128.4180215419501  , 129.5631859410431  , 130.70835034013604 , 131.853514739229   , 109.75645691609976 , 110.72032879818593 , 111.68420068027211 , 112.64807256235828 , 135.06700113378685 , 136.030873015873   , 136.99474489795915 , 137.95861678004536 , 162.45373582766442 , 163.59890022675737 , 164.74406462585029 , 165.88922902494335 , 195.25095804988663 , 196.60763038548754 , 197.9643027210884  , 199.32097505668935 , 235.62286281179135 , 237.2333446712018  , 238.8438265306122  , 240.4543083900227  , 244.5061961451247  , 246.11667800453512 , 247.72715986394553 , 249.33764172335603 , 209.21048185941046 , 210.56715419501134 , 211.92382653061222 , 213.28049886621315 , 178.95135487528344 , 180.09651927437642 , 181.24168367346937 , 182.38684807256237 , 152.2897902494331  , 153.25366213151926 , 154.21753401360544 , 155.1814058956916  , 129.2846201814059  , 130.0965873015873  , 130.90855442176868 , 131.7205215419501  , 155.27135487528346 , 156.23604308390023 , 157.20073129251696 , 158.1654195011338  , 186.301910430839   , 187.4447732426304  , 188.58763605442172 , 189.73049886621317 , 224.39381519274377 , 225.75048752834468 , 227.10715986394555 , 228.4638321995465  , 231.8771485260771  , 233.233820861678   , 234.59049319727885 , 235.9471655328798  , 198.06143424036284 , 199.2042970521542  , 200.34715986394554 , 201.49002267573698 , 169.1689739229025  , 170.13366213151926 , 171.09835034013605 , 172.06303854875284 , 143.79312358276644 , 144.60509070294785 , 145.41705782312928 , 146.22902494331066 , 120.41517573696144 , 121.10055555555556 , 121.78593537414966 , 122.47131519274376 , 144.47333900226758 , 145.28763038548752 , 146.10192176870743 , 146.91621315192745 , 173.14278344671206 , 174.1074716553288  , 175.07215986394553 , 176.0368480725624  , 208.26802154195013 , 209.41318594104308 , 210.55835034013603 , 211.70351473922906 , 214.5846882086168  , 215.72985260770974 , 216.8750170068027  , 218.0201814058957  , 183.0689739229025  , 184.03366213151926 , 184.99835034013603 , 185.96303854875285 , 156.20429138321995 , 157.0185827664399  , 157.8328741496599  , 158.6471655328798  , 132.6617743764172  , 133.34715419501134 , 134.03253401360547 , 134.71791383219954 , 109.34068594104308 , 109.91756235827664 , 110.49443877551022 , 111.07131519274375 , 131.0927267573696  , 131.77810657596373 , 132.4634863945578  , 133.1488662131519  , 156.9764569160998  , 157.78842403628119 , 158.60039115646254 , 159.41235827664403 , 188.64455215419503 , 189.60842403628118 , 190.5722959183673  , 191.53616780045354 , 193.9612188208617  , 194.92509070294784 , 195.888962585034   , 196.8528344671202  , 165.33121882086166 , 166.14318594104307 , 166.9551530612245  , 167.7671201814059  , 140.96653628117912 , 141.65191609977325 , 142.33729591836737 , 143.02267573696145 , 119.64850907029479 , 120.22538548752834 , 120.8022619047619  , 121.37913832199547 };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.14285714285714285 , 0.16326530612244897 , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.18367346938775508 , 0.2040816326530612  , 0.22448979591836732 , 0.24489795918367346 , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.3061224489795918  , 0.32653061224489793 };
  const std::array<int, 4> in_shape = {{ 1, 8, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 7.882772108843537,  9.66202380952381 , 11.549778911564626, 13.87874716553288 , 14.47124716553288 , 16.30922335600907 , 14.486604308390024, 12.815856009070295, 11.036604308390022, 12.034812925170067, 14.65079931972789 , 17.395697278911566, 20.748475056689344, 21.276689342403625, 23.63609410430839 , 20.884903628117918, 18.39782879818594 , 15.781842403628119, 18.0181462585034  , 21.824608843537412, 25.783792517006805, 30.581014739229026, 30.959229024943305, 34.001967120181405, 29.9174433106576  , 26.263701814058955, 22.457239229024943, 26.56528911564626 , 32.057465986394554, 37.73093537414966 , 44.561490929705215, 44.66970521541949 , 48.62244331065759 , 42.63791950113379 , 37.32703514739229 , 31.834858276643992, 38.52778911564626 , 46.26996598639456 , 54.193435374149665, 63.64899092970522 , 62.969705215419495, 67.7099433106576  , 59.10041950113378 , 51.539535147392286, 43.79735827664399 , 36.81636054421769 , 44.158537414965984, 51.653435374149666, 60.57565759637188 , 59.71637188208616 , 63.996609977324255, 55.78708616780045 , 48.59763038548753 , 41.25545351473922 , 34.2508843537415  , 41.04544217687076 , 47.968911564625856, 56.19668934240362 , 55.262403628117916, 59.08430839002267 , 51.458117913832204, 44.79247165532879 , 37.99791383219955 , 31.075374149659865, 37.21687074829932 , 43.46687074829933 , 50.88512471655329 , 49.95083900226758 , 53.315600907029484, 46.40369614512471 , 40.37070294784581 , 34.22920634920635 };
  const std::array<int, 4> in_shape = {{ 1, 8, 9, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.10204081632653061 , 0.061224489795918366, 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.08163265306122448 , 0.18367346938775508 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.22448979591836732 , 0.12244897959183673 };
  const std::array<int, 4> in_shape = {{ 1, 8, 9, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 15.188667800453512,  15.765544217687074,  18.63866780045351 ,  19.32404761904762 ,  22.3056746031746  ,  23.099557823129253,  26.837023809523814,  27.75749433106576 ,  28.060000000000002,  28.94249433106576 ,  31.697976190476187,  32.61844671201814 ,  28.179325396825394,  28.97320861678005 ,  24.946332199546482,  25.63171201814059 ,  21.496332199546483,  22.073208616780043,  23.384246031746027,  24.069625850340135,  28.487307256235823,  29.30159863945578 ,  33.84819160997732 ,  34.79139455782313 ,  40.403350340136065,  41.49695011337869 ,  41.50489795918368 ,  42.55337868480725 ,  46.17858843537415 ,  47.27218820861678 ,  40.826604308390024,  41.769807256235836,  35.98136621315193 ,  36.79565759637188 ,  30.878304988662126,  31.563684807256237,  35.22432539682539 ,  36.0362925170068  ,  42.68452947845804 ,  43.649217687074824,  50.45017573696144 ,  51.56758503401361 ,  59.8664455782313  ,  61.16202947845805 ,  60.67632653061225 ,  61.91845804988661 ,  66.70835034013605 ,  68.00393424036281 ,  58.717477324263044,  59.8348866213152  ,  51.56271541950114 ,  52.52740362811791 ,  44.10251133786848 ,  44.914478458049885,  52.16670634920634 ,  53.13057823129252 ,  62.96976757369613 ,  64.11493197278911 ,  74.13541383219955 ,  75.46187074829932 ,  87.58501700680273 ,  89.12298185941043 ,  87.8648979591837  ,  89.33941043083898 ,  95.70692176870749 ,  97.24488662131517 ,  83.94938208616782 ,  85.27583900226757 ,  73.50890589569161 ,  74.65407029478457 ,  62.70584467120181 ,  63.669716553287984,  76.09170634920633 ,  77.05557823129251 ,  91.39476757369613 ,  92.53993197278912 , 107.06041383219953 , 108.38687074829933 , 125.76001700680273 , 127.29798185941044 , 124.46489795918367 , 125.93941043083899 , 133.88192176870749 , 135.4198866213152  , 116.8743820861678  , 118.20083900226756 , 101.9339058956916  , 103.07907029478457 ,  86.63084467120181 ,  87.59471655328798 ,  72.82075396825397 ,  73.63272108843537 ,  87.35238662131518 ,  88.31707482993197 , 102.18946145124715 , 103.30687074829933 , 119.855731292517   , 121.15131519274377 , 118.19061224489795 , 119.43274376417232 , 126.69763605442176 , 127.99321995464851 , 110.45676303854874 , 111.5741723356009  ,  96.23057256235828 ,  97.19526077097505 ,  81.69893990929705 ,  82.51090702947845 ,  67.8163888888889  ,  68.501768707483   ,  81.27659297052153 ,  82.09088435374152 ,  94.99462018140588 ,  95.93782312925171 , 111.29977891156462 , 112.39337868480725 , 109.47632653061224 , 110.52480725623583 , 117.07501700680271 , 118.16861678004534 , 101.97303287981859 , 102.91623582766441 ,  88.77065192743764 ,  89.58494331065758 ,  75.31044784580499 ,  75.9958276643991  ,  61.57387188208617 ,  62.15074829931973 ,  73.74836167800453 ,  74.43374149659864 ,  86.13985827664398 ,  86.93374149659866 , 100.84977891156461 , 101.77024943310659 ,  99.01918367346937 ,  99.90167800453516 , 105.710731292517   , 106.63120181405897 ,  92.01350907029477 ,  92.80739229024942 ,  80.0560260770975  ,  80.74140589569161 ,  67.88153628117914 ,  68.4584126984127  };
  const std::array<int, 4> in_shape = {{ 1, 8, 9, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.16326530612244897, 0.20408163265306123, 0.1020408163265306 , 0.12244897959183673, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.14285714285714285, 0.16326530612244897, 0.32653061224489793, 0.36734693877551017, 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.4081632653061224 , 0.44897959183673464, 0.22448979591836732, 0.24489795918367346};
  const std::array<int, 4> in_shape = {{ 1, 8, 9, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 29.800459183673464,  30.377335600907024,  30.954212018140588,  31.531088435374148,  36.59195578231292 ,  37.27733560090702 ,  37.96271541950113 ,  38.64809523809524 ,  43.81746598639456 ,  44.6113492063492  ,  45.405232426303854,  46.199115646258505,  52.75357709750567 ,  53.67404761904763 ,  54.594518140589564,  55.51498866213152 ,  55.23750566893423 ,  56.120000000000005,  57.00249433106575 ,  57.88498866213152 ,  62.47548185941042 ,  63.39595238095237 ,  64.31642290249434 ,  65.23689342403628 ,  55.56476757369614 ,  56.35865079365079 ,  57.15253401360544 ,  57.9464172335601  ,  49.20728458049886 ,  49.892664399092965,  50.57804421768707 ,  51.26342403628118 ,  42.4157879818594  ,  42.992664399092966,  43.56954081632652 ,  44.146417233560086,  46.08311224489796 ,  46.768492063492054,  47.45387188208617 ,  48.13925170068027 ,  56.1603231292517  ,  56.974614512471646,  57.788905895691606,  58.60319727891156 ,  66.75318027210885 ,  67.69638321995464 ,  68.63958616780045 ,  69.58278911564626 ,  79.71310090702949 ,  80.80670068027213 ,  81.90030045351473 ,  82.99390022675738 ,  81.96131519274377 ,  83.00979591836736 ,  84.05827664399091 ,  85.1067573696145  ,  91.26357709750566 ,  92.3571768707483  ,  93.45077664399092 ,  94.54437641723356 ,  80.71000566893422 ,  81.65320861678005 ,  82.59641156462584 ,  83.53961451247167 ,  71.14844104308389 ,  71.96273242630386 ,  72.7770238095238  ,  73.59131519274376 ,  61.07123015873015 ,  61.75660997732425 ,  62.44198979591836 ,  63.127369614512475,  69.63668367346938 ,  70.44865079365078 ,  71.26061791383219 ,  72.0725850340136  ,  84.40437074829931 ,  85.36905895691608 ,  86.33374716553288 ,  87.29843537414965 ,  99.78294217687076 , 100.90035147392288 , 102.01776077097504 , 103.13517006802722 , 118.43730725623585 , 119.7328911564626  , 121.02847505668933 , 122.3240589569161  , 120.11052154195012 , 121.3526530612245  , 122.59478458049884 , 123.83691609977322 , 132.12111678004533 , 133.4167006802721  , 134.71228458049885 , 136.00786848072562 , 116.3175453514739  , 117.43495464852609 , 118.55236394557821 , 119.6697732426304  , 102.16074263038549 , 103.12543083900228 , 104.09011904761903 , 105.05480725623582 ,  87.39305555555555 ,  88.20502267573696 ,  89.01698979591835 ,  89.82895691609977 , 103.36954081632652 , 104.33341269841269 , 105.29728458049885 , 106.26115646258503 , 124.79437074829933 , 125.93953514739226 , 127.08469954648525 , 128.22986394557822 , 146.94437074829932 , 148.2708276643991  , 149.59728458049887 , 150.92374149659864 , 173.63206916099776 , 175.17003401360546 , 176.7079988662131  , 178.24596371882086 , 174.255283446712   , 175.7297959183674  , 177.20430839002262 , 178.67882086167796 , 189.87587868480722 , 191.41384353741498 , 192.95180839002265 , 194.48977324263035 , 166.5723072562358  , 167.89876417233563 , 169.22522108843535 , 170.55167800453515 , 145.87264739229025 , 147.01781179138322 , 148.16297619047617 , 149.30814058956915 , 124.44781746031745 , 125.41168934240362 , 126.37556122448976 , 127.33943310657597 , 151.21954081632654 , 152.18341269841267 , 153.14728458049885 , 154.11115646258503 , 181.64437074829937 , 182.78953514739226 , 183.9346995464852  , 185.07986394557824 , 212.79437074829934 , 214.12082766439906 , 215.44728458049886 , 216.77374149659866 , 249.98206916099775 , 251.52003401360545 , 253.05799886621313 , 254.59596371882088 , 247.45528344671206 , 248.92979591836735 , 250.40430839002266 , 251.87882086167798 , 266.22587868480724 , 267.76384353741497 , 269.30180839002264 , 270.8397732426304  , 232.42230725623583 , 233.7487641723356  , 235.07522108843534 , 236.4016780045351  , 202.72264739229024 , 203.8678117913832  , 205.01297619047617 , 206.15814058956914 , 172.29781746031748 , 173.26168934240363 , 174.22556122448978 , 175.18943310657596 , 144.82954081632653 , 145.64150793650794 , 146.45347505668934 , 147.26544217687075 , 173.74008503401365 , 174.70477324263035 , 175.66946145124712 , 176.63414965986394 , 203.2615136054422  , 204.3789229024943  , 205.49633219954646 , 206.61374149659866 , 238.41587868480727 , 239.711462585034   , 241.00704648526076 , 242.30263038548753 , 235.13909297052157 , 236.3812244897959  , 237.62335600907025 , 238.86548752834463 , 252.09968820861678 , 253.39527210884353 , 254.69085600907025 , 255.98643990929702 , 219.79611678004537 , 220.9135260770975  , 222.03093537414964 , 223.1483446712018  , 191.4964569160998  , 192.46114512471655 , 193.42583333333332 , 194.3905215419501  , 162.5859126984127  , 163.3978798185941  , 164.20984693877548 , 165.0218140589569  , 134.9473979591837  , 135.6327777777778  , 136.31815759637186 , 137.003537414966   , 161.73889455782316 , 162.55318594104307 , 163.367477324263   , 164.18176870748303 , 189.046037414966   , 189.98924036281176 , 190.93244331065756 , 191.87564625850342 , 221.50595804988663 , 222.59955782312923 , 223.69315759637183 , 224.7867573696145  , 217.90417233560095 , 218.95265306122448 , 220.00113378684804 , 221.04961451247166 , 233.05643424036282 , 234.15003401360542 , 235.24363378684805 , 236.33723356009068 , 203.00286281179137 , 203.94606575963718 , 204.88926870748296 , 205.83247165532882 , 176.72701247165534 , 177.54130385487528 , 178.35559523809522 , 179.16988662131516 , 149.93551587301587 , 150.62089569160997 , 151.30627551020405 , 151.9916553287982  , 122.57086734693878 , 123.14774376417235 , 123.7246201814059  , 124.30149659863946 , 146.81134353741498 , 147.49672335600906 , 148.18210317460316 , 148.86748299319729 , 171.48583333333335 , 172.27971655328795 , 173.07359977324262 , 173.8674829931973  , 200.77908730158728 , 201.69955782312923 , 202.62002834467117 , 203.54049886621317 , 197.15587301587303 , 198.03836734693874 , 198.9208616780045  , 199.8033560090703  , 210.50099206349208 , 211.421462585034   , 212.34193310657594 , 213.26240362811794 , 183.2331349206349  , 184.02701814058955 , 184.82090136054418 , 185.61478458049885 , 159.42667233560093 , 160.112052154195   , 160.7974319727891  , 161.48281179138323 , 135.1861961451247  , 135.76307256235827 , 136.33994897959184 , 136.9168253968254  };
  const std::array<int, 4> in_shape = {{ 1, 8, 9, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.40816326530612246 , 0.18367346938775508 , 0.2040816326530612  , 0.22448979591836732 , 0.24489795918367346 , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.26530612244897955 , 0.2857142857142857  , 0.3061224489795918  , 0.32653061224489793 , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.4693877551020408  , 0.4897959183673469  };
  const std::array<int, 4> in_shape = {{ 1, 8, 9, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 8.613361678004535, 10.5300283446712  , 12.555198412698413, 14.688871882086168, 14.710102040816327, 15.773435374149658, 18.094070294784576, 16.285907029478455, 14.36924036281179 , 12.344070294784583, 13.199416099773241, 16.034450113378682, 18.998395691609975, 22.091252834467117, 21.791054421768706, 23.054387755102034, 26.136927437641713, 23.430804988662125, 20.595770975056684, 17.6318253968254  , 19.815685941043082, 23.960243764172333, 28.257522675736958, 32.70752267573695 , 31.893435374149657, 33.390102040816316, 37.50041950113378 , 33.5085827664399  , 29.36402494331065 , 25.06674603174603 , 29.274257369614514, 35.27595804988662 , 41.45895124716553 , 47.82323696145123 , 46.225816326530605, 48.00248299319726 , 53.51280045351472 , 47.692392290249416, 41.690691609977314, 35.50769841269841 , 42.56592403628118 , 51.06762471655329 , 59.7506179138322  , 68.6149036281179  , 65.55914965986395 , 67.33581632653059 , 74.3044671201814  , 65.98405895691609 , 57.48235827664399 , 48.79936507936508 , 40.702590702947845, 48.77571995464853 , 57.00157029478458 , 65.380141723356   , 62.27438775510203 , 63.7710544217687  , 70.17303854875283 , 62.25263038548753 , 54.17950113378685 , 45.953650793650795, 37.883939909297055, 45.361831065759645, 52.96863378684808 , 60.704348072562354, 57.69581632653061 , 58.95914965986395 , 64.75002267573697 , 57.40104308390023 , 49.92315192743765 , 42.31634920634921 , 34.38291950113379 , 41.14652494331066 , 48.01863378684808 , 54.99924603174604 , 52.193095238095246, 53.25642857142858 , 58.40444444444445 , 51.74934240362813 , 44.98573696145125 , 38.113628117913834};
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.18367346938775508 , 0.14285714285714285 , 0.08163265306122448 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.1020408163265306  , 0.22448979591836732 , 0.36734693877551017 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.4285714285714285  , 0.30612244897959184 , 0.16326530612244897 };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 16.64984693877551 ,  17.22672335600907 ,  20.374676870748296,  21.0600566893424  ,  24.31651360544218 ,  25.110396825396826,  28.475357142857142,  29.377743764172337,  28.581111111111106,  29.420204081632654,  30.707777777777775,  31.546870748299316,  35.285753968253964,  36.18814058956915 ,  31.77793083900226 ,  32.57181405895691 ,  28.053100907029474,  28.73848072562358 ,  24.111264172335602,  24.688140589569166,  25.713452380952383,  26.398832199546483,  31.25460884353741 ,  32.068900226757364,  37.053588435374145,  37.99679138321995 ,  43.11039115646258 ,  44.18250566893423 ,  42.58519274376416 ,  43.58210884353741 ,  45.11185941043083 ,  46.10877551020407 ,  51.20174036281178 ,  52.273854875283426,  45.918407029478445,  46.86160997732425 ,  40.377250566893416,  41.19154195011337 ,  34.57827097505669 ,  35.2636507936508  ,  38.819404761904764,  39.631371882086164,  46.95579931972788 ,  47.920487528344665,  55.39763605442177 ,  56.515045351473916,  64.14491496598639 ,  65.4150453514739  ,  62.60582766439907 ,  63.786870748299314,  65.59916099773243 ,  66.78020408163263 ,  73.73070861678003 ,  75.00083900226755 ,  65.89975623582765 ,  67.0171655328798  ,  57.76336167800453 ,  58.7280498866213  ,  49.321524943310656,  50.13349206349206 ,  57.58464285714285 ,  58.54851473922903 ,  69.40675170068026 ,  70.55191609977324 ,  81.5914455782313  ,  82.91790249433106 ,  94.13872448979592 ,  95.64647392290246 ,  91.0496371882086  ,  92.45163265306121 ,  94.60297052154196 ,  96.00496598639452 , 105.5178514739229  , 107.02560090702944 ,  94.05832766439909 ,  95.38478458049883 ,  82.23621882086168 ,  83.38138321995463 ,  70.05152494331065 ,  71.01539682539682 ,  84.1679761904762  ,  85.13184807256236 , 100.9900850340136  , 102.13524943310658 , 118.17477891156463 , 119.5012358276644  , 135.72205782312926 , 137.2298072562358  , 129.7163038548753  , 131.1182993197279  , 133.2696371882086  , 134.67163265306118 , 147.10118480725623 , 148.6089342403628  , 130.6416609977324  , 131.96811791383217 , 113.81955215419498 , 114.96471655328799 ,  96.63485827664397 ,  97.59873015873016 ,  80.59321428571428 ,  81.40518140589569 ,  96.58675170068028 ,  97.55143990929706 , 112.88573129251701 , 114.00314058956916 , 129.4901530612245  , 130.760283446712   , 123.36773242630383 , 124.54877551020407 , 126.36106575963717 , 127.5421088435374  , 139.07594671201812 , 140.34607709750566 , 123.38785147392288 , 124.50526077097506 , 107.3943140589569  , 108.3590022675737  ,  91.09533446712017 ,  91.90730158730159 ,  75.0825           ,  75.76787981859411 ,  89.90937074829932 ,  90.72366213151929 , 104.99406462585034 , 105.93726757369616 , 120.33658163265305 , 121.40869614512471 , 114.39471655328798 , 115.39163265306122 , 116.92138321995462 , 117.9182993197279  , 128.42793083900224 , 129.50004535147394 , 113.85888321995462 , 114.80208616780045 ,  99.0320124716553  ,  99.8463038548753  ,  83.9473185941043  ,  84.63269841269842 ,  68.188962585034   ,  68.76583900226758 ,  81.60767006802722 ,  82.29304988662132 ,  95.2433843537415  ,  96.03726757369616 , 109.09610544217686 , 109.99849206349208 , 103.54709750566892 , 104.38619047619049 , 105.67376417233557 , 106.51285714285716 , 115.90650226757367 , 116.8088888888889  , 102.70480158730156 , 103.49868480725625 ,  89.28609410430836 ,  89.9714739229025  ,  75.6503798185941  ,  76.22725623582767 };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.30612244897959184, 0.36734693877551017, 0.24489795918367346, 0.2857142857142857 , 0.14285714285714285, 0.16326530612244897, 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.18367346938775508, 0.2040816326530612 , 0.4081632653061224 , 0.44897959183673464, 0.6734693877551019 , 0.7346938775510203 , 0.9795918367346936 , 1.0612244897959182 , 0.9795918367346936 , 1.0612244897959182 , 0.9795918367346936 , 1.0612244897959182 , 0.9795918367346936 , 1.0612244897959182 , 0.7959183673469387 , 0.857142857142857  , 0.5714285714285714 , 0.6122448979591837 , 0.3061224489795918 , 0.32653061224489793};
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 32.72281746031746 ,  33.29969387755102 ,  33.876570294784585,  34.45344671201814 ,  40.06397392290249 ,  40.74935374149659 ,  41.434733560090706,  42.1201133786848  ,  47.8391439909297  ,  48.63302721088436 ,  49.426910430838994,  50.22079365079365 ,  56.04832766439909 ,  56.950714285714284,  57.853100907029464,  58.75548752834467 ,  56.32312925170068 ,  57.16222222222221 ,  58.00131519274377 ,  58.84040816326531 ,  60.576462585034015,  61.41555555555555 ,  62.254648526077105,  63.09374149659863 ,  69.66912131519274 ,  70.57150793650793 ,  71.47389455782313 ,  72.3762811791383  ,  62.76197845804988 ,  63.55586167800452 ,  64.34974489795918 ,  65.14362811791382 ,  55.42082199546485 ,  56.10620181405895 ,  56.79158163265306 ,  57.47696145124716 ,  47.64565192743764 ,  48.222528344671204,  48.79940476190476 ,  49.37628117913833 ,  50.74152494331066 ,  51.426904761904765,  52.112284580498866,  52.797664399092966,  61.69492630385488 ,  62.50921768707482 ,  63.32350907029478 ,  64.13780045351473 ,  73.16397392290249 ,  74.10717687074829 ,  75.0503798185941  ,  75.9935827664399  ,  85.1486678004535  ,  86.22078231292517 ,  87.2928968253968  ,  88.36501133786847 ,  84.17346938775509 ,  85.17038548752832 ,  86.1673015873016  ,  87.16421768707482 ,  89.22680272108843 ,  90.22371882086166 ,  91.22063492063492 ,  92.21755102040814 , 101.33136621315192 , 102.40348072562357 , 103.47559523809524 , 104.54770975056685 ,  90.89361111111111 ,  91.83681405895689 ,  92.78001700680272 ,  93.7232199546485  ,  79.94020975056691 ,  80.75450113378683 ,  81.56879251700681 ,  82.38308390022674 ,  68.47116213151928 ,  69.15654195011338 ,  69.84192176870748 ,  70.5273015873016  ,  76.82684240362812 ,  77.63880952380953 ,  78.45077664399093 ,  79.26274376417233 ,  92.94691043083901 ,  93.91159863945576 ,  94.87628684807257 ,  95.84097505668933 , 109.67786281179137 , 110.79527210884353 , 111.91268140589568 , 113.03009070294783 , 127.01969954648524 , 128.28982993197278 , 129.55996031746028 , 130.8300907029478  , 124.03061224489795 , 125.21165532879814 , 126.39269841269842 , 127.57374149659863 , 130.01727891156463 , 131.19832199546485 , 132.37936507936507 , 133.56040816326527 , 146.19128684807256 , 147.46141723356007 , 148.73154761904763 , 150.0016780045351  , 130.68210317460318 , 131.7995124716553  , 132.91692176870748 , 134.0343310657596  , 114.56203514739231 , 115.52672335600906 , 116.49141156462585 , 117.4560997732426  ,  97.83108276643992 ,  98.64304988662131 ,  99.4550170068027  , 100.26698412698413 , 114.20541383219954 , 115.1692857142857  , 116.1331575963719  , 117.09702947845805 , 137.6683390022676  , 138.81350340136052 , 139.95866780045353 , 141.10383219954647 , 161.85643424036283 , 163.1828911564626  , 164.50934807256235 , 165.83580498866212 , 186.7696995464853  , 188.27744897959184 , 189.78519841269838 , 191.29294784580492 , 180.69727891156467 , 182.0992743764172  , 183.50126984126985 , 184.90326530612242 , 187.80394557823132 , 189.20594104308393 , 190.6079365079365  , 192.00993197278905 , 209.52795351473924 , 211.0357029478458  , 212.54345238095237 , 214.05120181405889 , 186.79019841269843 , 188.11665532879817 , 189.44311224489795 , 190.76956916099766 , 163.32727324263038 , 164.47243764172336 , 165.6176020408163  , 166.76276643990926 , 139.13917800453515 , 140.1030498866213  , 141.06692176870746 , 142.03079365079364 , 167.3720804988662  , 168.3359523809524  , 169.29982426303857 , 170.26369614512473 , 200.83500566893426 , 201.9801700680272  , 203.12533446712015 , 204.27049886621316 , 235.0231009070295  , 236.34955782312926 , 237.676014739229   , 239.0024716553288  , 269.936366213152   , 271.4441156462585  , 272.951865079365   , 274.4596145124716  , 258.030612244898   , 259.4326077097506  , 260.83460317460316 , 262.2365986394558  , 265.13727891156464 , 266.5392743764172  , 267.94126984126984 , 269.34326530612236 , 292.69462018140587 , 294.20236961451246 , 295.71011904761906 , 297.2178684807256  , 259.9568650793651  , 261.2833219954648  , 262.6097789115646  , 263.93623582766435 , 226.49393990929704 , 227.63910430838996 , 228.78426870748302 , 229.92943310657597 , 192.3058446712018  , 193.26971655328794 , 194.23358843537414 , 195.19746031746033 , 160.37446145124716 , 161.18642857142856 , 161.99839569160997 , 162.81036281179138 , 192.20881519274377 , 193.17350340136056 , 194.1381916099773  , 195.10287981859412 , 224.65405328798187 , 225.77146258503402 , 226.88887188208614 , 228.0062811791383  , 257.7101757369615  , 258.980306122449   , 260.2504365079365  , 261.520566893424   , 245.55442176870753 , 246.73546485260766 , 247.9165079365079  , 249.09755102040813 , 251.54108843537418 , 252.72213151927434 , 253.9031746031746  , 255.0842176870748  , 276.8817630385488  , 278.15189342403625 , 279.4220238095238  , 280.6921541950113  , 245.65829365079364 , 246.77570294784576 , 247.89311224489796 , 249.0105215419501  , 213.82393990929705 , 214.7886281179138  , 215.7533163265306  , 216.7180045351474  , 181.37870181405896 , 182.19066893424034 , 183.00263605442177 , 183.81460317460318 , 149.4796201814059  , 150.165            , 150.8503798185941  , 151.53575963718822 , 179.0044501133787  , 179.81874149659865 , 180.6330328798186  , 181.44732426303858 , 209.04492630385488 , 209.98812925170068 , 210.93133219954646 , 211.87453514739232 , 239.6010487528345  , 240.6731632653061  , 241.74527777777774 , 242.81739229024942 , 227.79251700680274 , 228.78943310657596 , 229.7863492063492  , 230.78326530612244 , 232.84585034013605 , 233.84276643990924 , 234.83968253968254 , 235.8365986394558  , 255.78374716553287 , 256.8558616780045  , 257.9279761904762  , 259.0000907029479  , 226.77456349206346 , 227.71776643990924 , 228.6609693877551  , 229.6041723356009  , 197.2497335600907  , 198.0640249433106  , 198.87831632653064 , 199.6926077097506  , 167.2092573696145  , 167.8946371882086  , 168.5800170068027  , 169.26539682539683 , 135.80104875283448 , 136.377925170068   , 136.9548015873016  , 137.53167800453517 , 162.5299603174603  , 163.21534013605444 , 163.9007199546485  , 164.58609977324264 , 189.69288548752832 , 190.486768707483   , 191.28065192743765 , 192.0745351473923  , 217.28982426303855 , 218.19221088435373 , 219.09459750566893 , 219.99698412698416 , 206.2551020408163  , 207.09419501133783 , 207.93328798185942 , 208.77238095238098 , 210.50843537414966 , 211.34752834467113 , 212.18662131519278 , 213.02571428571432 , 230.9106179138322  , 231.81300453514734 , 232.7153911564626  , 233.6177777777778  , 204.6157199546485  , 205.40960317460312 , 206.20348639455787 , 206.9973696145125  , 177.88680839002268 , 178.57218820861672 , 179.2575680272109  , 179.942947845805   , 150.72388321995464 , 151.3007596371882  , 151.87763605442177 , 152.45451247165533 };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5510204081632653  , 0.6122448979591837  , 0.6734693877551019  , 0.7346938775510203  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.3061224489795918  , 0.32653061224489793 , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 0.3469387755102041  , 0.36734693877551017 , 0.3877551020408163  , 0.4081632653061224  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 1.2857142857142856  , 1.3469387755102038  , 1.4081632653061225  , 1.4693877551020407  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.530612244897959   , 1.5918367346938773  , 1.6530612244897958  , 1.714285714285714   , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 0.5918367346938775  , 0.6122448979591836  , 0.6326530612244897  , 0.6530612244897959  };
  const std::array<int, 4> in_shape = {{ 1, 8, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 7.15218253968254 ,  8.794019274376419, 10.836082766439908, 13.43846371882086 , 14.767630385487529, 12.924773242630383, 11.262471655328797,  9.729138321995464, 10.870209750566895, 13.2671485260771  , 16.213973922902493, 19.93064058956916 , 21.509807256235824, 18.69552154195011 , 16.19988662131519 , 13.931859410430839, 15.456264172335601, 18.77157029478458 , 22.813633786848072, 27.873157596371875, 29.70232426303854 , 25.68803854875283 , 22.168594104308387, 19.002607709750567, 21.81935941043084 , 26.396570294784585, 31.938633786848076, 38.83149092970521 , 40.95232426303855 , 35.271371882086164, 30.33526077097505 , 25.931179138321994, 30.23995464852608 , 36.381451247165536, 43.7401814058957  , 52.803038548752845, 54.836371882086176, 46.93541950113379 , 40.157641723356015, 34.18213151927438 , 41.26316893424036 , 49.49752267573696 , 59.306252834467124, 71.31910997732427 , 73.4399433106576  , 62.638990929705216, 53.43621315192744 , 45.37498866213151 , 38.95086734693877 , 46.68522108843537 , 55.88284013605442 , 67.12903061224489 , 68.95819727891156 , 58.75724489795918 , 50.08224489795918 , 42.497210884353734, 36.10086734693878 , 43.2433843537415  , 51.72671768707483 , 62.087193877551016, 63.66636054421768 , 54.20826530612245 , 46.176122448979584, 39.16251700680272 , 32.38284013605442 , 38.770255102040814, 46.348826530612236, 55.59501700680271 , 56.92418367346938 , 48.43751700680272 , 41.23870748299319 , 34.95979591836735 };
  const std::array<int, 4> in_shape = {{ 1, 9, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.04081632653061224 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.16326530612244897 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.20408163265306123 , 0.1020408163265306  , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.12244897959183673 };
  const std::array<int, 4> in_shape = {{ 1, 9, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 13.72748866213152 ,  14.30436507936508 ,  16.90265873015873 ,  17.588038548752838,  20.860198412698413,  21.672165532879816,  25.91305555555556 ,  26.87692743764172 ,  28.571388888888887,  29.535260770975057,  25.037579365079367,  25.849546485260767,  21.839563492063494,  22.524943310657594,  18.88140022675737 ,  19.458276643990928,  21.055039682539682,  21.74041950113379 ,  25.720005668934242,  26.5342970521542  ,  31.46325963718821 ,  32.42794784580499 ,  38.716116780045354,  39.86128117913832 ,  41.874450113378686,  43.01961451247165 ,  36.426354875283444,  37.39104308390022 ,  31.58548185941043 ,  32.39977324263038 ,  27.17833900226757 ,  27.863718820861678,  30.11864512471655 ,  30.912528344671202,  36.59993764172336 ,  37.54314058956916 ,  44.509858276643996,  45.627267573696145,  54.419858276644   ,  55.74631519274375 ,  58.07819160997733 ,  59.40464852607708 ,  50.258667800453516,  51.37607709750566 ,  43.393985260770975,  44.33718820861677 ,  37.21133219954648 ,  38.005215419501134,  42.71824829931972 ,  43.63871882086168 ,  51.699540816326525,  52.79314058956917 ,  62.581683673469385,  63.87726757369615 ,  76.12501700680274 ,  77.66298185941042 ,  80.3666836734694  ,  81.9046485260771  ,  69.24715986394558 ,  70.54274376417233 ,  59.57692176870748 ,  60.6705215419501  ,  50.94188775510204 ,  51.86235827664399 ,  59.59741496598638 ,  60.47990929705216 ,  71.71442176870748 ,  72.76290249433107 ,  86.238231292517   ,  87.4803628117914  , 104.13156462585036 , 105.60607709750569 , 108.19823129251701 , 109.67274376417235 ,  92.62870748299319 ,  93.87083900226757 ,  79.26680272108842 ,  80.31528344671203 ,  67.48176870748298 ,  68.36426303854876 ,  81.60586734693877 ,  82.52633786848072 ,  97.90144557823128 ,  98.99504535147392 , 117.31692176870747 , 118.61250566893425 , 141.10025510204082 , 142.63821995464855 , 145.3419217687075  , 146.8798866213152  , 123.98239795918367 , 125.27798185941043 , 105.77882653061222 , 106.87242630385488 ,  89.82950680272108 ,  90.74997732426301 ,  77.10785147392289 ,  77.90173469387754 ,  92.42723922902492 ,  93.37044217687074 , 110.64827097505669 , 111.76568027210884 , 132.93160430839    , 134.25806122448978 , 136.58993764172334 , 137.9163945578231  , 116.3970804988662  , 117.51448979591837 ,  99.22128684807255 , 100.16448979591836 ,  84.20053854875285 ,  84.99442176870747 ,  71.51635487528345 ,  72.20173469387755 ,  85.67247732426303 ,  86.486768707483   , 102.48874716553287 , 103.45343537414966 , 123.02922335600907 , 124.17438775510203 , 126.18755668934239 , 127.33272108843536 , 107.45184240362812 , 108.4165306122449  ,  91.53795351473923 ,  92.35224489795917 ,  77.63965419501133 ,  78.32503401360545 ,  64.18880385487529 ,  64.76568027210884 ,  76.85513038548753 ,  77.54051020408163 ,  91.88568594104308 ,  92.69765306122447 , 110.22616213151927 , 111.19003401360543 , 112.8844954648526  , 113.84836734693876 ,  96.06306689342404 ,  96.87503401360544 ,  81.79203514739228 ,  82.47741496598638 ,  69.34271541950113 ,  69.9195918367347  };
  const std::array<int, 4> in_shape = {{ 1, 9, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.2857142857142857  , 0.32653061224489793 , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.36734693877551017 , 0.40816326530612246 , 0.18367346938775508 , 0.2040816326530612  , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.22448979591836732 , 0.24489795918367346 };
  const std::array<int, 4> in_shape = {{ 1, 9, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  59.44340702947846 ,  60.2372902494331  ,  61.031173469387745,  61.825056689342404,  72.2566723356009  ,  73.19987528344672 ,  74.1430782312925  ,  75.08628117913833 ,  87.9023072562358  ,  89.01971655328799 ,  90.13712585034013 ,  91.25453514739229 , 107.51325963718818 , 108.839716553288   , 110.16617346938774 , 111.4926303854875  , 114.82992630385486 , 116.15638321995466 , 117.48284013605442 , 118.80929705215416 ,  99.39992630385487 , 100.51733560090703 , 101.63474489795917 , 102.75215419501131 ,  85.84476757369615 ,  86.78797052154195 ,  87.73117346938774 ,  88.67437641723355 ,  73.62878117913833 ,  74.42266439909297 ,  75.21654761904762 ,  76.01043083900227 ,  84.5160260770975  ,  85.43649659863944 ,  86.35696712018138 ,  87.27743764172337 , 102.30548185941042 , 103.39908163265305 , 104.49268140589568 , 105.58628117913834 , 123.867783446712   , 125.16336734693877 , 126.45895124716553 , 127.7545351473923  , 150.7120691609977  , 152.25003401360547 , 153.78799886621314 , 155.32596371882084 , 159.19540249433103 , 160.7333673469388  , 162.27133219954646 , 163.8092970521542  , 137.1987358276644  , 138.49431972789117 , 139.78990362811788 , 141.08548752834466 , 118.06024376417234 , 119.15384353741496 , 120.24744331065759 , 121.3410430839002  , 100.96330498866214 , 101.88377551020407 , 102.80424603174603 , 103.72471655328798 , 118.31233560090702 , 119.19482993197276 , 120.07732426303852 , 120.95981859410432 , 142.38036281179137 , 143.42884353741496 , 144.47732426303853 , 145.52580498866214 , 171.23433106575962 , 172.476462585034   , 173.71859410430838 , 174.9607256235828  , 206.78861678004532 , 208.26312925170072 , 209.73764172335598 , 211.21215419501138 , 214.92195011337864 , 216.39646258503402 , 217.8709750566893  , 219.3454875283447  , 184.01528344671203 , 185.25741496598638 , 186.49954648526074 , 187.74167800453515 , 157.48512471655332 , 158.53360544217685 , 159.5820861678004  , 160.63056689342406 , 134.08104308390025 , 134.96353741496597 , 135.84603174603174 , 136.7285260770975  , 162.29126417233562 , 163.21173469387753 , 164.13220521541948 , 165.05267573696145 , 194.70929138321995 , 195.80289115646255 , 196.8964909297052  , 197.99009070294784 , 233.3382596371882  , 234.63384353741495 , 235.92942743764172 , 237.2250113378685  , 280.6625453514739  , 282.20051020408164 , 283.7384750566893  , 285.2764399092971  , 289.14587868480726 , 290.683843537415   , 292.2218083900226  , 293.7597732426304  , 246.6692120181406  , 247.96479591836734 , 249.2603798185941  , 250.55596371882086 , 210.4640532879819  , 211.55765306122444 , 212.65125283446713 , 213.74485260770976 , 178.73854308390025 , 179.65901360544217 , 180.57948412698414 , 181.49995464852603 , 153.42181972789115 , 154.21570294784578 , 155.00958616780042 , 155.8034693877551  , 183.91127551020406 , 184.85447845804984 , 185.79768140589567 , 186.74088435374148 , 220.1791326530612  , 221.29654195011338 , 222.41395124716553 , 223.53136054421768 , 264.53675170068027 , 265.86320861678    , 267.1896655328798  , 268.51612244897956 , 271.853418367347   , 273.1798752834467  , 274.5063321995465  , 275.8327891156462  , 231.67675170068028 , 232.7941609977324  , 233.91157029478455 , 235.02897959183673 , 197.49937074829933 , 198.4425736961451  , 199.38577664399094 , 200.3289795918367  , 167.60719387755103 , 168.4010770975057  , 169.19496031746033 , 169.98884353741494 , 142.34732993197278 , 143.0327097505669  , 143.71808956916098 , 144.4034693877551  , 170.53066326530612 , 171.34495464852606 , 172.15924603174602 , 172.973537414966   , 204.01280612244898 , 204.97749433106574 , 205.94218253968253 , 206.90687074829933 , 244.91328231292516 , 246.05844671201814 , 247.20361111111106 , 248.34877551020406 , 251.22994897959185 , 252.37511337868477 , 253.52027777777775 , 254.66544217687073 , 213.93899659863948 , 214.90368480725624 , 215.868373015873   , 216.8330612244898  , 182.26161564625852 , 183.07590702947846 , 183.89019841269842 , 184.70448979591833 , 154.5939285714286  , 155.27930839002266 , 155.96468820861676 , 156.6500680272109  , 127.80073129251701 , 128.37760770975058 , 128.9544841269841  , 129.53136054421768 , 153.02488095238095 , 153.71026077097505 , 154.39564058956915 , 155.08102040816325 , 182.95940476190475 , 183.77137188208616 , 184.5833390022676  , 185.39530612244894 , 219.4884523809524  , 220.45232426303855 , 221.41619614512473 , 222.38006802721085 , 224.80511904761906 , 225.7689909297052  , 226.7328628117914  , 227.69673469387752 , 191.31416666666667 , 192.12613378684807 , 192.93810090702948 , 193.7500680272109  , 162.8986904761905  , 163.58407029478457 , 164.2694501133787  , 164.95482993197277 , 138.1085544217687  , 138.68543083900227 , 139.26230725623583 , 139.8391836734694  };
  const std::array<int, 4> in_shape = {{ 1, 9, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.14285714285714285 , 0.16326530612244897 , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5306122448979591  , 0.5714285714285714  , 0.6122448979591837  , 0.6530612244897959  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 0.693877551020408   , 0.7346938775510203  , 0.7755102040816326  , 0.8163265306122449  , 0.3469387755102041  , 0.36734693877551017 , 0.3877551020408163  , 0.4081632653061224  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.4693877551020408  , 0.4897959183673469  };
  const std::array<int, 4> in_shape = {{ 1, 9, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 7.882772108843537,  9.66202380952381 , 11.549778911564626, 13.87874716553288 , 14.47124716553288 , 16.30922335600907 , 14.486604308390024, 12.815856009070295, 11.036604308390022, 12.034812925170067, 14.65079931972789 , 17.395697278911566, 20.748475056689344, 21.276689342403625, 23.63609410430839 , 20.884903628117918, 18.39782879818594 , 15.781842403628119, 17.163384353741495, 20.799778911564623, 24.58549319727891 , 29.176366213151926, 29.57600907029478 , 32.52112811791383 , 28.627080498866217, 25.14000566893424 , 21.50361111111111 , 24.286003401360542, 29.327159863945575, 34.54144557823129 , 40.826763038548755, 41.001405895691605, 44.70485827664399 , 39.227477324263035, 34.359450113378685, 29.318293650793645, 33.76993197278911 , 40.57537414965986 , 47.54680272108843 , 55.87378684807257 , 55.35092970521542 , 59.59188208616779 , 52.039501133786835, 45.40004535147391 , 38.59460317460317 , 46.16028911564626 , 55.31573129251701 , 64.64430272108844 , 75.7296201814059  , 74.46426303854875 , 79.60771541950113 , 69.33033446712017 , 60.34802154195011 , 51.19257936507936 , 43.59481292517007 , 52.20263605442177 , 60.95977891156462 , 71.35065192743765 , 70.0102947845805  , 74.69541383219953 , 65.00136621315193 , 56.54286281179137 , 47.935039682539674, 40.419302721088435, 48.374064625850345, 56.457738095238085, 66.0390873015873  , 64.69873015873014 , 68.92670634920634 , 59.94694444444444 , 52.12109410430838 , 44.16633219954649 , 36.2672619047619  , 43.385289115646266, 50.61181972789116 , 59.169359410430836, 57.89328798185941 , 61.59983560090703 , 53.54864512471655 , 46.539121315192745, 39.421094104308395};
  const std::array<int, 4> in_shape = {{ 1, 9, 9, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.10204081632653061 , 0.061224489795918366, 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.22448979591836732 , 0.4897959183673469  , 0.7959183673469388  , 0.7959183673469388  , 0.7959183673469388  , 0.7959183673469388  , 0.7959183673469388  , 0.5714285714285714  , 0.30612244897959184 , 0.14285714285714285 , 0.30612244897959184 , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.346938775510204   , 0.18367346938775508 };
  const std::array<int, 4> in_shape = {{ 1, 9, 9, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 15.188667800453512,  15.765544217687074,  18.63866780045351 ,  19.32404761904762 ,  22.3056746031746  ,  23.099557823129253,  26.837023809523814,  27.75749433106576 ,  28.060000000000002,  28.94249433106576 ,  31.697976190476187,  32.61844671201814 ,  28.179325396825394,  28.97320861678005 ,  24.946332199546482,  25.63171201814059 ,  21.496332199546483,  22.073208616780043,  23.384246031746027,  24.069625850340135,  28.487307256235823,  29.30159863945578 ,  33.84819160997732 ,  34.79139455782313 ,  40.403350340136065,  41.49695011337869 ,  41.50489795918368 ,  42.55337868480725 ,  46.17858843537415 ,  47.27218820861678 ,  40.826604308390024,  41.769807256235836,  35.98136621315193 ,  36.79565759637188 ,  30.878304988662126,  31.563684807256237,  33.53288548752834 ,  34.32676870748299 ,  40.65635487528344 ,  41.599557823129246,  48.078463718820856,  49.17098639455782 ,  57.08600340136055 ,  58.35273242630385 ,  57.937551020408165,  59.15201814058956 ,  63.77552721088435 ,  65.04225623582767 ,  56.16163832199546 ,  57.254160997732434,  49.336808390022675,  50.28001133786848 ,  42.21333900226756 ,  43.00722222222222 ,  47.65153628117913 ,  48.572006802721084,  57.56071995464852 ,  58.65431972789115 ,  67.81616213151926 ,  69.08289115646258 ,  80.18481292517008 ,  81.65352607709751 ,  80.59469387755102 ,  82.00281179138321 ,  87.94100340136053 ,  89.40971655328798 ,  77.18822562358275 ,  78.45495464852607 ,  67.62530045351474 ,  68.71890022675737 ,  57.71611678004534 ,  58.63658730158729 ,  66.65736961451248 ,  67.53986394557822 ,  80.10226757369614 ,  81.15074829931972 ,  93.87913832199544 ,  95.09360544217687 , 110.33945578231291 , 111.74757369614514 , 109.35183673469386 , 110.70185941043084 , 117.77564625850339 , 119.18376417233559 , 102.86453514739229 , 104.07900226757367 ,  89.75160997732426 ,  90.80009070294783 ,  76.30671201814059 ,  77.18920634920634 ,  91.40010770975054 ,  92.32057823129252 , 109.53786281179136 , 110.63146258503401 , 128.02187641723353 , 129.28860544217687 , 149.99052721088432 , 151.4592403628118  , 147.52040816326524 , 148.9285260770975  , 157.74671768707478 , 159.21543083900227 , 137.39393990929705 , 138.66066893424033 , 119.60244331065762 , 120.69604308390022 , 101.46468820861679 , 102.38515873015872 ,  86.39574263038547 ,  87.18962585034014 , 103.46206916099773 , 104.40527210884353 , 120.82703514739227 , 121.91955782312924 , 141.4345748299319  , 142.7013038548753  , 138.80612244897955 , 140.020589569161   , 148.12409863945575 , 149.39082766439907 , 128.91020975056688 , 130.00273242630385 , 112.14252267573697 , 113.08572562358275 ,  95.07619614512473 ,  95.87007936507935 ,  80.15322562358276 ,  80.83860544217687 ,  95.9338378684807  ,  96.74812925170069 , 111.97227324263038 , 112.91547619047617 , 130.98457482993197 , 132.0781746031746  , 128.34897959183675 , 129.3974603174603  , 136.75981292517008 , 137.85341269841268 , 118.95068594104309 , 119.89388888888888 , 103.42789682539683 , 104.24218820861677 ,  87.64728458049886 ,  88.33266439909298 ,  71.95764739229024 ,  72.5345238095238  ,  86.08519841269838 ,  86.77057823129253 , 100.42975623582764 , 101.22363945578232 , 117.41824829931971 , 118.33871882086167 , 114.90408163265303 , 115.78657596371882 , 122.2792006802721  , 123.19967120181406 , 106.30340702947845 , 107.0972902494331  ,  92.39286281179139 ,  93.07824263038549 ,  78.26531179138321 ,  78.84218820861679 };
  const std::array<int, 4> in_shape = {{ 1, 9, 9, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.16326530612244897, 0.20408163265306123, 0.1020408163265306 , 0.12244897959183673, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4081632653061224 , 0.44897959183673464, 0.8979591836734693 , 0.9795918367346939 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.0612244897959182 , 1.1428571428571428 , 0.5714285714285714 , 0.6122448979591837 , 0.26530612244897955, 0.2857142857142857 , 0.5714285714285714 , 0.6122448979591837 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.6530612244897959 , 0.693877551020408  , 0.3469387755102041 , 0.36734693877551017};
  const std::array<int, 4> in_shape = {{ 1, 9, 9, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 29.800459183673464,  30.377335600907024,  30.954212018140588,  31.531088435374148,  36.59195578231292 ,  37.27733560090702 ,  37.96271541950113 ,  38.64809523809524 ,  43.81746598639456 ,  44.6113492063492  ,  45.405232426303854,  46.199115646258505,  52.75357709750567 ,  53.67404761904763 ,  54.594518140589564,  55.51498866213152 ,  55.23750566893423 ,  56.120000000000005,  57.00249433106575 ,  57.88498866213152 ,  62.47548185941042 ,  63.39595238095237 ,  64.31642290249434 ,  65.23689342403628 ,  55.56476757369614 ,  56.35865079365079 ,  57.15253401360544 ,  57.9464172335601  ,  49.20728458049886 ,  49.892664399092965,  50.57804421768707 ,  51.26342403628118 ,  42.4157879818594  ,  42.992664399092966,  43.56954081632652 ,  44.146417233560086,  46.08311224489796 ,  46.768492063492054,  47.45387188208617 ,  48.13925170068027 ,  56.1603231292517  ,  56.974614512471646,  57.788905895691606,  58.60319727891156 ,  66.75318027210885 ,  67.69638321995464 ,  68.63958616780045 ,  69.58278911564626 ,  79.71310090702949 ,  80.80670068027213 ,  81.90030045351473 ,  82.99390022675738 ,  81.96131519274377 ,  83.00979591836736 ,  84.05827664399091 ,  85.1067573696145  ,  91.26357709750566 ,  92.3571768707483  ,  93.45077664399092 ,  94.54437641723356 ,  80.71000566893422 ,  81.65320861678005 ,  82.59641156462584 ,  83.53961451247167 ,  71.14844104308389 ,  71.96273242630386 ,  72.7770238095238  ,  73.59131519274376 ,  61.07123015873015 ,  61.75660997732425 ,  62.44198979591836 ,  63.127369614512475,  66.27188775510204 ,  67.06577097505668 ,  67.85965419501134 ,  68.65353741496598 ,  80.36950680272109 ,  81.31270975056688 ,  82.2559126984127  ,  83.19911564625849 ,  95.06440476190477 ,  96.15692743764171 ,  97.24945011337869 ,  98.34197278911564 , 112.90527777777778 , 114.1720068027211  , 115.4387358276644  , 116.7054648526077  , 114.66063492063493 , 115.87510204081633 , 117.08956916099771 , 118.30403628117912 , 126.2843253968254  , 127.5510544217687  , 128.817783446712   , 130.08451247165533 , 111.23075396825395 , 112.32327664399092 , 113.41579931972788 , 114.50832199546487 ,  97.73041383219955 ,  98.67361678004535 ,  99.61681972789114 , 100.56002267573696 ,  83.6327947845805  ,  84.42667800453512 ,  85.22056122448978 ,  86.01444444444444 ,  94.38260204081632 ,  95.30307256235827 ,  96.22354308390024 ,  97.14401360544217 , 114.02784013605442 , 115.12143990929704 , 116.2150396825397  , 117.3086394557823  , 134.36559523809524 , 135.63232426303853 , 136.89905328798187 , 138.16578231292516 , 158.90091269841272 , 160.36962585034016 , 161.83833900226756 , 163.30705215419502 , 159.78126984126985 , 161.18938775510205 , 162.5975056689342  , 164.00562358276642 , 174.41329365079366 , 175.88200680272107 , 177.35071995464853 , 178.81943310657596 , 153.1097222222222  , 154.3764512471655  , 155.64318027210885 , 156.90990929705214 , 134.15700113378685 , 135.25060090702948 , 136.3442006802721  , 137.43780045351474 , 114.51176303854875 , 115.43223356009068 , 116.35270408163264 , 117.27317460317458 , 132.4322448979592  , 133.31473922902495 , 134.1972335600907  , 135.07972789115644 , 159.15605442176872 , 160.20453514739228 , 161.25301587301584 , 162.30149659863943 , 186.54380952380956 , 187.75827664399088 , 188.97274376417235 , 190.18721088435373 , 219.27079365079368 , 220.67891156462582 , 222.08702947845805 , 223.49514739229028 , 217.35365079365081 , 218.70367346938772 , 220.0536961451247  , 221.40371882086168 , 234.1431746031746  , 235.55129251700677 , 236.959410430839   , 238.36752834467117 , 204.51460317460317 , 205.72907029478458 , 206.943537414966   , 208.15800453514734 , 178.45473922902494 , 179.50321995464853 , 180.5517006802721  , 181.60018140589565 , 151.73092970521543 , 152.61342403628117 , 153.49591836734692 , 154.3784126984127  , 181.87974489795917 , 182.8002154195011  , 183.7206859410431  , 184.64115646258503 , 217.98212585034014 , 219.0757256235827  , 220.1693253968254  , 221.26292517006803 , 254.77702380952383 , 256.04375283446706 , 257.31048185941046 , 258.57721088435375 , 298.51234126984133 , 299.98105442176865 , 301.44976757369614 , 302.9184807256236  , 293.63269841269846 , 295.0408163265305  , 296.44893424036275 , 297.857052154195   , 314.0247222222223  , 315.49343537414956 , 316.96214852607704 , 318.43086167800453 , 273.5211507936508  , 274.7878798185941  , 276.05460884353744 , 277.32133786848067 , 238.11128684807255 , 239.20488662131524 , 240.2984863945578  , 241.39208616780044 , 202.00890589569156 , 202.92937641723358 , 203.8498469387755  , 204.77031746031744 , 171.99760204081633 , 172.79148526077094 , 173.58536848072566 , 174.37925170068027 , 205.98093537414968 , 206.92413832199546 , 207.8673412698413  , 208.81054421768707 , 240.56154761904762 , 241.65407029478453 , 242.74659297052153 , 243.83911564625848 , 281.60242063492063 , 282.8691496598638  , 284.13587868480727 , 285.4026077097506  , 276.3977777777778  , 277.6122448979591  , 278.8267120181406  , 280.041179138322   , 294.9814682539683  , 296.2481972789115  , 297.5149263038549  , 298.78165532879814 , 256.7278968253968  , 257.82041950113376 , 258.91294217687073 , 260.0054648526077  , 223.34184240362808 , 224.28504535147394 , 225.22824829931972 , 226.1714512471655  , 189.35850907029476 , 190.15239229024945 , 190.94627551020406 , 191.7401587301587  , 159.62107142857144 , 160.3064512471655  , 160.99183106575964 , 161.67721088435374 , 191.0533843537415  , 191.8676757369614  , 192.6819671201814  , 193.49625850340138 , 223.00134353741495 , 223.94454648526076 , 224.8877494331066  , 225.83095238095234 , 260.8755498866213  , 261.96914965986394 , 263.0627494331066  , 264.1563492063492  , 255.64947845804986 , 256.6979591836735  , 257.74643990929707 , 258.7949206349206  , 272.4260260770975  , 273.51962585034016 , 274.6132256235828  , 275.70682539682537 , 236.95816893424032 , 237.90137188208618 , 238.844574829932   , 239.78777777777776 , 206.04150226757363 , 206.85579365079366 , 207.6700850340136  , 208.48437641723353 , 174.6091893424036  , 175.29456916099772 , 175.97994897959182 , 176.66532879818595 , 143.33841836734695 , 143.91529478458048 , 144.49217120181407 , 145.0690476190476  , 171.4850170068027  , 172.17039682539675 , 172.85577664399096 , 173.54115646258506 , 200.06562925170067 , 200.85951247165528 , 201.65339569161003 , 202.44727891156464 , 233.91602607709748 , 234.83649659863943 , 235.75696712018146 , 236.67743764172334 , 228.92566893424032 , 229.80816326530606 , 230.69065759637192 , 231.57315192743764 , 243.63793083900222 , 244.5584013605442  , 245.4788718820862  , 246.3993424036281  , 211.8129308390022  , 212.6068140589569  , 213.4006972789116  , 214.1945804988662  , 184.10034580498862 , 184.78572562358278 , 185.47110544217685 , 186.15648526077098 , 155.9537471655329  , 156.53062358276642 , 157.1075           , 157.68437641723358 };
  const std::array<int, 4> in_shape = {{ 1, 9, 9, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.40816326530612246 , 0.18367346938775508 , 0.2040816326530612  , 0.22448979591836732 , 0.24489795918367346 , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.7959183673469388  , 0.857142857142857   , 0.9183673469387754  , 0.9795918367346939  , 1.8367346938775508  , 1.9591836734693873  , 2.081632653061224   , 2.204081632653061   , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.693877551020408   , 1.2857142857142856  , 1.346938775510204   , 1.4081632653061222  , 1.4693877551020407  , 0.7959183673469388  , 0.857142857142857   , 0.9183673469387754  , 0.9795918367346939  , 1.8367346938775508  , 1.9591836734693873  , 2.081632653061224   , 2.204081632653061   , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.693877551020408   , 1.2857142857142856  , 1.346938775510204   , 1.4081632653061222  , 1.4693877551020407  , 0.7959183673469388  , 0.857142857142857   , 0.9183673469387754  , 0.9795918367346939  , 1.8367346938775508  , 1.9591836734693873  , 2.081632653061224   , 2.204081632653061   , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.693877551020408   , 1.2857142857142856  , 1.346938775510204   , 1.4081632653061222  , 1.4693877551020407  , 0.7959183673469388  , 0.857142857142857   , 0.9183673469387754  , 0.9795918367346939  , 1.8367346938775508  , 1.9591836734693873  , 2.081632653061224   , 2.204081632653061   , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.693877551020408   , 1.2857142857142856  , 1.346938775510204   , 1.4081632653061222  , 1.4693877551020407  , 0.7959183673469388  , 0.857142857142857   , 0.9183673469387754  , 0.9795918367346939  , 1.8367346938775508  , 1.9591836734693873  , 2.081632653061224   , 2.204081632653061   , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.693877551020408   , 1.2857142857142856  , 1.346938775510204   , 1.4081632653061222  , 1.4693877551020407  , 0.7755102040816326  , 0.8163265306122448  , 0.857142857142857   , 0.8979591836734693  , 1.7142857142857144  , 1.7959183673469385  , 1.8775510204081631  , 1.9591836734693877  , 2.816326530612245   , 2.9387755102040813  , 3.0612244897959178  , 3.183673469387755   , 2.816326530612245   , 2.9387755102040813  , 3.0612244897959178  , 3.183673469387755   , 2.816326530612245   , 2.9387755102040813  , 3.0612244897959178  , 3.183673469387755   , 2.816326530612245   , 2.9387755102040813  , 3.0612244897959178  , 3.183673469387755   , 2.816326530612245   , 2.9387755102040813  , 3.0612244897959178  , 3.183673469387755   , 2.0408163265306123  , 2.1224489795918364  , 2.204081632653061   , 2.2857142857142856  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 0.5102040816326531  , 0.5306122448979591  , 0.5510204081632653  , 0.5714285714285714  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 0.673469387755102   , 0.6938775510204082  , 0.7142857142857142  , 0.7346938775510203  };
  const std::array<int, 4> in_shape = {{ 1, 9, 9, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 8.613361678004535, 10.5300283446712  , 12.555198412698413, 14.688871882086168, 14.710102040816327, 15.773435374149658, 18.094070294784576, 16.285907029478455, 14.36924036281179 , 12.344070294784583, 13.199416099773241, 16.034450113378682, 18.998395691609975, 22.091252834467117, 21.791054421768706, 23.054387755102034, 26.136927437641713, 23.430804988662125, 20.595770975056684, 17.6318253968254  , 18.87050453514739 , 22.82798752834467 , 26.93479024943311 , 31.1909126984127  , 30.450238095238095, 31.913571428571423, 35.877063492063485, 32.068900226757364, 28.111417233560083, 24.004614512471655, 26.75264739229025 , 32.25774943310658 , 37.93598072562358 , 43.78734126984127 , 42.39388888888889 , 44.09055555555555 , 49.220714285714266, 43.88874149659863 , 38.3836394557823  , 32.705408163265304, 37.29990929705215 , 44.7692970521542  , 52.404671201814054, 60.20603174603175 , 57.59174603174603 , 59.21841269841269 , 65.4152380952381  , 58.11183673469387 , 50.64244897959183 , 43.00707482993198 , 51.05740929705215 , 61.13393990929706 , 71.38359977324264 , 81.80638888888889 , 77.74626984126985 , 79.44293650793652 , 87.23976190476192 , 77.33636054421768 , 67.25982993197279 , 57.01017006802721 , 48.238758503401364, 57.72005102040817 , 67.35066326530612 , 77.13059523809525 , 73.16769841269843 , 74.63103174603175 , 81.81674603174604 , 72.48477324263038 , 63.00348072562359 , 53.37286848072563 , 44.7377380952381  , 53.504744897959185, 62.40066326530612 , 71.42549319727893 , 67.66497732426305 , 68.92831065759638 , 75.47116780045353 , 66.83307256235827 , 58.06606575963718 , 49.17014739229025 , 40.151683673469385, 48.000323129251704, 55.95746598639456 , 64.02311224489797 , 60.58402494331066 , 61.647358276643985, 67.42831065759637 , 59.688174603174595, 51.83953514739229 , 43.882392290249435};
  const std::array<int, 4> in_shape = {{ 1, 9, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.18367346938775508 , 0.14285714285714285 , 0.08163265306122448 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.2857142857142857  , 0.6122448979591836  , 0.9795918367346939  , 1.3877551020408163  , 1.3877551020408163  , 1.3877551020408163  , 1.3877551020408163  , 1.1020408163265305  , 0.7755102040816326  , 0.40816326530612246 , 0.18367346938775508 , 0.3877551020408163  , 0.6122448979591837  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 };
  const std::array<int, 4> in_shape = {{ 1, 9, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 16.64984693877551 ,  17.22672335600907 ,  20.374676870748296,  21.0600566893424  ,  24.31651360544218 ,  25.110396825396826,  28.475357142857142,  29.377743764172337,  28.581111111111106,  29.420204081632654,  30.707777777777775,  31.546870748299316,  35.285753968253964,  36.18814058956915 ,  31.77793083900226 ,  32.57181405895691 ,  28.053100907029474,  28.73848072562358 ,  24.111264172335602,  24.688140589569166,  25.713452380952383,  26.398832199546483,  31.25460884353741 ,  32.068900226757364,  37.053588435374145,  37.99679138321995 ,  43.11039115646258 ,  44.18250566893423 ,  42.58519274376416 ,  43.58210884353741 ,  45.11185941043083 ,  46.10877551020407 ,  51.20174036281178 ,  52.273854875283426,  45.918407029478445,  46.86160997732425 ,  40.377250566893416,  41.19154195011337 ,  34.57827097505669 ,  35.2636507936508  ,  36.947125850340136,  37.74100907029478 ,  44.71277210884353 ,  45.65597505668934 ,  52.77705782312924 ,  53.86958049886622 ,  61.13998299319727 ,  62.3818253968254  ,  59.745736961451236,  60.90047619047619 ,  62.672403628117905,  63.827142857142846,  70.51228458049886 ,  71.75412698412697 ,  63.04527777777776 ,  64.13780045351473 ,  55.27963151927437 ,  56.222834467120165,  47.215345804988665,  48.00922902494331 ,  52.58482426303855 ,  53.5052947845805  ,  63.42189909297051 ,  64.51549886621316 ,  74.60523242630384 ,  75.87196145124716 ,  86.13482426303854 ,  87.57468253968254 ,  83.44891156462585 ,  84.78777777777778 ,  86.84224489795918 ,  88.1811111111111  ,  97.00157029478457 ,  98.44142857142853 ,  86.51075396825397 ,  87.77748299319725 ,  75.67367913832199 ,  76.7672789115646  ,  64.49034580498866 ,  65.41081632653061 ,  73.71732426303855 ,  74.5998185941043  ,  88.4901133786848  ,  89.5385941043084  , 103.59487528344668 , 104.80934240362811 , 119.03160997732424 , 120.4120634920635  , 113.89986394557822 , 115.18349206349205 , 117.15319727891155 , 118.43682539682538 , 129.45002267573693 , 130.8304761904762  , 115.00920634920634 , 116.22367346938773 , 100.23641723356009 , 101.28489795918367 ,  85.13165532879819 ,  86.01414965986396 , 101.19434807256235 , 102.1148185941043  , 121.17428004535147 , 122.26787981859412 , 141.50047052154196 , 142.76719954648527 , 162.17291950113375 , 163.61277777777778 , 154.15367346938774 , 155.4925396825397  , 157.54700680272106 , 158.88587301587305 , 173.03966553287978 , 174.47952380952384 , 153.40599206349205 , 154.67272108843537 , 133.42606009070295 , 134.51965986394558 , 113.09986961451249 , 114.02034013605441 ,  95.68363378684808 ,  96.47751700680273 , 114.49689909297052 , 115.44010204081634 , 133.60880385487528 , 134.70132653061225 , 153.01934807256234 , 154.2611904761905  , 145.18065759637187 , 146.33539682539686 , 148.10732426303852 , 149.2620634920635  , 162.39164965986393 , 163.63349206349207 , 143.87702380952382 , 144.96954648526076 , 125.06375850340137 , 126.00696145124718 , 105.95185374149659 , 106.74573696145126 ,  88.79009637188209 ,  89.4754761904762  , 106.1951984126984  , 107.00948979591837 , 123.85812358276644 , 124.80132653061224 , 141.77887188208615 , 142.85098639455785 , 134.33303854875282 , 135.3299546485261  , 136.8597052154195  , 137.85662131519277 , 149.87022108843536 , 150.94233560090706 , 132.72294217687076 , 133.66614512471654 , 115.31784013605443 , 116.13213151927437 ,  97.65491496598639 ,  98.3402947845805  ,  79.72649092970521 ,  80.30336734693877 ,  95.31526643990931 ,  96.00064625850341 , 111.12104875283448 , 111.91493197278912 , 127.14383786848073 , 128.04622448979595 , 120.3289569160998  , 121.16804988662132 , 122.45562358276645 , 123.29471655328797 , 133.95423469387757 , 134.85662131519274 , 118.58246598639457 , 119.37634920634919 , 102.99369047619048 , 103.67907029478458 ,  87.1879081632653  ,  87.76478458049887 };
  const std::array<int, 4> in_shape = {{ 1, 9, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.30612244897959184, 0.36734693877551017, 0.24489795918367346, 0.2857142857142857 , 0.14285714285714285, 0.16326530612244897, 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.5510204081632653 , 0.6122448979591836 , 1.2244897959183674 , 1.346938775510204  , 2.020408163265306  , 2.204081632653061  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.387755102040816  , 2.5714285714285716 , 1.714285714285714  , 1.8367346938775508 , 0.9183673469387754 , 0.9795918367346939 , 0.5510204081632653 , 0.6122448979591836 , 1.2244897959183674 , 1.346938775510204  , 2.020408163265306  , 2.204081632653061  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.387755102040816  , 2.5714285714285716 , 1.714285714285714  , 1.8367346938775508 , 0.9183673469387754 , 0.9795918367346939 , 0.5510204081632653 , 0.6122448979591836 , 1.2244897959183674 , 1.346938775510204  , 2.020408163265306  , 2.204081632653061  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.387755102040816  , 2.5714285714285716 , 1.714285714285714  , 1.8367346938775508 , 0.9183673469387754 , 0.9795918367346939 , 0.5510204081632653 , 0.6122448979591836 , 1.2244897959183674 , 1.346938775510204  , 2.020408163265306  , 2.204081632653061  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.387755102040816  , 2.5714285714285716 , 1.714285714285714  , 1.8367346938775508 , 0.9183673469387754 , 0.9795918367346939 , 0.5510204081632653 , 0.6122448979591836 , 1.2244897959183674 , 1.346938775510204  , 2.020408163265306  , 2.204081632653061  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.387755102040816  , 2.5714285714285716 , 1.714285714285714  , 1.8367346938775508 , 0.9183673469387754 , 0.9795918367346939 , 0.5306122448979591 , 0.5714285714285714 , 1.1428571428571428 , 1.2244897959183672 , 1.8367346938775508 , 1.9591836734693877 , 2.612244897959183  , 2.7755102040816326 , 2.612244897959183  , 2.7755102040816326 , 2.612244897959183  , 2.7755102040816326 , 2.612244897959183  , 2.7755102040816326 , 2.0816326530612246 , 2.204081632653061  , 1.4693877551020407 , 1.5510204081632653 , 0.7755102040816326 , 0.8163265306122449 , 0.3469387755102041 , 0.36734693877551017, 0.7346938775510203 , 0.7755102040816326 , 1.163265306122449  , 1.2244897959183674 , 1.6326530612244898 , 1.7142857142857144 , 1.6326530612244898 , 1.7142857142857144 , 1.6326530612244898 , 1.7142857142857144 , 1.6326530612244898 , 1.7142857142857144 , 1.2857142857142856 , 1.3469387755102038 , 0.8979591836734693 , 0.9387755102040816 , 0.4693877551020408 , 0.4897959183673469 };
  const std::array<int, 4> in_shape = {{ 1, 9, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 32.72281746031746 ,  33.29969387755102 ,  33.876570294784585,  34.45344671201814 ,  40.06397392290249 ,  40.74935374149659 ,  41.434733560090706,  42.1201133786848  ,  47.8391439909297  ,  48.63302721088436 ,  49.426910430838994,  50.22079365079365 ,  56.04832766439909 ,  56.950714285714284,  57.853100907029464,  58.75548752834467 ,  56.32312925170068 ,  57.16222222222221 ,  58.00131519274377 ,  58.84040816326531 ,  60.576462585034015,  61.41555555555555 ,  62.254648526077105,  63.09374149659863 ,  69.66912131519274 ,  70.57150793650793 ,  71.47389455782313 ,  72.3762811791383  ,  62.76197845804988 ,  63.55586167800452 ,  64.34974489795918 ,  65.14362811791382 ,  55.42082199546485 ,  56.10620181405895 ,  56.79158163265306 ,  57.47696145124716 ,  47.64565192743764 ,  48.222528344671204,  48.79940476190476 ,  49.37628117913833 ,  50.74152494331066 ,  51.426904761904765,  52.112284580498866,  52.797664399092966,  61.69492630385488 ,  62.50921768707482 ,  63.32350907029478 ,  64.13780045351473 ,  73.16397392290249 ,  74.10717687074829 ,  75.0503798185941  ,  75.9935827664399  ,  85.1486678004535  ,  86.22078231292517 ,  87.2928968253968  ,  88.36501133786847 ,  84.17346938775509 ,  85.17038548752832 ,  86.1673015873016  ,  87.16421768707482 ,  89.22680272108843 ,  90.22371882086166 ,  91.22063492063492 ,  92.21755102040814 , 101.33136621315192 , 102.40348072562357 , 103.47559523809524 , 104.54770975056685 ,  90.89361111111111 ,  91.83681405895689 ,  92.78001700680272 ,  93.7232199546485  ,  79.94020975056691 ,  80.75450113378683 ,  81.56879251700681 ,  82.38308390022674 ,  68.47116213151928 ,  69.15654195011338 ,  69.84192176870748 ,  70.5273015873016  ,  73.10036848072562 ,  73.89425170068027 ,  74.68813492063491 ,  75.48201814058956 ,  88.48234126984129 ,  89.42554421768706 ,  90.36874716553288 ,  91.31195011337869 , 104.46159297052155 , 105.55411564625848 , 106.64663832199544 , 107.73916099773244 , 121.03812358276642 , 122.27996598639454 , 123.52180839002263 , 124.7636507936508  , 118.33673469387755 , 119.49147392290247 , 120.64621315192743 , 121.80095238095238 , 124.19006802721088 , 125.34480725623581 , 126.49954648526077 , 127.65428571428569 , 139.7827267573696  , 141.02456916099771 , 142.26641156462583 , 143.50825396825394 , 124.99803287981858 , 126.09055555555553 , 127.18307823129251 , 128.27560090702946 , 109.61606009070294 , 110.55926303854874 , 111.50246598639455 , 112.44566893424033 ,  93.63680839002267 ,  94.43069160997733 ,  95.22457482993195 ,  96.01845804988662 , 104.24917800453515 , 105.1696485260771  , 106.09011904761904 , 107.010589569161   , 125.75019841269844 , 126.84379818594103 , 127.93739795918367 , 129.03099773242633 , 147.94373582766443 , 149.21046485260769 , 150.477193877551   , 151.74392290249432 , 170.82979024943305 , 172.26964852607708 , 173.70950680272102 , 175.14936507936508 , 165.55895691609976 , 166.8978231292517  , 168.23668934240362 , 169.57555555555555 , 172.34562358276642 , 173.68448979591835 , 175.02335600907028 , 176.3622222222222  , 192.56328231292514 , 194.00314058956914 , 195.44299886621312 , 196.88285714285706 , 171.75477891156459 , 173.02150793650793 , 174.28823696145122 , 175.5549659863945  , 150.25375850340134 , 151.34735827664397 , 152.4409580498866  , 153.5345578231292  , 128.06022108843536 , 128.98069160997733 , 129.90116213151924 , 130.82163265306122 , 146.55215419501133 , 147.4346485260771  , 148.31714285714284 , 149.1996371882086  , 175.93174603174606 , 176.9802267573696  , 178.02870748299316 , 179.0771882086168  , 205.97528344671204 , 207.18975056689337 , 208.40421768707478 , 209.61868480725622 , 236.6827664399093  , 238.06321995464847 , 239.4436734693877  , 240.824126984127   , 226.51609977324264 , 227.79972789115644 , 229.08335600907026 , 230.3669841269841  , 233.02276643990933 , 234.3063945578231  , 235.59002267573692 , 236.87365079365077 , 257.5195918367347  , 258.90004535147386 , 260.2804988662131  , 261.6609523809524  , 228.8039455782313  , 230.01841269841267 , 231.23287981859409 , 232.44734693877547 , 199.4243537414966  , 200.47283446712018 , 201.5213151927437  , 202.56979591836733 , 169.3808163265306  , 170.26331065759638 , 171.1458049886621  , 172.02829931972792 , 201.46822562358278 , 202.3886961451247  , 203.30916666666664 , 204.2296371882086  , 241.25496031746036 , 242.34856009070293 , 243.44215986394553 , 244.53575963718825 , 281.7342120181406  , 283.0009410430839  , 284.26767006802714 , 285.53439909297055 , 322.9059807256236  , 324.3458390022675  , 325.7856972789116  , 327.22555555555556 , 306.96848072562364 , 308.3073469387755  , 309.6462131519274  , 310.9850793650794  , 313.75514739229027 , 315.0940136054421  , 316.4328798185941  , 317.7717460317461  , 344.63947278911564 , 346.07933106575956 , 347.5191893424036  , 348.9590476190477  , 305.54525510204076 , 306.8119841269841  , 308.07871315192745 , 309.34544217687073 , 265.75852040816324 , 266.8521201814059  , 267.94571995464844 , 269.03931972789115 , 225.279268707483   , 226.19973922902497 , 227.12020975056686 , 228.04068027210883 , 190.5733843537415  , 191.36726757369615 , 192.1611507936508  , 192.95503401360546 , 228.05059523809524 , 228.99379818594105 , 229.9370011337868  , 230.88020408163268 , 266.1250850340136  , 267.21760770975055 , 268.31013038548747 , 269.4026530612245  , 304.7968537414966  , 306.0386961451247  , 307.2805385487528  , 308.522380952381   , 289.2065759637188  , 290.36131519274375 , 291.51605442176873 , 292.6707936507937  , 295.0599092970521  , 296.21464852607704 , 297.36938775510197 , 298.524126984127   , 323.5414569160997  , 324.78329931972786 , 326.02514172335594 , 327.26698412698414 , 286.6615249433106  , 287.75404761904764 , 288.84657029478456 , 289.93909297052153 , 249.1843140589569  , 250.12751700680275 , 251.0707199546485  , 252.01392290249436 , 211.10982426303852 , 211.90370748299318 , 212.69759070294782 , 213.49147392290251 , 176.89481292517007 , 177.58019274376417 , 178.26557256235827 , 178.9509523809524  , 211.57610544217687 , 212.3903968253968  , 213.20468820861677 , 214.01897959183674 , 246.77304421768704 , 247.71624716553288 , 248.65945011337865 , 249.6026530612245  , 282.4856292517007  , 283.5577437641723  , 284.629858276644   , 285.7019727891157  , 267.66916099773243 , 268.66607709750565 , 269.66299319727887 , 270.6599092970522  , 272.7224943310657  , 273.719410430839   , 274.71632653061226 , 275.71324263038554 , 298.6683276643991  , 299.7404421768707  , 300.8125566893424  , 301.8846712018141  , 264.5026814058957  , 265.4458843537415  , 266.3890873015873  , 267.3322902494331  , 229.82138888888886 , 230.63568027210886 , 231.44997165532877 , 232.26426303854873 , 194.62445011337869 , 195.30982993197279 , 195.99520975056686 , 196.680589569161   , 158.87610544217688 , 159.45298185941041 , 160.029858276644   , 160.60673469387754 , 189.94515306122446 , 190.63053287981862 , 191.3159126984127  , 192.00129251700682 , 221.44821428571424 , 222.24209750566897 , 223.03598072562357 , 223.82986394557824 , 253.38528911564626 , 254.28767573696146 , 255.19006235827663 , 256.0924489795919  , 239.81882086167798 , 240.6579138321996  , 241.49700680272107 , 242.33609977324264 , 244.0721541950113  , 244.9112471655329  , 245.7503401360544  , 246.58943310657594 , 267.0060827664399  , 267.90846938775513 , 268.8108560090703  , 269.7132426303855  , 236.37104875283444 , 237.16493197278913 , 237.95881519274374 , 238.75269841269838 , 205.30200113378683 , 205.98738095238096 , 206.67276077097503 , 207.35814058956916 , 173.79893990929705 , 174.3758163265306  , 174.95269274376415 , 175.52956916099774 };
  const std::array<int, 4> in_shape = {{ 1, 9, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5510204081632653  , 0.6122448979591837  , 0.6734693877551019  , 0.7346938775510203  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.3061224489795918  , 0.32653061224489793 , 0.3673469387755102  , 0.4081632653061224  , 0.4489795918367347  , 0.48979591836734687 , 0.8979591836734693  , 0.9795918367346937  , 1.0612244897959182  , 1.1428571428571428  , 1.5918367346938775  , 1.7142857142857142  , 1.8367346938775508  , 1.9591836734693875  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.0816326530612246  , 2.204081632653061   , 2.326530612244898   , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244894  , 1.714285714285714   , 1.7959183673469385  , 0.8571428571428571  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.0408163265306123  , 1.1020408163265305  , 1.163265306122449   , 1.2244897959183672  , 2.3265306122448974  , 2.4489795918367347  , 2.571428571428571   , 2.693877551020408   , 3.8571428571428568  , 4.040816326530612   , 4.224489795918367   , 4.408163265306122   , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.591836734693877   , 4.775510204081632   , 4.959183673469387   , 5.142857142857143   , 3.3061224489795915  , 3.428571428571428   , 3.551020408163265   , 3.6734693877551017  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.0408163265306123  , 1.1020408163265305  , 1.163265306122449   , 1.2244897959183672  , 2.3265306122448974  , 2.4489795918367347  , 2.571428571428571   , 2.693877551020408   , 3.8571428571428568  , 4.040816326530612   , 4.224489795918367   , 4.408163265306122   , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.591836734693877   , 4.775510204081632   , 4.959183673469387   , 5.142857142857143   , 3.3061224489795915  , 3.428571428571428   , 3.551020408163265   , 3.6734693877551017  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.0408163265306123  , 1.1020408163265305  , 1.163265306122449   , 1.2244897959183672  , 2.3265306122448974  , 2.4489795918367347  , 2.571428571428571   , 2.693877551020408   , 3.8571428571428568  , 4.040816326530612   , 4.224489795918367   , 4.408163265306122   , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.591836734693877   , 4.775510204081632   , 4.959183673469387   , 5.142857142857143   , 3.3061224489795915  , 3.428571428571428   , 3.551020408163265   , 3.6734693877551017  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.0408163265306123  , 1.1020408163265305  , 1.163265306122449   , 1.2244897959183672  , 2.3265306122448974  , 2.4489795918367347  , 2.571428571428571   , 2.693877551020408   , 3.8571428571428568  , 4.040816326530612   , 4.224489795918367   , 4.408163265306122   , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.591836734693877   , 4.775510204081632   , 4.959183673469387   , 5.142857142857143   , 3.3061224489795915  , 3.428571428571428   , 3.551020408163265   , 3.6734693877551017  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.0408163265306123  , 1.1020408163265305  , 1.163265306122449   , 1.2244897959183672  , 2.3265306122448974  , 2.4489795918367347  , 2.571428571428571   , 2.693877551020408   , 3.8571428571428568  , 4.040816326530612   , 4.224489795918367   , 4.408163265306122   , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.591836734693877   , 4.775510204081632   , 4.959183673469387   , 5.142857142857143   , 3.3061224489795915  , 3.428571428571428   , 3.551020408163265   , 3.6734693877551017  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 2.204081632653061   , 2.2857142857142856  , 2.3673469387755097  , 2.4489795918367343  , 3.5510204081632653  , 3.6734693877551017  , 3.795918367346938   , 3.9183673469387754  , 5.061224489795918   , 5.224489795918366   , 5.387755102040815   , 5.551020408163265   , 5.061224489795918   , 5.224489795918366   , 5.387755102040815   , 5.551020408163265   , 5.061224489795918   , 5.224489795918366   , 5.387755102040815   , 5.551020408163265   , 5.061224489795918   , 5.224489795918366   , 5.387755102040815   , 5.551020408163265   , 4.040816326530612   , 4.163265306122449   , 4.285714285714285   , 4.408163265306122   , 2.8571428571428568  , 2.9387755102040813  , 3.020408163265306   , 3.1020408163265305  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244898  , 0.673469387755102   , 0.6938775510204082  , 0.7142857142857142  , 0.7346938775510203  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 2.265306122448979   , 2.326530612244898   , 2.387755102040816   , 2.4489795918367347  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 0.9183673469387754  , 0.9387755102040816  , 0.9591836734693877  , 0.9795918367346939  };
  const std::array<int, 4> in_shape = {{ 1, 9, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 7.15218253968254 ,  8.794019274376419, 10.836082766439908, 13.43846371882086 , 14.767630385487529, 12.924773242630383, 11.262471655328797,  9.729138321995464, 10.870209750566895, 13.2671485260771  , 16.213973922902493, 19.93064058956916 , 21.509807256235824, 18.69552154195011 , 16.19988662131519 , 13.931859410430839, 15.456264172335601, 18.77157029478458 , 22.813633786848072, 27.873157596371875, 29.70232426303854 , 25.68803854875283 , 22.168594104308387, 19.002607709750567, 20.910345804988662, 25.307284580498866, 30.63506235827664 , 37.266014739229014, 39.34518140589568 , 33.902324263038544, 29.168594104308387, 24.94138321995465 , 27.855782312925168, 33.5265306122449  , 40.32653061224489 , 48.70748299319727 , 50.6408163265306  , 43.364625850340126, 37.117006802721086, 31.604081632653063, 36.36244897959183 , 43.63319727891156 , 52.299863945578224, 62.9208163265306  , 64.85414965986392 , 55.33795918367347 , 47.223673469387755, 40.11074829931973 , 48.15193310657597 , 57.672681405895695, 68.97823696145124 , 82.78252267573696 , 84.86168934240362 , 72.24549886621315 , 61.53399092970521 , 52.182970521541954, 45.301933106575966, 54.230844671201815, 64.82211451247166 , 77.74068594104308 , 79.56985260770976 , 67.69651927437643 , 57.627868480725624, 48.84827664399093 , 41.583905895691615, 49.75771541950113 , 59.44422335600907 , 71.24850907029479 , 72.82767573696145 , 61.92577097505669 , 52.69045351473923 , 44.64555555555556 , 36.9978514739229  , 44.25329365079365 , 52.8445634920635  , 63.30599206349206 , 64.63515873015874 , 54.93325396825397 , 46.72174603174604 , 39.57480725623583 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.04081632653061224 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.30612244897959184 , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.36734693877551017 , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.14285714285714285 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.16326530612244897 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 13.72748866213152 ,  14.30436507936508 ,  16.90265873015873 ,  17.588038548752838,  20.860198412698413,  21.672165532879816,  25.91305555555556 ,  26.87692743764172 ,  28.571388888888887,  29.535260770975057,  25.037579365079367,  25.849546485260767,  21.839563492063494,  22.524943310657594,  18.88140022675737 ,  19.458276643990928,  21.055039682539682,  21.74041950113379 ,  25.720005668934242,  26.5342970521542  ,  31.46325963718821 ,  32.42794784580499 ,  38.716116780045354,  39.86128117913832 ,  41.874450113378686,  43.01961451247165 ,  36.426354875283444,  37.39104308390022 ,  31.58548185941043 ,  32.39977324263038 ,  27.17833900226757 ,  27.863718820861678,  30.11864512471655 ,  30.912528344671202,  36.59993764172336 ,  37.54314058956916 ,  44.509858276643996,  45.627267573696145,  54.419858276644   ,  55.74631519274375 ,  58.07819160997733 ,  59.40464852607708 ,  50.258667800453516,  51.37607709750566 ,  43.393985260770975,  44.33718820861677 ,  37.21133219954648 ,  38.005215419501134,  40.91830498866213 ,  41.820691609977324,  49.54245464852608 ,  50.61456916099773 ,  59.999994331065764,  61.27012471655328 ,  73.02428004535149 ,  74.53202947845803 ,  77.1826133786848  ,  78.69036281179136 ,  66.53451814058957 ,  67.80464852607709 ,  57.26507369614513 ,  58.33718820861677 ,  48.98037981859411 ,  49.8827664399093  ,  54.8724716553288  ,  55.711564625850336,  66.05614512471656 ,  67.0530612244898  ,  79.47201814058958 ,  80.65306122448978 ,  96.01297052154196 ,  97.41496598639453 ,  99.87963718820862 , 101.2816326530612  ,  85.54820861678004 ,  86.72925170068025 ,  73.23709750566894 ,  74.23401360544217 ,  62.36907029478458 ,  63.208163265306126,  71.88580498866214 ,  72.72489795918366 ,  86.26947845804989 ,  87.26639455782312 , 103.41868480725623 , 104.59972789115645 , 124.43963718820861 , 125.8416326530612  , 128.30630385487527 , 129.70829931972784 , 109.49487528344675 , 110.67591836734694 ,  93.45043083900227 ,  94.44734693877551 ,  79.3824036281179  ,  80.22149659863946 ,  95.40147959183673 ,  96.30386621315193 , 114.27324829931972 , 115.34536281179139 , 136.68634353741498 , 137.9564739229025  , 164.05729591836737 , 165.5650453514739  , 168.2156292517007  , 169.72337868480724 , 143.22086734693877 , 144.4909977324263  , 121.99586734693874 , 123.06798185941042 , 103.46355442176869 , 104.36594104308391 ,  89.80998299319727 ,  90.60386621315193 , 107.51848639455781 , 108.46168934240363 , 128.52681972789117 , 129.64422902494331 , 154.15491496598642 , 155.48137188208617 , 157.81324829931975 , 159.13970521541953 , 134.27562925170065 , 135.39303854875286 , 114.31253401360541 , 115.25573696145125 ,  96.90267006802718 ,  97.69655328798186 ,  82.48243197278912 ,  83.16781179138323 ,  98.7011394557823  ,  99.51543083900226 , 117.92375850340134 , 118.88844671201814 , 141.35185374149657 , 142.49701814058957 , 144.5101870748299  , 145.6553514739229  , 122.88685374149657 , 123.85154195011339 , 104.56661564625847 , 105.38090702947846 ,  88.60573129251699 ,  89.29111111111112 ,  73.41882653061224 ,  73.9957029478458  ,  87.82120748299317 ,  88.5065873015873  , 104.87715986394555 , 105.689126984127   , 125.64811224489793 , 126.61198412698413 , 128.30644557823126 , 129.27031746031747 , 109.0545408163265  , 109.86650793650794 ,  92.75811224489793 ,  93.44349206349207 ,  78.5727380952381  ,  79.14961451247166 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5510204081632653  , 0.6122448979591837  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 0.6734693877551019  , 0.7346938775510203  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.3061224489795918  , 0.32653061224489793 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  59.44340702947846 ,  60.2372902494331  ,  61.031173469387745,  61.825056689342404,  72.2566723356009  ,  73.19987528344672 ,  74.1430782312925  ,  75.08628117913833 ,  87.9023072562358  ,  89.01971655328799 ,  90.13712585034013 ,  91.25453514739229 , 107.51325963718818 , 108.839716553288   , 110.16617346938774 , 111.4926303854875  , 114.82992630385486 , 116.15638321995466 , 117.48284013605442 , 118.80929705215416 ,  99.39992630385487 , 100.51733560090703 , 101.63474489795917 , 102.75215419501131 ,  85.84476757369615 ,  86.78797052154195 ,  87.73117346938774 ,  88.67437641723355 ,  73.62878117913833 ,  74.42266439909297 ,  75.21654761904762 ,  76.01043083900227 ,  80.93422335600908 ,  81.83660997732426 ,  82.73899659863945 ,  83.64138321995465 ,  98.01279478458049 ,  99.08490929705216 , 100.15702380952379 , 101.22913832199546 , 118.72985827664397 , 119.99998866213153 , 121.27011904761903 , 122.54024943310657 , 144.54081065759635 , 146.04856009070298 , 147.5563095238095  , 149.06405895691606 , 152.85747732426302 , 154.3652267573696  , 155.8729761904762  , 157.38072562358272 , 131.7989058956916  , 133.06903628117914 , 134.33916666666664 , 135.60929705215418 , 113.45803287981859 , 114.53014739229026 , 115.60226190476189 , 116.67437641723355 ,  97.05837301587302 ,  97.96075963718822 ,  98.86314625850339 ,  99.7655328798186  , 108.90585034013606 , 109.7449433106576  , 110.58403628117911 , 111.42312925170067 , 131.11537414965986 , 132.11229024943313 , 133.10920634920632 , 134.1061224489796  , 157.7629931972789  , 158.94403628117917 , 160.1250793650793  , 161.30612244897955 , 190.6239455782313  , 192.02594104308392 , 193.4279365079365  , 194.82993197278907 , 198.3572789115646  , 199.75927437641724 , 201.16126984126984 , 202.5632653061224  , 169.91537414965984 , 171.0964172335601  , 172.2774603174603  , 173.4585034013605  , 145.4772789115646  , 146.47419501133788 , 147.4711111111111  , 148.46802721088434 , 123.89904761904764 , 124.73814058956916 , 125.57723356009069 , 126.41632653061225 , 142.93251700680273 , 143.7716099773243  , 144.61070294784577 , 145.44979591836733 , 171.54204081632656 , 172.53895691609978 , 173.535873015873   , 174.53278911564624 , 205.65632653061223 , 206.83736961451245 , 208.0184126984127  , 209.1994557823129  , 247.4772789115646  , 248.87927437641721 , 250.28126984126982 , 251.6832653061224  , 255.21061224489796 , 256.61260770975053 , 258.01460317460317 , 259.4165986394557  , 217.8087074829932  , 218.9897505668935  , 220.17079365079363 , 221.35183673469388 , 185.9039455782313  , 186.90086167800453 , 187.89777777777778 , 188.89469387755102 , 157.9257142857143  , 158.7648072562358  , 159.60390022675736 , 160.44299319727892 , 189.9005725623583  , 190.80295918367347 , 191.70534580498867 , 192.60773242630387 , 227.47438208616782 , 228.54649659863944 , 229.61861111111114 , 230.69072562358278 , 272.1025566893424  , 273.37268707482997 , 274.6428174603175  , 275.912947845805   , 326.60684240362815 , 328.11459183673475 , 329.6223412698412  , 331.1300907029478  , 334.9235090702948  , 336.4312585034014  , 337.93900793650795 , 339.4467573696145  , 285.17160430839    , 286.44173469387755 , 287.7118650793651  , 288.9819954648526  , 242.91962018140592 , 243.99173469387748 , 245.06384920634923 , 246.13596371882085 , 206.02472222222224 , 206.92710884353738 , 207.8294954648526  , 208.73188208616781 , 178.8260827664399  , 179.61996598639453 , 180.41384920634923 , 181.20773242630386 , 214.09376984126985 , 215.03697278911562 , 215.98017573696146 , 216.92337868480726 , 255.93623015873018 , 257.05363945578233 , 258.1710487528345  , 259.28845804988663 , 306.98337301587304 , 308.30982993197284 , 309.63628684807253 , 310.96274376417233 , 314.3000396825397  , 315.6264965986395  , 316.95295351473925 , 318.27941043083905 , 267.43384920634924 , 268.5512585034013  , 269.66866780045353 , 270.7860770975057  , 227.68186507936508 , 228.62506802721083 , 229.56827097505672 , 230.5114739229025  , 193.01145691609977 , 193.80534013605435 , 194.5992233560091  , 195.3931065759637  , 164.2794841269841  , 164.96486394557823 , 165.6502437641724  , 166.33562358276646 , 196.58798752834466 , 197.4022789115646  , 198.21657029478462 , 199.03086167800453 , 234.88282879818595 , 235.8475170068027  , 236.81220521541954 , 237.77689342403627 , 281.5585430839002  , 282.70370748299314 , 283.8488718820862  , 284.99403628117915 , 287.8752097505669  , 289.0203741496598  , 290.1655385487529  , 291.3107029478458  , 244.80901927437642 , 245.77370748299313 , 246.73839569161004 , 247.70308390022677 , 208.31893990929706 , 209.13323129251694 , 209.947522675737   , 210.76181405895693 , 176.5260827664399  , 177.21146258503398 , 177.89684240362814 , 178.58222222222224 , 146.26077664399094 , 146.83765306122447 , 147.41452947845806 , 147.9914058956916  , 174.95703514739228 , 175.64241496598635 , 176.32779478458053 , 177.0131746031746  , 208.94235260770972 , 209.7543197278911  , 210.56628684807262 , 211.378253968254   , 250.33235260770974 , 251.29622448979586 , 252.26009637188213 , 253.22396825396825 , 255.64901927437643 , 256.6128911564625  , 257.57676303854885 , 258.54063492063494 , 217.29711451247164 , 218.109081632653   , 218.9210487528345  , 219.7330158730159  , 184.83084467120182 , 185.51622448979586 , 186.20160430839002 , 186.88698412698415 , 156.5685997732426  , 157.1454761904762  , 157.72235260770972 , 158.29922902494332 };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.14285714285714285 , 0.16326530612244897 , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 1.0612244897959182  , 1.1428571428571428  , 1.2244897959183674  , 1.3061224489795917  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 1.3877551020408163  , 1.4693877551020407  , 1.5510204081632653  , 1.6326530612244898  , 1.0612244897959182  , 1.1428571428571428  , 1.2244897959183674  , 1.3061224489795917  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 1.3877551020408163  , 1.4693877551020407  , 1.5510204081632653  , 1.6326530612244898  , 1.0612244897959182  , 1.1428571428571428  , 1.2244897959183674  , 1.3061224489795917  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 1.3877551020408163  , 1.4693877551020407  , 1.5510204081632653  , 1.6326530612244898  , 1.0612244897959182  , 1.1428571428571428  , 1.2244897959183674  , 1.3061224489795917  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 2.4489795918367347  , 2.6122448979591835  , 2.7755102040816326  , 2.9387755102040813  , 1.3877551020408163  , 1.4693877551020407  , 1.5510204081632653  , 1.6326530612244898  , 1.0408163265306123  , 1.1020408163265305  , 1.163265306122449   , 1.2244897959183674  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.6938775510204076  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.6938775510204076  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.6938775510204076  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.6938775510204076  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.6938775510204076  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.6938775510204076  , 1.2857142857142856  , 1.3469387755102038  , 1.4081632653061225  , 1.4693877551020407  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.5102040816326531  , 0.5306122448979591  , 0.5510204081632653  , 0.5714285714285714  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 0.5918367346938775  , 0.6122448979591836  , 0.6326530612244897  , 0.6530612244897959  };
  const std::array<int, 4> in_shape = {{ 1, 10, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 7.882772108843537,  9.66202380952381 , 11.549778911564626, 13.87874716553288 , 14.47124716553288 , 16.30922335600907 , 14.486604308390024, 12.815856009070295, 11.036604308390022, 12.034812925170067, 14.65079931972789 , 17.395697278911566, 20.748475056689344, 21.276689342403625, 23.63609410430839 , 20.884903628117918, 18.39782879818594 , 15.781842403628119, 17.163384353741495, 20.799778911564623, 24.58549319727891 , 29.176366213151926, 29.57600907029478 , 32.52112811791383 , 28.627080498866217, 25.14000566893424 , 21.50361111111111 , 23.268486394557826, 28.108962585034014, 33.11916666666667 , 39.16242063492063 , 39.369206349206344, 42.964325396825394, 37.71313492063492 , 33.04238662131519 , 28.201910430839   , 31.100034013605445, 37.38098639455782 , 43.819761904761904, 51.515793650793654, 51.085079365079366, 55.051031746031754, 48.09150793650793 , 41.968378684807256, 35.68742630385487 , 40.670034013605445, 48.75098639455783 , 56.989761904761906, 66.78579365079366 , 65.72507936507937 , 70.32103174603175 , 61.26150793650793 , 53.33837868480725 , 45.25742630385487 , 53.91527210884354 , 64.52003401360544 , 75.29452380952382 , 88.0627777777778  , 86.25206349206353 , 91.86468253968256 , 79.88849206349207 , 69.45345804988662 , 58.84869614512471 , 50.739761904761906, 60.69146258503402 , 70.79248299319728 , 82.75121315192746 , 80.94049886621316 , 86.09597505668935 , 74.83407029478458 , 65.03168934240362 , 55.07998866213151 , 46.58772108843537 , 55.70268707482993 , 64.94656462585034 , 75.88148526077099 , 74.1350566893424  , 78.76910430839003 , 68.43577097505668 , 59.44971655328798 , 50.33475056689341 , 41.45914965986395 , 49.55370748299319 , 57.75676870748299 , 67.45359410430838 , 65.83573696145123 , 69.88407029478456 , 60.69359410430838 , 52.707539682539675, 44.61298185941043 };
  const std::array<int, 4> in_shape = {{ 1, 10, 9, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.10204081632653061 , 0.061224489795918366, 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.4285714285714285  , 0.9183673469387754  , 1.469387755102041   , 1.469387755102041   , 1.469387755102041   , 1.469387755102041   , 1.469387755102041   , 1.0408163265306123  , 0.5510204081632653  , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.2040816326530612  , 0.4285714285714285  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 };
  const std::array<int, 4> in_shape = {{ 1, 10, 9, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 15.188667800453512,  15.765544217687074,  18.63866780045351 ,  19.32404761904762 ,  22.3056746031746  ,  23.099557823129253,  26.837023809523814,  27.75749433106576 ,  28.060000000000002,  28.94249433106576 ,  31.697976190476187,  32.61844671201814 ,  28.179325396825394,  28.97320861678005 ,  24.946332199546482,  25.63171201814059 ,  21.496332199546483,  22.073208616780043,  23.384246031746027,  24.069625850340135,  28.487307256235823,  29.30159863945578 ,  33.84819160997732 ,  34.79139455782313 ,  40.403350340136065,  41.49695011337869 ,  41.50489795918368 ,  42.55337868480725 ,  46.17858843537415 ,  47.27218820861678 ,  40.826604308390024,  41.769807256235836,  35.98136621315193 ,  36.79565759637188 ,  30.878304988662126,  31.563684807256237,  33.53288548752834 ,  34.32676870748299 ,  40.65635487528344 ,  41.599557823129246,  48.078463718820856,  49.17098639455782 ,  57.08600340136055 ,  58.35273242630385 ,  57.937551020408165,  59.15201814058956 ,  63.77552721088435 ,  65.04225623582767 ,  56.16163832199546 ,  57.254160997732434,  49.336808390022675,  50.28001133786848 ,  42.21333900226756 ,  43.00722222222222 ,  45.63458616780045 ,  46.53697278911565 ,  55.145810657596364,  56.21792517006803 ,  64.9964909297052  ,  66.23833333333334 ,  76.8849829931973  ,  78.32484126984126 ,  77.35795918367347 ,  78.73841269841269 ,  84.4887925170068  ,  85.92865079365079 ,  74.18442743764172 ,  75.42626984126984 ,  65.01265873015872 ,  66.08477324263038 ,  55.5014342403628  ,  56.403820861678   ,  61.36097505668933 ,  62.20006802721089 ,  73.76505668934239 ,  74.76197278911565 ,  86.48478458049885 ,  87.63952380952381 , 101.69272108843538 , 103.03158730158731 , 100.8865306122449  , 102.17015873015873 , 108.76319727891155 , 110.10206349206351 ,  95.02827664399092 ,  96.18301587301586 ,  82.93984126984125 ,  83.93675736961451 ,  70.53575963718819 ,  71.37485260770974 ,  80.50097505668933 ,  81.34006802721089 ,  96.50505668934238 ,  97.50197278911565 , 112.82478458049884 , 113.97952380952381 , 132.23272108843534 , 133.57158730158733 , 130.16653061224488 , 131.45015873015873 , 139.30319727891157 , 140.6420634920635  , 121.36827664399091 , 122.52301587301586 , 105.67984126984125 , 106.6767573696145  ,  89.6757596371882  ,  90.51485260770974 , 106.92815759637188 , 107.83054421768708 , 127.96795351473921 , 129.04006802721088 , 149.34720521541948 , 150.58904761904765 , 174.68569727891153 , 176.1255555555556  , 171.12367346938774 , 172.50412698412705 , 182.28950680272106 , 183.72936507936512 , 158.535141723356   , 159.77698412698413 , 137.83480158730157 , 138.90691609977324 , 116.79500566893424 , 117.69739229024943 , 100.68564058956916 , 101.47952380952381 , 120.43972222222222 , 121.38292517006803 , 140.49244331065756 , 141.58496598639456 , 164.23569727891152 , 165.50242630385492 , 160.66653061224486 , 161.88099773242632 , 170.92522108843534 , 172.1919501133787  , 148.5756179138322  , 149.66814058956916 , 129.12017573696147 , 130.06337868480725 , 109.3660941043084  , 110.15997732426302 ,  92.49006235827665 ,  93.17544217687075 , 110.5910827664399  , 111.40537414965986 , 128.94992630385485 , 129.89312925170069 , 150.6693707482993  , 151.76297052154197 , 147.2216326530612  , 148.2701133786848  , 156.4446088435374  , 157.53820861678005 , 135.9283390022676  , 136.87154195011337 , 118.08514172335602 , 118.89943310657596 ,  99.98412131519275 , 100.66950113378682 ,  82.34142290249434 ,  82.9182993197279  ,  98.42203514739231 ,  99.10741496598638 , 114.71965419501134 , 115.51353741496598 , 133.98671768707482 , 134.90718820861676 , 130.78897959183675 , 131.67147392290246 , 138.84767006802724 , 139.76814058956913 , 120.59330498866215 , 121.38718820861676 , 104.72969954648528 , 105.41507936507935 ,  88.6490873015873  ,  89.22596371882086 };
  const std::array<int, 4> in_shape = {{ 1, 10, 9, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.16326530612244897, 0.20408163265306123, 0.1020408163265306 , 0.12244897959183673, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.8163265306122448 , 0.8979591836734693 , 1.7959183673469385 , 1.9591836734693877 , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.1224489795918364 , 2.2857142857142856 , 1.1428571428571428 , 1.2244897959183674 , 0.8163265306122448 , 0.8979591836734693 , 1.7959183673469385 , 1.9591836734693877 , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.1224489795918364 , 2.2857142857142856 , 1.1428571428571428 , 1.2244897959183674 , 0.8163265306122448 , 0.8979591836734693 , 1.7959183673469385 , 1.9591836734693877 , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.1224489795918364 , 2.2857142857142856 , 1.1428571428571428 , 1.2244897959183674 , 0.8163265306122448 , 0.8979591836734693 , 1.7959183673469385 , 1.9591836734693877 , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.1224489795918364 , 2.2857142857142856 , 1.1428571428571428 , 1.2244897959183674 , 0.7959183673469388 , 0.857142857142857  , 1.7142857142857142 , 1.8367346938775508 , 2.7551020408163263 , 2.938775510204082  , 2.7551020408163263 , 2.938775510204082  , 2.7551020408163263 , 2.938775510204082  , 2.7551020408163263 , 2.938775510204082  , 2.7551020408163263 , 2.938775510204082  , 1.9591836734693877 , 2.0816326530612246 , 1.0408163265306123 , 1.1020408163265305 , 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.3877551020408163 , 0.4081632653061224 , 0.8163265306122449 , 0.857142857142857  , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 0.8979591836734693 , 0.9387755102040816 , 0.4693877551020408 , 0.4897959183673469 };
  const std::array<int, 4> in_shape = {{ 1, 10, 9, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 29.800459183673464,  30.377335600907024,  30.954212018140588,  31.531088435374148,  36.59195578231292 ,  37.27733560090702 ,  37.96271541950113 ,  38.64809523809524 ,  43.81746598639456 ,  44.6113492063492  ,  45.405232426303854,  46.199115646258505,  52.75357709750567 ,  53.67404761904763 ,  54.594518140589564,  55.51498866213152 ,  55.23750566893423 ,  56.120000000000005,  57.00249433106575 ,  57.88498866213152 ,  62.47548185941042 ,  63.39595238095237 ,  64.31642290249434 ,  65.23689342403628 ,  55.56476757369614 ,  56.35865079365079 ,  57.15253401360544 ,  57.9464172335601  ,  49.20728458049886 ,  49.892664399092965,  50.57804421768707 ,  51.26342403628118 ,  42.4157879818594  ,  42.992664399092966,  43.56954081632652 ,  44.146417233560086,  46.08311224489796 ,  46.768492063492054,  47.45387188208617 ,  48.13925170068027 ,  56.1603231292517  ,  56.974614512471646,  57.788905895691606,  58.60319727891156 ,  66.75318027210885 ,  67.69638321995464 ,  68.63958616780045 ,  69.58278911564626 ,  79.71310090702949 ,  80.80670068027213 ,  81.90030045351473 ,  82.99390022675738 ,  81.96131519274377 ,  83.00979591836736 ,  84.05827664399091 ,  85.1067573696145  ,  91.26357709750566 ,  92.3571768707483  ,  93.45077664399092 ,  94.54437641723356 ,  80.71000566893422 ,  81.65320861678005 ,  82.59641156462584 ,  83.53961451247167 ,  71.14844104308389 ,  71.96273242630386 ,  72.7770238095238  ,  73.59131519274376 ,  61.07123015873015 ,  61.75660997732425 ,  62.44198979591836 ,  63.127369614512475,  66.27188775510204 ,  67.06577097505668 ,  67.85965419501134 ,  68.65353741496598 ,  80.36950680272109 ,  81.31270975056688 ,  82.2559126984127  ,  83.19911564625849 ,  95.06440476190477 ,  96.15692743764171 ,  97.24945011337869 ,  98.34197278911564 , 112.90527777777778 , 114.1720068027211  , 115.4387358276644  , 116.7054648526077  , 114.66063492063493 , 115.87510204081633 , 117.08956916099771 , 118.30403628117912 , 126.2843253968254  , 127.5510544217687  , 128.817783446712   , 130.08451247165533 , 111.23075396825395 , 112.32327664399092 , 113.41579931972788 , 114.50832199546487 ,  97.73041383219955 ,  98.67361678004535 ,  99.61681972789114 , 100.56002267573696 ,  83.6327947845805  ,  84.42667800453512 ,  85.22056122448978 ,  86.01444444444444 ,  90.36678571428573 ,  91.2691723356009  ,  92.17155895691609 ,  93.0739455782313  , 109.2195068027211  , 110.29162131519273 , 111.36373582766439 , 112.43585034013606 , 128.75113945578232 , 129.9929818594104  , 131.23482426303855 , 132.4766666666667  , 152.33010770975056 , 153.7699659863946  , 155.20982426303854 , 156.64968253968252 , 153.33546485260774 , 154.71591836734694 , 156.09637188208612 , 157.47682539682538 , 167.5377267573696  , 168.9775850340136  , 170.41744331065757 , 171.85730158730158 , 147.1270124716553  , 148.36885487528343 , 149.61069727891154 , 150.85253968253969 , 128.9532029478458  , 130.02531746031744 , 131.0974319727891  , 132.16954648526075 , 110.10048185941042 , 111.0028684807256  , 111.90525510204081 , 112.807641723356   , 121.88285714285716 , 122.72195011337865 , 123.5610430839002  , 124.40013605442178 , 146.53319727891156 , 147.53011337868477 , 148.52702947845805 , 149.5239455782313  , 171.81482993197278 , 172.9695691609977  , 174.12430839002266 , 175.27904761904762 , 202.0465759637188  , 203.38544217687075 , 204.72430839002266 , 206.06317460317462 , 200.489433106576   , 201.7730612244898  , 203.0566893424036  , 204.34031746031746 , 216.18752834467122 , 217.5263945578231  , 218.86526077097506 , 220.20412698412702 , 188.90181405895692 , 190.05655328798184 , 191.21129251700683 , 192.36603174603172 , 164.88276643990932 , 165.8796825396825  , 166.87659863945578 , 167.87351473922902 , 140.23242630385488 , 141.07151927437639 , 141.91061224489798 , 142.74970521541948 , 160.16285714285715 , 161.00195011337865 , 161.84104308390022 , 162.68013605442178 , 192.01319727891155 , 193.01011337868476 , 194.00702947845804 , 195.0039455782313  , 224.4948299319728  , 225.6495691609977  , 226.80430839002264 , 227.95904761904762 , 263.1265759637188  , 264.4654421768707  , 265.80430839002264 , 267.14317460317466 , 259.049433106576   , 260.33306122448977 , 261.61668934240356 , 262.90031746031747 , 277.2675283446712  , 278.60639455782314 , 279.945260770975   , 281.284126984127   , 241.58181405895695 , 242.73655328798182 , 243.8912925170068  , 245.04603174603173 , 210.36276643990934 , 211.3596825396825  , 212.35659863945583 , 213.353514739229   , 178.51242630385488 , 179.3515192743764  , 180.19061224489795 , 181.02970521541948 , 212.95392857142858 , 213.85631519274375 , 214.75870181405898 , 215.66108843537415 , 254.86379251700677 , 255.93590702947841 , 257.00802154195014 , 258.08013605442176 , 297.4525680272108  , 298.69441043083896 , 299.9362528344671  , 301.1780952380953  , 347.93153628117915 , 349.37139455782307 , 350.8112528344671  , 352.2511111111112  , 340.8668934240363  , 342.2473469387755  , 343.6278004535147  , 345.0082539682541  , 363.1391553287982  , 364.5790136054421  , 366.0188718820861  , 367.45873015873025 , 315.8284410430839  , 317.070283446712   , 318.3121258503401  , 319.55396825396826 , 274.5974886621315  , 275.66960317460314 , 276.7417176870748  , 277.8138321995465  , 232.6876247165533  , 233.59001133786848 , 234.49239795918365 , 235.39478458049885 , 200.57739795918366 , 201.37128117913832 , 202.16516439909296 , 202.95904761904762 , 239.93624149659863 , 240.87944444444443 , 241.82264739229026 , 242.76585034013607 , 279.89236394557815 , 280.9848866213151  , 282.0774092970522  , 283.16993197278913 , 327.2046655328798  , 328.47139455782303 , 329.73812358276643 , 331.00485260770984 , 320.1185941043084  , 321.3330612244897  , 322.5475283446712  , 323.76199546485265 , 340.58371315192744 , 341.8504421768707  , 343.1171712018141  , 344.3839002267574  , 296.0587131519274  , 297.1512358276644  , 298.2437585034013  , 299.3362811791383  , 257.2971485260771  , 258.24035147392294 , 259.1835544217687  , 260.1267573696145  , 217.93830498866214 , 218.7321882086168  , 219.5260714285714  , 220.31995464852605 , 184.29474489795916 , 184.9801247165533  , 185.66550453514742 , 186.3508843537415  , 220.36787414965983 , 221.1821655328798  , 221.9964569160998  , 222.81074829931973 , 256.9566496598639  , 257.8998526077097  , 258.8430555555556  , 259.78625850340137 , 300.245141723356   , 301.3387414965986  , 302.43234126984134 , 303.52594104308395 , 293.3947845804988  , 294.4432653061224  , 295.49174603174606 , 296.5402267573696  , 311.7956179138322  , 312.8892176870748  , 313.98281746031745 , 315.0764172335601  , 270.9134750566893  , 271.8566780045352  , 272.79988095238093 , 273.74308390022674 , 235.35599206349207 , 236.17028344671203 , 236.98457482993197 , 237.7988662131519  , 199.2828628117914  , 199.9682426303855  , 200.65362244897958 , 201.33900226757365 , 164.1059693877551  , 164.6828458049887  , 165.25972222222225 , 165.8365986394558  , 196.15869047619043 , 196.84407029478461 , 197.5294501133787  , 198.21482993197276 , 228.645425170068   , 229.4393083900227  , 230.23319160997735 , 231.02707482993196 , 267.05296485260766 , 267.97343537414963 , 268.89390589569166 , 269.8143764172335  , 260.69546485260764 , 261.5779591836735  , 262.46045351473924 , 263.34294784580493 , 276.77486961451245 , 277.6953401360545  , 278.6158106575964  , 279.53628117913826 , 240.39272675736962 , 241.1866099773243  , 241.98049319727892 , 242.77437641723353 , 208.77401927437643 , 209.45939909297056 , 210.14477891156463 , 210.8301587301587  , 176.72129818594104 , 177.2981746031746  , 177.87505102040816 , 178.45192743764173 };
  const std::array<int, 4> in_shape = {{ 1, 10, 9, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.40816326530612246 , 0.18367346938775508 , 0.2040816326530612  , 0.22448979591836732 , 0.24489795918367346 , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.7959183673469388  , 0.857142857142857   , 0.9183673469387754  , 0.9795918367346939  , 1.8367346938775508  , 1.9591836734693873  , 2.081632653061224   , 2.204081632653061   , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 3.122448979591837   , 3.3061224489795915  , 3.4897959183673466  , 3.6734693877551017  , 2.326530612244898   , 2.4489795918367343  , 2.571428571428571   , 2.693877551020408   , 1.2857142857142856  , 1.346938775510204   , 1.4081632653061222  , 1.4693877551020407  , 1.5510204081632653  , 1.6326530612244896  , 1.714285714285714   , 1.7959183673469385  , 3.428571428571428   , 3.591836734693877   , 3.755102040816326   , 3.9183673469387754  , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.081632653061224   , 4.244897959183673   , 4.408163265306122   , 4.571428571428571   , 2.204081632653061   , 2.2857142857142856  , 2.36734693877551    , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244896  , 1.714285714285714   , 1.7959183673469385  , 3.428571428571428   , 3.591836734693877   , 3.755102040816326   , 3.9183673469387754  , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.081632653061224   , 4.244897959183673   , 4.408163265306122   , 4.571428571428571   , 2.204081632653061   , 2.2857142857142856  , 2.36734693877551    , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244896  , 1.714285714285714   , 1.7959183673469385  , 3.428571428571428   , 3.591836734693877   , 3.755102040816326   , 3.9183673469387754  , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.081632653061224   , 4.244897959183673   , 4.408163265306122   , 4.571428571428571   , 2.204081632653061   , 2.2857142857142856  , 2.36734693877551    , 2.4489795918367347  , 1.5510204081632653  , 1.6326530612244896  , 1.714285714285714   , 1.7959183673469385  , 3.428571428571428   , 3.591836734693877   , 3.755102040816326   , 3.9183673469387754  , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 5.63265306122449    , 5.877551020408162   , 6.122448979591837   , 6.36734693877551    , 4.081632653061224   , 4.244897959183673   , 4.408163265306122   , 4.571428571428571   , 2.204081632653061   , 2.2857142857142856  , 2.36734693877551    , 2.4489795918367347  , 1.530612244897959   , 1.5918367346938775  , 1.6530612244897958  , 1.714285714285714   , 3.3061224489795915  , 3.4285714285714284  , 3.551020408163265   , 3.6734693877551017  , 5.326530612244897   , 5.5102040816326525  , 5.693877551020407   , 5.877551020408164   , 5.326530612244897   , 5.5102040816326525  , 5.693877551020407   , 5.877551020408164   , 5.326530612244897   , 5.5102040816326525  , 5.693877551020407   , 5.877551020408164   , 5.326530612244897   , 5.5102040816326525  , 5.693877551020407   , 5.877551020408164   , 5.326530612244897   , 5.5102040816326525  , 5.693877551020407   , 5.877551020408164   , 3.7959183673469385  , 3.9183673469387754  , 4.040816326530612   , 4.163265306122449   , 2.020408163265306   , 2.0816326530612246  , 2.142857142857143   , 2.204081632653061   , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 0.7551020408163265  , 0.7755102040816326  , 0.7959183673469387  , 0.8163265306122448  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.714285714285714   , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 0.9183673469387754  , 0.9387755102040816  , 0.9591836734693877  , 0.9795918367346939  };
  const std::array<int, 4> in_shape = {{ 1, 10, 9, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  8.613361678004535,  10.5300283446712  ,  12.555198412698413,  14.688871882086168,  14.710102040816327,  15.773435374149658,  18.094070294784576,  16.285907029478455,  14.36924036281179 ,  12.344070294784583,  13.199416099773241,  16.034450113378682,  18.998395691609975,  22.091252834467117,  21.791054421768706,  23.054387755102034,  26.136927437641713,  23.430804988662125,  20.595770975056684,  17.6318253968254  ,  18.87050453514739 ,  22.82798752834467 ,  26.93479024943311 ,  31.1909126984127  ,  30.450238095238095,  31.913571428571423,  35.877063492063485,  32.068900226757364,  28.111417233560083,  24.004614512471655,  25.626626984126982,  30.910640589569162,  36.3643820861678  ,  41.9878514739229  ,  40.68765306122449 ,  42.350986394557815,  47.31447845804988 ,  42.20019274376416 ,  36.916179138321986,  31.46243764172336 ,  34.34428571428571 ,  41.23544217687075 ,  48.28442176870748 ,  55.49122448979592 ,  53.128526077097504,  54.67519274376416 ,  60.44424036281178 ,  53.71090702947845 ,  46.81975056689342 ,  39.770770975056685,  44.97761904761904 ,  53.86877551020408 ,  62.917755102040815,  72.12455782312925 ,  68.59519274376417 ,  70.14185941043084 ,  77.07757369614512 ,  68.34424036281179 ,  59.45308390022675 ,  50.40410430839003 ,  59.67861111111111 ,  71.36738662131519 ,  83.22589002267573 ,  95.25412131519273 ,  90.2178117913832  ,  91.88114512471654 , 100.58074829931971 ,  89.06170068027211 ,  77.37292517006803 ,  65.51442176870749 ,  56.17759070294784 ,  67.15208049886621 ,  78.27589002267572 ,  89.5490192743764  ,  84.71509070294783 ,  86.17842403628117 ,  94.2351700680272  ,  83.41             ,  72.43551020408164 ,  61.31170068027211 ,  51.59153628117914 ,  61.64765873015873 ,  71.83269274376417 ,  82.14663832199545 ,  77.63413832199545 ,  78.89747165532879 ,  86.19231292517006 ,  76.26510204081633 ,  66.20897959183674 ,  56.0239455782313  ,  45.920447845804986,  54.85412131519274 ,  63.89629818594105 ,  73.04697845804988 ,  68.97495464852608 ,  70.03828798185941 ,  76.4521768707483  ,  67.6270068027211  ,  58.693333333333335,  49.651156462585035};
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.18367346938775508 , 0.14285714285714285 , 0.08163265306122448 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.5714285714285714  , 1.2244897959183674  , 1.9591836734693875  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.2040816326530615  , 1.551020408163265   , 0.8163265306122449  , 0.5714285714285714  , 1.2244897959183674  , 1.9591836734693875  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.2040816326530615  , 1.551020408163265   , 0.8163265306122449  , 0.5714285714285714  , 1.2244897959183674  , 1.9591836734693875  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.2040816326530615  , 1.551020408163265   , 0.8163265306122449  , 0.5714285714285714  , 1.2244897959183674  , 1.9591836734693875  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.7755102040816326  , 2.2040816326530615  , 1.551020408163265   , 0.8163265306122449  , 0.5510204081632653  , 1.1632653061224487  , 1.8367346938775506  , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.020408163265306   , 1.4081632653061222  , 0.7346938775510203  , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.26530612244897955 , 0.5510204081632653  , 0.857142857142857   , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 0.9183673469387754  , 0.6326530612244897  , 0.32653061224489793 };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 16.64984693877551 ,  17.22672335600907 ,  20.374676870748296,  21.0600566893424  ,  24.31651360544218 ,  25.110396825396826,  28.475357142857142,  29.377743764172337,  28.581111111111106,  29.420204081632654,  30.707777777777775,  31.546870748299316,  35.285753968253964,  36.18814058956915 ,  31.77793083900226 ,  32.57181405895691 ,  28.053100907029474,  28.73848072562358 ,  24.111264172335602,  24.688140589569166,  25.713452380952383,  26.398832199546483,  31.25460884353741 ,  32.068900226757364,  37.053588435374145,  37.99679138321995 ,  43.11039115646258 ,  44.18250566893423 ,  42.58519274376416 ,  43.58210884353741 ,  45.11185941043083 ,  46.10877551020407 ,  51.20174036281178 ,  52.273854875283426,  45.918407029478445,  46.86160997732425 ,  40.377250566893416,  41.19154195011337 ,  34.57827097505669 ,  35.2636507936508  ,  36.947125850340136,  37.74100907029478 ,  44.71277210884353 ,  45.65597505668934 ,  52.77705782312924 ,  53.86958049886622 ,  61.13998299319727 ,  62.3818253968254  ,  59.745736961451236,  60.90047619047619 ,  62.672403628117905,  63.827142857142846,  70.51228458049886 ,  71.75412698412697 ,  63.04527777777776 ,  64.13780045351473 ,  55.27963151927437 ,  56.222834467120165,  47.215345804988665,  48.00922902494331 ,  50.35086734693877 ,  51.253253968253965,  60.74916666666665 ,  61.821281179138325,  71.48692176870746 ,  72.7287641723356  ,  82.56413265306122 ,  83.9757029478458  ,  80.06274376417231 ,  81.37530612244898 ,  83.38941043083898 ,  84.70197278911563 ,  93.21738662131516 ,  94.62895691609975 ,  83.1585430839002  ,  84.40038548752833 ,  72.76024376417232 ,  73.83235827664397 ,  62.02248866213152 ,  62.92487528344672 ,  67.84947845804989 ,  68.68857142857142 ,  81.47396825396824 ,  82.4708843537415  ,  95.41410430839    ,  96.56884353741496 , 109.66988662131516 , 110.98244897959184 , 105.03655328798182 , 106.25705215419501 , 108.12988662131517 , 109.35038548752831 , 119.5759183673469  , 120.88848072562357 , 106.26707482993194 , 107.4218140589569  ,  92.64258503401359 ,  93.63950113378684 ,  78.70244897959184 ,  79.54154195011337 ,  89.11614512471654 ,  89.95523809523807 , 106.7406349206349  , 107.73755102040816 , 124.68077097505666 , 125.83551020408163 , 142.9365532879818  , 144.2491156462585  , 135.96988662131517 , 137.19038548752835 , 139.0632199546485  , 140.28371882086168 , 152.84258503401358 , 154.15514739229025 , 135.5337414965986  , 136.68848072562358 , 117.90925170068026 , 118.9061678004535  ,  99.96911564625852 , 100.80820861678006 , 118.45483560090703 , 119.35722222222222 , 141.6626587301587  , 142.73477324263038 , 165.20993764172334 , 166.45178004535146 , 189.09667233560086 , 190.50824263038547 , 179.12306122448976 , 180.4356235827664  , 182.44972789115644 , 183.76229024943308 , 199.74992630385483 , 201.16149659863942 , 176.88155895691605 , 178.12340136054422 , 153.6737358276644  , 154.74585034013606 , 130.12645691609978 , 131.02884353741499 , 111.56129818594104 , 112.35518140589568 , 133.36095804988662 , 134.30416099773242 , 155.45925736961448 , 156.55178004535145 , 177.8561961451247  , 179.0980385487528  , 168.2754421768707  , 169.43018140589567 , 171.2021088435374  , 172.35684807256234 , 187.22849773242626 , 188.4703401360544  , 165.72747732426302 , 166.82             , 143.92781746031744 , 144.87102040816328 , 121.82951814058958 , 122.62340136054422 , 102.49769274376418 , 103.18307256235828 , 122.4810260770975  , 123.29531746031746 , 142.72218253968254 , 143.66538548752834 , 163.22116213151926 , 164.2932766439909  , 154.27136054421766 , 155.2682766439909  , 156.79802721088433 , 157.79494331065757 , 171.31251133786847 , 172.38462585034011 , 151.58700113378683 , 152.53020408163266 , 131.6036678004535  , 132.41795918367347 , 111.36251133786848 , 112.0478911564626  ,  91.26401927437644 ,  91.84089569160997 , 109.02286281179138 , 109.70824263038548 , 126.99871315192743 , 127.7925963718821  , 145.19157029478458 , 146.09395691609976 , 137.1108163265306  , 137.94990929705216 , 139.2374829931973  , 140.07657596371882 , 152.00196712018138 , 152.9043537414966  , 134.46013038548753 , 135.2540136054422  , 116.70128684807256 , 117.38666666666667 ,  98.72543650793651 ,  99.30231292517007 };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.30612244897959184, 0.36734693877551017, 0.24489795918367346, 0.2857142857142857 , 0.14285714285714285, 0.16326530612244897, 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.5510204081632653 , 0.6122448979591836 , 1.2244897959183674 , 1.346938775510204  , 2.020408163265306  , 2.204081632653061  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.938775510204081  , 3.183673469387755  , 2.387755102040816  , 2.5714285714285716 , 1.714285714285714  , 1.8367346938775508 , 0.9183673469387754 , 0.9795918367346939 , 1.0612244897959182 , 1.1428571428571428 , 2.2857142857142856 , 2.4489795918367347 , 3.6734693877551017 , 3.918367346938775  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 4.163265306122448  , 4.408163265306123  , 2.9387755102040813 , 3.10204081632653   , 1.5510204081632653 , 1.6326530612244898 , 1.0612244897959182 , 1.1428571428571428 , 2.2857142857142856 , 2.4489795918367347 , 3.6734693877551017 , 3.918367346938775  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 4.163265306122448  , 4.408163265306123  , 2.9387755102040813 , 3.10204081632653   , 1.5510204081632653 , 1.6326530612244898 , 1.0612244897959182 , 1.1428571428571428 , 2.2857142857142856 , 2.4489795918367347 , 3.6734693877551017 , 3.918367346938775  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 4.163265306122448  , 4.408163265306123  , 2.9387755102040813 , 3.10204081632653   , 1.5510204081632653 , 1.6326530612244898 , 1.0612244897959182 , 1.1428571428571428 , 2.2857142857142856 , 2.4489795918367347 , 3.6734693877551017 , 3.918367346938775  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 5.224489795918366  , 5.551020408163265  , 4.163265306122448  , 4.408163265306123  , 2.9387755102040813 , 3.10204081632653   , 1.5510204081632653 , 1.6326530612244898 , 1.0408163265306123 , 1.1020408163265305 , 2.204081632653061  , 2.3265306122448974 , 3.4897959183673466 , 3.6734693877551012 , 4.897959183673469  , 5.142857142857142  , 4.897959183673469  , 5.142857142857142  , 4.897959183673469  , 5.142857142857142  , 4.897959183673469  , 5.142857142857142  , 3.857142857142857  , 4.040816326530612  , 2.693877551020408  , 2.8163265306122445 , 1.4081632653061225 , 1.4693877551020407 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.5102040816326531 , 0.5306122448979591 , 1.0612244897959182 , 1.1020408163265305 , 1.6530612244897958 , 1.714285714285714  , 2.2857142857142856 , 2.3673469387755097 , 2.2857142857142856 , 2.3673469387755097 , 2.2857142857142856 , 2.3673469387755097 , 2.2857142857142856 , 2.3673469387755097 , 1.7755102040816326 , 1.8367346938775508 , 1.2244897959183674 , 1.2653061224489794 , 0.6326530612244897 , 0.6530612244897959 };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 32.72281746031746 ,  33.29969387755102 ,  33.876570294784585,  34.45344671201814 ,  40.06397392290249 ,  40.74935374149659 ,  41.434733560090706,  42.1201133786848  ,  47.8391439909297  ,  48.63302721088436 ,  49.426910430838994,  50.22079365079365 ,  56.04832766439909 ,  56.950714285714284,  57.853100907029464,  58.75548752834467 ,  56.32312925170068 ,  57.16222222222221 ,  58.00131519274377 ,  58.84040816326531 ,  60.576462585034015,  61.41555555555555 ,  62.254648526077105,  63.09374149659863 ,  69.66912131519274 ,  70.57150793650793 ,  71.47389455782313 ,  72.3762811791383  ,  62.76197845804988 ,  63.55586167800452 ,  64.34974489795918 ,  65.14362811791382 ,  55.42082199546485 ,  56.10620181405895 ,  56.79158163265306 ,  57.47696145124716 ,  47.64565192743764 ,  48.222528344671204,  48.79940476190476 ,  49.37628117913833 ,  50.74152494331066 ,  51.426904761904765,  52.112284580498866,  52.797664399092966,  61.69492630385488 ,  62.50921768707482 ,  63.32350907029478 ,  64.13780045351473 ,  73.16397392290249 ,  74.10717687074829 ,  75.0503798185941  ,  75.9935827664399  ,  85.1486678004535  ,  86.22078231292517 ,  87.2928968253968  ,  88.36501133786847 ,  84.17346938775509 ,  85.17038548752832 ,  86.1673015873016  ,  87.16421768707482 ,  89.22680272108843 ,  90.22371882086166 ,  91.22063492063492 ,  92.21755102040814 , 101.33136621315192 , 102.40348072562357 , 103.47559523809524 , 104.54770975056685 ,  90.89361111111111 ,  91.83681405895689 ,  92.78001700680272 ,  93.7232199546485  ,  79.94020975056691 ,  80.75450113378683 ,  81.56879251700681 ,  82.38308390022674 ,  68.47116213151928 ,  69.15654195011338 ,  69.84192176870748 ,  70.5273015873016  ,  73.10036848072562 ,  73.89425170068027 ,  74.68813492063491 ,  75.48201814058956 ,  88.48234126984129 ,  89.42554421768706 ,  90.36874716553288 ,  91.31195011337869 , 104.46159297052155 , 105.55411564625848 , 106.64663832199544 , 107.73916099773244 , 121.03812358276642 , 122.27996598639454 , 123.52180839002263 , 124.7636507936508  , 118.33673469387755 , 119.49147392290247 , 120.64621315192743 , 121.80095238095238 , 124.19006802721088 , 125.34480725623581 , 126.49954648526077 , 127.65428571428569 , 139.7827267573696  , 141.02456916099771 , 142.26641156462583 , 143.50825396825394 , 124.99803287981858 , 126.09055555555553 , 127.18307823129251 , 128.27560090702946 , 109.61606009070294 , 110.55926303854874 , 111.50246598639455 , 112.44566893424033 ,  93.63680839002267 ,  94.43069160997733 ,  95.22457482993195 ,  96.01845804988662 ,  99.79934807256237 , 100.70173469387754 , 101.60412131519273 , 102.50650793650793 , 120.4262188208617  , 121.4983333333333  , 122.570447845805   , 123.64256235827665 , 141.73200113378687 , 142.97384353741492 , 144.21568594104306 , 145.4575283446712  , 163.71669501133783 , 165.12826530612244 , 166.539835600907   , 167.9514058956916  , 158.812925170068   , 160.12548752834462 , 161.43804988662134 , 162.75061224489795 , 165.46625850340135 , 166.77882086167796 , 168.09138321995468 , 169.40394557823126 , 185.0232029478458  , 186.4347732426303  , 187.84634353741498 , 189.2579138321995  , 165.0752437641723  , 166.3170861678004  , 167.5589285714286  , 168.80077097505665 , 144.44837301587302 , 145.52048752834463 , 146.59260204081633 , 147.66471655328795 , 123.14259070294783 , 124.04497732426304 , 124.9473639455782  , 125.84975056689343 , 134.8598639455782  , 135.69895691609977 , 136.5380498866213  , 137.37714285714284 , 161.9510204081633  , 162.94793650793648 , 163.94485260770975 , 164.941768707483   , 189.67346938775512 , 190.82820861678    , 191.98294784580497 , 193.13768707482993 , 218.02721088435374 , 219.33977324263032 , 220.652335600907   , 221.96489795918367 , 208.85260770975057 , 210.07310657596364 , 211.2936054421769  , 212.51410430839002 , 215.03927437641727 , 216.25977324263033 , 217.48027210884356 , 218.70077097505663 , 237.83927437641725 , 239.1518367346938  , 240.46439909297052 , 241.77696145124713 , 211.37941043083902 , 212.53414965986389 , 213.6888888888889  , 214.8436281179138  , 184.28825396825397 , 185.28517006802718 , 186.28208616780043 , 187.27900226757367 , 156.5658049886621  , 157.40489795918367 , 158.24399092970518 , 159.08308390022674 , 177.39319727891157 , 178.23229024943308 , 179.07138321995467 , 179.91047619047615 , 212.48435374149665 , 213.4812698412698  , 214.47818594104314 , 215.47510204081632 , 248.20680272108845 , 249.36154195011332 , 250.51628117913836 , 251.67102040816326 , 284.56054421768704 , 285.8731065759636  , 287.1856689342404  , 288.498231292517   , 270.7192743764172  , 271.93977324263034 , 273.16027210884357 , 274.3807709750567  , 276.90594104308394 , 278.126439909297   , 279.34693877551024 , 280.56743764172336 , 304.3726077097506  , 305.68517006802716 , 306.99773242630386 , 308.3102947845805  , 269.9127437641723  , 271.0674829931972  , 272.2222222222222  , 273.37696145124715 , 234.82158730158727 , 235.81850340136052 , 236.8154195011337  , 237.812335600907   , 199.09913832199544 , 199.93823129251703 , 200.77732426303848 , 201.61641723356013 , 236.00728458049886 , 236.90967120181406 , 237.81205782312927 , 238.71444444444444 , 282.2532029478458  , 283.3253174603174  , 284.39743197278915 , 285.46954648526076 , 329.17803287981855 , 330.4198752834467  , 331.66171768707494 , 332.9035600907029  , 376.7817743764172  , 378.1933446712017  , 379.60491496598644 , 381.01648526077093 , 356.9335600907029  , 358.2461224489795  , 359.55868480725627 , 360.8712471655328  , 363.5868934240362  , 364.8994557823129  , 366.2120181405896  , 367.52458049886616 , 398.0882823129251  , 399.49985260770967 , 400.91142290249434 , 402.32299319727883 , 352.52127551020396 , 353.7631179138321  , 355.0049603174603  , 356.24680272108844 , 306.2753571428571  , 307.3474716553288  , 308.4195861678004  , 309.4917006802721  , 259.35052721088437 , 260.25291383219957 , 261.15530045351466 , 262.05768707482997 , 222.32871315192742 , 223.12259637188208 , 223.91647959183675 , 224.71036281179136 , 265.77871315192743 , 266.72191609977324 , 267.6651190476191  , 268.60832199546485 , 309.825992063492   , 310.91851473922895 , 312.01103741496604 , 313.1035600907029  , 354.47054988662126 , 355.7123922902494  , 356.9542346938776  , 358.1960770975056  , 335.3961451247165  , 336.5508843537414  , 337.70562358276646 , 338.86036281179133 , 341.2494784580498  , 342.4042176870748  , 343.55895691609976 , 344.7136961451247  , 373.2151530612244  , 374.4569954648525  , 375.6988378684807  , 376.9406802721088  , 330.36243197278907 , 331.45495464852604 , 332.547477324263   , 333.64             , 286.9124319727891  , 287.8556349206349  , 288.79883786848063 , 289.74204081632655 , 242.8651530612245  , 243.65903628117917 , 244.45291950113375 , 245.24680272108844 , 204.31000566893425 , 204.99538548752835 , 205.68076530612245 , 206.36614512471655 , 244.14776077097505 , 244.962052154195   , 245.77634353741496 , 246.59063492063493 , 284.50116213151927 , 285.44436507936507 , 286.38756802721093 , 287.3307709750567  , 325.3702097505668  , 326.44232426303853 , 327.5144387755102  , 328.5865532879818  , 307.54580498866204 , 308.5427210884353  , 309.53963718820864 , 310.5365532879818  , 312.5991383219954  , 313.59605442176866 , 314.59297052154193 , 315.58988662131515 , 341.5529081632653  , 342.62502267573694 , 343.69713718820856 , 344.76925170068023 , 302.23079931972785 , 303.17400226757366 , 304.11720521541946 , 305.0604081632653  , 262.3930442176871  , 263.207335600907   , 264.0216269841269  , 264.83591836734695 , 222.03964285714287 , 222.72502267573697 , 223.41040249433104 , 224.0957823129252  , 181.95116213151928 , 182.52803854875287 , 183.10491496598638 , 183.68179138321995 , 217.36034580498867 , 218.04572562358277 , 218.73110544217687 , 219.41648526077097 , 253.20354308390023 , 253.99742630385487 , 254.79130952380953 , 255.5851927437642  , 289.48075396825396 , 290.38314058956917 , 291.28552721088437 , 292.1879138321995  , 273.3825396825397  , 274.2216326530612  , 275.06072562358275 , 275.8998185941043  , 277.635873015873   , 278.4749659863946  , 279.3140589569161  , 280.15315192743765 , 303.1015476190476  , 304.00393424036275 , 304.90632086167795 , 305.8087074829932  , 268.1263775510204  , 268.92026077097506 , 269.71414399092964 , 270.5080272108844  , 232.71719387755104 , 233.4025736961451  , 234.0879535147392  , 234.77333333333334 , 196.87399659863948 , 197.45087301587301 , 198.02774943310658 , 198.60462585034014 };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID1x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5510204081632653  ,  0.6122448979591837  ,  0.6734693877551019  ,  0.7346938775510203  ,  0.44897959183673464 ,  0.4897959183673469  ,  0.5306122448979591  ,  0.5714285714285714  ,  0.26530612244897955 ,  0.2857142857142857  ,  0.3061224489795918  ,  0.32653061224489793 ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.020408163265306   ,  2.0816326530612246  ,  2.1428571428571423  ,  2.204081632653061   ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897958   ,  4.653061224489795   ,  6.795918367346939   ,  6.979591836734693   ,  7.163265306122447   ,  7.3469387755102025  ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  7.530612244897959   ,  7.714285714285714   ,  7.897959183673468   ,  8.081632653061224   ,  5.26530612244898    ,  5.387755102040816   ,  5.5102040816326525  ,  5.632653061224489   ,  2.7551020408163263  ,  2.816326530612245   ,  2.877551020408163   ,  2.9387755102040813  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  0.9999999999999999  ,  1.0204081632653061  ,  1.040816326530612   ,  1.0612244897959182  ,  2.081632653061224   ,  2.1224489795918364  ,  2.1632653061224487  ,  2.204081632653061   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  3.4897959183673466  ,  3.5510204081632653  ,  3.6122448979591835  ,  3.6734693877551017  ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  1.2448979591836733  ,  1.2653061224489794  ,  1.2857142857142856  ,  1.3061224489795917  };
  const std::array<int, 4> in_shape = {{ 1, 10, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  7.15218253968254 ,   8.794019274376419,  10.836082766439908,  13.43846371882086 ,  14.767630385487529,  12.924773242630383,  11.262471655328797,   9.729138321995464,  10.870209750566895,  13.2671485260771  ,  16.213973922902493,  19.93064058956916 ,  21.509807256235824,  18.69552154195011 ,  16.19988662131519 ,  13.931859410430839,  16.22060657596372 ,  19.6889739229025  ,  23.913577097505666,  29.196910430838997,  31.06774376417233 ,  26.85345804988662 ,  23.163378684807256,  19.847732426303853,  23.856320861678007,  28.838973922902497,  34.86357709750566 ,  42.346910430839   ,  44.567743764172334,  38.35345804988661 ,  32.96337868480725 ,  28.16201814058957 ,  34.48965419501134 ,  41.47230725623584 ,  49.83024376417234 ,  60.113577097505676,  62.33441043083901 ,  53.32012471655329 ,  45.59671201814059 ,  38.7953514739229  ,  32.93013038548752 ,  39.54135487528345 ,  47.43262471655329 ,  57.11595804988662 ,  58.98679138321995 ,  50.372505668934245,  43.01575963718821 ,  36.557256235827666,  30.61782879818594 ,  36.72905328798186 ,  44.0092120181406  ,  52.925878684807266,  54.505045351473925,  46.49075963718821 ,  39.66179138321995 ,  33.679478458049886,  27.76782879818594 ,  33.287216553287976,  39.85308956916101 ,  47.884041950113385,  49.21320861678005 ,  41.94178004535147 ,  35.75566893424036 ,  30.344784580498867,  44.07227324263039 ,  52.658327664399096,  62.80197845804989 ,  75.1262641723356  ,  76.45543083900225 ,  64.89066893424037 ,  55.126780045351474,  46.64922902494332 ,  54.734518140589564,  65.38179705215418 ,  77.95401927437642 ,  93.22116213151926 ,  94.80032879818592 ,  80.43556689342404 ,  68.31453514739228 ,  57.796167800453524,  68.18650226757369 ,  81.4290192743764  ,  97.05679705215421 , 116.02393990929704 , 117.89477324263036 ,  99.99667800453516 ,  84.90342403628118 ,  71.81362811791385 ,  85.54412131519274 , 102.1294954648526  , 121.69060657596374 , 145.4177494331066  , 147.6385827664399  , 125.18048752834468 , 106.25390022675738 ,  89.84981859410433 ,  96.17745464852605 , 114.76282879818592 , 136.6572732426304  , 163.18441609977324 , 165.40524943310658 , 140.14715419501135 , 118.8872335600907  , 100.48315192743763 ,  84.89602607709752 , 101.28140022675736 , 120.57584467120179 , 143.94298752834467 , 145.813820861678   , 123.51572562358277 , 104.75580498866212 ,  88.52315192743762 ,  74.48213718820863 ,  88.84370181405895 , 105.74925736961451 , 126.21640022675736 , 127.79556689342402 , 108.23080498866213 ,  91.77643990929704 ,  77.54378684807256 ,  64.68791950113379 ,  77.15152494331065 ,  91.81898526077097 , 109.57184240362811 , 110.90100907029478 ,  93.90767573696144 ,  79.61997732426303 ,  67.26487528344671 ,  80.99236394557823 ,  96.52263605442175 , 114.76787414965986 , 136.81406462585034 , 138.143231292517   , 116.85656462585033 ,  98.99108843537414 ,  83.56931972789114 ,  98.59882653061226 , 117.49644557823129 , 139.69406462585036 , 166.5116836734694  , 168.09085034013606 , 142.17561224489796 , 120.42918367346938 , 101.66047619047617 , 120.1523979591837  , 143.16906462585035 , 170.20001700680274 , 202.85096938775513 , 204.72180272108847 , 173.1398979591837  , 146.64346938775512 , 123.77952380952378 , 147.2319217687075  , 175.42001700680274 , 208.51763605442179 , 248.48858843537417 , 250.7094217687075  , 212.00751700680274 , 179.54442176870748 , 151.537619047619   , 157.86525510204083 , 188.0533503401361  , 223.48430272108845 , 266.25525510204085 , 268.47608843537415 , 226.97418367346935 , 192.1777551020408  , 162.1709523809524  , 136.86192176870748 , 163.02144557823132 , 193.71906462585036 , 230.77001700680273 , 232.64085034013604 , 196.65894557823128 , 166.49585034013606 , 140.48904761904762 , 118.34644557823128 , 140.95835034013606 , 167.48930272108845 , 199.50692176870749 , 201.08608843537414 , 169.97085034013605 , 143.89108843537414 , 121.40809523809524 , 101.60801020408164 , 121.01583333333332 , 143.78488095238095 , 171.25964285714286 , 172.58880952380954 , 145.87357142857147 , 123.48428571428573 , 104.18496598639456 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.04081632653061224 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.061224489795918366, 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.14285714285714285 , 0.08163265306122448 , 0.1020408163265306  , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.12244897959183673 , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.14285714285714285 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.16326530612244897 , 0.18367346938775508 , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.2040816326530612  , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.22448979591836732 , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.24489795918367346 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 13.72748866213152 ,  14.30436507936508 ,  16.90265873015873 ,  17.588038548752838,  20.860198412698413,  21.672165532879816,  25.91305555555556 ,  26.87692743764172 ,  28.571388888888887,  29.535260770975057,  25.037579365079367,  25.849546485260767,  21.839563492063494,  22.524943310657594,  18.88140022675737 ,  19.458276643990928,  21.055039682539682,  21.74041950113379 ,  25.720005668934242,  26.5342970521542  ,  31.46325963718821 ,  32.42794784580499 ,  38.716116780045354,  39.86128117913832 ,  41.874450113378686,  43.01961451247165 ,  36.426354875283444,  37.39104308390022 ,  31.58548185941043 ,  32.39977324263038 ,  27.17833900226757 ,  27.863718820861678,  31.629246031746028,  32.44121315192744 ,  38.41325963718821 ,  39.377947845805   ,  46.68429138321996 ,  47.82715419501133 ,  57.037148526077104,  58.393820861677995,  60.77881519274377 ,  62.13548752834466 ,  52.564053287981864,  53.70691609977324 ,  45.362069160997734,  46.32675736961451 ,  38.88349773242631 ,  39.69546485260771 ,  46.74876984126984 ,  47.712641723356015,  56.532783446712024,  57.677947845804994,  68.37048185941043 ,  69.72715419501132 ,  83.08333900226756 ,  84.693820861678   ,  87.52500566893423 ,  89.13548752834467 ,  75.35024376417233 ,  76.70691609977322 ,  64.78159297052154 ,  65.9267573696145  ,  55.360164399092966,  56.32403628117914 ,  68.0154365079365  ,  68.97930839002268 ,  81.79945011337868 ,  82.94461451247167 ,  98.30381519274377 ,  99.66048752834467 , 118.6166723356009  , 120.22715419501135 , 123.05833900226756 , 124.66882086167801 , 105.28357709750567 , 106.64024943310658 ,  90.04825963718821 ,  91.19342403628119 ,  76.62683106575963 ,  77.5907029478458  ,  65.04829365079365 ,  65.86026077097505 ,  78.11802154195011 ,  79.0827097505669  ,  93.7223866213152  ,  94.86524943310658 , 112.87524376417234 , 114.23191609977324 , 116.616910430839   , 117.9735827664399  ,  99.6021485260771  , 100.74501133786849 ,  85.06683106575963 ,  86.03151927437642 ,  72.30254535147392 ,  73.11451247165533 ,  60.55027777777778 ,  61.23565759637188 ,  72.64381519274376 ,  73.45810657596373 ,  87.0537358276644  ,  88.0184240362812  , 104.70659297052154 , 105.85175736961453 , 107.86492630385487 , 109.01009070294785 ,  92.01683106575963 ,  92.98151927437642 ,  78.50929138321995 ,  79.3235827664399  ,  66.67357709750567 ,  67.35895691609977 ,  54.95878117913832 ,  55.53565759637188 ,  65.88905328798187 ,  66.57443310657595 ,  78.89421201814059 ,  79.70617913832201 ,  94.80421201814059 ,  95.76808390022677 ,  97.46254535147392 ,  98.4264172335601  ,  83.07159297052154 ,  83.88356009070294 ,  70.82595804988662 ,  71.51133786848072 ,  60.11269274376417 ,  60.689569160997735,  87.56767006802723 ,  88.14454648526078 , 104.63127551020408 , 105.31665532879819 , 124.79198979591837 , 125.60395691609978 , 149.28865646258504 , 150.2525283446712  , 151.9469897959184  , 152.9108616780045  , 128.96937074829933 , 129.78133786848073 , 109.56818027210885 , 110.25356009070295 ,  92.72158163265307 ,  93.29845804988663 , 108.78365646258504 , 109.46903628117913 , 129.94930272108843 , 130.76359410430837 , 154.94335034013608 , 155.90803854875284 , 185.2971598639456  , 186.44232426303853 , 188.45549319727894 , 189.60065759637183 , 159.90644557823128 , 160.87113378684808 , 135.81477891156462 , 136.62907029478455 , 114.90695578231293 , 115.59233560090705 , 135.561037414966   , 136.37300453514737 , 161.89335034013604 , 162.8580385487528  , 192.97073129251703 , 194.11359410430842 , 230.69120748299324 , 232.04787981859408 , 234.43287414965988 , 235.78954648526073 , 198.8504931972789  , 199.9933560090703  , 168.84215986394557 , 169.80684807256236 , 142.81528911564627 , 143.6272562358277  , 170.12437074829933 , 171.08824263038548 , 203.11382653061222 , 204.2589909297052  , 242.02454081632655 , 243.38121315192748 , 289.2250170068028  , 290.8354988662132  , 293.6666836734694  , 295.2771655328798  , 249.00430272108838 , 250.36097505668937 , 211.36263605442173 , 212.50780045351476 , 178.73576530612243 , 179.69963718820867 , 191.391037414966   , 192.3549092970521  , 228.3804931972789  , 229.52565759637184 , 271.95787414965986 , 273.3145464852608  , 324.758350340136   , 326.3688321995465  , 329.2000170068026  , 330.81049886621315 , 278.9376360544217  , 280.2943083900227  , 236.6293027210884  , 237.7744671201814  , 200.0024319727891  , 200.96630385487526 , 168.98008503401363 , 169.79205215419503 , 201.59811224489795 , 202.5628004535147  , 240.00882653061225 , 241.15168934240359 , 286.5293027210884  , 287.88597505668935 , 290.2709693877551  , 291.627641723356   , 245.88858843537412 , 247.03145124716553 , 208.54692176870748 , 209.51160997732424 , 176.23433673469387 , 177.04630385487525 , 148.27889455782312 , 148.96427437641725 , 176.87311224489798 , 177.6874036281179  , 210.53382653061226 , 211.49851473922902 , 251.28763605442177 , 252.43280045351472 , 254.4459693877551  , 255.59113378684805 , 215.4969217687075  , 216.46160997732426 , 182.73858843537417 , 183.55287981859408 , 154.402193877551   , 155.0875736961451  , 128.79896258503402 , 129.37583900226758 , 153.6176700680272  , 154.3030498866213  , 182.82600340136057 , 183.63797052154194 , 218.17981292517007 , 219.14368480725622 , 220.8381462585034  , 221.80201814058955 , 187.00338435374152 , 187.81535147392287 , 158.55457482993197 , 159.23995464852607 , 133.95287414965986 , 134.52975056689343 , 161.4078514739229  , 161.98472789115647 , 192.35989229024943 , 193.0452721088435  , 228.72378117913829 , 229.53574829931972 , 272.6642573696145  , 273.62812925170067 , 275.3225907029479  , 276.286462585034   , 232.90116213151927 , 233.71312925170065 , 197.29679705215418 , 197.98217687074828 , 166.56176303854875 , 167.13863945578228 , 196.51227324263039 , 197.1976530612245  , 234.17859977324264 , 234.99289115646258 , 278.4234410430839  , 279.3881292517007  , 331.87820294784586 , 333.0233673469388  , 335.0365362811792  , 336.1817006802721  , 283.3865362811792  , 284.3512244897959  , 240.0440759637188  , 240.85836734693876 , 202.63557256235828 , 203.32095238095235 , 239.49282879818594 , 240.3047959183674  , 285.3734410430839  , 286.3381292517007  , 339.2571712018142  , 340.4000340136055  , 404.34526643990944 , 405.70193877551026 , 408.0869331065761  , 409.44360544217693 , 345.13693310657607 , 346.2797959183674  , 292.3222505668934  , 293.28693877551024 , 246.7470804988662  , 247.55904761904756 , 293.49997165532875 , 294.463843537415   , 349.6948696145124  , 350.8400340136055  , 415.6785997732427  , 417.03527210884357 , 495.366695011338   , 496.97717687074834 , 499.8083616780047  , 501.418843537415   , 422.65836167800467 , 424.0150340136055  , 357.943679138322   , 359.08884353741496 , 302.111366213152   , 303.075238095238   , 314.76663832199546 , 315.73051020408167 , 374.9615362811792  , 376.1067006802722  , 445.61193310657603 , 446.9686054421769  , 530.9000283446713  , 532.5105102040817  , 535.3416950113381  , 536.9521768707483  , 452.59169501133795 , 453.9483673469387  , 383.2103458049888  , 384.3555102040816  , 323.3780328798186  , 324.3419047619048  , 272.9118764172336  , 273.72384353741495 , 325.07820294784585 , 326.04289115646264 , 386.29526643990937 , 387.43812925170073 , 460.1833616780046  , 461.54003401360546 , 463.9250283446713  , 465.2817006802721  , 392.1750283446713  , 393.31789115646257 , 332.0270124716553  , 332.9917006802721  , 280.1661281179138  , 280.97809523809525 , 236.00751133786846 , 236.69289115646257 , 281.1024092970522  , 281.91670068027213 , 334.01391723356016 , 334.9786054421769  , 397.86867913832214 , 399.01384353741497 , 401.02701247165544 , 402.1721768707483  , 338.97701247165537 , 339.9417006802721  , 286.9678854875283  , 287.7821768707483  , 242.13081065759636 , 242.81619047619049 , 202.63914399092974 , 203.21602040816327 , 241.34628684807257 , 242.03166666666664 , 286.75779478458054 , 287.5697619047619  , 341.55541383219963 , 342.51928571428573 , 344.21374716553294 , 345.1776190476191  , 290.9351757369614  , 291.74714285714293 , 246.28319160997734 , 246.96857142857147 , 207.79305555555555 , 208.36993197278912 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.24489795918367346 , 0.2857142857142857  , 0.14285714285714285 , 0.16326530612244897 , 0.18367346938775508 , 0.2040816326530612  , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.22448979591836732 , 0.24489795918367346 , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.3061224489795918  , 0.32653061224489793 , 0.3469387755102041  , 0.36734693877551017 , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.3877551020408163  , 0.4081632653061224  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.4693877551020408  , 0.4897959183673469  };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  62.446524943310656,  63.258492063492056,  64.07045918367346 ,  64.88242630385488 ,  75.86183106575963 ,  76.82651927437642 ,  77.79120748299319 ,  78.75589569161    ,  92.2257199546485  ,  93.36858276643991 ,  94.51144557823127 ,  95.65430839002266 , 112.71762471655326 , 114.07429705215421 , 115.4309693877551  , 116.78764172335599 , 120.20095804988661 , 121.55763038548754 , 122.91430272108843 , 124.27097505668932 , 103.98524376417232 , 105.12810657596373 , 106.27096938775509 , 107.41383219954648 ,  89.75945011337868 ,  90.72413832199547 ,  91.68882653061223 ,  92.65351473922902 ,  76.9550283446712  ,  77.76699546485261 ,  78.578962585034   ,  79.39092970521541 ,  92.53366780045351 ,  93.49753968253968 ,  94.46141156462583 ,  95.42528344671203 , 111.92040249433107 , 113.06556689342405 , 114.21073129251698 , 115.35589569160999 , 135.38429138321993 , 136.74096371882086 , 138.09763605442174 , 139.45430839002265 , 164.5561961451247  , 166.16667800453513 , 167.77715986394557 , 169.387641723356   , 173.43952947845804 , 175.05001133786845 , 176.66049319727892 , 178.27097505668934 , 149.3438151927438  , 150.70048752834467 , 152.05715986394554 , 153.41383219954645 , 128.4180215419501  , 129.5631859410431  , 130.70835034013604 , 131.853514739229   , 109.75645691609976 , 110.72032879818593 , 111.68420068027211 , 112.64807256235828 , 135.06700113378685 , 136.030873015873   , 136.99474489795915 , 137.95861678004536 , 162.45373582766442 , 163.59890022675737 , 164.74406462585029 , 165.88922902494335 , 195.25095804988663 , 196.60763038548754 , 197.9643027210884  , 199.32097505668935 , 235.62286281179135 , 237.2333446712018  , 238.8438265306122  , 240.4543083900227  , 244.5061961451247  , 246.11667800453512 , 247.72715986394553 , 249.33764172335603 , 209.21048185941046 , 210.56715419501134 , 211.92382653061222 , 213.28049886621315 , 178.95135487528344 , 180.09651927437642 , 181.24168367346937 , 182.38684807256237 , 152.2897902494331  , 153.25366213151926 , 154.21753401360544 , 155.1814058956916  , 129.2846201814059  , 130.0965873015873  , 130.90855442176868 , 131.7205215419501  , 155.27135487528346 , 156.23604308390023 , 157.20073129251696 , 158.1654195011338  , 186.301910430839   , 187.4447732426304  , 188.58763605442172 , 189.73049886621317 , 224.39381519274377 , 225.75048752834468 , 227.10715986394555 , 228.4638321995465  , 231.8771485260771  , 233.233820861678   , 234.59049319727885 , 235.9471655328798  , 198.06143424036284 , 199.2042970521542  , 200.34715986394554 , 201.49002267573698 , 169.1689739229025  , 170.13366213151926 , 171.09835034013605 , 172.06303854875284 , 143.79312358276644 , 144.60509070294785 , 145.41705782312928 , 146.22902494331066 , 120.41517573696144 , 121.10055555555556 , 121.78593537414966 , 122.47131519274376 , 144.47333900226758 , 145.28763038548752 , 146.10192176870743 , 146.91621315192745 , 173.14278344671206 , 174.1074716553288  , 175.07215986394553 , 176.0368480725624  , 208.26802154195013 , 209.41318594104308 , 210.55835034013603 , 211.70351473922906 , 214.5846882086168  , 215.72985260770974 , 216.8750170068027  , 218.0201814058957  , 183.0689739229025  , 184.03366213151926 , 184.99835034013603 , 185.96303854875285 , 156.20429138321995 , 157.0185827664399  , 157.8328741496599  , 158.6471655328798  , 132.6617743764172  , 133.34715419501134 , 134.03253401360547 , 134.71791383219954 , 109.34068594104308 , 109.91756235827664 , 110.49443877551022 , 111.07131519274375 , 131.0927267573696  , 131.77810657596373 , 132.4634863945578  , 133.1488662131519  , 156.9764569160998  , 157.78842403628119 , 158.60039115646254 , 159.41235827664403 , 188.64455215419503 , 189.60842403628118 , 190.5722959183673  , 191.53616780045354 , 193.9612188208617  , 194.92509070294784 , 195.888962585034   , 196.8528344671202  , 165.33121882086166 , 166.14318594104307 , 166.9551530612245  , 167.7671201814059  , 140.96653628117912 , 141.65191609977325 , 142.33729591836737 , 143.02267573696145 , 119.64850907029479 , 120.22538548752834 , 120.8022619047619  , 121.37913832199547 , 174.55846371882086 , 175.13534013605445 , 175.712216553288   , 176.28909297052155 , 208.57717120181402 , 209.26255102040815 , 209.9479308390023  , 210.63331065759638 , 248.77201247165533 , 249.58397959183674 , 250.39594671201817 , 251.20791383219955 , 297.6134410430839  , 298.5773129251701  , 299.5411848072563  , 300.5050566893424  , 302.9301077097505  , 303.8939795918368  , 304.85785147392295 , 305.821723356009   , 257.1267743764172  , 257.93874149659865 , 258.75070861678006 , 259.56267573696147 , 218.45098072562357 , 219.1363605442177  , 219.82174036281177 , 220.5071201814059  , 184.86628684807255 , 185.44316326530614 , 186.02003968253965 , 186.59691609977327 , 216.88193310657596 , 217.56731292517009 , 218.2526927437642  , 218.93807256235826 , 259.0843140589569  , 259.89860544217686 , 260.71289682539685 , 261.52718820861674 , 308.9220124716553  , 309.88670068027216 , 310.851388888889   , 311.8160770975057  , 369.4491553287982  , 370.5943197278912  , 371.7394841269842  , 372.88464852607706 , 375.76582199546476 , 376.9109863945579  , 378.0561507936509  , 379.20131519274366 , 318.8482029478458  , 319.81289115646257 , 320.7775793650794  , 321.74226757369615 , 270.8152664399093  , 271.62955782312923 , 272.44384920634917 , 273.2581405895691  , 229.1285317460317  , 229.81391156462587 , 230.4992913832199  , 231.1846712018141  , 270.3101077097506  , 271.122074829932   , 271.9340419501134  , 272.74600907029475 , 322.82201247165534 , 323.7867006802721  , 324.75138888888887 , 325.7160770975056  , 384.79859977324264 , 385.94146258503406 , 387.0843253968255  , 388.22718820861684 , 460.02574263038554 , 461.38241496598647 , 462.73908730158735 , 464.09575963718817 , 467.5090759637188  , 468.86574829931976 , 470.2224206349207  , 471.57909297052146 , 396.5581235827664  , 397.7009863945578  , 398.8438492063492  , 399.9867120181406  , 336.7196315192744  , 337.68431972789114 , 338.64900793650787 , 339.6136961451247  , 284.81861111111107 , 285.63057823129253 , 286.4425453514739  , 287.2545124716554  , 339.2848696145125  , 340.24874149659865 , 341.21261337868486 , 342.17648526077096 , 405.08248866213154 , 406.22765306122443 , 407.3728174603175  , 408.5179818594104  , 482.69240929705217 , 484.0490816326531  , 485.40575396825403 , 486.76242630385497 , 576.8395521541951  , 578.4500340136055  , 580.0605158730159  , 581.6709977324264  , 585.7228854875283  , 587.3333673469388  , 588.9438492063493  , 590.5543310657596  , 496.651933106576   , 498.00860544217676 , 499.3652777777778  , 500.72195011337874 , 421.5801077097506  , 422.72527210884346 , 423.87043650793646 , 425.0156009070295  , 356.5076587301587  , 357.47153061224486 , 358.435402494331   , 359.39927437641734 , 381.8182029478458  , 382.782074829932   , 383.7459467120182  , 384.7098185941042  , 455.6158219954648  , 456.7609863945578  , 457.90615079365085 , 459.0513151927437  , 542.5590759637189  , 543.9157482993197  , 545.2724206349206  , 546.6290929705216  , 647.9062188208618  , 649.516700680272   , 651.1271825396827  , 652.737664399093   , 656.7895521541951  , 658.4000340136053  , 660.010515873016   , 661.6209977324263  , 556.5185997732426  , 557.8752721088434  , 559.2319444444444  , 560.5886167800454  , 472.11344104308387 , 473.2586054421768  , 474.4037698412698  , 475.5489342403628  , 399.040992063492   , 400.0048639455782  , 400.9687358276644  , 401.9326077097505  , 337.14820294784573 , 337.96017006802725 , 338.77213718820866 , 339.58410430839007 , 402.2315362811791  , 403.1962244897959  , 404.1609126984127  , 405.1256009070294  , 478.87479024943303 , 480.0176530612245  , 481.16051587301587 , 482.30337868480717 , 571.7019331065759  , 573.0586054421768  , 574.4152777777779  , 575.7719501133787  , 579.1852664399094  , 580.5419387755102  , 581.8986111111111  , 583.255283446712   , 490.6343140589569  , 491.77717687074824 , 492.9200396825397  , 494.06290249433107 , 416.12915532879816 , 417.09384353741495 , 418.05853174603175 , 419.0232199546485  , 351.6567063492063  , 352.46867346938774 , 353.28064058956915 , 354.0926077097505  , 295.8724092970521  , 296.55778911564624 , 297.2431689342404  , 297.9285487528345  , 352.93193310657597 , 353.74622448979596 , 354.5605158730159  , 355.3748072562358  , 420.1029648526076  , 421.0676530612245  , 422.03234126984125 , 422.99702947845805 , 501.43010770975053 , 502.57527210884354 , 503.72043650793654 , 504.86560090702943 , 507.7467743764172  , 508.8919387755102  , 510.0371031746032  , 511.1822675736961  , 430.02915532879814 , 430.993843537415   , 431.9585317460317  , 432.9232199546485  , 364.6628854875283  , 365.47717687074834 , 366.2914682539682  , 367.10575963718816 , 308.11900793650796 , 308.804387755102   , 309.4897675736961  , 310.1751473922902  , 257.0210487528344  , 257.59792517006804 , 258.1748015873016  , 258.75167800453517 , 306.54996031746026 , 307.2353401360544  , 307.9207199546485  , 308.6060997732426  , 364.8400396825396  , 365.65200680272113 , 366.4639739229025  , 367.2759410430839  , 435.3957539682539  , 436.35962585034014 , 437.3234977324263  , 438.28736961451244 , 440.7124206349206  , 441.6762925170068  , 442.64016439909295 , 443.6040362811791  , 373.19480158730147 , 374.00676870748305 , 374.81873582766434 , 375.63070294784575 , 316.4237698412698  , 317.10914965986393 , 317.794529478458   , 318.47990929705213 , 267.3288718820861  , 267.9057482993197  , 268.4826247165533  , 269.05950113378685 ,  26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  62.446524943310656,  63.258492063492056,  64.07045918367346 ,  64.88242630385488 ,  75.86183106575963 ,  76.82651927437642 ,  77.79120748299319 ,  78.75589569161    ,  92.2257199546485  ,  93.36858276643991 ,  94.51144557823127 ,  95.65430839002266 , 112.71762471655326 , 114.07429705215421 , 115.4309693877551  , 116.78764172335599 , 120.20095804988661 , 121.55763038548754 , 122.91430272108843 , 124.27097505668932 , 103.98524376417232 , 105.12810657596373 , 106.27096938775509 , 107.41383219954648 ,  89.75945011337868 ,  90.72413832199547 ,  91.68882653061223 ,  92.65351473922902 ,  76.9550283446712  ,  77.76699546485261 ,  78.578962585034   ,  79.39092970521541 ,  92.53366780045351 ,  93.49753968253968 ,  94.46141156462583 ,  95.42528344671203 , 111.92040249433107 , 113.06556689342405 , 114.21073129251698 , 115.35589569160999 , 135.38429138321993 , 136.74096371882086 , 138.09763605442174 , 139.45430839002265 , 164.5561961451247  , 166.16667800453513 , 167.77715986394557 , 169.387641723356   , 173.43952947845804 , 175.05001133786845 , 176.66049319727892 , 178.27097505668934 , 149.3438151927438  , 150.70048752834467 , 152.05715986394554 , 153.41383219954645 , 128.4180215419501  , 129.5631859410431  , 130.70835034013604 , 131.853514739229   , 109.75645691609976 , 110.72032879818593 , 111.68420068027211 , 112.64807256235828 , 135.06700113378685 , 136.030873015873   , 136.99474489795915 , 137.95861678004536 , 162.45373582766442 , 163.59890022675737 , 164.74406462585029 , 165.88922902494335 , 195.25095804988663 , 196.60763038548754 , 197.9643027210884  , 199.32097505668935 , 235.62286281179135 , 237.2333446712018  , 238.8438265306122  , 240.4543083900227  , 244.5061961451247  , 246.11667800453512 , 247.72715986394553 , 249.33764172335603 , 209.21048185941046 , 210.56715419501134 , 211.92382653061222 , 213.28049886621315 , 178.95135487528344 , 180.09651927437642 , 181.24168367346937 , 182.38684807256237 , 152.2897902494331  , 153.25366213151926 , 154.21753401360544 , 155.1814058956916  , 129.2846201814059  , 130.0965873015873  , 130.90855442176868 , 131.7205215419501  , 155.27135487528346 , 156.23604308390023 , 157.20073129251696 , 158.1654195011338  , 186.301910430839   , 187.4447732426304  , 188.58763605442172 , 189.73049886621317 , 224.39381519274377 , 225.75048752834468 , 227.10715986394555 , 228.4638321995465  , 231.8771485260771  , 233.233820861678   , 234.59049319727885 , 235.9471655328798  , 198.06143424036284 , 199.2042970521542  , 200.34715986394554 , 201.49002267573698 , 169.1689739229025  , 170.13366213151926 , 171.09835034013605 , 172.06303854875284 , 143.79312358276644 , 144.60509070294785 , 145.41705782312928 , 146.22902494331066 , 120.41517573696144 , 121.10055555555556 , 121.78593537414966 , 122.47131519274376 , 144.47333900226758 , 145.28763038548752 , 146.10192176870743 , 146.91621315192745 , 173.14278344671206 , 174.1074716553288  , 175.07215986394553 , 176.0368480725624  , 208.26802154195013 , 209.41318594104308 , 210.55835034013603 , 211.70351473922906 , 214.5846882086168  , 215.72985260770974 , 216.8750170068027  , 218.0201814058957  , 183.0689739229025  , 184.03366213151926 , 184.99835034013603 , 185.96303854875285 , 156.20429138321995 , 157.0185827664399  , 157.8328741496599  , 158.6471655328798  , 132.6617743764172  , 133.34715419501134 , 134.03253401360547 , 134.71791383219954 , 109.34068594104308 , 109.91756235827664 , 110.49443877551022 , 111.07131519274375 , 131.0927267573696  , 131.77810657596373 , 132.4634863945578  , 133.1488662131519  , 156.9764569160998  , 157.78842403628119 , 158.60039115646254 , 159.41235827664403 , 188.64455215419503 , 189.60842403628118 , 190.5722959183673  , 191.53616780045354 , 193.9612188208617  , 194.92509070294784 , 195.888962585034   , 196.8528344671202  , 165.33121882086166 , 166.14318594104307 , 166.9551530612245  , 167.7671201814059  , 140.96653628117912 , 141.65191609977325 , 142.33729591836737 , 143.02267573696145 , 119.64850907029479 , 120.22538548752834 , 120.8022619047619  , 121.37913832199547 };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.14285714285714285 , 0.16326530612244897 , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.18367346938775508 , 0.2040816326530612  , 0.22448979591836732 , 0.24489795918367346 , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.44897959183673464 , 0.4897959183673469  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.3061224489795918  , 0.32653061224489793 , 0.3469387755102041  , 0.36734693877551017 , 0.3877551020408163  , 0.4081632653061224  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.4693877551020408  , 0.4897959183673469  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.8571428571428572  , 0.8979591836734693  , 0.9387755102040816  , 0.9795918367346939  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 2.0408163265306123  , 2.1224489795918364  , 1.0204081632653061  , 1.0612244897959182  , 1.1020408163265305  , 1.1428571428571428  , 0.5102040816326531  , 0.5306122448979591  , 0.5510204081632653  , 0.5714285714285714  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 0.5918367346938775  , 0.6122448979591836  , 0.6326530612244897  , 0.6530612244897959  , 0.673469387755102   , 0.6938775510204082  , 0.7142857142857142  , 0.7346938775510203  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 1.4285714285714284  , 1.4693877551020407  , 1.510204081632653   , 1.5510204081632653  , 0.7551020408163265  , 0.7755102040816326  , 0.7959183673469387  , 0.8163265306122448  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 0.836734693877551   , 0.8571428571428571  , 0.8775510204081632  , 0.8979591836734693  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 0.9183673469387754  , 0.9387755102040816  , 0.9591836734693877  , 0.9795918367346939  };
  const std::array<int, 4> in_shape = {{ 3, 8, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  7.882772108843537,   9.66202380952381 ,  11.549778911564626,  13.87874716553288 ,  14.47124716553288 ,  16.30922335600907 ,  14.486604308390024,  12.815856009070295,  11.036604308390022,  12.034812925170067,  14.65079931972789 ,  17.395697278911566,  20.748475056689344,  21.276689342403625,  23.63609410430839 ,  20.884903628117918,  18.39782879818594 ,  15.781842403628119,  18.0181462585034  ,  21.824608843537412,  25.783792517006805,  30.581014739229026,  30.959229024943305,  34.001967120181405,  29.9174433106576  ,  26.263701814058955,  22.457239229024943,  26.56528911564626 ,  32.057465986394554,  37.73093537414966 ,  44.561490929705215,  44.66970521541949 ,  48.62244331065759 ,  42.63791950113379 ,  37.32703514739229 ,  31.834858276643992,  38.52778911564626 ,  46.26996598639456 ,  54.193435374149665,  63.64899092970522 ,  62.969705215419495,  67.7099433106576  ,  59.10041950113378 ,  51.539535147392286,  43.79735827664399 ,  36.81636054421769 ,  44.158537414965984,  51.653435374149666,  60.57565759637188 ,  59.71637188208616 ,  63.996609977324255,  55.78708616780045 ,  48.59763038548753 ,  41.25545351473922 ,  34.2508843537415  ,  41.04544217687076 ,  47.968911564625856,  56.19668934240362 ,  55.262403628117916,  59.08430839002267 ,  51.458117913832204,  44.79247165532879 ,  37.99791383219955 ,  31.075374149659865,  37.21687074829932 ,  43.46687074829933 ,  50.88512471655329 ,  49.95083900226758 ,  53.315600907029484,  46.40369614512471 ,  40.37070294784581 ,  34.22920634920635 ,  49.417874149659866,  59.00937074829932 ,  68.70937074829932 ,  80.15262471655328 ,  78.01083900226757 ,  82.58310090702949 ,  71.64619614512472 ,  62.1632029478458  ,  52.571706349206345,  61.38215986394559 ,  73.27977891156463 ,  85.30630952380952 ,  99.48765873015871 ,  96.76730158730159 , 102.3752777777778  ,  88.79551587301589 ,  77.02680839002267 ,  65.12918934240362 ,  76.47977891156464 ,  91.28215986394558 , 106.2372619047619  , 123.86305555555553 , 120.39269841269841 , 127.28400793650795 , 110.37091269841271 ,  95.72125283446711 ,  80.91887188208617 ,  95.96406462585034 , 114.50930272108843 , 133.23583333333332 , 155.29496031746032 , 150.8346031746032  , 159.35591269841274 , 138.14281746031747 , 119.77887188208616 , 101.23363378684807 , 107.92656462585033 , 128.7218027210884  , 149.69833333333335 , 174.3824603174603  , 169.13460317460317 , 178.4434126984127  , 154.60531746031745 , 133.99137188208618 , 113.19613378684808 ,  95.27799319727889 , 113.61608843537414 , 132.10690476190476 , 153.8576984126984  , 149.14984126984126 , 157.2786507936508  , 136.24055555555557 , 118.05518140589571 ,  99.71708616780047 ,  83.59823129251699 ,  99.67442176870746 , 115.8795238095238  , 134.935873015873   , 130.75301587301587 , 137.82349206349207 , 119.36873015873016 , 103.42145124716554 ,  87.34526077097506 ,  72.61047619047618 ,  86.56421768707482 , 100.62646258503399 , 117.1590022675737  , 113.49043083900226 , 119.58947845804988 , 103.56328798185942 ,  89.71804988662133 ,  75.76430839002268 ,  90.95297619047618 , 108.35671768707482 , 125.86896258503401 , 146.4265022675737  , 141.55043083900227 , 148.85697845804984 , 128.8057879818594  , 111.51054988662132 ,  94.10680839002268 , 110.72950680272108 , 131.90875850340134 , 153.21692176870746 , 178.22684240362813 , 172.25791383219953 , 181.1144614512471  , 156.7061281179138  , 135.65578798185942 , 114.47653628117914 , 134.94141156462584 , 160.73971088435374 , 186.690731292517   , 217.14509637188212 , 209.82616780045353 , 220.56604875283443 , 190.8243820861678  , 165.1788038548753  , 139.3805045351474  , 165.3628401360544  , 196.9611394557823  , 228.74073129251698 , 266.02842970521544 , 256.99950113378685 , 270.0893820861678  , 233.64771541950114 , 202.23070861678008 , 170.63240929705216 , 177.3253401360544  , 211.17363945578228 , 245.203231292517   , 285.11592970521536 , 275.29950113378686 , 289.17688208616784 , 250.11021541950115 , 216.44320861678005 , 182.5949092970521  , 153.7396258503401  , 183.0736394557823  , 212.56037414965985 , 247.13973922902494 , 238.58331065759634 , 250.5606916099773  , 216.69402494331064 , 187.51273242630384 , 158.17871882086166 , 132.94557823129253 , 158.30340136054423 , 183.79013605442177 , 213.67505668934237 , 206.24362811791383 , 216.56267573696144 , 187.27934240362808 , 162.05043083900222 , 136.69260770975058 , 114.14557823129253 , 135.91156462585036 , 157.7860544217687  , 183.4328798185941  , 177.03002267573694 , 185.86335600907026 , 160.72287981859407 , 139.06539682539682 , 117.29941043083902 };
  const std::array<int, 4> in_shape = {{ 3, 8, 9, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.10204081632653061 , 0.061224489795918366, 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.08163265306122448 , 0.18367346938775508 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.22448979591836732 , 0.12244897959183673 , 0.14285714285714285 , 0.30612244897959184 , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.346938775510204   , 0.18367346938775508 , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.2040816326530612  , 0.4285714285714285  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 , 0.26530612244897955 , 0.5510204081632653  , 0.857142857142857   , 0.857142857142857   , 0.857142857142857   , 0.857142857142857   , 0.857142857142857   , 0.5918367346938775  , 0.3061224489795918  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.32653061224489793 , 0.673469387755102   , 1.0408163265306123  , 1.0408163265306123  , 1.0408163265306123  , 1.0408163265306123  , 1.0408163265306123  , 0.7142857142857142  , 0.36734693877551017 };
  const std::array<int, 4> in_shape = {{ 3, 8, 9, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 15.188667800453512,  15.765544217687074,  18.63866780045351 ,  19.32404761904762 ,  22.3056746031746  ,  23.099557823129253,  26.837023809523814,  27.75749433106576 ,  28.060000000000002,  28.94249433106576 ,  31.697976190476187,  32.61844671201814 ,  28.179325396825394,  28.97320861678005 ,  24.946332199546482,  25.63171201814059 ,  21.496332199546483,  22.073208616780043,  23.384246031746027,  24.069625850340135,  28.487307256235823,  29.30159863945578 ,  33.84819160997732 ,  34.79139455782313 ,  40.403350340136065,  41.49695011337869 ,  41.50489795918368 ,  42.55337868480725 ,  46.17858843537415 ,  47.27218820861678 ,  40.826604308390024,  41.769807256235836,  35.98136621315193 ,  36.79565759637188 ,  30.878304988662126,  31.563684807256237,  35.22432539682539 ,  36.0362925170068  ,  42.68452947845804 ,  43.649217687074824,  50.45017573696144 ,  51.56758503401361 ,  59.8664455782313  ,  61.16202947845805 ,  60.67632653061225 ,  61.91845804988661 ,  66.70835034013605 ,  68.00393424036281 ,  58.717477324263044,  59.8348866213152  ,  51.56271541950114 ,  52.52740362811791 ,  44.10251133786848 ,  44.914478458049885,  52.16670634920634 ,  53.13057823129252 ,  62.96976757369613 ,  64.11493197278911 ,  74.13541383219955 ,  75.46187074829932 ,  87.58501700680273 ,  89.12298185941043 ,  87.8648979591837  ,  89.33941043083898 ,  95.70692176870749 ,  97.24488662131517 ,  83.94938208616782 ,  85.27583900226757 ,  73.50890589569161 ,  74.65407029478457 ,  62.70584467120181 ,  63.669716553287984,  76.09170634920633 ,  77.05557823129251 ,  91.39476757369613 ,  92.53993197278912 , 107.06041383219953 , 108.38687074829933 , 125.76001700680273 , 127.29798185941044 , 124.46489795918367 , 125.93941043083899 , 133.88192176870749 , 135.4198866213152  , 116.8743820861678  , 118.20083900226756 , 101.9339058956916  , 103.07907029478457 ,  86.63084467120181 ,  87.59471655328798 ,  72.82075396825397 ,  73.63272108843537 ,  87.35238662131518 ,  88.31707482993197 , 102.18946145124715 , 103.30687074829933 , 119.855731292517   , 121.15131519274377 , 118.19061224489795 , 119.43274376417232 , 126.69763605442176 , 127.99321995464851 , 110.45676303854874 , 111.5741723356009  ,  96.23057256235828 ,  97.19526077097505 ,  81.69893990929705 ,  82.51090702947845 ,  67.8163888888889  ,  68.501768707483   ,  81.27659297052153 ,  82.09088435374152 ,  94.99462018140588 ,  95.93782312925171 , 111.29977891156462 , 112.39337868480725 , 109.47632653061224 , 110.52480725623583 , 117.07501700680271 , 118.16861678004534 , 101.97303287981859 , 102.91623582766441 ,  88.77065192743764 ,  89.58494331065758 ,  75.31044784580499 ,  75.9958276643991  ,  61.57387188208617 ,  62.15074829931973 ,  73.74836167800453 ,  74.43374149659864 ,  86.13985827664398 ,  86.93374149659866 , 100.84977891156461 , 101.77024943310659 ,  99.01918367346937 ,  99.90167800453516 , 105.710731292517   , 106.63120181405897 ,  92.01350907029477 ,  92.80739229024942 ,  80.0560260770975  ,  80.74140589569161 ,  67.88153628117914 ,  68.4584126984127  ,  98.25887188208615 ,  98.83574829931973 , 117.33336167800454 , 118.01874149659864 , 136.62485827664398 , 137.41874149659864 , 159.3847789115646  , 160.30524943310655 , 155.13918367346935 , 156.02167800453515 , 164.24573129251698 , 165.16620181405898 , 142.4985090702948  , 143.29239229024944 , 123.64102607709751 , 124.3264058956916  , 104.56653628117914 , 105.14341269841269 , 122.07893990929703 , 122.76431972789118 , 145.7452664399093  , 146.55955782312927 , 169.66941609977323 , 170.61261904761903 , 197.88171768707483 , 198.97531746031743 , 192.48612244897956 , 193.53460317460318 , 203.6569557823129  , 204.7505555555556  , 176.64782879818597 , 177.59103174603177 , 153.23932539682542 , 154.05361678004533 , 129.57299886621314 , 130.25837868480724 , 152.14759070294784 , 152.95955782312927 , 181.59963151927437 , 182.56431972789116 , 211.35711451247164 , 212.4745238095238  , 246.43052721088435 , 247.72611111111107 , 239.54326530612244 , 240.78539682539682 , 253.27243197278912 , 254.5680158730159  , 219.6244160997733  , 220.74182539682542 , 190.4778174603175  , 191.44250566893422 , 161.02577664399095 , 161.83774376417233 , 190.9642573696145  , 191.92812925170068 , 227.8734410430839  , 229.01860544217686 , 265.1452097505669  , 266.47166666666664 , 309.05195578231286 , 310.58992063492065 , 300.194693877551   , 301.6692063492064  , 317.1738605442177  , 318.7118253968255  , 274.9591780045352  , 276.28563492063495 , 238.4125793650794  , 239.55774376417233 , 201.50339569161    , 202.46726757369615 , 214.8892573696145  , 215.85312925170066 , 256.29844104308387 , 257.4436054421768  , 298.07020975056685 , 299.3966666666667  , 347.2269557823129  , 348.7649206349206  , 336.7946938775511  , 338.26920634920634 , 355.34886054421776 , 356.8868253968254  , 307.8841780045352  , 309.2106349206349  , 266.83757936507936 , 267.98274376417237 , 225.42839569160995 , 226.39226757369616 , 189.74401927437646 , 190.55598639455778 , 226.26748866213154 , 227.23217687074828 , 263.0964002267574  , 264.2138095238095  , 306.4198129251701  , 307.7153968253968  , 297.05755102040814 , 298.2996825396825  , 313.26171768707485 , 314.5573015873016  , 271.3637018140589  , 272.48111111111115 , 235.1456746031746  , 236.11036281179142 , 198.62220521541946 , 199.43417233560095 , 166.51108276643993 , 167.19646258503397 , 198.53455215419504 , 199.34884353741492 , 230.81584467120183 , 231.7590476190476  , 268.77814625850345 , 269.871746031746   , 260.4575510204082  , 261.50603174603174 , 274.5533843537415  , 275.64698412698414 , 237.7942573696145  , 238.73746031746032 , 206.02861111111108 , 206.84290249433107 , 174.005141723356   , 174.69052154195012 , 144.64407596371882 , 145.22095238095235 , 172.4430555555556  , 173.12843537414963 , 200.4590419501134  , 201.25292517006798 , 233.39753401360545 , 234.3180045351474  , 226.0983673469388  , 226.98086167800452 , 238.25848639455782 , 239.17895691609976 , 206.33269274376414 , 207.12657596371884 , 178.7507199546485  , 179.43609977324266 , 150.9517403628118  , 151.52861678004535 , 181.32907596371885 , 181.90595238095236 , 216.0280555555555  , 216.71343537414964 , 250.94404195011336 , 251.73792517006802 , 291.93253401360545 , 292.8530045351474  , 282.2183673469388  , 283.10086167800455 , 296.7934863945578  , 297.7139569160997  , 256.81769274376416 , 257.6115759637188  , 222.33571995464854 , 223.02109977324264 , 187.63674036281185 , 188.21361678004536 , 220.7736337868481  , 221.45901360544215 , 263.0032256235827  , 263.8175170068027  , 305.4906405895691  , 306.43384353741493 , 355.36008503401365 , 356.45368480725625 , 343.4673469387755  , 344.51582766439907 , 361.1353231292517  , 362.2289229024942  , 312.46905328798186 , 313.4122562358276  , 270.4972845804989  , 271.31157596371884 , 228.26769274376426 , 228.95307256235827 , 269.0708560090703  , 269.8828231292517  , 320.5147335600907  , 321.4794217687075  , 372.2640532879819  , 373.381462585034   , 432.9946088435375  , 434.29019274376424 , 418.4102040816327  , 419.65233560090707 , 439.8365136054422  , 441.13209750566887 , 380.53135487528345 , 381.6487641723356  , 329.3929195011338  , 330.3576077097506  , 277.94904195011344 , 278.7610090702948  , 329.76180839002274 , 330.7256802721088  , 392.77711451247166 , 393.9222789115646  , 456.1550056689343  , 457.48146258503397 , 530.5188945578232  , 532.0568594104309  , 512.5244897959184  , 513.9990022675737  , 538.6407993197279  , 540.1787641723356  , 465.9689739229025  , 467.2954308390023  , 403.3162528344671  , 404.46141723356016 , 340.3009467120182  , 341.2648185941043  , 353.68680839002263 , 354.6506802721088  , 421.20211451247155 , 422.34727891156456 , 489.0800056689343  , 490.406462585034   , 568.6938945578232  , 570.2318594104307  , 549.1244897959184  , 550.5990022675737  , 576.815799319728   , 578.3537641723357  , 498.8939739229025  , 500.2204308390023  , 431.7412528344671  , 432.8864172335601  , 364.2259467120182  , 365.1898185941042  , 306.6672845804988  , 307.4792517006802  , 365.1825907029478  , 366.1472789115646  , 424.0033390022676  , 425.1207482993197  , 492.98389455782313 , 494.2794784580499  , 475.92448979591836 , 477.1666213151927  , 499.8257993197278  , 501.1213832199546  , 432.2706405895691  , 433.3880498866213  , 374.06077664399095 , 375.0254648526077  , 315.5454705215419  , 316.3574376417233  , 265.205776643991   , 265.89115646258506 , 315.79251133786846 , 316.60680272108846 , 366.6370691609977  , 367.58027210884353 , 426.25651360544214 , 427.35011337868474 , 411.43877551020404 , 412.48725623582766 , 432.0317517006802  , 433.1253514739229  , 373.6154818594104  , 374.55868480725616 , 323.2865702947846  , 324.10086167800443 , 272.699835600907   , 273.38521541950115 , 227.71428004535147 , 228.29115646258506 , 271.1377494331066  , 271.8231292517007  , 314.7782256235828  , 315.5721088435374  , 365.9452891156463  , 366.8657596371882  , 353.17755102040815 , 354.0600453514739  , 370.8062414965986  , 371.7267120181405  , 320.65187641723355 , 321.44575963718813 , 277.4454138321995  , 278.13079365079363 , 234.02194444444444 , 234.59882086167804 };
  const std::array<int, 4> in_shape = {{ 3, 8, 9, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.16326530612244897, 0.20408163265306123, 0.1020408163265306 , 0.12244897959183673, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.14285714285714285, 0.16326530612244897, 0.32653061224489793, 0.36734693877551017, 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.5510204081632653 , 0.6122448979591837 , 0.4081632653061224 , 0.44897959183673464, 0.22448979591836732, 0.24489795918367346, 0.26530612244897955, 0.2857142857142857 , 0.5714285714285714 , 0.6122448979591837 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.6530612244897959 , 0.693877551020408  , 0.3469387755102041 , 0.36734693877551017, 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.6530612244897959 , 0.693877551020408  , 1.3877551020408163 , 1.4693877551020407 , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 2.204081632653061  , 2.326530612244898  , 1.5510204081632653 , 1.6326530612244898 , 0.8163265306122449 , 0.8571428571428571 , 0.3877551020408163 , 0.4081632653061224 , 0.8163265306122449 , 0.857142857142857  , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 0.8979591836734693 , 0.9387755102040816 , 0.4693877551020408 , 0.4897959183673469 , 0.5102040816326531 , 0.5306122448979591 , 1.0612244897959182 , 1.1020408163265305 , 1.6530612244897958 , 1.714285714285714  , 1.6530612244897958 , 1.714285714285714  , 1.6530612244897958 , 1.714285714285714  , 1.6530612244897958 , 1.714285714285714  , 1.6530612244897958 , 1.714285714285714  , 1.1428571428571428 , 1.183673469387755  , 0.5918367346938775 , 0.6122448979591836 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 0.6326530612244897 , 0.6530612244897959 , 1.3061224489795917 , 1.346938775510204  , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 1.387755102040816  , 1.4285714285714284 , 0.7142857142857142 , 0.7346938775510203 };
  const std::array<int, 4> in_shape = {{ 3, 8, 9, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 29.800459183673464,  30.377335600907024,  30.954212018140588,  31.531088435374148,  36.59195578231292 ,  37.27733560090702 ,  37.96271541950113 ,  38.64809523809524 ,  43.81746598639456 ,  44.6113492063492  ,  45.405232426303854,  46.199115646258505,  52.75357709750567 ,  53.67404761904763 ,  54.594518140589564,  55.51498866213152 ,  55.23750566893423 ,  56.120000000000005,  57.00249433106575 ,  57.88498866213152 ,  62.47548185941042 ,  63.39595238095237 ,  64.31642290249434 ,  65.23689342403628 ,  55.56476757369614 ,  56.35865079365079 ,  57.15253401360544 ,  57.9464172335601  ,  49.20728458049886 ,  49.892664399092965,  50.57804421768707 ,  51.26342403628118 ,  42.4157879818594  ,  42.992664399092966,  43.56954081632652 ,  44.146417233560086,  46.08311224489796 ,  46.768492063492054,  47.45387188208617 ,  48.13925170068027 ,  56.1603231292517  ,  56.974614512471646,  57.788905895691606,  58.60319727891156 ,  66.75318027210885 ,  67.69638321995464 ,  68.63958616780045 ,  69.58278911564626 ,  79.71310090702949 ,  80.80670068027213 ,  81.90030045351473 ,  82.99390022675738 ,  81.96131519274377 ,  83.00979591836736 ,  84.05827664399091 ,  85.1067573696145  ,  91.26357709750566 ,  92.3571768707483  ,  93.45077664399092 ,  94.54437641723356 ,  80.71000566893422 ,  81.65320861678005 ,  82.59641156462584 ,  83.53961451247167 ,  71.14844104308389 ,  71.96273242630386 ,  72.7770238095238  ,  73.59131519274376 ,  61.07123015873015 ,  61.75660997732425 ,  62.44198979591836 ,  63.127369614512475,  69.63668367346938 ,  70.44865079365078 ,  71.26061791383219 ,  72.0725850340136  ,  84.40437074829931 ,  85.36905895691608 ,  86.33374716553288 ,  87.29843537414965 ,  99.78294217687076 , 100.90035147392288 , 102.01776077097504 , 103.13517006802722 , 118.43730725623585 , 119.7328911564626  , 121.02847505668933 , 122.3240589569161  , 120.11052154195012 , 121.3526530612245  , 122.59478458049884 , 123.83691609977322 , 132.12111678004533 , 133.4167006802721  , 134.71228458049885 , 136.00786848072562 , 116.3175453514739  , 117.43495464852609 , 118.55236394557821 , 119.6697732426304  , 102.16074263038549 , 103.12543083900228 , 104.09011904761903 , 105.05480725623582 ,  87.39305555555555 ,  88.20502267573696 ,  89.01698979591835 ,  89.82895691609977 , 103.36954081632652 , 104.33341269841269 , 105.29728458049885 , 106.26115646258503 , 124.79437074829933 , 125.93953514739226 , 127.08469954648525 , 128.22986394557822 , 146.94437074829932 , 148.2708276643991  , 149.59728458049887 , 150.92374149659864 , 173.63206916099776 , 175.17003401360546 , 176.7079988662131  , 178.24596371882086 , 174.255283446712   , 175.7297959183674  , 177.20430839002262 , 178.67882086167796 , 189.87587868480722 , 191.41384353741498 , 192.95180839002265 , 194.48977324263035 , 166.5723072562358  , 167.89876417233563 , 169.22522108843535 , 170.55167800453515 , 145.87264739229025 , 147.01781179138322 , 148.16297619047617 , 149.30814058956915 , 124.44781746031745 , 125.41168934240362 , 126.37556122448976 , 127.33943310657597 , 151.21954081632654 , 152.18341269841267 , 153.14728458049885 , 154.11115646258503 , 181.64437074829937 , 182.78953514739226 , 183.9346995464852  , 185.07986394557824 , 212.79437074829934 , 214.12082766439906 , 215.44728458049886 , 216.77374149659866 , 249.98206916099775 , 251.52003401360545 , 253.05799886621313 , 254.59596371882088 , 247.45528344671206 , 248.92979591836735 , 250.40430839002266 , 251.87882086167798 , 266.22587868480724 , 267.76384353741497 , 269.30180839002264 , 270.8397732426304  , 232.42230725623583 , 233.7487641723356  , 235.07522108843534 , 236.4016780045351  , 202.72264739229024 , 203.8678117913832  , 205.01297619047617 , 206.15814058956914 , 172.29781746031748 , 173.26168934240363 , 174.22556122448978 , 175.18943310657596 , 144.82954081632653 , 145.64150793650794 , 146.45347505668934 , 147.26544217687075 , 173.74008503401365 , 174.70477324263035 , 175.66946145124712 , 176.63414965986394 , 203.2615136054422  , 204.3789229024943  , 205.49633219954646 , 206.61374149659866 , 238.41587868480727 , 239.711462585034   , 241.00704648526076 , 242.30263038548753 , 235.13909297052157 , 236.3812244897959  , 237.62335600907025 , 238.86548752834463 , 252.09968820861678 , 253.39527210884353 , 254.69085600907025 , 255.98643990929702 , 219.79611678004537 , 220.9135260770975  , 222.03093537414964 , 223.1483446712018  , 191.4964569160998  , 192.46114512471655 , 193.42583333333332 , 194.3905215419501  , 162.5859126984127  , 163.3978798185941  , 164.20984693877548 , 165.0218140589569  , 134.9473979591837  , 135.6327777777778  , 136.31815759637186 , 137.003537414966   , 161.73889455782316 , 162.55318594104307 , 163.367477324263   , 164.18176870748303 , 189.046037414966   , 189.98924036281176 , 190.93244331065756 , 191.87564625850342 , 221.50595804988663 , 222.59955782312923 , 223.69315759637183 , 224.7867573696145  , 217.90417233560095 , 218.95265306122448 , 220.00113378684804 , 221.04961451247166 , 233.05643424036282 , 234.15003401360542 , 235.24363378684805 , 236.33723356009068 , 203.00286281179137 , 203.94606575963718 , 204.88926870748296 , 205.83247165532882 , 176.72701247165534 , 177.54130385487528 , 178.35559523809522 , 179.16988662131516 , 149.93551587301587 , 150.62089569160997 , 151.30627551020405 , 151.9916553287982  , 122.57086734693878 , 123.14774376417235 , 123.7246201814059  , 124.30149659863946 , 146.81134353741498 , 147.49672335600906 , 148.18210317460316 , 148.86748299319729 , 171.48583333333335 , 172.27971655328795 , 173.07359977324262 , 173.8674829931973  , 200.77908730158728 , 201.69955782312923 , 202.62002834467117 , 203.54049886621317 , 197.15587301587303 , 198.03836734693874 , 198.9208616780045  , 199.8033560090703  , 210.50099206349208 , 211.421462585034   , 212.34193310657594 , 213.26240362811794 , 183.2331349206349  , 184.02701814058955 , 184.82090136054418 , 185.61478458049885 , 159.42667233560093 , 160.112052154195   , 160.7974319727891  , 161.48281179138323 , 135.1861961451247  , 135.76307256235827 , 136.33994897959184 , 136.9168253968254  , 195.94086734693877 , 196.5177437641723  , 197.09462018140582 , 197.67149659863946 , 233.98134353741494 , 234.66672335600907 , 235.35210317460312 , 236.03748299319727 , 272.4558333333333  , 273.24971655328795 , 274.0435997732426  , 274.8374829931973  , 317.8490873015873  , 318.7695578231292  , 319.6900283446712  , 320.6104988662131  , 309.39587301587306 , 310.2783673469387  , 311.16086167800444 , 312.0433560090703  , 327.5709920634921  , 328.49146258503396 , 329.41193310657593 , 330.33240362811796 , 284.20313492063497 , 284.9970181405896  , 285.7909013605442  , 286.5847845804989  , 246.59667233560094 , 247.28205215419501 , 247.96743197278911 , 248.6528117913832  , 208.55619614512472 , 209.13307256235828 , 209.70994897959184 , 210.28682539682538 , 243.47250000000003 , 244.15787981859407 , 244.8432596371881  , 245.52863945578235 , 290.6762414965986  , 291.4905328798186  , 292.3048242630384  , 293.11911564625854 , 338.39562925170065 , 339.33883219954646 , 340.2820351473922  , 341.22523809523807 , 394.66983560090705 , 395.76343537414965 , 396.85703514739225 , 397.95063492063485 , 383.9237641723356  , 384.9722448979591  , 386.0207256235826  , 387.06920634920635 , 406.22031179138327 , 407.3139115646258  , 408.4075113378684  , 409.5011111111112  , 352.35245464852613 , 353.29565759637194 , 354.2388605442177  , 355.18206349206355 , 305.6643594104308  , 306.47865079365084 , 307.2929421768707  , 308.10723356009066 , 258.4606179138322  , 259.1459977324263  , 259.8313775510204  , 260.5167573696145  , 303.4832142857143  , 304.2951814058957  , 305.10714852607697 , 305.91911564625855 , 362.23457482993194 , 363.19926303854874 , 364.16395124716536 , 365.1286394557823  , 421.59681972789116 , 422.7142290249433  , 423.83163832199534 , 424.9490476190476  , 491.565470521542   , 492.8610544217687  , 494.1566383219954  , 495.45222222222213 , 477.84439909297055 , 479.08653061224487 , 480.3286621315191  , 481.57079365079363 , 505.24928004535155 , 506.54486394557824 , 507.8404478458049  , 509.1360317460318  , 438.1314229024944  , 439.2488321995466  , 440.3662414965986  , 441.48365079365084 , 379.9909467120181  , 380.955634920635   , 381.92032312925164 , 382.88501133786843 , 321.2395861678005  , 322.0515532879819  , 322.86352040816325 , 323.67548752834466 , 349.26940476190487 , 350.2332766439909  , 351.197148526077   , 352.1610204081633  , 408.27790816326535 , 409.42307256235824 , 410.5682369614511  , 411.71340136054425 , 468.01158163265313 , 469.33803854875276 , 470.6644954648525  , 471.99095238095236 , 538.5468990929706  , 540.0848639455783  , 541.622828798186   , 543.1607936507936  , 500.41582766439916 , 501.89034013605436 , 503.36485260770957 , 504.8393650793651  , 508.71070861678015 , 510.24867346938777 , 511.7866383219954  , 513.3246031746032  , 441.55951814058966 , 442.88597505668946 , 444.2124319727891  , 445.53888888888895 , 383.2761848072562  , 384.4213492063493  , 385.56651360544214 , 386.7116780045351  , 324.2676814058957  , 325.2315532879819  , 326.19542517006806 , 327.15929705215416 , 299.9003571428573  , 300.86422902494326 , 301.82810090702947 , 302.79197278911573 , 349.6231462585034  , 350.7683106575963  , 351.91347505668926 , 353.0586394557823  , 400.07110544217693 , 401.39756235827656 , 402.72401927437636 , 404.0504761904763  , 459.77308956916113 , 461.3110544217687  , 462.84901927437636 , 464.38698412698415 , 424.89201814058964 , 426.3665306122449  , 427.8410430839001  , 429.3155555555556  , 429.9368990929705  , 431.4748639455783  , 433.0128287981859  , 434.5507936507936  , 373.6190419501134  , 374.9454988662132  , 376.2719557823129  , 377.59841269841263 , 324.6214229024943  , 325.7665873015873  , 326.9117517006802  , 328.0569160997732  , 274.89863378684805 , 275.8625056689342  , 276.82637755102036 , 277.79024943310645 , 249.76178571428574 , 250.57375283446717 , 251.3857199546485  , 252.19768707482993 , 289.74171768707487 , 290.7064058956916  , 291.6710941043084  , 292.63578231292524 , 330.3325340136055  , 331.44994331065755 , 332.5673526077098  , 333.68476190476196 , 378.4011848072563  , 379.69676870748293 , 380.99235260770973 , 382.28793650793654 , 345.65011337868486 , 346.8922448979591  , 348.1343764172335  , 349.376507936508   , 346.00499433106586 , 347.3005782312925  , 348.59616213151924 , 349.89174603174604 , 300.7871371882086  , 301.90454648526077 , 303.0219557823129  , 304.13936507936506 , 261.418089569161   , 262.38277777777773 , 263.34746598639447 , 264.3121541950114  , 221.43815759637184 , 222.25012471655324 , 223.06209183673462 , 223.87405895691612 , 203.4225           , 204.1078798185941  , 204.79325963718816 , 205.47863945578231 , 234.42624149659864 , 235.24053287981863 , 236.0548242630385  , 236.8691156462585  , 265.9456292517006  , 266.88883219954647 , 267.8320351473923  , 268.77523809523814 , 303.31983560090697 , 304.4134353741496  , 305.5070351473923  , 306.60063492063495 , 272.6437641723356  , 273.69224489795914 , 274.74072562358276 , 275.7892063492064  , 268.7903117913832  , 269.8839115646258  , 270.9775113378684  , 272.07111111111107 , 233.82245464852608 , 234.76565759637188 , 235.7088605442176  , 236.65206349206352 , 203.33435941043086 , 204.14865079365077 , 204.96294217687068 , 205.7772335600907  , 172.3306179138322  , 173.01599773242629 , 173.70137755102036 , 174.3867573696145  , 159.79698979591836 , 160.37386621315193 , 160.95074263038546 , 161.52761904761903 , 182.3721598639456  , 183.0575396825397  , 183.74291950113374 , 184.4282993197279  , 205.38134353741495 , 206.17522675736961 , 206.9691099773242  , 207.76299319727892 , 232.73174036281176 , 233.65221088435374 , 234.57268140589562 , 235.49315192743768 , 204.09138321995465 , 204.9738775510204  , 205.8563718820861  , 206.7388662131519  , 196.37364512471655 , 197.2941156462585  , 198.21458616780038 , 199.1350566893424  , 171.04864512471656 , 171.8425283446712  , 172.63641156462577 , 173.43029478458052 , 148.90748866213153 , 149.5928684807256  , 150.27824829931967 , 150.96362811791386 , 126.33231859410428 , 126.90919501133786 , 127.48607142857144 , 128.06294784580498 ,  66.72054988662133 ,  67.29742630385488 ,  67.87430272108844 ,  68.45117913832199 ,  80.45626417233561 ,  81.14164399092971 ,  81.82702380952381 ,  82.51240362811791 ,  94.62599206349208 ,  95.4198752834467  ,  96.21375850340137 ,  97.007641723356   , 111.66369047619047 , 112.58416099773241 , 113.50463151927437 , 114.42510204081633 , 111.71714285714285 , 112.59963718820862 , 113.48213151927438 , 114.36462585034012 , 121.38559523809525 , 122.30606575963719 , 123.22653628117914 , 124.14700680272108 , 106.37329365079364 , 107.16717687074828 , 107.96106009070293 , 108.75494331065758 ,  93.07159297052155 ,  93.75697278911564 ,  94.44235260770975 ,  95.12773242630387 ,  79.33587868480726 ,  79.91275510204082 ,  80.48963151927437 ,  81.06650793650793 ,  89.94742063492065 ,  90.63280045351473 ,  91.31818027210885 ,  92.00356009070295 , 108.2749716553288  , 109.08926303854875 , 109.9035544217687  , 110.71784580498864 , 127.11816893424037 , 128.06137188208615 , 129.00457482993198 , 129.94777777777776 , 149.70348639455779 , 150.79708616780044 , 151.89068594104307 , 152.98428571428573 , 149.06408163265303 , 150.11256235827668 , 151.1610430839002  , 152.2095238095238  , 161.25396258503403 , 162.3475623582767  , 163.44116213151926 , 164.53476190476192 , 141.07499433106574 , 142.01819727891154 , 142.96140022675732 , 143.90460317460315 , 123.26308956916101 , 124.07738095238093 , 124.89167233560089 , 125.70596371882087 , 104.93553854875285 , 105.62091836734693 , 106.30629818594103 , 106.99167800453515 , 121.60257936507936 , 122.41454648526076 , 123.2265136054422  , 124.03848072562359 , 146.14441609977325 , 147.10910430839002 , 148.0737925170068  , 149.03848072562357 , 171.29713718820864 , 172.41454648526076 , 173.53195578231293 , 174.64936507936508 , 201.35467687074828 , 202.65026077097505 , 203.9458446712018  , 205.2414285714286  , 199.60693877551017 , 200.8490702947846  , 202.09120181405893 , 203.3333333333333  , 215.03848639455782 , 216.33407029478462 , 217.6296541950113  , 218.92523809523806 , 187.83174036281176 , 188.94914965986393 , 190.06655895691603 , 191.1839682539682  , 163.9007879818594  , 164.8654761904762  , 165.83016439909295 , 166.79485260770971 , 139.35895124716552 , 140.17091836734693 , 140.98288548752834 , 141.79485260770974 , 165.05734126984126 , 166.0212131519274  , 166.9850850340136  , 167.94895691609977 , 198.08489229024946 , 199.23005668934238 , 200.37522108843535 , 201.52038548752833 , 231.83761337868484 , 233.16407029478455 , 234.49052721088432 , 235.81698412698412 , 272.0618197278912  , 273.5997845804988  , 275.13774943310653 , 276.6757142857143  , 268.62408163265303 , 270.0985941043084  , 271.57310657596366 , 273.04761904761904 , 288.3056292517007  , 289.8435941043084  , 291.381558956916   , 292.9195238095238  , 251.4655498866213  , 252.79200680272106 , 254.11846371882075 , 255.44492063492058 , 219.16316893424036 , 220.3083333333333  , 221.45349773242626 , 222.59866213151926 , 186.1356179138322  , 187.09948979591834 , 188.0633616780045  , 189.0272335600907  , 212.90734126984125 , 213.8712131519274  , 214.8350850340136  , 215.79895691609974 , 254.93489229024942 , 256.08005668934237 , 257.2252210884354  , 258.3703854875283  , 297.68761337868483 , 299.0140702947845  , 300.34052721088426 , 301.66698412698406 , 348.4118197278912  , 349.9497845804988  , 351.48774943310644 , 353.02571428571423 , 341.8240816326531  , 343.29859410430834 , 344.77310657596365 , 346.247619047619   , 364.65562925170065 , 366.1935941043083  , 367.731558956916   , 369.2695238095237  , 317.3155498866213  , 318.642006802721   , 319.96846371882083 , 321.2949206349206  , 276.0131689342403  , 277.1583333333333  , 278.30349773242625 , 279.44866213151926 , 233.9856179138322  , 234.94948979591834 , 235.9133616780045  , 236.8772335600907  , 196.7954365079365  , 197.60740362811788 , 198.41937074829934 , 199.2313378684807  , 235.48013038548748 , 236.44481859410428 , 237.40950680272107 , 238.37419501133783 , 274.77570861678004 , 275.89311791383216 , 277.0105272108843  , 278.1279365079365  , 321.33324829931973 , 322.6288321995464  , 323.92441609977317 , 325.21999999999997 , 314.63551020408164 , 315.877641723356   , 317.11977324263034 , 318.36190476190467 , 335.0170578231292  , 336.312641723356   , 337.6082256235827  , 338.90380952380946 , 291.31031179138324 , 292.42772108843536 , 293.5451303854875  , 294.66253968253966 , 253.23650226757368 , 254.20119047619045 , 255.1658786848072  , 256.13056689342403 , 214.5518083900227  , 215.36377551020408 , 216.17574263038549 , 216.98770975056692 , 178.81170634920633 , 179.49708616780043 , 180.1824659863946  , 180.86784580498863 , 213.8535430839002  , 214.66783446712014 , 215.48212585034017 , 216.2964172335601  , 249.41102607709746 , 250.3542290249433  , 251.29743197278913 , 252.2406349206349  , 291.49634353741493 , 292.58994331065753 , 293.6835430839002  , 294.77714285714285 , 285.00693877551015 , 286.05541950113377 , 287.1039002267574  , 288.1523809523809  , 303.04681972789115 , 304.14041950113375 , 305.2340192743764  , 306.327619047619   , 263.3678514739229  , 264.3110544217687  , 265.2542573696145  , 266.19746031746035 , 228.84166099773242 , 229.65595238095239 , 230.47024376417235 , 231.28453514739232 , 193.79982426303854 , 194.48520408163267 , 195.17058390022675 , 195.85596371882087 , 159.49095804988661 , 160.0678344671202  , 160.64471088435377 , 161.22158730158728 , 190.67565192743763 , 191.36103174603176 , 192.04641156462588 , 192.73179138321993 , 222.29435941043081 , 223.0882426303855  , 223.88212585034017 , 224.67600907029475 , 259.68920068027205 , 260.609671201814   , 261.530141723356   , 262.45061224489797 , 253.6355102040816  , 254.5180045351474  , 255.40049886621316 , 256.28299319727887 , 269.41110544217685 , 270.3315759637188  , 271.25204648526073 , 272.17251700680276 , 234.0416609977324  , 234.83554421768707 , 235.62942743764174 , 236.42331065759637 , 203.2909807256236  , 203.97636054421773 , 204.66174036281177 , 205.3471201814059  , 172.10628684807259 , 172.68316326530615 , 173.26003968253966 , 173.83691609977325 };
  const std::array<int, 4> in_shape = {{ 3, 8, 9, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.42857142857142855 , 0.4897959183673469  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.40816326530612246 , 0.18367346938775508 , 0.2040816326530612  , 0.22448979591836732 , 0.24489795918367346 , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.2857142857142857  , 0.32653061224489793 , 0.36734693877551017 , 0.4081632653061224  , 0.7346938775510203  , 0.8163265306122448  , 0.8979591836734693  , 0.9795918367346939  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.0612244897959184  , 1.1428571428571428  , 1.2244897959183674  , 1.306122448979592   , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 0.26530612244897955 , 0.2857142857142857  , 0.3061224489795918  , 0.32653061224489793 , 0.6122448979591837  , 0.6530612244897959  , 0.693877551020408   , 0.7346938775510203  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 1.1632653061224487  , 1.2244897959183674  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.4693877551020408  , 0.4897959183673469  , 0.5102040816326531  , 0.5306122448979591  , 0.5510204081632653  , 0.5714285714285714  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 1.8979591836734693  , 1.9591836734693877  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 0.673469387755102   , 0.6938775510204082  , 0.7142857142857142  , 0.7346938775510203  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 1.2653061224489797  , 1.3061224489795917  , 1.3469387755102038  , 1.387755102040816   , 2.693877551020408   , 2.7755102040816326  , 2.8571428571428568  , 2.9387755102040813  , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 3.020408163265306   , 3.1020408163265305  , 3.1836734693877546  , 3.2653061224489797  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.7142857142857142  , 0.7551020408163265  , 0.7755102040816326  , 0.7959183673469387  , 0.8163265306122448  , 1.5918367346938775  , 1.6326530612244898  , 1.673469387755102   , 1.714285714285714   , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 2.510204081632653   , 2.571428571428571   , 2.63265306122449    , 2.6938775510204076  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 0.9183673469387754  , 0.9387755102040816  , 0.9591836734693877  , 0.9795918367346939  , 0.9999999999999999  , 1.0204081632653061  , 1.040816326530612   , 1.0612244897959182  , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 3.244897959183673   , 3.3061224489795915  , 3.36734693877551    , 3.428571428571428   , 3.244897959183673   , 3.3061224489795915  , 3.36734693877551    , 3.428571428571428   , 3.244897959183673   , 3.3061224489795915  , 3.36734693877551    , 3.428571428571428   , 3.244897959183673   , 3.3061224489795915  , 3.36734693877551    , 3.428571428571428   , 3.244897959183673   , 3.3061224489795915  , 3.36734693877551    , 3.428571428571428   , 2.2448979591836733  , 2.2857142857142856  , 2.326530612244898   , 2.36734693877551    , 1.163265306122449   , 1.183673469387755   , 1.2040816326530612  , 1.2244897959183672  , 2.2448979591836733  , 2.2857142857142856  , 2.3265306122448974  , 2.36734693877551    , 4.653061224489795   , 4.73469387755102    , 4.816326530612244   , 4.897959183673469   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 4.979591836734693   , 5.061224489795919   , 5.142857142857142   , 5.224489795918367   , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.6938775510204076  , 2.2448979591836733  , 2.2857142857142856  , 2.3265306122448974  , 2.36734693877551    , 4.653061224489795   , 4.73469387755102    , 4.816326530612244   , 4.897959183673469   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 4.979591836734693   , 5.061224489795919   , 5.142857142857142   , 5.224489795918367   , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.6938775510204076  , 2.2448979591836733  , 2.2857142857142856  , 2.3265306122448974  , 2.36734693877551    , 4.653061224489795   , 4.73469387755102    , 4.816326530612244   , 4.897959183673469   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 4.979591836734693   , 5.061224489795919   , 5.142857142857142   , 5.224489795918367   , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.6938775510204076  , 2.2448979591836733  , 2.2857142857142856  , 2.3265306122448974  , 2.36734693877551    , 4.653061224489795   , 4.73469387755102    , 4.816326530612244   , 4.897959183673469   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 4.979591836734693   , 5.061224489795919   , 5.142857142857142   , 5.224489795918367   , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.6938775510204076  , 2.2448979591836733  , 2.2857142857142856  , 2.3265306122448974  , 2.36734693877551    , 4.653061224489795   , 4.73469387755102    , 4.816326530612244   , 4.897959183673469   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 4.979591836734693   , 5.061224489795919   , 5.142857142857142   , 5.224489795918367   , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.6938775510204076  , 2.2448979591836733  , 2.2857142857142856  , 2.3265306122448974  , 2.36734693877551    , 4.653061224489795   , 4.73469387755102    , 4.816326530612244   , 4.897959183673469   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 4.979591836734693   , 5.061224489795919   , 5.142857142857142   , 5.224489795918367   , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.6938775510204076  , 1.2448979591836733  , 1.2653061224489794  , 1.2857142857142856  , 1.3061224489795917  , 2.571428571428571   , 2.6122448979591835  , 2.6530612244897958  , 2.693877551020408   , 3.979591836734693   , 4.040816326530612   , 4.1020408163265305  , 4.163265306122449   , 3.979591836734693   , 4.040816326530612   , 4.1020408163265305  , 4.163265306122449   , 3.979591836734693   , 4.040816326530612   , 4.1020408163265305  , 4.163265306122449   , 3.979591836734693   , 4.040816326530612   , 4.1020408163265305  , 4.163265306122449   , 3.979591836734693   , 4.040816326530612   , 4.1020408163265305  , 4.163265306122449   , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 1.4081632653061222  , 1.4285714285714284  , 1.4489795918367345  , 1.4693877551020407  };
  const std::array<int, 4> in_shape = {{ 3, 8, 9, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  8.613361678004535,  10.5300283446712  ,  12.555198412698413,  14.688871882086168,  14.710102040816327,  15.773435374149658,  18.094070294784576,  16.285907029478455,  14.36924036281179 ,  12.344070294784583,  13.199416099773241,  16.034450113378682,  18.998395691609975,  22.091252834467117,  21.791054421768706,  23.054387755102034,  26.136927437641713,  23.430804988662125,  20.595770975056684,  17.6318253968254  ,  19.815685941043082,  23.960243764172333,  28.257522675736958,  32.70752267573695 ,  31.893435374149657,  33.390102040816316,  37.50041950113378 ,  33.5085827664399  ,  29.36402494331065 ,  25.06674603174603 ,  29.274257369614514,  35.27595804988662 ,  41.45895124716553 ,  47.82323696145123 ,  46.225816326530605,  48.00248299319726 ,  53.51280045351472 ,  47.692392290249416,  41.690691609977314,  35.50769841269841 ,  42.56592403628118 ,  51.06762471655329 ,  59.7506179138322  ,  68.6149036281179  ,  65.55914965986395 ,  67.33581632653059 ,  74.3044671201814  ,  65.98405895691609 ,  57.48235827664399 ,  48.79936507936508 ,  40.702590702947845,  48.77571995464853 ,  57.00157029478458 ,  65.380141723356   ,  62.27438775510203 ,  63.7710544217687  ,  70.17303854875283 ,  62.25263038548753 ,  54.17950113378685 ,  45.953650793650795,  37.883939909297055,  45.361831065759645,  52.96863378684808 ,  60.704348072562354,  57.69581632653061 ,  58.95914965986395 ,  64.75002267573697 ,  57.40104308390023 ,  49.92315192743765 ,  42.31634920634921 ,  34.38291950113379 ,  41.14652494331066 ,  48.01863378684808 ,  54.99924603174604 ,  52.193095238095246,  53.25642857142858 ,  58.40444444444445 ,  51.74934240362813 ,  44.98573696145125 ,  38.113628117913834,  54.763475056689344,  65.36041383219955 ,  76.0658560090703  ,  86.87980158730159 ,  81.83753968253968 ,  82.90087301587303 ,  90.28500000000003 ,  79.79656462585037 ,  69.19962585034015 ,  58.49418367346939 ,  68.02980158730158 ,  81.17776077097506 ,  94.45463151927437 , 107.86041383219953 , 101.54434240362811 , 102.80767573696146 , 111.90608843537416 ,  98.88704081632655 ,  85.73908163265307 ,  72.46221088435374 ,  84.77305555555554 , 101.13530045351473 , 117.65026643990929 , 134.3179535147392  , 126.37688208616778 , 127.87354875283447 , 139.11085034013607 , 122.90132653061225 , 106.53908163265307 ,  90.0241156462585  , 106.38400793650791 , 126.88910997732424 , 147.57550453514742 , 168.44319160997733 , 158.38545351473923 , 160.1621201814059  , 174.13275510204085 , 153.8089455782313  , 133.303843537415   , 112.61744897959183 , 119.6756746031746  , 142.6807766439909  , 165.86717120181405 , 189.23485827664396 , 177.71878684807254 , 179.4954535147392  , 194.92442176870748 , 172.10061224489797 , 149.09551020408162 , 125.90911564625848 , 105.6599603174603  , 125.95077664399092 , 146.39431405895692 , 166.99057256235827 , 156.7578344671202  , 158.25450113378685 , 171.78346938775508 , 151.64537414965986 , 131.35455782312926 , 110.91102040816325 ,  92.71432539682539 , 110.505141723356   , 128.42486961451246 , 146.47350907029477 , 137.44910430839002 , 138.71243764172337 , 150.5191836734694  , 132.85727891156463 , 115.06646258503402 ,  97.14673469387756 ,  80.53303287981859 ,  95.976910430839   , 111.52929138321997 , 127.19017573696146 , 119.3205328798186  , 120.38386621315192 , 130.59537414965985 , 115.26             ,  99.81612244897958 ,  84.26374149659863 , 100.91358843537414 , 120.19079931972787 , 139.57651360544216 , 159.07073129251702 , 148.96497732426306 , 150.02831065759634 , 162.47592970521544 , 143.3072222222222  , 124.03001133786846 , 104.64429705215417 , 122.86018707482992 , 146.3210714285714  , 169.91086734693874 , 193.62957482993198 , 181.29763038548757 , 182.56096371882083 , 197.6752494331066  , 174.34327664399092 , 150.8823922902494  , 127.29259637188207 , 149.730425170068   , 178.3103571428571  , 207.04301020408158 , 235.92838435374148 , 220.86032879818595 , 222.35699546485256 , 240.72128117913832 , 212.29407029478455 , 183.71413832199542 , 154.98148526077094 , 183.49375850340135 , 218.50226190476187 , 253.6920578231292  , 289.06314625850337 , 270.54509070294785 , 272.3217573696145  , 294.7527097505669  , 259.9254988662131  , 224.91699546485256 , 189.72719954648522 , 196.78542517006807 , 234.29392857142858 , 271.9837244897959  , 309.85481292517005 , 289.8784240362812  , 291.65509070294786 , 315.5443764172336  , 278.2171655328798  , 240.70866213151922 , 203.0188662131519  , 170.61732993197282 , 203.12583333333336 , 235.78705782312923 , 268.6010034013606  , 251.24128117913827 , 252.737947845805   , 273.39390022675735 , 241.03811791383217 , 208.52961451247162 , 175.8683900226757  , 147.54471088435378 , 175.6484523809524  , 203.88110544217685 , 232.24267006802722 , 217.20239229024943 , 218.46572562358276 , 236.28834467120183 , 208.313514739229   , 180.20977324263035 , 151.97712018140587 , 126.68314625850338 , 150.80729591836734 , 175.03994897959183 , 199.38110544217687 , 186.44797052154195 , 187.51130385487525 , 202.78630385487526 , 178.77065759637185 , 154.6465079365079  , 130.41385487528345 };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.18367346938775508 , 0.14285714285714285 , 0.08163265306122448 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.1020408163265306  , 0.22448979591836732 , 0.36734693877551017 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.4285714285714285  , 0.30612244897959184 , 0.16326530612244897 , 0.18367346938775508 , 0.3877551020408163  , 0.6122448979591837  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.44897959183673464 , 0.9387755102040816  , 1.4693877551020407  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.5918367346938773  , 1.1020408163265305  , 0.5714285714285714  , 0.26530612244897955 , 0.5510204081632653  , 0.857142857142857   , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 0.9183673469387754  , 0.6326530612244897  , 0.32653061224489793 , 0.3469387755102041  , 0.7142857142857142  , 1.1020408163265305  , 1.510204081632653   , 1.510204081632653   , 1.510204081632653   , 1.510204081632653   , 1.163265306122449   , 0.7959183673469388  , 0.4081632653061224  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.42857142857142855 , 0.8775510204081631  , 1.3469387755102038  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.4081632653061225  , 0.9591836734693877  , 0.4897959183673469  };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 16.64984693877551 ,  17.22672335600907 ,  20.374676870748296,  21.0600566893424  ,  24.31651360544218 ,  25.110396825396826,  28.475357142857142,  29.377743764172337,  28.581111111111106,  29.420204081632654,  30.707777777777775,  31.546870748299316,  35.285753968253964,  36.18814058956915 ,  31.77793083900226 ,  32.57181405895691 ,  28.053100907029474,  28.73848072562358 ,  24.111264172335602,  24.688140589569166,  25.713452380952383,  26.398832199546483,  31.25460884353741 ,  32.068900226757364,  37.053588435374145,  37.99679138321995 ,  43.11039115646258 ,  44.18250566893423 ,  42.58519274376416 ,  43.58210884353741 ,  45.11185941043083 ,  46.10877551020407 ,  51.20174036281178 ,  52.273854875283426,  45.918407029478445,  46.86160997732425 ,  40.377250566893416,  41.19154195011337 ,  34.57827097505669 ,  35.2636507936508  ,  38.819404761904764,  39.631371882086164,  46.95579931972788 ,  47.920487528344665,  55.39763605442177 ,  56.515045351473916,  64.14491496598639 ,  65.4150453514739  ,  62.60582766439907 ,  63.786870748299314,  65.59916099773243 ,  66.78020408163263 ,  73.73070861678003 ,  75.00083900226755 ,  65.89975623582765 ,  67.0171655328798  ,  57.76336167800453 ,  58.7280498866213  ,  49.321524943310656,  50.13349206349206 ,  57.58464285714285 ,  58.54851473922903 ,  69.40675170068026 ,  70.55191609977324 ,  81.5914455782313  ,  82.91790249433106 ,  94.13872448979592 ,  95.64647392290246 ,  91.0496371882086  ,  92.45163265306121 ,  94.60297052154196 ,  96.00496598639452 , 105.5178514739229  , 107.02560090702944 ,  94.05832766439909 ,  95.38478458049883 ,  82.23621882086168 ,  83.38138321995463 ,  70.05152494331065 ,  71.01539682539682 ,  84.1679761904762  ,  85.13184807256236 , 100.9900850340136  , 102.13524943310658 , 118.17477891156463 , 119.5012358276644  , 135.72205782312926 , 137.2298072562358  , 129.7163038548753  , 131.1182993197279  , 133.2696371882086  , 134.67163265306118 , 147.10118480725623 , 148.6089342403628  , 130.6416609977324  , 131.96811791383217 , 113.81955215419498 , 114.96471655328799 ,  96.63485827664397 ,  97.59873015873016 ,  80.59321428571428 ,  81.40518140589569 ,  96.58675170068028 ,  97.55143990929706 , 112.88573129251701 , 114.00314058956916 , 129.4901530612245  , 130.760283446712   , 123.36773242630383 , 124.54877551020407 , 126.36106575963717 , 127.5421088435374  , 139.07594671201812 , 140.34607709750566 , 123.38785147392288 , 124.50526077097506 , 107.3943140589569  , 108.3590022675737  ,  91.09533446712017 ,  91.90730158730159 ,  75.0825           ,  75.76787981859411 ,  89.90937074829932 ,  90.72366213151929 , 104.99406462585034 , 105.93726757369616 , 120.33658163265305 , 121.40869614512471 , 114.39471655328798 , 115.39163265306122 , 116.92138321995462 , 117.9182993197279  , 128.42793083900224 , 129.50004535147394 , 113.85888321995462 , 114.80208616780045 ,  99.0320124716553  ,  99.8463038548753  ,  83.9473185941043  ,  84.63269841269842 ,  68.188962585034   ,  68.76583900226758 ,  81.60767006802722 ,  82.29304988662132 ,  95.2433843537415  ,  96.03726757369616 , 109.09610544217686 , 109.99849206349208 , 103.54709750566892 , 104.38619047619049 , 105.67376417233557 , 106.51285714285716 , 115.90650226757367 , 116.8088888888889  , 102.70480158730156 , 103.49868480725625 ,  89.28609410430836 ,  89.9714739229025  ,  75.6503798185941  ,  76.22725623582767 , 108.95007369614511 , 109.52695011337869 , 130.03544784580498 , 130.7208276643991  , 151.33782879818594 , 152.1317120181406  , 172.857216553288   , 173.75960317460317 , 162.83598639455784 , 163.67507936507937 , 164.9626530612245  , 165.80174603174606 , 179.6676133786848  , 180.57000000000005 , 158.79924603174604 , 159.59312925170073 , 137.71387188208615 , 138.3992517006803  , 116.41149092970522 , 116.98836734693877 , 135.37422335600905 , 136.05960317460315 , 161.54123015873017 , 162.3555215419501  , 187.96606009070297 , 188.90926303854874 , 214.64871315192747 , 215.72082766439905 , 202.09176870748303 , 203.08868480725621 , 204.6184353741497  , 205.6153514739229  , 222.74006235827665 , 223.81217687074832 , 196.8308786848073  , 197.7740816326531  , 170.66387188208617 , 171.47816326530614 , 144.2390419501134  , 144.92442176870748 , 168.73414399092968 , 169.5461111111111  , 201.3059126984127  , 202.27060090702946 , 234.18312358276646 , 235.30053287981858 , 267.36577664399096 , 268.6359070294784  , 251.5727210884354  , 252.75376417233556 , 254.56605442176874 , 255.74709750566893 , 276.95157029478463 , 278.22170068027214 , 244.68524376417236 , 245.8026530612245  , 212.11347505668934 , 213.07816326530613 , 179.2362641723356  , 180.048231292517   , 211.80414399092967 , 212.76801587301583 , 252.63305555555556 , 253.77821995464848 , 293.82455215419503 , 295.15100907029483 , 335.37863378684807 , 336.88638321995467 , 315.3689115646258  , 316.77090702947845 , 318.92224489795916 , 320.3242403628118  , 346.75776077097504 , 348.2655102040817  , 306.2914342403628  , 307.6178911564626  , 265.462522675737   , 266.60768707483    , 224.2710260770975  , 225.23489795918366 , 238.38747732426305 , 239.3513492063492  , 284.21638888888884 , 285.3615532879818  , 330.4078854875283  , 331.7343424036281  , 376.9619671201814  , 378.4697165532879  , 354.0355782312925  , 355.4375736961451  , 357.58891156462585 , 358.9909070294784  , 388.3410941043084  , 389.84884353741495 , 342.87476757369615 , 344.20122448979595 , 297.0458560090703  , 298.19102040816324 , 250.85435941043082 , 251.81823129251697 , 210.50795351473923 , 211.3199206349206  , 250.9368650793651  , 251.90155328798184 , 291.67121882086167 , 292.78862811791385 , 332.711014739229   , 333.98114512471653 , 312.3346258503401  , 313.5156689342404  , 315.3279591836735  , 316.5090022675737  , 342.29680839002265 , 343.56693877551015 , 302.17333900226754 , 303.2907482993197  , 261.74442743764166 , 262.7091156462585  , 221.0100736961451  , 221.8220408163265  , 184.7432709750567  , 185.42865079365077 , 220.19599206349207 , 221.010283446712   , 255.90653628117914 , 256.8497392290249  , 291.8749036281179  , 292.94701814058953 , 273.9012925170068  , 274.89820861678004 , 276.42795918367347 , 277.42487528344674 , 299.9662528344671  , 301.0383673469388  , 264.7713548752834  , 265.71455782312927 , 229.31863378684804 , 230.13292517006803 , 193.60808956916097 , 194.29346938775512 , 160.48918934240365 , 161.06606575963718 , 191.2684410430839  , 191.953820861678   , 222.26469954648528 , 223.05858276643994 , 253.4779648526077  , 254.38035147392293 , 237.80197278911564 , 238.6410657596372  , 239.9286394557823  , 240.76773242630384 , 260.28836167800455 , 261.1907482993197  , 229.72611678004532 , 230.52             , 198.94686507936504 , 199.63224489795917 , 167.9506065759637  , 168.52748299319725 , 201.2503004535147  , 201.82717687074827 , 239.69621882086165 , 240.38159863945575 , 278.35914399092974 , 279.1530272108843  , 317.23907596371885 , 318.14146258503405 , 297.09086167800456 , 297.9299546485261  , 299.2175283446712  , 300.0566213151927  , 324.0494727891157  , 324.95185941043087 , 285.8205612244898  , 286.6144444444444  , 247.37464285714282 , 248.06002267573692 , 208.71171768707478 , 209.28859410430834 , 245.03499433106572 , 245.72037414965985 , 291.82785147392286 , 292.6421428571428  , 338.8785317460318  , 339.8217346938775  , 386.18703514739235 , 387.25914965986397 , 361.59834467120186 , 362.59526077097513 , 364.1250113378685  , 365.12192743764166 , 394.2783843537416  , 395.3504988662132  , 347.74335034013603 , 348.68655328798184 , 300.95049319727883 , 301.7647845804988  , 253.89981292517    , 254.58519274376414 , 298.64888321995466 , 299.460850340136   , 355.6560260770975  , 356.6207142857142  , 412.9686111111112  , 414.08602040816317 , 470.58663832199557 , 471.85676870748296 , 440.5396145124717  , 441.7206575963719  , 443.532947845805   , 444.7139909297051  , 480.17243197278924 , 481.44256235827663 , 423.470731292517   , 424.5881405895691  , 366.46358843537405 , 367.42827664399084 , 309.15100340136047 , 309.9629705215419  , 366.0236451247165  , 366.9875170068027  , 435.8593594104308  , 437.00452380952373 , 506.05765873015883 , 507.3841156462584  , 576.6185430839004  , 578.1262925170067  , 539.688185941043   , 541.0901814058957  , 543.2415192743763  , 544.643514739229   , 587.9976700680273  , 589.5054195011338  , 518.5245408163265  , 519.8509977324262  , 448.6888265306122  , 449.8339909297051  , 378.4905272108843  , 379.45439909297045 , 392.60697845804975 , 393.57085034013613 , 467.44269274376416 , 468.58785714285716 , 542.640992063492   , 543.9674489795918  , 618.2018764172335  , 619.7096258503401  , 578.3548526077095  , 579.7568480725624  , 581.9081859410429  , 583.3101814058957  , 629.5810034013604  , 631.0887528344672  , 555.1078741496598  , 556.4343310657596  , 480.27215986394566 , 481.41732426303844 , 405.07386054421767 , 406.0377324263038  , 340.4226927437642  , 341.23465986394564 , 405.2869784580498  , 406.2516666666667  , 470.4567063492063  , 471.57411564625846 , 535.9318764172334  , 537.2020068027211  , 501.3015192743763  , 502.48256235827654 , 504.2948526077097  , 505.47589569161    , 545.5176700680272  , 546.7878004535147  , 480.95882653061227 , 482.07623582766433 , 416.0945408163265  , 417.05922902494325 , 350.9248129251701  , 351.7367800453514  , 294.40404195011337 , 295.08942176870755 , 350.4826133786848  , 351.2969047619048  , 406.8190079365079  , 407.7622108843537  , 463.41322562358266 , 464.48534013605445 , 433.40786848072565 , 434.40478458049887 , 435.93453514739235 , 436.9314512471655  , 471.504574829932   , 472.57668934240365 , 415.6838265306123  , 416.627029478458   , 359.60525510204087 , 360.4195464852607  , 303.26886054421766 , 303.95424036281173 , 252.78941609977323 , 253.36629251700677 , 300.9292120181406  , 301.6145918367347  , 349.286014739229   , 350.07989795918365 , 397.85982426303855 , 398.76221088435375 , 372.0568480725624  , 372.8959410430839  , 374.18351473922905 , 375.0226077097505  , 404.6702210884354  , 405.5726077097505  , 356.7474319727892  , 357.5413151927437  , 308.60763605442173 , 309.2930158730158  , 260.2508333333333  , 260.8277097505669  };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.32653061224489793, 0.40816326530612246, 0.30612244897959184, 0.36734693877551017, 0.24489795918367346, 0.2857142857142857 , 0.14285714285714285, 0.16326530612244897, 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.2040816326530612 , 0.24489795918367344, 0.48979591836734687, 0.5714285714285714 , 0.8571428571428571 , 0.9795918367346937 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.3061224489795917 , 1.4693877551020407 , 1.1020408163265305 , 1.2244897959183674 , 0.8163265306122447 , 0.8979591836734693 , 0.44897959183673464, 0.4897959183673469 , 0.18367346938775508, 0.2040816326530612 , 0.4081632653061224 , 0.44897959183673464, 0.6734693877551019 , 0.7346938775510203 , 0.9795918367346936 , 1.0612244897959182 , 0.9795918367346936 , 1.0612244897959182 , 0.9795918367346936 , 1.0612244897959182 , 0.9795918367346936 , 1.0612244897959182 , 0.7959183673469387 , 0.857142857142857  , 0.5714285714285714 , 0.6122448979591837 , 0.3061224489795918 , 0.32653061224489793, 0.3469387755102041 , 0.36734693877551017, 0.7346938775510203 , 0.7755102040816326 , 1.163265306122449  , 1.2244897959183674 , 1.6326530612244898 , 1.7142857142857144 , 1.6326530612244898 , 1.7142857142857144 , 1.6326530612244898 , 1.7142857142857144 , 1.6326530612244898 , 1.7142857142857144 , 1.2857142857142856 , 1.3469387755102038 , 0.8979591836734693 , 0.9387755102040816 , 0.4693877551020408 , 0.4897959183673469 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.8571428571428572 , 0.8979591836734693 , 1.7959183673469385 , 1.8775510204081631 , 2.816326530612245  , 2.9387755102040813 , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.9183673469387754 , 4.081632653061225  , 3.061224489795918  , 3.1836734693877546 , 2.1224489795918364 , 2.204081632653061  , 1.1020408163265305 , 1.1428571428571428 , 0.5102040816326531 , 0.5306122448979591 , 1.0612244897959182 , 1.1020408163265305 , 1.6530612244897958 , 1.714285714285714  , 2.2857142857142856 , 2.3673469387755097 , 2.2857142857142856 , 2.3673469387755097 , 2.2857142857142856 , 2.3673469387755097 , 2.2857142857142856 , 2.3673469387755097 , 1.7755102040816326 , 1.8367346938775508 , 1.2244897959183674 , 1.2653061224489794 , 0.6326530612244897 , 0.6530612244897959 , 0.673469387755102  , 0.6938775510204082 , 1.387755102040816  , 1.4285714285714284 , 2.1428571428571423 , 2.204081632653061  , 2.938775510204081  , 3.020408163265306  , 2.938775510204081  , 3.020408163265306  , 2.938775510204081  , 3.020408163265306  , 2.938775510204081  , 3.020408163265306  , 2.265306122448979  , 2.326530612244898  , 1.5510204081632653 , 1.5918367346938775 , 0.7959183673469387 , 0.8163265306122448 , 1.510204081632653  , 1.5510204081632653 , 3.10204081632653   , 3.183673469387755  , 4.775510204081632  , 4.897959183673469  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 5.020408163265305  , 5.142857142857142  , 3.4285714285714284 , 3.5102040816326534 , 1.7551020408163263 , 1.7959183673469385 , 1.510204081632653  , 1.5510204081632653 , 3.10204081632653   , 3.183673469387755  , 4.775510204081632  , 4.897959183673469  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 5.020408163265305  , 5.142857142857142  , 3.4285714285714284 , 3.5102040816326534 , 1.7551020408163263 , 1.7959183673469385 , 1.510204081632653  , 1.5510204081632653 , 3.10204081632653   , 3.183673469387755  , 4.775510204081632  , 4.897959183673469  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 5.020408163265305  , 5.142857142857142  , 3.4285714285714284 , 3.5102040816326534 , 1.7551020408163263 , 1.7959183673469385 , 1.510204081632653  , 1.5510204081632653 , 3.10204081632653   , 3.183673469387755  , 4.775510204081632  , 4.897959183673469  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 5.020408163265305  , 5.142857142857142  , 3.4285714285714284 , 3.5102040816326534 , 1.7551020408163263 , 1.7959183673469385 , 1.510204081632653  , 1.5510204081632653 , 3.10204081632653   , 3.183673469387755  , 4.775510204081632  , 4.897959183673469  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 5.020408163265305  , 5.142857142857142  , 3.4285714285714284 , 3.5102040816326534 , 1.7551020408163263 , 1.7959183673469385 , 1.510204081632653  , 1.5510204081632653 , 3.10204081632653   , 3.183673469387755  , 4.775510204081632  , 4.897959183673469  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 6.5306122448979576 , 6.693877551020408  , 5.020408163265305  , 5.142857142857142  , 3.4285714285714284 , 3.5102040816326534 , 1.7551020408163263 , 1.7959183673469385 , 0.836734693877551  , 0.8571428571428571 , 1.7142857142857142 , 1.7551020408163263 , 2.63265306122449   , 2.6938775510204076 , 3.5918367346938775 , 3.6734693877551017 , 3.5918367346938775 , 3.6734693877551017 , 3.5918367346938775 , 3.6734693877551017 , 3.5918367346938775 , 3.6734693877551017 , 2.7551020408163263 , 2.816326530612245  , 1.8775510204081631 , 1.9183673469387754 , 0.9591836734693877 , 0.9795918367346939 };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 32.72281746031746 ,  33.29969387755102 ,  33.876570294784585,  34.45344671201814 ,  40.06397392290249 ,  40.74935374149659 ,  41.434733560090706,  42.1201133786848  ,  47.8391439909297  ,  48.63302721088436 ,  49.426910430838994,  50.22079365079365 ,  56.04832766439909 ,  56.950714285714284,  57.853100907029464,  58.75548752834467 ,  56.32312925170068 ,  57.16222222222221 ,  58.00131519274377 ,  58.84040816326531 ,  60.576462585034015,  61.41555555555555 ,  62.254648526077105,  63.09374149659863 ,  69.66912131519274 ,  70.57150793650793 ,  71.47389455782313 ,  72.3762811791383  ,  62.76197845804988 ,  63.55586167800452 ,  64.34974489795918 ,  65.14362811791382 ,  55.42082199546485 ,  56.10620181405895 ,  56.79158163265306 ,  57.47696145124716 ,  47.64565192743764 ,  48.222528344671204,  48.79940476190476 ,  49.37628117913833 ,  50.74152494331066 ,  51.426904761904765,  52.112284580498866,  52.797664399092966,  61.69492630385488 ,  62.50921768707482 ,  63.32350907029478 ,  64.13780045351473 ,  73.16397392290249 ,  74.10717687074829 ,  75.0503798185941  ,  75.9935827664399  ,  85.1486678004535  ,  86.22078231292517 ,  87.2928968253968  ,  88.36501133786847 ,  84.17346938775509 ,  85.17038548752832 ,  86.1673015873016  ,  87.16421768707482 ,  89.22680272108843 ,  90.22371882086166 ,  91.22063492063492 ,  92.21755102040814 , 101.33136621315192 , 102.40348072562357 , 103.47559523809524 , 104.54770975056685 ,  90.89361111111111 ,  91.83681405895689 ,  92.78001700680272 ,  93.7232199546485  ,  79.94020975056691 ,  80.75450113378683 ,  81.56879251700681 ,  82.38308390022674 ,  68.47116213151928 ,  69.15654195011338 ,  69.84192176870748 ,  70.5273015873016  ,  76.82684240362812 ,  77.63880952380953 ,  78.45077664399093 ,  79.26274376417233 ,  92.94691043083901 ,  93.91159863945576 ,  94.87628684807257 ,  95.84097505668933 , 109.67786281179137 , 110.79527210884353 , 111.91268140589568 , 113.03009070294783 , 127.01969954648524 , 128.28982993197278 , 129.55996031746028 , 130.8300907029478  , 124.03061224489795 , 125.21165532879814 , 126.39269841269842 , 127.57374149659863 , 130.01727891156463 , 131.19832199546485 , 132.37936507936507 , 133.56040816326527 , 146.19128684807256 , 147.46141723356007 , 148.73154761904763 , 150.0016780045351  , 130.68210317460318 , 131.7995124716553  , 132.91692176870748 , 134.0343310657596  , 114.56203514739231 , 115.52672335600906 , 116.49141156462585 , 117.4560997732426  ,  97.83108276643992 ,  98.64304988662131 ,  99.4550170068027  , 100.26698412698413 , 114.20541383219954 , 115.1692857142857  , 116.1331575963719  , 117.09702947845805 , 137.6683390022676  , 138.81350340136052 , 139.95866780045353 , 141.10383219954647 , 161.85643424036283 , 163.1828911564626  , 164.50934807256235 , 165.83580498866212 , 186.7696995464853  , 188.27744897959184 , 189.78519841269838 , 191.29294784580492 , 180.69727891156467 , 182.0992743764172  , 183.50126984126985 , 184.90326530612242 , 187.80394557823132 , 189.20594104308393 , 190.6079365079365  , 192.00993197278905 , 209.52795351473924 , 211.0357029478458  , 212.54345238095237 , 214.05120181405889 , 186.79019841269843 , 188.11665532879817 , 189.44311224489795 , 190.76956916099766 , 163.32727324263038 , 164.47243764172336 , 165.6176020408163  , 166.76276643990926 , 139.13917800453515 , 140.1030498866213  , 141.06692176870746 , 142.03079365079364 , 167.3720804988662  , 168.3359523809524  , 169.29982426303857 , 170.26369614512473 , 200.83500566893426 , 201.9801700680272  , 203.12533446712015 , 204.27049886621316 , 235.0231009070295  , 236.34955782312926 , 237.676014739229   , 239.0024716553288  , 269.936366213152   , 271.4441156462585  , 272.951865079365   , 274.4596145124716  , 258.030612244898   , 259.4326077097506  , 260.83460317460316 , 262.2365986394558  , 265.13727891156464 , 266.5392743764172  , 267.94126984126984 , 269.34326530612236 , 292.69462018140587 , 294.20236961451246 , 295.71011904761906 , 297.2178684807256  , 259.9568650793651  , 261.2833219954648  , 262.6097789115646  , 263.93623582766435 , 226.49393990929704 , 227.63910430838996 , 228.78426870748302 , 229.92943310657597 , 192.3058446712018  , 193.26971655328794 , 194.23358843537414 , 195.19746031746033 , 160.37446145124716 , 161.18642857142856 , 161.99839569160997 , 162.81036281179138 , 192.20881519274377 , 193.17350340136056 , 194.1381916099773  , 195.10287981859412 , 224.65405328798187 , 225.77146258503402 , 226.88887188208614 , 228.0062811791383  , 257.7101757369615  , 258.980306122449   , 260.2504365079365  , 261.520566893424   , 245.55442176870753 , 246.73546485260766 , 247.9165079365079  , 249.09755102040813 , 251.54108843537418 , 252.72213151927434 , 253.9031746031746  , 255.0842176870748  , 276.8817630385488  , 278.15189342403625 , 279.4220238095238  , 280.6921541950113  , 245.65829365079364 , 246.77570294784576 , 247.89311224489796 , 249.0105215419501  , 213.82393990929705 , 214.7886281179138  , 215.7533163265306  , 216.7180045351474  , 181.37870181405896 , 182.19066893424034 , 183.00263605442177 , 183.81460317460318 , 149.4796201814059  , 150.165            , 150.8503798185941  , 151.53575963718822 , 179.0044501133787  , 179.81874149659865 , 180.6330328798186  , 181.44732426303858 , 209.04492630385488 , 209.98812925170068 , 210.93133219954646 , 211.87453514739232 , 239.6010487528345  , 240.6731632653061  , 241.74527777777774 , 242.81739229024942 , 227.79251700680274 , 228.78943310657596 , 229.7863492063492  , 230.78326530612244 , 232.84585034013605 , 233.84276643990924 , 234.83968253968254 , 235.8365986394558  , 255.78374716553287 , 256.8558616780045  , 257.9279761904762  , 259.0000907029479  , 226.77456349206346 , 227.71776643990924 , 228.6609693877551  , 229.6041723356009  , 197.2497335600907  , 198.0640249433106  , 198.87831632653064 , 199.6926077097506  , 167.2092573696145  , 167.8946371882086  , 168.5800170068027  , 169.26539682539683 , 135.80104875283448 , 136.377925170068   , 136.9548015873016  , 137.53167800453517 , 162.5299603174603  , 163.21534013605444 , 163.9007199546485  , 164.58609977324264 , 189.69288548752832 , 190.486768707483   , 191.28065192743765 , 192.0745351473923  , 217.28982426303855 , 218.19221088435373 , 219.09459750566893 , 219.99698412698416 , 206.2551020408163  , 207.09419501133783 , 207.93328798185942 , 208.77238095238098 , 210.50843537414966 , 211.34752834467113 , 212.18662131519278 , 213.02571428571432 , 230.9106179138322  , 231.81300453514734 , 232.7153911564626  , 233.6177777777778  , 204.6157199546485  , 205.40960317460312 , 206.20348639455787 , 206.9973696145125  , 177.88680839002268 , 178.57218820861672 , 179.2575680272109  , 179.942947845805   , 150.72388321995464 , 151.3007596371882  , 151.87763605442177 , 152.45451247165533 , 217.3232709750567  , 217.90014739229022 , 218.4770238095238  , 219.05390022675738 , 259.38551587301583 , 260.07089569160996 , 260.7562755102041  , 261.4416553287982  , 301.88177437641724 , 302.6756575963719  , 303.4695408163265  , 304.2634240362812  , 344.8120464852608  , 345.714433106576   , 346.6168197278911  , 347.51920634920634 , 324.8328798185941  , 325.67197278911567 , 326.5110657596372  , 327.35015873015874 , 329.08621315192744 , 329.925306122449   , 330.7643990929705  , 331.6034920634921  , 358.4328401360544  , 359.3352267573696  , 360.2376133786848  , 361.1400000000001  , 316.80460884353744 , 317.5984920634921  , 318.3923752834467  , 319.18625850340146 , 274.74236394557823 , 275.4277437641723  , 276.11312358276643 , 276.7985034013606  , 232.24610544217686 , 232.82298185941045 , 233.39985827664398 , 233.97673469387755 , 270.06306689342404 , 270.7484467120181  , 271.43382653061224 , 272.1192063492063  , 322.26816893424035 , 323.08246031746035 , 323.8967517006803  , 324.7110430839002  , 374.98891723356013 , 375.93212018140593 , 376.8753231292517  , 377.8185260770975  , 428.22531179138326 , 429.29742630385493 , 430.36954081632643 , 431.4416553287981  , 403.1866213151927  , 404.18353741496605 , 405.1804535147392  , 406.17736961451243 , 393.61138321995463 , 394.60829931972796 , 395.6052154195011  , 396.6021315192744  , 411.49372448979585 , 412.5658390022676  , 413.6379535147392  , 414.7100680272109  , 359.804268707483   , 360.74747165532887 , 361.6906746031746  , 362.6338775510205  , 307.59916666666663 , 308.41345804988663 , 309.22774943310657 , 310.04204081632656 , 254.8784183673469  , 255.56379818594107 , 256.2491780045351  , 256.93455782312924 , 271.8436224489796  , 272.65558956916095 , 273.46755668934236 , 274.27952380952377 , 324.643962585034   , 325.6086507936508  , 326.5733390022676  , 327.53802721088437 , 378.05518707483    , 379.1725963718821  , 380.2900056689342  , 381.4074149659864  , 432.0772959183674  , 433.3474263038549  , 434.6175566893423  , 435.88768707482984 , 407.6913832199546  , 408.87242630385487 , 410.05346938775506 , 411.23451247165525 , 399.04947845804986 , 400.2305215419501  , 401.4115646258503  , 402.5926077097505  , 418.33459750566885 , 419.6047278911564  , 420.8748582766439  , 422.1449886621315  , 366.145141723356   , 367.2625510204082  , 368.3799603174603  , 369.4973696145125  , 313.34480158730156 , 314.30948979591835 , 315.2741780045351  , 316.2388662131519  , 259.93357709750563 , 260.7455442176871  , 261.5575113378684  , 262.3694784580498  , 280.0564795918367  , 281.02035147392286 , 281.984223356009   , 282.9480952380952  , 334.7139625850339  , 335.859126984127   , 337.00429138321994 , 338.14945578231294 , 390.0966156462585  , 391.4230725623583  , 392.749529478458   , 394.07598639455784 , 446.2044387755102  , 447.7121882086168  , 449.2199376417232  , 450.7276870748299  , 421.9351927437641  , 423.3371882086168  , 424.7391836734693  , 426.14117913832195 , 414.41328798185936 , 415.815283446712   , 417.21727891156456 , 418.6192743764172  , 436.04840702947837 , 437.55615646258497 , 439.06390589569156 , 440.57165532879816 , 382.1160941043084  , 383.4425510204082  , 384.76900793650793 , 386.09546485260773 , 327.4586111111111  , 328.60377551020406 , 329.748939909297   , 330.89410430839    , 272.0759580498866  , 273.0398299319728  , 274.0037018140589  , 274.96757369614505 , 236.00409863945575 , 236.96797052154193 , 237.93184240362808 , 238.8957142857143  , 282.3758673469387  , 283.5210317460317  , 284.6661961451247  , 285.8113605442177  , 329.47280612244896 , 330.79926303854876 , 332.1257199546485  , 333.4521768707483  , 377.2949149659864  , 378.8026643990929  , 380.31041383219946 , 381.8181632653061  , 357.85900226757366 , 359.2609977324263  , 360.6629931972788  , 362.0649886621315  , 350.33709750566885 , 351.73909297052154 , 353.14108843537406 , 354.5430839002267  , 367.1388832199546  , 368.64663265306126 , 370.15438208616774 , 371.6621315192743  , 321.49228458049885 , 322.81874149659865 , 324.14519841269833 , 325.47165532879814 , 275.12051587301585 , 276.26568027210885 , 277.4108446712018  , 278.55600907029475 , 228.02357709750564 , 228.98744897959185 , 229.95132086167806 , 230.91519274376415 , 180.3969557823129  , 181.2089229024943  , 182.02089002267576 , 182.83285714285716 , 215.9972959183673  , 216.9619841269841  , 217.9266723356009  , 218.89136054421772 , 252.20852040816322 , 253.32592970521534 , 254.44333900226758 , 255.56074829931973 , 289.03062925170065 , 290.30075963718815 , 291.57089002267577 , 292.8410204081633  , 274.6780498866213  , 275.8590929705215  , 277.04013605442174 , 278.22117913832204 , 266.03614512471654 , 267.2171882086168  , 268.3982312925169  , 269.57927437641723 , 275.28793083900223 , 276.5580612244898  , 277.82819160997724 , 279.09832199546486 , 240.29847505668934 , 241.41588435374146 , 242.5332936507937  , 243.65070294784582 , 204.6981349206349  , 205.66282312925168 , 206.62751133786853 , 207.5921995464853  , 168.486910430839   , 169.2988775510204  , 170.11084467120182 , 170.92281179138322 , 128.99417800453517 , 129.67955782312924 , 130.36493764172334 , 131.05031746031744 , 154.66594671201815 , 155.4802380952381  , 156.29452947845806 , 157.108820861678   , 180.85336167800455 , 181.7965646258503  , 182.73976757369616 , 183.68297052154193 , 207.55642290249432 , 208.62853741496596 , 209.70065192743766 , 210.7727664399093  , 197.99551020408163 , 198.9924263038548  , 199.98934240362814 , 200.98625850340133 , 188.42027210884353 , 189.41718820861675 , 190.41410430839005 , 191.41102040816327 , 190.824835600907   , 191.89695011337864 , 192.96906462585036 , 194.04117913832204 , 165.66871315192742 , 166.61191609977323 , 167.55511904761906 , 168.49832199546486 , 139.99694444444444 , 140.8112358276644  , 141.62552721088434 , 142.43981859410434 , 113.80952947845803 , 114.49490929705215 , 115.18028911564626 , 115.86566893424039 ,  80.59451814058959 ,  81.1713945578231  ,  81.74827097505668 ,  82.32514739229025 ,  96.9397562358277  ,  97.62513605442176 ,  98.31051587301586 ,  98.99589569160996 , 113.71900793650799 , 114.51289115646257 , 115.30677437641721 , 116.10065759637187 , 130.93227324263046 , 131.83465986394557 , 132.73704648526075 , 133.63943310657598 , 125.95469387755107 , 126.79378684807256 , 127.63287981859409 , 128.47197278911563 , 115.57945578231295 , 116.41854875283447 , 117.25764172335599 , 118.09673469387756 , 111.63878117913832 , 112.54116780045351 , 113.44355442176871 , 114.34594104308391 ,  95.7275566893424  ,  96.52143990929706 ,  97.31532312925171 ,  98.10920634920635 ,  79.38231859410432 ,  80.0676984126984  ,  80.75307823129252 ,  81.43845804988662 ,  62.60306689342403 ,  63.17994331065759 ,  63.75681972789115 ,  64.33369614512472 , 106.56299886621314 , 107.13987528344671 , 107.71675170068028 , 108.29362811791383 , 127.79259070294782 , 128.47797052154195 , 129.16335034013605 , 129.84873015873015 , 149.4561961451247  , 150.25007936507936 , 151.043962585034   , 151.83784580498863 , 171.5538151927438  , 172.45620181405897 , 173.35858843537414 , 174.2609750566893  , 163.72702947845806 , 164.5661224489796  , 165.4052154195011  , 166.24430839002267 , 167.9803628117914  , 168.81945578231293 , 169.65854875283446 , 170.49764172335603 , 185.17460884353744 , 186.07699546485262 , 186.97938208616776 , 187.881768707483   , 164.37903061224492 , 165.17291383219955 , 165.9667970521542  , 166.7606802721088  , 143.14943877551016 , 143.83481859410432 , 144.5201984126984  , 145.20557823129252 , 121.48583333333332 , 122.06270975056687 , 122.63958616780045 , 123.21646258503401 , 138.470141723356   , 139.15552154195012 , 139.8409013605442  , 140.52628117913832 , 165.92422335600907 , 166.73851473922903 , 167.55280612244894 , 168.3670975056689  , 193.89395124716552 , 194.83715419501135 , 195.7803571428571  , 196.7235600907029  , 222.37932539682544 , 223.45143990929708 , 224.52355442176867 , 225.5956689342403  , 211.77873015873016 , 212.77564625850343 , 213.7725623582766  , 214.7694784580499  , 216.8320634920635  , 217.82897959183674 , 218.82589569160996 , 219.82281179138326 , 238.56202380952382 , 239.63413832199547 , 240.70625283446705 , 241.7783673469388  , 211.62358843537416 , 212.56679138321996 , 213.50999433106574 , 214.45319727891155 , 184.16950680272103 , 184.98379818594105 , 185.79808956916096 , 186.612380952381   , 156.1997789115646  , 156.8851587301587  , 157.5705385487528  , 158.25591836734696 , 180.75863378684807 , 181.57060090702947 , 182.38256802721082 , 183.1945351473923  , 216.42700113378686 , 217.39168934240362 , 218.35637755102033 , 219.32106575963718 , 252.7062528344671  , 253.82366213151928 , 254.94107142857135 , 256.05848072562355 , 289.5963888888889  , 290.86651927437646 , 292.1366496598639  , 293.4067800453514  , 275.204126984127   , 276.38517006802726 , 277.56621315192734 , 278.74725623582765 , 281.1907936507937  , 282.3718367346939  , 283.5528798185941  , 284.7339229024943  , 308.76797619047625 , 310.0381065759637  , 311.3082369614512  , 312.5783673469388  , 273.7104931972789  , 274.8279024943311  , 275.94531179138323 , 277.06272108843535 , 238.04212585034006 , 239.00681405895693 , 239.97150226757367 , 240.93619047619052 , 201.76287414965984 , 202.57484126984124 , 203.38680839002265 , 204.19877551020411 , 237.58101473922898 , 238.5448866213152  , 239.5087585034013  , 240.4726303854875  , 284.2493820861678  , 285.3945464852608  , 286.53971088435367 , 287.68487528344673 , 331.6429195011338  , 332.9693764172336  , 334.29583333333323 , 335.62229024943315 , 379.761626984127   , 381.2693764172336  , 382.7771258503401  , 384.2848752834467  , 360.15269841269844 , 361.5546938775511  , 362.95668934240354 , 364.3586848072562  , 367.2593650793652  , 368.6613605442177  , 370.0633560090703  , 371.4653514739229  , 402.519880952381   , 404.0276303854875  , 405.5353798185941  , 407.0431292517007  , 356.5766836734694  , 357.9031405895692  , 359.229597505669   , 360.55605442176864 , 309.9083163265306  , 311.05348072562356 , 312.19864512471656 , 313.3438095238095  , 262.5147789115646  , 263.4786507936508  , 264.44252267573694 , 265.40639455782315 , 290.7476814058956  , 291.71155328798187 , 292.675425170068   , 293.6392970521542  , 347.41604875283446 , 348.56121315192746 , 349.7063775510203  , 350.85154195011336 , 404.80958616780043 , 406.13604308390023 , 407.4624999999999  , 408.7889569160998  , 462.92829365079365 , 464.4360430839002  , 465.94379251700667 , 467.45154195011344 , 437.48603174603164 , 438.88802721088433 , 440.29002267573696 , 441.69201814058954 , 444.5926984126983  , 445.994693877551   , 447.3966893424036  , 448.7986848072562  , 485.68654761904753 , 487.1942970521542  , 488.7020464852608  , 490.2097959183673  , 429.7433503401361  , 431.0698072562358  , 432.39626417233563 , 433.7227210884353  , 373.07498299319724 , 374.2201473922902  , 375.36531179138325 , 376.51047619047614 , 315.68144557823126 , 316.64531746031753 , 317.60918934240357 , 318.5730612244898  , 264.3062528344671  , 265.11821995464857 , 265.93018707483    , 266.7421541950113  , 315.68890589569156 , 316.6535941043084  , 317.6182823129251  , 318.58297052154194 , 367.6824433106575  , 368.79985260770974 , 369.9172619047618  , 371.0346712018141  , 420.28686507936504 , 421.5569954648526  , 422.82712585034005 , 424.0972562358277  , 396.72793650793636 , 397.90897959183667 , 399.0900226757369  , 400.2710657596371  , 402.71460317460316 , 403.8956462585034  , 405.0766893424036  , 406.2577324263038  , 439.45845238095234 , 440.7285827664399  , 441.99871315192746 , 443.2688435374149  , 388.6866836734693  , 389.80409297052154 , 390.9215022675737  , 392.0389115646258  , 337.3040306122449  , 338.26871882086175 , 339.2334070294784  , 340.19809523809516 , 285.3104931972789  , 286.1224603174603  , 286.93442743764166 , 287.7463945578232  , 237.2082369614512  , 237.89361678004536 , 238.5789965986395  , 239.26437641723354 , 283.2337471655329  , 284.04803854875286 , 284.8623299319728  , 285.67662131519273 , 329.77490362811784 , 330.7181065759637  , 331.6613095238095  , 332.6045124716553  , 376.83170634920623 , 377.903820861678   , 378.9759353741497  , 380.0480498866213  , 355.39777777777766 , 356.394693877551   , 357.39160997732426 , 358.3885260770975  , 360.451111111111   , 361.44802721088433 , 362.4449433106576  , 363.44185941043077 , 393.01440476190464 , 394.0865192743764  , 395.1586337868481  , 396.23074829931966 , 347.5045408163265  , 348.4477437641724  , 349.3909467120181  , 350.3341496598639  , 301.4790306122449  , 302.2933219954649  , 303.1076133786848  , 303.9219047619048  , 254.93787414965988 , 255.62325396825395 , 256.3086337868481  , 256.9940136054422  , 209.64123015873017 , 210.2181065759637  , 210.7949829931973  , 211.37185941043086 , 250.25857709750568 , 250.9439569160998  , 251.62933673469388 , 252.31471655328798 , 291.30993764172337 , 292.103820861678   , 292.8977040816327  , 293.6915873015873  , 332.7953117913832  , 333.6976984126984  , 334.6000850340136  , 335.50247165532875 , 313.6590022675736  , 314.49809523809523 , 315.33718820861685 , 316.1762811791383  , 317.91233560090694 , 318.7514285714286  , 319.5905215419501  , 320.4296145124716  , 346.4161054421768  , 347.3184920634921  , 348.22087868480725 , 349.1232653061224  , 306.23277210884356 , 307.02665532879826 , 307.82053854875284 , 308.6144217687075  , 265.6154251700681  , 266.3008049886621  , 266.9861848072562  , 267.67156462585035 , 224.56406462585036 , 225.1409410430839  , 225.71781746031746 , 226.29469387755103 };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x8x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5510204081632653  ,  0.6122448979591837  ,  0.6734693877551019  ,  0.7346938775510203  ,  0.44897959183673464 ,  0.4897959183673469  ,  0.5306122448979591  ,  0.5714285714285714  ,  0.26530612244897955 ,  0.2857142857142857  ,  0.3061224489795918  ,  0.32653061224489793 ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  0.3469387755102041  ,  0.36734693877551017 ,  0.3877551020408163  ,  0.4081632653061224  ,  0.7755102040816326  ,  0.8163265306122448  ,  0.8571428571428571  ,  0.8979591836734693  ,  1.2857142857142856  ,  1.3469387755102038  ,  1.4081632653061225  ,  1.4693877551020407  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.530612244897959   ,  1.5918367346938773  ,  1.6530612244897958  ,  1.714285714285714   ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  0.5918367346938775  ,  0.6122448979591836  ,  0.6326530612244897  ,  0.6530612244897959  ,  0.673469387755102   ,  0.6938775510204082  ,  0.7142857142857142  ,  0.7346938775510203  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  2.265306122448979   ,  2.326530612244898   ,  2.387755102040816   ,  2.4489795918367347  ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  1.7551020408163263  ,  1.7959183673469385  ,  1.8367346938775508  ,  1.8775510204081631  ,  0.9183673469387754  ,  0.9387755102040816  ,  0.9591836734693877  ,  0.9795918367346939  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  0.9999999999999999  ,  1.0204081632653061  ,  1.040816326530612   ,  1.0612244897959182  ,  2.081632653061224   ,  2.1224489795918364  ,  2.1632653061224487  ,  2.204081632653061   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  3.4897959183673466  ,  3.5510204081632653  ,  3.6122448979591835  ,  3.6734693877551017  ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  1.2448979591836733  ,  1.2653061224489794  ,  1.2857142857142856  ,  1.3061224489795917  ,  1.3265306122448979  ,  1.346938775510204   ,  1.3673469387755102  ,  1.3877551020408163  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  4.224489795918367   ,  4.285714285714285   ,  4.346938775510204   ,  4.408163265306122   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  4.469387755102041   ,  4.530612244897958   ,  4.591836734693877   ,  4.653061224489796   ,  3.061224489795918   ,  3.1020408163265305  ,  3.1428571428571423  ,  3.183673469387755   ,  1.5714285714285714  ,  1.5918367346938773  ,  1.6122448979591835  ,  1.6326530612244896  ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  1.6530612244897958  ,  1.673469387755102   ,  1.693877551020408   ,  1.7142857142857142  ,  3.387755102040816   ,  3.4285714285714284  ,  3.4693877551020407  ,  3.5102040816326525  ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040815   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  1.8979591836734693  ,  1.9183673469387754  ,  1.9387755102040816  ,  1.9591836734693877  };
  const std::array<int, 4> in_shape = {{ 3, 8, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  7.15218253968254 ,   8.794019274376419,  10.836082766439908,  13.43846371882086 ,  14.767630385487529,  12.924773242630383,  11.262471655328797,   9.729138321995464,  10.870209750566895,  13.2671485260771  ,  16.213973922902493,  19.93064058956916 ,  21.509807256235824,  18.69552154195011 ,  16.19988662131519 ,  13.931859410430839,  15.456264172335601,  18.77157029478458 ,  22.813633786848072,  27.873157596371875,  29.70232426303854 ,  25.68803854875283 ,  22.168594104308387,  19.002607709750567,  21.81935941043084 ,  26.396570294784585,  31.938633786848076,  38.83149092970521 ,  40.95232426303855 ,  35.271371882086164,  30.33526077097505 ,  25.931179138321994,  30.23995464852608 ,  36.381451247165536,  43.7401814058957  ,  52.803038548752845,  54.836371882086176,  46.93541950113379 ,  40.157641723356015,  34.18213151927438 ,  41.26316893424036 ,  49.49752267573696 ,  59.306252834467124,  71.31910997732427 ,  73.4399433106576  ,  62.638990929705216,  53.43621315192744 ,  45.37498866213151 ,  38.95086734693877 ,  46.68522108843537 ,  55.88284013605442 ,  67.12903061224489 ,  68.95819727891156 ,  58.75724489795918 ,  50.08224489795918 ,  42.497210884353734,  36.10086734693878 ,  43.2433843537415  ,  51.72671768707483 ,  62.087193877551016,  63.66636054421768 ,  54.20826530612245 ,  46.176122448979584,  39.16251700680272 ,  32.38284013605442 ,  38.770255102040814,  46.348826530612236,  55.59501700680271 ,  56.92418367346938 ,  48.43751700680272 ,  41.23870748299319 ,  34.95979591836735 ,  48.687284580498854,  58.14136621315192 ,  69.29771541950115 ,  82.83723922902495 ,  84.16640589569161 ,  71.38640589569158 ,  60.60981859410431 ,  51.2642403628118  ,  60.21755668934239 ,  71.89612811791383 ,  85.67152494331067 , 102.38247732426305 , 103.96164399092972 ,  88.15307256235826 ,  74.82886621315194 ,  63.279206349206355,  72.61585600907028 ,  86.68218253968254 , 103.26710317460319 , 123.37805555555558 , 125.20722222222224 , 106.14150793650794 ,  90.07920634920637 ,  76.16219954648528 ,  88.09323696145124 , 105.13575396825398 , 125.22067460317463 , 149.56496031746033 , 151.68579365079367 , 128.5534126984127  , 109.07444444444447 ,  92.20505668934243 ,  93.77954648526078 , 111.87206349206349 , 133.1736507936508  , 158.96793650793654 , 161.0012698412699  , 136.3688888888889  , 115.64825396825398 ,  97.72172335600906 , 107.53704648526077 , 128.23670634920634 , 152.58829365079362 , 182.05257936507937 , 184.1734126984127  , 155.92103174603173 , 132.17539682539683 , 111.64886621315195 ,  96.11045918367348 , 114.59583333333333 , 136.33630952380955 , 162.63392857142856 , 164.46309523809524 , 139.2107142857143  , 117.99285714285715 ,  99.65680272108845 ,  85.44821428571429 , 101.87236394557824 , 121.184268707483   , 144.5390306122449  , 146.11819727891157 , 123.66581632653063 , 104.80510204081634 ,  88.50986394557825 ,  73.91794217687075 ,  88.11760204081635 , 104.81045918367349 , 124.99379251700684 , 126.3229591836735  , 106.89914965986397 ,  90.58605442176872 ,  76.49489795918367 ,  90.2223866213152  , 107.48871315192743 , 127.75934807256235 , 152.236014739229   , 153.56518140589566 , 129.8480385487528  , 109.95716553287981 ,  92.79934240362812 , 109.56490362811792 , 130.52510770975056 , 155.12907596371883 , 184.83431405895692 , 186.41348072562357 , 157.61062358276644 , 133.45784580498866 , 112.62655328798185 , 129.775447845805   , 154.59279478458052 , 183.7205725623583  , 218.88295351473926 , 220.7121201814059  , 186.59497732426306 , 157.98981859410432 , 133.32179138321993 , 154.36711451247163 , 183.87493764172336 , 218.50271541950116 , 260.2984297052154  , 262.4192630385487  , 221.8354535147392  , 187.81362811791385 , 158.4789342403628  , 157.3191383219955  , 187.36267573696145 , 222.60712018140592 , 265.1328344671202  , 267.16616780045354 , 225.80235827664396 , 191.1388662131519  , 161.26131519274378 , 173.8109240362812  , 206.97589002267577 , 245.87033446712022 , 292.78604875283446 , 294.9068820861678  , 249.2030725623583  , 210.91458049886623 , 177.92274376417234 , 153.27005102040818 , 182.5064455782313  , 216.78977891156464 , 258.1388265306123  , 259.96799319727893 , 219.66418367346938 , 185.9034693877551  , 156.81639455782312 , 134.7955612244898  , 160.50134353741495 , 190.64181972789115 , 226.9908673469388  , 228.57003401360546 , 193.12336734693875 , 163.43408163265303 , 137.85721088435375 , 115.45304421768707 , 137.46494897959184 , 163.27209183673466 , 194.39256802721084 , 195.72173469387752 , 165.36078231292515 , 139.93340136054422 , 118.03             };
  const std::array<int, 4> in_shape = {{ 3, 9, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.04081632653061224 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.16326530612244897 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.36734693877551017 , 0.20408163265306123 , 0.1020408163265306  , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.22448979591836732 , 0.12244897959183673 , 0.14285714285714285 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.16326530612244897 , 0.32653061224489793 , 0.6938775510204082  , 0.6938775510204082  , 0.6938775510204082  , 0.6938775510204082  , 0.6938775510204082  , 0.6938775510204082  , 0.36734693877551017 , 0.5510204081632653  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.6122448979591837  , 0.5510204081632653  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.6122448979591837  , 0.5510204081632653  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.6122448979591837  , 0.5510204081632653  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.6122448979591837  , 0.5510204081632653  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.6122448979591837  , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.22448979591836732 , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.4693877551020408  , 0.24489795918367346 , 0.26530612244897955 , 0.5510204081632653  , 0.5510204081632653  , 0.5510204081632653  , 0.5510204081632653  , 0.5510204081632653  , 0.5510204081632653  , 0.2857142857142857  , 0.5714285714285714  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 0.6122448979591837  , 0.9183673469387754  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 0.9795918367346939  , 0.9183673469387754  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 0.9795918367346939  , 0.9183673469387754  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 0.9795918367346939  , 0.9183673469387754  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 0.9795918367346939  , 0.9183673469387754  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 0.9795918367346939  , 0.6530612244897959  , 1.346938775510204   , 1.346938775510204   , 1.346938775510204   , 1.346938775510204   , 1.346938775510204   , 1.346938775510204   , 0.693877551020408   , 0.3469387755102041  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.36734693877551017 };
  const std::array<int, 4> in_shape = {{ 3, 9, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 13.72748866213152 ,  14.30436507936508 ,  16.90265873015873 ,  17.588038548752838,  20.860198412698413,  21.672165532879816,  25.91305555555556 ,  26.87692743764172 ,  28.571388888888887,  29.535260770975057,  25.037579365079367,  25.849546485260767,  21.839563492063494,  22.524943310657594,  18.88140022675737 ,  19.458276643990928,  21.055039682539682,  21.74041950113379 ,  25.720005668934242,  26.5342970521542  ,  31.46325963718821 ,  32.42794784580499 ,  38.716116780045354,  39.86128117913832 ,  41.874450113378686,  43.01961451247165 ,  36.426354875283444,  37.39104308390022 ,  31.58548185941043 ,  32.39977324263038 ,  27.17833900226757 ,  27.863718820861678,  30.11864512471655 ,  30.912528344671202,  36.59993764172336 ,  37.54314058956916 ,  44.509858276643996,  45.627267573696145,  54.419858276644   ,  55.74631519274375 ,  58.07819160997733 ,  59.40464852607708 ,  50.258667800453516,  51.37607709750566 ,  43.393985260770975,  44.33718820861677 ,  37.21133219954648 ,  38.005215419501134,  42.71824829931972 ,  43.63871882086168 ,  51.699540816326525,  52.79314058956917 ,  62.581683673469385,  63.87726757369615 ,  76.12501700680274 ,  77.66298185941042 ,  80.3666836734694  ,  81.9046485260771  ,  69.24715986394558 ,  70.54274376417233 ,  59.57692176870748 ,  60.6705215419501  ,  50.94188775510204 ,  51.86235827664399 ,  59.59741496598638 ,  60.47990929705216 ,  71.71442176870748 ,  72.76290249433107 ,  86.238231292517   ,  87.4803628117914  , 104.13156462585036 , 105.60607709750569 , 108.19823129251701 , 109.67274376417235 ,  92.62870748299319 ,  93.87083900226757 ,  79.26680272108842 ,  80.31528344671203 ,  67.48176870748298 ,  68.36426303854876 ,  81.60586734693877 ,  82.52633786848072 ,  97.90144557823128 ,  98.99504535147392 , 117.31692176870747 , 118.61250566893425 , 141.10025510204082 , 142.63821995464855 , 145.3419217687075  , 146.8798866213152  , 123.98239795918367 , 125.27798185941043 , 105.77882653061222 , 106.87242630385488 ,  89.82950680272108 ,  90.74997732426301 ,  77.10785147392289 ,  77.90173469387754 ,  92.42723922902492 ,  93.37044217687074 , 110.64827097505669 , 111.76568027210884 , 132.93160430839    , 134.25806122448978 , 136.58993764172334 , 137.9163945578231  , 116.3970804988662  , 117.51448979591837 ,  99.22128684807255 , 100.16448979591836 ,  84.20053854875285 ,  84.99442176870747 ,  71.51635487528345 ,  72.20173469387755 ,  85.67247732426303 ,  86.486768707483   , 102.48874716553287 , 103.45343537414966 , 123.02922335600907 , 124.17438775510203 , 126.18755668934239 , 127.33272108843536 , 107.45184240362812 , 108.4165306122449  ,  91.53795351473923 ,  92.35224489795917 ,  77.63965419501133 ,  78.32503401360545 ,  64.18880385487529 ,  64.76568027210884 ,  76.85513038548753 ,  77.54051020408163 ,  91.88568594104308 ,  92.69765306122447 , 110.22616213151927 , 111.19003401360543 , 112.8844954648526  , 113.84836734693876 ,  96.06306689342404 ,  96.87503401360544 ,  81.79203514739228 ,  82.47741496598638 ,  69.34271541950113 ,  69.9195918367347  ,  96.79769274376416 ,  97.37456916099771 , 115.59735260770975 , 116.28273242630384 , 137.78346371882085 , 138.5954308390023  , 164.71060657596374 , 165.6744784580499  , 167.36893990929707 , 168.33281179138322 , 141.9608446712018  , 142.77281179138316 , 120.53425736961451 , 121.21963718820862 , 101.95160430839002 , 102.5284807256236  , 119.74973356009068 , 120.43511337868478 , 142.9779648526077  , 143.79225623582767 , 170.37836167800455 , 171.34304988662134 , 203.61979024943315 , 204.7649546485261  , 206.77812358276648 , 207.92328798185943 , 175.3414569160998  , 176.30614512471652 , 148.8434410430839  , 149.65773242630388 , 125.87303287981858 , 126.55841269841271 , 144.43782879818593 , 145.23171201814057 , 172.42116213151928 , 173.3643650793651  , 205.41679705215424 , 206.53420634920639 , 245.4296541950114  , 246.75611111111115 , 249.08798752834474 , 250.41444444444448 , 211.16560657596375 , 212.28301587301587 , 179.2152097505669  , 180.15841269841275 , 151.53051587301587 , 152.32439909297057 , 175.2660034013605  , 176.18647392290248 , 209.17790816326527 , 210.27150793650796 , 249.14576530612246 , 250.44134920634926 , 297.59195578231305 , 299.12992063492067 , 301.8336224489797  , 303.37158730158734 , 255.81124149659865 , 257.1068253968254  , 217.05528911564627 , 218.14888888888893 , 183.48964285714285 , 184.41011337868485 , 186.6765986394557  , 187.55909297052156 , 222.69564625850336 , 223.74412698412698 , 265.1051700680272  , 266.3473015873016  , 316.46136054421765 , 317.9358730158731  , 320.5280272108843  , 322.0025396825398  , 271.4956462585034  , 272.7377777777778  , 230.24802721088432 , 231.29650793650796 , 194.5609523809524  , 195.44344671201813 , 214.15362244897955 , 215.07409297052155 , 255.37981292517    , 256.4734126984127  , 303.88100340136054 , 305.17658730158723 , 362.567193877551   , 364.10515873015873 , 366.8088605442177  , 368.3468253968254  , 310.54647959183666 , 311.84206349206346 , 263.257193877551   , 264.35079365079366 , 222.3772619047619  , 223.2977324263039  , 191.42703514739227 , 192.22091836734697 , 228.24846371882083 , 229.19166666666666 , 271.55520975056686 , 272.6726190476191  , 323.9414002267573  , 325.2678571428571  , 327.59973356009067 , 328.92619047619047 , 277.3040192743764  , 278.4214285714286  , 235.0425113378685  , 235.9857142857143  , 198.5197222222222  , 199.3136054421769  , 170.21104875283444 , 170.89642857142857 , 202.9304365079365  , 203.7447278911565  , 241.40384920634918 , 242.368537414966   , 287.9328968253968  , 289.0780612244898  , 291.0912301587302  , 292.23639455782313 , 246.36694444444444 , 247.33163265306126 , 208.7959126984127  , 209.61020408163267 , 176.33434807256236 , 177.0197278911565  , 147.25900793650794 , 147.8358843537415  , 175.54982426303854 , 176.2352040816327  , 208.8089512471655  , 209.62091836734697 , 249.0237131519274  , 249.98758503401368 , 251.68204648526077 , 252.645918367347   , 212.9863321995465  , 213.79829931972793 , 180.48672902494332 , 181.17210884353744 , 152.41291950113379 , 152.98979591836735 , 179.8678968253968  , 180.4447732426304  , 214.29204648526073 , 214.97742630385486 , 254.70672902494326 , 255.5186961451247  , 303.5081575963719  , 304.472029478458   , 306.16649092970516 , 307.1303628117913  , 258.8841099773243  , 259.6960770975056  , 219.22895124716553 , 219.91433106575963 , 185.02180839002267 , 185.59868480725623 , 218.4444274376417  , 219.12980725623584 , 260.2359240362811  , 261.0502154195011  , 309.2934637188208  , 310.25815192743767 , 368.5234637188209  , 369.66862811791384 , 371.68179705215414 , 372.82696145124714 , 314.2565589569161  , 315.2212471655329  , 266.10140022675733 , 266.91569160997733 , 224.5677267573696  , 225.2531065759637  , 258.7570124716553  , 259.55089569161    , 308.2423866213152  , 309.18558956916104 , 366.32373582766445 , 367.4411451247166  , 436.43945011337877 , 437.7659070294785  , 440.09778344671207 , 441.4242403628118  , 372.07254535147393 , 373.1899546485261  , 315.03643424036284 , 315.97963718820864 , 265.8496995464853  , 266.64358276643986 , 307.8137585034013  , 308.73422902494326 , 366.656275510204   , 367.7498752834467  , 435.7098469387755  , 437.0054308390023  , 519.0588945578231  , 520.5968594104309  , 523.3005612244898  , 524.8385260770974  , 442.3753231292517  , 443.6709070294784  , 374.53365646258504 , 375.6272562358277  , 316.0373979591837  , 316.9578684807256  , 313.75578231292513 , 314.638276643991   , 373.6768707482993  , 374.7253514739229  , 443.9721088435374  , 445.21424036281184 , 528.7911564625851  , 530.2656689342404  , 532.8578231292516  , 534.3323356009071  , 450.36258503401353 , 451.6047165532879  , 381.22925170068027 , 382.2777324263038  , 321.6401360544217  , 322.52263038548756 , 346.70137755102036 , 347.6218480725624  , 412.8581802721088  , 413.95178004535154 , 490.44508503401363 , 491.74066893424043 , 584.0341326530612  , 585.5720975056689  , 588.2757993197279  , 589.8137641723356  , 497.1105612244898  , 498.4061451247166  , 420.73556122448974 , 421.82916099773246 , 354.9250170068027  , 355.8454875283447  , 305.74621882086166 , 306.54010204081635 , 364.0696882086168  , 365.0128911564626  , 432.4621485260771  , 433.5795578231293  , 514.9511961451248  , 516.2776530612246  , 518.609529478458   , 519.9359863945579  , 438.2109580498866  , 439.32836734693876 , 370.86373582766436 , 371.8069387755102  , 312.8389058956916  , 313.63278911564623 , 268.9057426303855  , 269.5911224489796  , 320.18839569160997 , 321.0026870748299  , 380.31895124716556 , 381.2836394557823  , 452.83657029478456 , 453.9817346938776  , 455.99490362811787 , 457.14006802721093 , 385.28204648526076 , 386.2467346938775  , 326.0538718820862  , 326.86816326530607 , 275.02904195011337 , 275.7144217687075  , 230.3292120181406  , 230.90608843537413 , 274.2445181405896  , 274.9298979591837  , 325.732216553288   , 326.5441836734693  , 387.8212641723356  , 388.7851360544217  , 390.47959750566895 , 391.44346938775504 , 329.90959750566896 , 330.7215646258503  , 279.1814229024943  , 279.86680272108845 , 235.48312358276644 , 236.06             };
  const std::array<int, 4> in_shape = {{ 3, 9, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.2857142857142857  , 0.32653061224489793 , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.6530612244897959  , 0.7346938775510203  , 0.36734693877551017 , 0.40816326530612246 , 0.18367346938775508 , 0.2040816326530612  , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.4081632653061224  , 0.44897959183673464 , 0.22448979591836732 , 0.24489795918367346 , 0.26530612244897955 , 0.2857142857142857  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.3061224489795918  , 0.32653061224489793 , 0.6122448979591837  , 0.6530612244897959  , 1.3061224489795917  , 1.3877551020408163  , 1.3061224489795917  , 1.3877551020408163  , 1.3061224489795917  , 1.3877551020408163  , 1.3061224489795917  , 1.3877551020408163  , 1.3061224489795917  , 1.3877551020408163  , 1.3061224489795917  , 1.3877551020408163  , 0.693877551020408   , 0.7346938775510203  , 1.0408163265306123  , 1.1020408163265305  , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 1.1632653061224487  , 1.2244897959183674  , 1.0408163265306123  , 1.1020408163265305  , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 2.204081632653061   , 2.326530612244898   , 1.1632653061224487  , 1.2244897959183674  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.8979591836734693  , 0.9387755102040816  , 0.4693877551020408  , 0.4897959183673469  , 0.5102040816326531  , 0.5306122448979591  , 1.0612244897959182  , 1.1020408163265305  , 1.0612244897959182  , 1.1020408163265305  , 1.0612244897959182  , 1.1020408163265305  , 1.0612244897959182  , 1.1020408163265305  , 1.0612244897959182  , 1.1020408163265305  , 1.0612244897959182  , 1.1020408163265305  , 0.5510204081632653  , 0.5714285714285714  , 1.1020408163265305  , 1.1428571428571428  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 1.183673469387755   , 1.2244897959183674  , 1.7755102040816326  , 1.8367346938775508  , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 1.8979591836734693  , 1.9591836734693877  , 1.7755102040816326  , 1.8367346938775508  , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 3.6734693877551017  , 3.795918367346938   , 1.8979591836734693  , 1.9591836734693877  , 1.2653061224489797  , 1.3061224489795917  , 2.612244897959184   , 2.693877551020408   , 2.612244897959184   , 2.693877551020408   , 2.612244897959184   , 2.693877551020408   , 2.612244897959184   , 2.693877551020408   , 2.612244897959184   , 2.693877551020408   , 2.612244897959184   , 2.693877551020408   , 1.3469387755102038  , 1.387755102040816   , 0.673469387755102   , 0.6938775510204082  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 0.7142857142857142  , 0.7346938775510203  };
  const std::array<int, 4> in_shape = {{ 3, 9, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  59.44340702947846 ,  60.2372902494331  ,  61.031173469387745,  61.825056689342404,  72.2566723356009  ,  73.19987528344672 ,  74.1430782312925  ,  75.08628117913833 ,  87.9023072562358  ,  89.01971655328799 ,  90.13712585034013 ,  91.25453514739229 , 107.51325963718818 , 108.839716553288   , 110.16617346938774 , 111.4926303854875  , 114.82992630385486 , 116.15638321995466 , 117.48284013605442 , 118.80929705215416 ,  99.39992630385487 , 100.51733560090703 , 101.63474489795917 , 102.75215419501131 ,  85.84476757369615 ,  86.78797052154195 ,  87.73117346938774 ,  88.67437641723355 ,  73.62878117913833 ,  74.42266439909297 ,  75.21654761904762 ,  76.01043083900227 ,  84.5160260770975  ,  85.43649659863944 ,  86.35696712018138 ,  87.27743764172337 , 102.30548185941042 , 103.39908163265305 , 104.49268140589568 , 105.58628117913834 , 123.867783446712   , 125.16336734693877 , 126.45895124716553 , 127.7545351473923  , 150.7120691609977  , 152.25003401360547 , 153.78799886621314 , 155.32596371882084 , 159.19540249433103 , 160.7333673469388  , 162.27133219954646 , 163.8092970521542  , 137.1987358276644  , 138.49431972789117 , 139.78990362811788 , 141.08548752834466 , 118.06024376417234 , 119.15384353741496 , 120.24744331065759 , 121.3410430839002  , 100.96330498866214 , 101.88377551020407 , 102.80424603174603 , 103.72471655328798 , 118.31233560090702 , 119.19482993197276 , 120.07732426303852 , 120.95981859410432 , 142.38036281179137 , 143.42884353741496 , 144.47732426303853 , 145.52580498866214 , 171.23433106575962 , 172.476462585034   , 173.71859410430838 , 174.9607256235828  , 206.78861678004532 , 208.26312925170072 , 209.73764172335598 , 211.21215419501138 , 214.92195011337864 , 216.39646258503402 , 217.8709750566893  , 219.3454875283447  , 184.01528344671203 , 185.25741496598638 , 186.49954648526074 , 187.74167800453515 , 157.48512471655332 , 158.53360544217685 , 159.5820861678004  , 160.63056689342406 , 134.08104308390025 , 134.96353741496597 , 135.84603174603174 , 136.7285260770975  , 162.29126417233562 , 163.21173469387753 , 164.13220521541948 , 165.05267573696145 , 194.70929138321995 , 195.80289115646255 , 196.8964909297052  , 197.99009070294784 , 233.3382596371882  , 234.63384353741495 , 235.92942743764172 , 237.2250113378685  , 280.6625453514739  , 282.20051020408164 , 283.7384750566893  , 285.2764399092971  , 289.14587868480726 , 290.683843537415   , 292.2218083900226  , 293.7597732426304  , 246.6692120181406  , 247.96479591836734 , 249.2603798185941  , 250.55596371882086 , 210.4640532879819  , 211.55765306122444 , 212.65125283446713 , 213.74485260770976 , 178.73854308390025 , 179.65901360544217 , 180.57948412698414 , 181.49995464852603 , 153.42181972789115 , 154.21570294784578 , 155.00958616780042 , 155.8034693877551  , 183.91127551020406 , 184.85447845804984 , 185.79768140589567 , 186.74088435374148 , 220.1791326530612  , 221.29654195011338 , 222.41395124716553 , 223.53136054421768 , 264.53675170068027 , 265.86320861678    , 267.1896655328798  , 268.51612244897956 , 271.853418367347   , 273.1798752834467  , 274.5063321995465  , 275.8327891156462  , 231.67675170068028 , 232.7941609977324  , 233.91157029478455 , 235.02897959183673 , 197.49937074829933 , 198.4425736961451  , 199.38577664399094 , 200.3289795918367  , 167.60719387755103 , 168.4010770975057  , 169.19496031746033 , 169.98884353741494 , 142.34732993197278 , 143.0327097505669  , 143.71808956916098 , 144.4034693877551  , 170.53066326530612 , 171.34495464852606 , 172.15924603174602 , 172.973537414966   , 204.01280612244898 , 204.97749433106574 , 205.94218253968253 , 206.90687074829933 , 244.91328231292516 , 246.05844671201814 , 247.20361111111106 , 248.34877551020406 , 251.22994897959185 , 252.37511337868477 , 253.52027777777775 , 254.66544217687073 , 213.93899659863948 , 214.90368480725624 , 215.868373015873   , 216.8330612244898  , 182.26161564625852 , 183.07590702947846 , 183.89019841269842 , 184.70448979591833 , 154.5939285714286  , 155.27930839002266 , 155.96468820861676 , 156.6500680272109  , 127.80073129251701 , 128.37760770975058 , 128.9544841269841  , 129.53136054421768 , 153.02488095238095 , 153.71026077097505 , 154.39564058956915 , 155.08102040816325 , 182.95940476190475 , 183.77137188208616 , 184.5833390022676  , 185.39530612244894 , 219.4884523809524  , 220.45232426303855 , 221.41619614512473 , 222.38006802721085 , 224.80511904761906 , 225.7689909297052  , 226.7328628117914  , 227.69673469387752 , 191.31416666666667 , 192.12613378684807 , 192.93810090702948 , 193.7500680272109  , 162.8986904761905  , 163.58407029478457 , 164.2694501133787  , 164.95482993197277 , 138.1085544217687  , 138.68543083900227 , 139.26230725623583 , 139.8391836734694  , 193.01850907029478 , 193.59538548752832 , 194.1722619047619  , 194.74913832199542 , 230.5093253968254  , 231.1947052154195  , 231.88008503401363 , 232.56546485260768 , 274.7549603174604  , 275.5669274376417  , 276.3788945578232  , 277.1908616780046  , 328.4573412698413  , 329.4212131519275  , 330.3850850340137  , 331.3489569160998  , 333.7740079365079  , 334.73787981859414 , 335.70175170068035 , 336.66562358276644 , 283.1097222222223  , 283.9216893424036  , 284.73365646258503 , 285.5456235827663  , 240.3831349206349  , 241.06851473922902 , 241.75389455782314 , 242.43927437641725 , 203.32633219954647 , 203.90320861678003 , 204.48008503401363 , 205.0569614512472  , 238.8140873015873  , 239.49946712018135 , 240.1848469387755  , 240.87022675736955 , 285.1416383219954  , 285.9559297052154  , 286.7702210884354  , 287.58451247165533 , 339.79203514739237 , 340.7567233560091  , 341.7214115646259  , 342.6860997732427  , 406.0944160997733  , 407.2395804988663  , 408.3847448979593  , 409.5299092970522  , 412.4110827664399  , 413.55624716553297 , 414.70141156462597 , 415.84657596371886 , 349.71822562358284 , 350.6829138321996  , 351.64760204081637 , 352.61229024943304 , 296.8725907029479  , 297.6868820861678  , 298.50117346938777 , 299.31546485260776 , 251.06068594104306 , 251.74606575963716 , 252.43144557823132 , 253.11682539682542 , 288.08177437641723 , 288.87565759637187 , 289.66954081632656 , 290.46342403628114 , 343.8991213151927  , 344.84232426303856 , 345.78552721088437 , 346.7287301587302  , 409.7161848072563  , 410.8335941043085  , 411.9510034013606  , 413.06841269841277 , 489.532851473923   , 490.8593083900228  , 492.18576530612256 , 493.5122222222223  , 496.84951814058957 , 498.1759750566895  , 499.5024319727892  , 500.82888888888897 , 421.21380385487544 , 422.3312131519275  , 423.4486224489796  , 424.56603174603174 , 357.4872165532881  , 358.4304195011338  , 359.3736224489796  , 360.3168253968255  , 302.2671485260771  , 303.06103174603174 , 303.8549149659864  , 304.64879818594113 , 349.61153628117916 , 350.532006802721   , 351.4524773242631  , 352.37294784580496 , 417.26221655328794 , 418.35581632653054 , 419.4494160997733  , 420.5430158730159  , 496.9959467120182  , 498.2915306122449  , 499.5871145124717  , 500.8826984126985  , 593.6459467120183  , 595.1839115646261  , 596.7218764172337  , 598.2598412698413  , 602.1292800453515  , 603.6672448979594  , 605.205209750567   , 606.7431746031747  , 510.3268990929706  , 511.6224829931973  , 512.9180668934241  , 514.2136507936508  , 433.01697845804995 , 434.11057823129255 , 435.20417800453515 , 436.29777777777787 , 366.05881519274374 , 366.9792857142857  , 367.8997562358277  , 368.8202267573697  , 294.6954648526077  , 295.5779591836734  , 296.4604535147392  , 297.342947845805   , 351.9390022675737  , 352.9874829931972  , 354.0359637188208  , 355.0844444444444  , 419.49773242630386 , 420.73986394557824 , 421.9819954648526  , 423.22412698412694 , 501.4977324263038  , 502.97224489795923 , 504.44675736961443 , 505.9212698412699  , 509.6310657596372  , 511.10557823129255 , 512.5800907029478  , 514.0546031746032  , 432.27868480725624 , 433.5208163265306  , 434.76294784580494 , 436.00507936507944 , 367.0437641723355  , 368.0922448979591  , 369.1407256235827  , 370.1892063492064  , 310.4641723356008  , 311.3466666666667  , 312.22916099773244 , 313.1116553287982  , 252.3924886621315  , 253.31295918367346 , 254.23342970521537 , 255.15390022675737 , 301.757454648526   , 302.8510544217686  , 303.9446541950113  , 305.03825396825385 , 360.1578514739229  , 361.45343537414954 , 362.7490192743764  , 364.0446031746031  , 431.2078514739229  , 432.7458163265306  , 434.2837811791383  , 435.82174603174604 , 439.6911848072562  , 441.2291496598638  , 442.76711451247166 , 444.30507936507934 , 373.48880385487513 , 374.78438775510193 , 376.0799716553289  , 377.3755555555555  , 317.51221655328783 , 318.60581632653054 , 319.69941609977326 , 320.7930158730158  , 268.8397675736961  , 269.76023809523804 , 270.68070861678    , 271.601179138322   , 207.06590136054422 , 207.85978458049885 , 208.6536678004535  , 209.44755102040816 , 247.6451530612245  , 248.58835600907028 , 249.53155895691606 , 250.47476190476186 , 295.6844387755101  , 296.80184807256234 , 297.9192573696145  , 299.03666666666663 , 354.1677721088434  , 355.49422902494325 , 356.820685941043   , 358.1471428571428  , 361.48443877551006 , 362.81089569160986 , 364.13735260770983 , 365.46380952380946 , 307.1820578231291  , 308.2994671201814  , 309.4168764172336  , 310.5342857142856  , 261.2332482993197  , 262.1764512471655  , 263.1196541950114  , 264.0628571428571  , 221.2512755102041  , 222.04515873015868 , 222.83904195011337 , 223.63292517006806 , 164.74243197278912 , 165.42781179138322 , 166.11319160997726 , 166.79857142857136 , 197.13801020408167 , 197.95230158730158 , 198.76659297052151 , 199.5808843537415  , 235.5344387755102  , 236.49912698412695 , 237.4638151927437  , 238.42850340136053 , 282.33205782312916 , 283.4772222222222  , 284.6223866213151  , 285.767551020408   , 288.6487244897958  , 289.7938888888889  , 290.93905328798184 , 292.08421768707467 , 245.46062925170074 , 246.42531746031742 , 247.3900056689342  , 248.35469387755106 , 208.86896258503404 , 209.68325396825395 , 210.49754535147392 , 211.3118367346939  , 176.9890306122449  , 177.67441043083898 , 178.35979024943313 , 179.04517006802723 , 118.94685374149658 , 119.52373015873015 , 120.10060657596374 , 120.67748299319727 , 142.50569727891158 , 143.19107709750566 , 143.87645691609976 , 144.5618367346939  , 170.49736394557826 , 171.3093310657596  , 172.12129818594101 , 172.93326530612248 , 204.6949829931973  , 205.65885487528342 , 206.6227267573696  , 207.58659863945581 , 210.01164965986396 , 210.97552154195012 , 211.93939342403627 , 212.9032653061225  , 178.85212585034014 , 179.66409297052152 , 180.47606009070296 , 181.28802721088442 , 152.37950680272107 , 153.06488662131517 , 153.7502664399093  , 154.43564625850345 , 129.25467687074828 , 129.83155328798188 , 130.4084297052154  , 130.98530612244897 ,  63.79819160997732 ,  64.37506802721089 ,  64.95194444444445 ,  65.52882086167799 ,  76.98424603174603 ,  77.66962585034014 ,  78.35500566893423 ,  79.04038548752834 ,  92.87432539682538 ,  93.6862925170068  ,  94.4982596371882  ,  95.3102267573696  , 112.55003968253968 , 113.51391156462587 , 114.47778344671201 , 115.44165532879819 , 117.86670634920634 , 118.83057823129255 , 119.79445011337867 , 120.75832199546485 , 101.2290873015873  , 102.0410544217687  , 102.8530215419501  , 103.66498866213152 ,  86.85805555555555 ,  87.54343537414967 ,  88.22881519274375 ,  88.91419501133787 ,  74.10601473922902 ,  74.68289115646259 ,  75.25976757369614 ,  75.8366439909297  ,  85.28900793650794 ,  85.97438775510204 ,  86.65976757369614 ,  87.34514739229023 , 102.74036848072562 , 103.55465986394559 , 104.36895124716551 , 105.18324263038548 , 123.70187641723355 , 124.66656462585036 , 125.6312528344671  , 126.59594104308388 , 149.57759070294782 , 150.72275510204085 , 151.86791950113377 , 153.01308390022677 , 155.89425736961448 , 157.0394217687075  , 158.18458616780046 , 159.3297505668934  , 133.62806689342403 , 134.5927551020408  , 135.5574433106576  , 136.52213151927438 , 114.471320861678   , 115.28561224489796 , 116.0999036281179  , 116.91419501133787 ,  97.53560657596371 ,  98.22098639455784 ,  98.90636621315191 ,  99.59174603174603 , 110.25193310657596 , 111.04581632653061 , 111.83969954648526 , 112.63358276643989 , 132.62166099773242 , 133.56486394557822 , 134.50806689342403 , 135.45126984126983 , 159.4165022675737  , 160.53391156462592 , 161.651320861678   , 162.76873015873014 , 192.40650226757367 , 193.73295918367353 , 195.05941609977324 , 196.38587301587302 , 199.72316893424033 , 201.04962585034022 , 202.37608276643994 , 203.70253968253965 , 170.91412131519274 , 172.0315306122449  , 173.14893990929707 , 174.2663492063492  , 146.20975623582763 , 147.1529591836735  , 148.09616213151926 , 149.03936507936507 , 124.43730725623581 , 125.23119047619049 , 126.02507369614511 , 126.81895691609976 , 143.4261394557823  , 144.34660997732425 , 145.26708049886622 , 146.18755102040816 , 172.29586734693876 , 173.38946712018137 , 174.48306689342402 , 175.5766666666667  , 206.7851530612245  , 208.0807369614513  , 209.37632086167795 , 210.67190476190478 , 249.14181972789115 , 250.6797845804989  , 252.21774943310655 , 253.75571428571433 , 257.62515306122447 , 259.16311791383225 , 260.7010827664399  , 262.2390476190476  , 220.1161054421769  , 221.4116893424036  , 222.7072732426304  , 224.00285714285715 , 188.05062925170066 , 189.14422902494331 , 190.23782879818594 , 191.33142857142857 , 159.87341836734694 , 160.79388888888892 , 161.71435941043083 , 162.63482993197277 , 174.79197278911562 , 175.6744671201814  , 176.55696145124716 , 177.4394557823129  , 209.48312925170066 , 210.53160997732422 , 211.58009070294784 , 212.62857142857146 , 250.73074829931974 , 251.97287981859407 , 253.2150113378685  , 254.4571428571429  , 301.1574149659864  , 302.6319274376417  , 304.106439909297   , 305.5809523809524  , 309.2907482993198  , 310.76526077097503 , 312.2397732426304  , 313.7142857142857  , 263.51170068027216 , 264.7538321995465  , 265.99596371882086 , 267.23809523809524 , 224.5878911564626  , 225.6363718820862  , 226.68485260770973 , 227.73333333333335 , 190.56068027210887 , 191.44317460317458 , 192.32566893424035 , 193.2081632653061  , 221.20137755102039 , 222.12184807256236 , 223.0423185941043  , 223.96278911564627 , 264.6996768707483  , 265.7932766439909  , 266.88687641723357 , 267.9804761904762  , 316.25562925170067 , 317.5512131519274  , 318.8467970521542  , 320.14238095238096 , 379.0922959183673  , 380.63026077097504 , 382.1682256235828  , 383.7061904761904  , 387.5756292517007  , 389.1135941043084  , 390.6515589569162  , 392.1895238095238  , 329.58658163265306 , 330.8821655328798  , 332.17774943310656 , 333.47333333333336 , 280.4544387755102  , 281.54803854875286 , 282.64163832199546 , 283.73523809523806 , 237.64865646258505 , 238.56912698412702 , 239.4895975056689  , 240.41006802721088 , 204.23034580498864 , 205.0242290249433  , 205.81811224489792 , 206.6119954648526  , 244.2762641723356  , 245.2194671201814  , 246.1626700680272  , 247.10587301587302 , 291.6933276643991  , 292.81073696145125 , 293.9281462585034  , 295.04555555555555 , 349.42999433106576 , 350.7564512471655  , 352.08290816326536 , 353.40936507936505 , 356.7466609977324  , 358.0731179138322  , 359.399574829932   , 360.7260317460317  , 303.19094671201816 , 304.30835600907034 , 305.42576530612246 , 306.5431746031746  , 257.86435941043084 , 258.80756235827664 , 259.75076530612245 , 260.69396825396825 , 218.41571995464852 , 219.2096031746032  , 220.0034863945578  , 220.79736961451246 , 186.21163832199548 , 186.89701814058955 , 187.58239795918365 , 188.2677777777778  , 222.64531179138322 , 223.45960317460316 , 224.2738945578231  , 225.0881859410431  , 265.7528514739229  , 266.71753968253967 , 267.68222789115646 , 268.64691609977325 , 318.2038038548753  , 319.3489682539683  , 320.4941326530613  , 321.6392970521542  , 324.52047052154194 , 325.6656349206349  , 326.8107993197279  , 327.95596371882084 , 275.6790419501134  , 276.64373015873014 , 277.60841836734687 , 278.5731065759637  , 234.3762641723356  , 235.1905555555556  , 236.0048469387755  , 236.81913832199544 , 198.45823696145123 , 199.1436167800454  , 199.82899659863943 , 200.51437641723356 , 164.72082199546486 , 165.29769841269842 , 165.87457482993196 , 166.45145124716552 , 196.88918934240363 , 197.57456916099775 , 198.25994897959183 , 198.94532879818595 , 234.92530045351475 , 235.73726757369616 , 236.54923469387754 , 237.36120181405897 , 281.1762528344671  , 282.1401247165533  , 283.10399659863947 , 284.0678684807256  , 286.49291950113377 , 287.45679138322    , 288.4206632653061  , 289.3845351473923  , 243.28006235827664 , 244.09202947845807 , 244.90399659863942 , 245.7159637188209  , 206.76299886621314 , 207.44837868480727 , 208.13375850340134 , 208.81913832199547 , 175.02864512471655 , 175.6055215419501  , 176.18239795918367 , 176.75927437641724 };
  const std::array<int, 4> in_shape = {{ 3, 9, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.12244897959183672 , 0.16326530612244897 , 0.20408163265306123 , 0.24489795918367346 , 0.1020408163265306  , 0.12244897959183673 , 0.14285714285714285 , 0.16326530612244897 , 0.2040816326530612  , 0.24489795918367344 , 0.2857142857142857  , 0.32653061224489793 , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 0.7346938775510203  , 0.8163265306122449  , 0.36734693877551017 , 0.40816326530612246 , 0.44897959183673464 , 0.4897959183673469  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5510204081632653  , 0.6122448979591836  , 0.673469387755102   , 0.7346938775510203  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 1.346938775510204   , 1.4693877551020407  , 1.5918367346938775  , 1.7142857142857144  , 0.7959183673469388  , 0.8571428571428571  , 0.9183673469387754  , 0.9795918367346939  , 0.5306122448979591  , 0.5714285714285714  , 0.6122448979591837  , 0.6530612244897959  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 1.2244897959183674  , 1.3061224489795917  , 1.387755102040816   , 1.4693877551020407  , 0.693877551020408   , 0.7346938775510203  , 0.7755102040816326  , 0.8163265306122449  , 0.3469387755102041  , 0.36734693877551017 , 0.3877551020408163  , 0.4081632653061224  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.7755102040816326  , 0.8163265306122448  , 0.8571428571428571  , 0.8979591836734693  , 0.42857142857142855 , 0.44897959183673464 , 0.4693877551020408  , 0.4897959183673469  , 0.5102040816326531  , 0.5306122448979591  , 0.5510204081632653  , 0.5714285714285714  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 1.1020408163265305  , 1.1428571428571428  , 1.183673469387755   , 1.2244897959183674  , 0.5918367346938775  , 0.6122448979591836  , 0.6326530612244897  , 0.6530612244897959  , 1.183673469387755   , 1.2244897959183674  , 1.2653061224489794  , 1.3061224489795917  , 2.5306122448979593  , 2.6122448979591835  , 2.693877551020408   , 2.7755102040816326  , 2.5306122448979593  , 2.6122448979591835  , 2.693877551020408   , 2.7755102040816326  , 2.5306122448979593  , 2.6122448979591835  , 2.693877551020408   , 2.7755102040816326  , 2.5306122448979593  , 2.6122448979591835  , 2.693877551020408   , 2.7755102040816326  , 2.5306122448979593  , 2.6122448979591835  , 2.693877551020408   , 2.7755102040816326  , 2.5306122448979593  , 2.6122448979591835  , 2.693877551020408   , 2.7755102040816326  , 1.346938775510204   , 1.387755102040816   , 1.4285714285714284  , 1.4693877551020407  , 2.020408163265306   , 2.0816326530612246  , 2.142857142857143   , 2.204081632653061   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 2.2653061224489797  , 2.3265306122448974  , 2.387755102040816   , 2.4489795918367347  , 2.020408163265306   , 2.0816326530612246  , 2.142857142857143   , 2.204081632653061   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 2.2653061224489797  , 2.3265306122448974  , 2.387755102040816   , 2.4489795918367347  , 2.020408163265306   , 2.0816326530612246  , 2.142857142857143   , 2.204081632653061   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 2.2653061224489797  , 2.3265306122448974  , 2.387755102040816   , 2.4489795918367347  , 2.020408163265306   , 2.0816326530612246  , 2.142857142857143   , 2.204081632653061   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 2.2653061224489797  , 2.3265306122448974  , 2.387755102040816   , 2.4489795918367347  , 2.020408163265306   , 2.0816326530612246  , 2.142857142857143   , 2.204081632653061   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 4.285714285714286   , 4.408163265306122   , 4.530612244897959   , 4.653061224489796   , 2.2653061224489797  , 2.3265306122448974  , 2.387755102040816   , 2.4489795918367347  , 1.510204081632653   , 1.5510204081632653  , 1.5918367346938775  , 1.6326530612244896  , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 3.346938775510204   , 3.428571428571429   , 1.673469387755102   , 1.7142857142857142  , 1.7551020408163263  , 1.7959183673469385  , 0.836734693877551   , 0.8571428571428571  , 0.8775510204081632  , 0.8979591836734693  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 1.7551020408163263  , 1.7959183673469385  , 1.8367346938775508  , 1.8775510204081631  , 0.9183673469387754  , 0.9387755102040816  , 0.9591836734693877  , 0.9795918367346939  , 0.9999999999999999  , 1.0204081632653061  , 1.040816326530612   , 1.0612244897959182  , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 2.081632653061224   , 2.1224489795918364  , 2.1632653061224487  , 2.204081632653061   , 1.0816326530612244  , 1.1020408163265305  , 1.1224489795918366  , 1.1428571428571428  , 2.1632653061224487  , 2.204081632653061   , 2.2448979591836733  , 2.2857142857142856  , 4.489795918367346   , 4.571428571428571   , 4.653061224489796   , 4.7346938775510194  , 4.489795918367346   , 4.571428571428571   , 4.653061224489796   , 4.7346938775510194  , 4.489795918367346   , 4.571428571428571   , 4.653061224489796   , 4.7346938775510194  , 4.489795918367346   , 4.571428571428571   , 4.653061224489796   , 4.7346938775510194  , 4.489795918367346   , 4.571428571428571   , 4.653061224489796   , 4.7346938775510194  , 4.489795918367346   , 4.571428571428571   , 4.653061224489796   , 4.7346938775510194  , 2.3265306122448974  , 2.36734693877551    , 2.408163265306122   , 2.4489795918367347  , 3.4897959183673466  , 3.5510204081632653  , 3.6122448979591835  , 3.6734693877551017  , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 3.7346938775510194  , 3.7959183673469385  , 3.8571428571428568  , 3.9183673469387754  , 3.4897959183673466  , 3.5510204081632653  , 3.6122448979591835  , 3.6734693877551017  , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 3.7346938775510194  , 3.7959183673469385  , 3.8571428571428568  , 3.9183673469387754  , 3.4897959183673466  , 3.5510204081632653  , 3.6122448979591835  , 3.6734693877551017  , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 3.7346938775510194  , 3.7959183673469385  , 3.8571428571428568  , 3.9183673469387754  , 3.4897959183673466  , 3.5510204081632653  , 3.6122448979591835  , 3.6734693877551017  , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 3.7346938775510194  , 3.7959183673469385  , 3.8571428571428568  , 3.9183673469387754  , 3.4897959183673466  , 3.5510204081632653  , 3.6122448979591835  , 3.6734693877551017  , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 7.224489795918366   , 7.346938775510203   , 7.469387755102041   , 7.591836734693876   , 3.7346938775510194  , 3.7959183673469385  , 3.8571428571428568  , 3.9183673469387754  , 2.4897959183673466  , 2.5306122448979593  , 2.571428571428571   , 2.6122448979591835  , 5.142857142857142   , 5.224489795918368   , 5.3061224489795915  , 5.387755102040816   , 5.142857142857142   , 5.224489795918368   , 5.3061224489795915  , 5.387755102040816   , 5.142857142857142   , 5.224489795918368   , 5.3061224489795915  , 5.387755102040816   , 5.142857142857142   , 5.224489795918368   , 5.3061224489795915  , 5.387755102040816   , 5.142857142857142   , 5.224489795918368   , 5.3061224489795915  , 5.387755102040816   , 5.142857142857142   , 5.224489795918368   , 5.3061224489795915  , 5.387755102040816   , 2.6530612244897958  , 2.6938775510204076  , 2.7346938775510203  , 2.775510204081632   , 1.3265306122448979  , 1.346938775510204   , 1.3673469387755102  , 1.3877551020408163  , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 2.7346938775510203  , 2.775510204081632   , 2.816326530612245   , 2.8571428571428568  , 1.4081632653061222  , 1.4285714285714284  , 1.4489795918367345  , 1.4693877551020407  };
  const std::array<int, 4> in_shape = {{ 3, 9, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  7.882772108843537,   9.66202380952381 ,  11.549778911564626,  13.87874716553288 ,  14.47124716553288 ,  16.30922335600907 ,  14.486604308390024,  12.815856009070295,  11.036604308390022,  12.034812925170067,  14.65079931972789 ,  17.395697278911566,  20.748475056689344,  21.276689342403625,  23.63609410430839 ,  20.884903628117918,  18.39782879818594 ,  15.781842403628119,  17.163384353741495,  20.799778911564623,  24.58549319727891 ,  29.176366213151926,  29.57600907029478 ,  32.52112811791383 ,  28.627080498866217,  25.14000566893424 ,  21.50361111111111 ,  24.286003401360542,  29.327159863945575,  34.54144557823129 ,  40.826763038548755,  41.001405895691605,  44.70485827664399 ,  39.227477324263035,  34.359450113378685,  29.318293650793645,  33.76993197278911 ,  40.57537414965986 ,  47.54680272108843 ,  55.87378684807257 ,  55.35092970521542 ,  59.59188208616779 ,  52.039501133786835,  45.40004535147391 ,  38.59460317460317 ,  46.16028911564626 ,  55.31573129251701 ,  64.64430272108844 ,  75.7296201814059  ,  74.46426303854875 ,  79.60771541950113 ,  69.33033446712017 ,  60.34802154195011 ,  51.19257936507936 ,  43.59481292517007 ,  52.20263605442177 ,  60.95977891156462 ,  71.35065192743765 ,  70.0102947845805  ,  74.69541383219953 ,  65.00136621315193 ,  56.54286281179137 ,  47.935039682539674,  40.419302721088435,  48.374064625850345,  56.457738095238085,  66.0390873015873  ,  64.69873015873014 ,  68.92670634920634 ,  59.94694444444444 ,  52.12109410430838 ,  44.16633219954649 ,  36.2672619047619  ,  43.385289115646266,  50.61181972789116 ,  59.169359410430836,  57.89328798185941 ,  61.59983560090703 ,  53.54864512471655 ,  46.539121315192745,  39.421094104308395,  54.60976190476192 ,  65.17778911564626 ,  75.85431972789115 ,  88.43685941043083 ,  85.9532879818594  ,  90.86733560090704 ,  78.79114512471655 ,  68.33162131519275 ,  57.763594104308396,  67.55057823129252 ,  80.60840136054424 ,  93.79513605442176 , 109.33005668934238 , 106.20362811791384 , 112.21767573696147 ,  97.2843424036281  ,  84.35543083900227 ,  71.29760770975057 ,  81.46792517006803 ,  97.19921768707485 , 113.07982993197278 , 131.78141723356006 , 127.94784580498866 , 135.12617913832202 , 117.12141723356007 , 101.53944444444444 ,  85.80815192743763 ,  98.8441156462585  , 117.90874149659865 , 137.14649659863946 , 159.79252834467118 , 155.05895691609982 , 163.6706235827665  , 141.8325283446712  , 122.94103174603174 , 103.8764058956916  , 105.25197278911564 , 125.50231292517007 , 145.9186394557823  , 169.93133786848074 , 164.7027664399093  , 173.64943310657597 , 150.41133786848073 , 130.32698412698412 , 110.0766439909297  , 120.71840136054422 , 143.89731292517007 , 167.24935374149658 , 194.6953854875283  , 188.5218140589569  , 198.57348072562357 , 171.93538548752832 , 148.92960317460316 , 125.75069160997732 , 107.8993537414966  , 128.60207482993198 , 149.4541156462585  , 173.95570294784577 , 168.38213151927437 , 177.3004648526077  , 153.49570294784579 , 132.94230158730159 , 112.2395804988662  ,  95.93506802721089 , 114.33166666666668 , 132.8571768707483  , 154.62066893424034 , 149.62566893424037 , 157.5082879818594  , 136.34638321995465 , 118.07869614512472 ,  99.68209750566893 ,  82.99425170068028 ,  98.9010544217687  , 114.9163605442177  , 133.7274716553288  , 129.37532879818596 , 136.15794784580498 , 117.8531859410431  , 102.05488662131519 ,  86.14808390022675 , 101.33675170068027 , 120.6935544217687  , 140.1588605442177  , 162.99497165532878 , 157.43532879818596 , 165.42544784580502 , 143.0956859410431  , 123.84738662131518 , 104.49058390022677 , 123.06634353741497 , 146.56600340136052 , 170.19457482993198 , 197.91163832199544 , 191.13056689342403 , 200.7992573696145  , 173.6837811791383  , 150.31303287981856 , 126.81337301587303 , 145.77246598639454 , 173.59865646258498 , 201.57416666666666 , 234.38646825396822 , 226.31968253968253 , 237.73123015873017 , 205.61575396825396 , 177.93888321995465 , 150.1126927437642  , 173.40222789115646 , 206.49032312925166 , 239.7515476190476  , 278.75829365079363 , 269.1165079365079  , 282.6363888888889  , 244.43757936507936 , 211.5226133786848  , 178.4345181405896  , 176.73401360544221 , 210.42925170068034 , 244.29047619047623 , 283.98888888888894 , 274.05460317460324 , 287.70698412698414 , 248.78317460317461 , 215.25392290249434 , 181.5586848072562  , 195.27651360544218 , 232.47889455782317 , 269.8544047619048  , 313.66115079365085 , 302.5793650793651  , 317.5392460317461  , 274.5404365079365  , 237.51118480725617 , 200.30880385487526 , 172.20389455782313 , 205.0015136054422  , 237.94845238095243 , 276.560753968254   , 266.75396825396825 , 279.9055158730158  , 241.99003968253965 , 209.34174036281175 , 176.5441213151927  , 151.45083333333332 , 180.289268707483   , 209.2566156462585  , 243.20225056689344 , 234.55260770975053 , 246.08986961451242 , 212.7458219954648  , 184.036298185941   , 155.1978628117914  , 129.72124149659862 , 154.41681972789115 , 179.22090136054422 , 208.28558390022675 , 200.85736961451246 , 210.7160600907029  , 182.1577267573696  , 157.57065192743764 , 132.87507369614514 };
  const std::array<int, 4> in_shape = {{ 3, 9, 9, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.10204081632653061 , 0.061224489795918366, 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.22448979591836732 , 0.4897959183673469  , 0.7959183673469388  , 0.7959183673469388  , 0.7959183673469388  , 0.7959183673469388  , 0.7959183673469388  , 0.5714285714285714  , 0.30612244897959184 , 0.14285714285714285 , 0.30612244897959184 , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.4897959183673469  , 0.346938775510204   , 0.18367346938775508 , 0.2040816326530612  , 0.4285714285714285  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 , 0.4693877551020408  , 0.9795918367346937  , 1.5306122448979589  , 1.5306122448979589  , 1.5306122448979589  , 1.5306122448979589  , 1.5306122448979589  , 1.0612244897959182  , 0.5510204081632653  , 0.7959183673469388  , 1.6530612244897958  , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 1.7755102040816324  , 0.9183673469387754  , 0.7959183673469388  , 1.6530612244897958  , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 1.7755102040816324  , 0.9183673469387754  , 0.7959183673469388  , 1.6530612244897958  , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 1.7755102040816324  , 0.9183673469387754  , 0.7959183673469388  , 1.6530612244897958  , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 1.7755102040816324  , 0.9183673469387754  , 0.7959183673469388  , 1.6530612244897958  , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 2.571428571428571   , 1.7755102040816324  , 0.9183673469387754  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.32653061224489793 , 0.673469387755102   , 1.0408163265306123  , 1.0408163265306123  , 1.0408163265306123  , 1.0408163265306123  , 1.0408163265306123  , 0.7142857142857142  , 0.36734693877551017 , 0.3877551020408163  , 0.7959183673469388  , 1.2244897959183674  , 1.2244897959183674  , 1.2244897959183674  , 1.2244897959183674  , 1.2244897959183674  , 0.836734693877551   , 0.42857142857142855 , 0.836734693877551   , 1.714285714285714   , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 1.7959183673469385  , 0.9183673469387754  , 1.346938775510204   , 2.7551020408163263  , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 2.8775510204081627  , 1.4693877551020407  , 1.346938775510204   , 2.7551020408163263  , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 2.8775510204081627  , 1.4693877551020407  , 1.346938775510204   , 2.7551020408163263  , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 2.8775510204081627  , 1.4693877551020407  , 1.346938775510204   , 2.7551020408163263  , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 2.8775510204081627  , 1.4693877551020407  , 1.346938775510204   , 2.7551020408163263  , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 4.224489795918367   , 2.8775510204081627  , 1.4693877551020407  , 0.9591836734693877  , 1.9591836734693875  , 3.                  , 3.                  , 3.                  , 3.                  , 3.                  , 2.040816326530612   , 1.0408163265306123  , 0.5102040816326531  , 1.0408163265306123  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.0816326530612244  , 0.5510204081632653  };
  const std::array<int, 4> in_shape = {{ 3, 9, 9, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 15.188667800453512,  15.765544217687074,  18.63866780045351 ,  19.32404761904762 ,  22.3056746031746  ,  23.099557823129253,  26.837023809523814,  27.75749433106576 ,  28.060000000000002,  28.94249433106576 ,  31.697976190476187,  32.61844671201814 ,  28.179325396825394,  28.97320861678005 ,  24.946332199546482,  25.63171201814059 ,  21.496332199546483,  22.073208616780043,  23.384246031746027,  24.069625850340135,  28.487307256235823,  29.30159863945578 ,  33.84819160997732 ,  34.79139455782313 ,  40.403350340136065,  41.49695011337869 ,  41.50489795918368 ,  42.55337868480725 ,  46.17858843537415 ,  47.27218820861678 ,  40.826604308390024,  41.769807256235836,  35.98136621315193 ,  36.79565759637188 ,  30.878304988662126,  31.563684807256237,  33.53288548752834 ,  34.32676870748299 ,  40.65635487528344 ,  41.599557823129246,  48.078463718820856,  49.17098639455782 ,  57.08600340136055 ,  58.35273242630385 ,  57.937551020408165,  59.15201814058956 ,  63.77552721088435 ,  65.04225623582767 ,  56.16163832199546 ,  57.254160997732434,  49.336808390022675,  50.28001133786848 ,  42.21333900226756 ,  43.00722222222222 ,  47.65153628117913 ,  48.572006802721084,  57.56071995464852 ,  58.65431972789115 ,  67.81616213151926 ,  69.08289115646258 ,  80.18481292517008 ,  81.65352607709751 ,  80.59469387755102 ,  82.00281179138321 ,  87.94100340136053 ,  89.40971655328798 ,  77.18822562358275 ,  78.45495464852607 ,  67.62530045351474 ,  68.71890022675737 ,  57.71611678004534 ,  58.63658730158729 ,  66.65736961451248 ,  67.53986394557822 ,  80.10226757369614 ,  81.15074829931972 ,  93.87913832199544 ,  95.09360544217687 , 110.33945578231291 , 111.74757369614514 , 109.35183673469386 , 110.70185941043084 , 117.77564625850339 , 119.18376417233559 , 102.86453514739229 , 104.07900226757367 ,  89.75160997732426 ,  90.80009070294783 ,  76.30671201814059 ,  77.18920634920634 ,  91.40010770975054 ,  92.32057823129252 , 109.53786281179136 , 110.63146258503401 , 128.02187641723353 , 129.28860544217687 , 149.99052721088432 , 151.4592403628118  , 147.52040816326524 , 148.9285260770975  , 157.74671768707478 , 159.21543083900227 , 137.39393990929705 , 138.66066893424033 , 119.60244331065762 , 120.69604308390022 , 101.46468820861679 , 102.38515873015872 ,  86.39574263038547 ,  87.18962585034014 , 103.46206916099773 , 104.40527210884353 , 120.82703514739227 , 121.91955782312924 , 141.4345748299319  , 142.7013038548753  , 138.80612244897955 , 140.020589569161   , 148.12409863945575 , 149.39082766439907 , 128.91020975056688 , 130.00273242630385 , 112.14252267573697 , 113.08572562358275 ,  95.07619614512473 ,  95.87007936507935 ,  80.15322562358276 ,  80.83860544217687 ,  95.9338378684807  ,  96.74812925170069 , 111.97227324263038 , 112.91547619047617 , 130.98457482993197 , 132.0781746031746  , 128.34897959183675 , 129.3974603174603  , 136.75981292517008 , 137.85341269841268 , 118.95068594104309 , 119.89388888888888 , 103.42789682539683 , 104.24218820861677 ,  87.64728458049886 ,  88.33266439909298 ,  71.95764739229024 ,  72.5345238095238  ,  86.08519841269838 ,  86.77057823129253 , 100.42975623582764 , 101.22363945578232 , 117.41824829931971 , 118.33871882086167 , 114.90408163265303 , 115.78657596371882 , 122.2792006802721  , 123.19967120181406 , 106.30340702947845 , 107.0972902494331  ,  92.39286281179139 ,  93.07824263038549 ,  78.26531179138321 ,  78.84218820861679 , 108.64264739229024 , 109.21952380952384 , 129.67019841269843 , 130.35557823129253 , 150.91475623582767 , 151.7086394557823  , 175.95324829931974 , 176.87371882086165 , 171.0240816326531  , 171.9065759637188  , 180.81420068027214 , 181.73467120181408 , 156.78840702947846 , 157.5822902494331  , 135.97786281179137 , 136.6632426303855  , 114.9503117913832  , 115.52718820861679 , 134.4157766439909  , 135.10115646258504 , 160.4025113378685  , 161.21680272108847 , 186.64706916099775 , 187.59027210884352 , 217.5665136054422  , 218.66011337868477 , 211.3587755102041  , 212.40725623582767 , 223.34175170068028 , 224.43535147392294 , 193.62548185941046 , 194.5686848072562  , 167.89657029478457 , 168.71086167800453 , 141.909835600907   , 142.59521541950113 , 162.14196712018136 , 162.93585034013606 , 193.45523242630387 , 194.3984353741497  , 225.06713718820862 , 226.15965986394556 , 262.2961054421769  , 263.5628344671201  , 254.68122448979594 , 255.89569160997732 , 268.98562925170063 , 270.25235827664403 , 233.15031179138325 , 234.24283446712013 , 202.13568594104308 , 203.07888888888888 , 170.8224206349206  , 171.61630385487527 , 196.767760770975   , 197.688231292517   , 234.72388321995464 , 235.8174829931973  , 273.02626417233563 , 274.2929931972789  , 318.11634353741505 , 319.58505668934237 , 308.7097959183674  , 310.11791383219963 , 325.8725340136054  , 327.341247165533   , 282.39832766439906 , 283.6650566893424  , 244.78846371882088 , 245.88206349206348 , 206.83234126984127 , 207.7528117913832  , 209.62145124716548 , 210.50394557823128 , 249.9561451247165  , 251.00462585034015 , 290.6228117913831  , 291.8372789115646  , 338.45455782312916 , 339.8626757369615  , 328.05551020408154 , 329.4055328798186  , 345.8907482993197  , 347.29886621315194 , 299.6082086167801  , 300.82267573696146 , 259.60548752834467 , 260.65396825396823 , 219.27079365079365 , 220.1532879818594  , 240.5163321995465  , 241.43680272108844 , 286.7010260770975  , 287.79462585034014 , 333.2319784580498  , 334.49870748299315 , 387.9220578231292  , 389.3907709750566  , 375.63551020408164 , 377.0436281179138  , 395.67824829931976 , 397.14696145124714 , 342.60404195011347 , 343.87077097505664 , 296.7656065759638  , 297.8592063492063  , 250.5809126984127  , 251.50138321995465 , 215.0048242630385  , 215.7987074829932  , 256.2609467120181  , 257.20414965986396 , 297.81570861678    , 298.908231292517   , 346.64467687074824 , 347.91140589569153 , 335.5497959183674  , 336.76426303854873 , 353.3342006802721  , 354.6009297052154  , 305.89888321995466 , 306.99140589569157 , 264.9414002267574  , 265.88460317460317 , 223.6852777777778  , 224.4791609977324  , 191.18475623582765 , 191.87013605442178 , 227.84904195011336 , 228.66333333333336 , 264.77115079365075 , 265.7143537414966  , 308.1477380952381  , 309.2413378684807  , 298.20285714285706 , 299.25133786848073 , 313.9229761904763  , 315.0165759637188  , 271.7495634920635  , 272.6927664399093  , 235.34310090702948 , 236.15739229024945 , 198.67881519274377 , 199.36419501133787 , 165.41162698412697 , 165.98850340136056 , 197.11672902494328 , 197.8021088435374  , 229.03883786848073 , 229.8327210884354  , 266.5344727891156  , 267.4549433106576  , 257.8681632653061  , 258.7506575963719  , 271.39542517006805 , 272.31589569160997 , 234.9124886621315  , 235.7063718820862  , 203.42439342403628 , 204.10977324263038 , 171.71929138321997 , 172.2961678004535  , 202.096626984127   , 202.67350340136053 , 240.70172902494326 , 241.3871088435374  , 279.52383786848077 , 280.3177210884354  , 325.0694727891156  , 325.98994331065757 , 313.98816326530607 , 314.8706575963719  , 329.93042517006796 , 330.85089569161005 , 285.3974886621315  , 286.1913718820862  , 247.00939342403626 , 247.69477324263036 , 208.40429138321997 , 208.98116780045353 , 245.44730725623583 , 246.13268707482993 , 292.31771541950104 , 293.13200680272104 , 339.44594671201816 , 340.38914965986396 , 394.7296768707482  , 395.8232766439909  , 381.2126530612244  , 382.26113378684806 , 400.5049149659863  , 401.598514739229   , 346.4243594104308  , 347.3675623582766  , 299.8117743764172  , 300.62606575963713 , 252.94136621315192 , 253.62674603174605 , 290.75104875283444 , 291.5449319727891  , 346.25410997732416 , 347.19731292516997 , 402.0558106575964  , 403.1483333333333  , 467.50620748299315 , 468.77293650793644 , 451.4248979591836  , 452.63936507936506 , 474.195731292517   , 475.46246031746034 , 410.138985260771   , 411.2315079365079  , 354.93456349206355 , 355.8777664399093  , 299.43150226757376 , 300.2253854875284  , 345.883985260771   , 346.8044557823129  , 411.8870464852607  , 412.9806462585033  , 478.236366213152   , 479.5030952380952  , 556.0478741496598  , 557.5165873015873  , 536.8248979591837  , 538.2330158730158  , 563.8040646258504  , 565.2727777777778  , 487.60842970521537 , 488.8751587301587  , 421.95162698412696 , 423.0452267573696  , 355.9485657596372  , 356.8690362811792  , 352.5855328798187  , 353.46802721088443 , 419.81002267573706 , 420.8585034013607  , 487.366485260771   , 488.58095238095245 , 566.5696598639456  , 567.9777777777779  , 546.7591836734694  , 548.1092063492065  , 574.005850340136   , 575.4139682539683  , 496.35188208616785 , 497.56634920634923 , 429.459365079365   , 430.5078458049887  , 362.2348752834467  , 363.1173696145124  , 389.6325566893425  , 390.55302721088435 , 463.8641893424037  , 464.95778911564634 , 538.4420804988663  , 539.7088095238096  , 625.8535884353743  , 627.3223015873017  , 603.750612244898   , 605.1587301587302  , 633.6097789115647  , 635.0784920634921  , 547.8141439909297  , 549.080873015873   , 473.9287698412698  , 475.02236961451234 , 399.6971371882086  , 400.61760770975053 , 343.61390589569163 , 344.40778911564627 , 409.05982426303854 , 410.0030272108844  , 474.8043820861678  , 475.89690476190486 , 551.8547789115646  , 553.121507936508   , 532.2934693877552  , 533.5079365079365  , 558.5443027210885  , 559.8110317460316  , 482.88755668934243 , 483.9800793650793  , 417.7402777777778  , 418.6834807256235  , 352.29435941043084 , 353.0882426303854  , 302.21628684807257 , 302.90166666666664 , 359.76424603174604 , 360.578537414966   , 417.5700283446712  , 418.513231292517   , 485.3109013605442  , 486.4045011337869  , 468.05673469387756 , 469.10521541950106 , 491.0861394557823  , 492.17973922902485 , 424.5484410430839  , 425.4916439909296  , 367.2583049886621  , 368.072596371882   , 309.71034580498866 , 310.3957256235828  , 258.8656065759637  , 259.44248299319725 , 308.1482596371882  , 308.8336394557823  , 357.64791950113374 , 358.44180272108844 , 415.65069727891154 , 416.5711678004535  , 400.8322448979592  , 401.71473922902493 , 420.5116496598639  , 421.4321201814058  , 363.52157029478457 , 364.3154535147392  , 314.45592403628115 , 315.1413038548753  , 265.17327097505665 , 265.7501473922903  };
  const std::array<int, 4> in_shape = {{ 3, 9, 9, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612, 0.04081632653061224, 0.08163265306122448, 0.12244897959183673, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.18367346938775508, 0.24489795918367346, 0.16326530612244897, 0.20408163265306123, 0.1020408163265306 , 0.12244897959183673, 0.16326530612244897, 0.2040816326530612 , 0.4081632653061224 , 0.4897959183673469 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.7346938775510203 , 0.8571428571428572 , 0.5714285714285714 , 0.653061224489796  , 0.32653061224489793, 0.36734693877551017, 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4285714285714285 , 0.4897959183673469 , 0.9795918367346936 , 1.1020408163265305 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.6530612244897958 , 1.8367346938775508 , 1.2244897959183672 , 1.346938775510204  , 0.673469387755102  , 0.7346938775510203 , 0.4081632653061224 , 0.44897959183673464, 0.8979591836734693 , 0.9795918367346939 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.4693877551020407 , 1.5918367346938775 , 1.0612244897959182 , 1.1428571428571428 , 0.5714285714285714 , 0.6122448979591837 , 0.26530612244897955, 0.2857142857142857 , 0.5714285714285714 , 0.6122448979591837 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.9183673469387754 , 0.9795918367346939 , 0.6530612244897959 , 0.693877551020408  , 0.3469387755102041 , 0.36734693877551017, 0.3877551020408163 , 0.4081632653061224 , 0.8163265306122449 , 0.857142857142857  , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 1.2857142857142856 , 1.3469387755102038 , 0.8979591836734693 , 0.9387755102040816 , 0.4693877551020408 , 0.4897959183673469 , 0.8979591836734694 , 0.9387755102040816 , 1.8775510204081631 , 1.9591836734693875 , 2.9387755102040813 , 3.0612244897959178 , 2.9387755102040813 , 3.0612244897959178 , 2.9387755102040813 , 3.0612244897959178 , 2.9387755102040813 , 3.0612244897959178 , 2.9387755102040813 , 3.0612244897959178 , 2.040816326530612  , 2.1224489795918364 , 1.0612244897959182 , 1.1020408163265305 , 1.530612244897959  , 1.5918367346938775 , 3.183673469387755  , 3.3061224489795915 , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 3.428571428571428  , 3.551020408163265  , 1.7755102040816324 , 1.8367346938775508 , 1.530612244897959  , 1.5918367346938775 , 3.183673469387755  , 3.3061224489795915 , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 3.428571428571428  , 3.551020408163265  , 1.7755102040816324 , 1.8367346938775508 , 1.530612244897959  , 1.5918367346938775 , 3.183673469387755  , 3.3061224489795915 , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 3.428571428571428  , 3.551020408163265  , 1.7755102040816324 , 1.8367346938775508 , 1.530612244897959  , 1.5918367346938775 , 3.183673469387755  , 3.3061224489795915 , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 3.428571428571428  , 3.551020408163265  , 1.7755102040816324 , 1.8367346938775508 , 1.530612244897959  , 1.5918367346938775 , 3.183673469387755  , 3.3061224489795915 , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 4.959183673469387  , 5.142857142857142  , 3.428571428571428  , 3.551020408163265  , 1.7755102040816324 , 1.8367346938775508 , 1.1428571428571428 , 1.183673469387755  , 2.36734693877551   , 2.4489795918367343 , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 3.6734693877551017 , 3.795918367346938  , 2.5306122448979593 , 2.6122448979591835 , 1.3061224489795917 , 1.3469387755102038 , 0.6326530612244897 , 0.6530612244897959 , 1.3061224489795917 , 1.346938775510204  , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 2.020408163265306  , 2.0816326530612246 , 1.387755102040816  , 1.4285714285714284 , 0.7142857142857142 , 0.7346938775510203 , 0.7551020408163265 , 0.7755102040816326 , 1.5510204081632653 , 1.5918367346938775 , 2.387755102040816  , 2.4489795918367347 , 2.387755102040816  , 2.4489795918367347 , 2.387755102040816  , 2.4489795918367347 , 2.387755102040816  , 2.4489795918367347 , 2.387755102040816  , 2.4489795918367347 , 1.6326530612244896 , 1.673469387755102  , 0.836734693877551  , 0.8571428571428571 , 1.6326530612244898 , 1.673469387755102  , 3.346938775510204  , 3.428571428571428  , 5.142857142857142  , 5.26530612244898   , 5.142857142857142  , 5.26530612244898   , 5.142857142857142  , 5.26530612244898   , 5.142857142857142  , 5.26530612244898   , 5.142857142857142  , 5.26530612244898   , 3.510204081632653  , 3.591836734693877  , 1.7959183673469385 , 1.8367346938775508 , 2.63265306122449   , 2.693877551020408  , 5.387755102040815  , 5.5102040816326525 , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 5.63265306122449   , 5.755102040816325  , 2.8775510204081627 , 2.9387755102040813 , 2.63265306122449   , 2.693877551020408  , 5.387755102040815  , 5.5102040816326525 , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 5.63265306122449   , 5.755102040816325  , 2.8775510204081627 , 2.9387755102040813 , 2.63265306122449   , 2.693877551020408  , 5.387755102040815  , 5.5102040816326525 , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 5.63265306122449   , 5.755102040816325  , 2.8775510204081627 , 2.9387755102040813 , 2.63265306122449   , 2.693877551020408  , 5.387755102040815  , 5.5102040816326525 , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 5.63265306122449   , 5.755102040816325  , 2.8775510204081627 , 2.9387755102040813 , 2.63265306122449   , 2.693877551020408  , 5.387755102040815  , 5.5102040816326525 , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 8.265306122448978  , 8.448979591836734  , 5.63265306122449   , 5.755102040816325  , 2.8775510204081627 , 2.9387755102040813 , 1.8775510204081631 , 1.9183673469387754 , 3.836734693877551  , 3.918367346938775  , 5.877551020408163  , 6.                 , 5.877551020408163  , 6.                 , 5.877551020408163  , 6.                 , 5.877551020408163  , 6.                 , 5.877551020408163  , 6.                 , 4.                 , 4.081632653061224  , 2.040816326530612  , 2.0816326530612246 , 0.9999999999999999 , 1.0204081632653061 , 2.040816326530612  , 2.0816326530612246 , 3.1224489795918364 , 3.183673469387755  , 3.1224489795918364 , 3.183673469387755  , 3.1224489795918364 , 3.183673469387755  , 3.1224489795918364 , 3.183673469387755  , 3.1224489795918364 , 3.183673469387755  , 2.1224489795918364 , 2.1632653061224487 , 1.0816326530612244 , 1.1020408163265305 };
  const std::array<int, 4> in_shape = {{ 3, 9, 9, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 29.800459183673464,  30.377335600907024,  30.954212018140588,  31.531088435374148,  36.59195578231292 ,  37.27733560090702 ,  37.96271541950113 ,  38.64809523809524 ,  43.81746598639456 ,  44.6113492063492  ,  45.405232426303854,  46.199115646258505,  52.75357709750567 ,  53.67404761904763 ,  54.594518140589564,  55.51498866213152 ,  55.23750566893423 ,  56.120000000000005,  57.00249433106575 ,  57.88498866213152 ,  62.47548185941042 ,  63.39595238095237 ,  64.31642290249434 ,  65.23689342403628 ,  55.56476757369614 ,  56.35865079365079 ,  57.15253401360544 ,  57.9464172335601  ,  49.20728458049886 ,  49.892664399092965,  50.57804421768707 ,  51.26342403628118 ,  42.4157879818594  ,  42.992664399092966,  43.56954081632652 ,  44.146417233560086,  46.08311224489796 ,  46.768492063492054,  47.45387188208617 ,  48.13925170068027 ,  56.1603231292517  ,  56.974614512471646,  57.788905895691606,  58.60319727891156 ,  66.75318027210885 ,  67.69638321995464 ,  68.63958616780045 ,  69.58278911564626 ,  79.71310090702949 ,  80.80670068027213 ,  81.90030045351473 ,  82.99390022675738 ,  81.96131519274377 ,  83.00979591836736 ,  84.05827664399091 ,  85.1067573696145  ,  91.26357709750566 ,  92.3571768707483  ,  93.45077664399092 ,  94.54437641723356 ,  80.71000566893422 ,  81.65320861678005 ,  82.59641156462584 ,  83.53961451247167 ,  71.14844104308389 ,  71.96273242630386 ,  72.7770238095238  ,  73.59131519274376 ,  61.07123015873015 ,  61.75660997732425 ,  62.44198979591836 ,  63.127369614512475,  66.27188775510204 ,  67.06577097505668 ,  67.85965419501134 ,  68.65353741496598 ,  80.36950680272109 ,  81.31270975056688 ,  82.2559126984127  ,  83.19911564625849 ,  95.06440476190477 ,  96.15692743764171 ,  97.24945011337869 ,  98.34197278911564 , 112.90527777777778 , 114.1720068027211  , 115.4387358276644  , 116.7054648526077  , 114.66063492063493 , 115.87510204081633 , 117.08956916099771 , 118.30403628117912 , 126.2843253968254  , 127.5510544217687  , 128.817783446712   , 130.08451247165533 , 111.23075396825395 , 112.32327664399092 , 113.41579931972788 , 114.50832199546487 ,  97.73041383219955 ,  98.67361678004535 ,  99.61681972789114 , 100.56002267573696 ,  83.6327947845805  ,  84.42667800453512 ,  85.22056122448978 ,  86.01444444444444 ,  94.38260204081632 ,  95.30307256235827 ,  96.22354308390024 ,  97.14401360544217 , 114.02784013605442 , 115.12143990929704 , 116.2150396825397  , 117.3086394557823  , 134.36559523809524 , 135.63232426303853 , 136.89905328798187 , 138.16578231292516 , 158.90091269841272 , 160.36962585034016 , 161.83833900226756 , 163.30705215419502 , 159.78126984126985 , 161.18938775510205 , 162.5975056689342  , 164.00562358276642 , 174.41329365079366 , 175.88200680272107 , 177.35071995464853 , 178.81943310657596 , 153.1097222222222  , 154.3764512471655  , 155.64318027210885 , 156.90990929705214 , 134.15700113378685 , 135.25060090702948 , 136.3442006802721  , 137.43780045351474 , 114.51176303854875 , 115.43223356009068 , 116.35270408163264 , 117.27317460317458 , 132.4322448979592  , 133.31473922902495 , 134.1972335600907  , 135.07972789115644 , 159.15605442176872 , 160.20453514739228 , 161.25301587301584 , 162.30149659863943 , 186.54380952380956 , 187.75827664399088 , 188.97274376417235 , 190.18721088435373 , 219.27079365079368 , 220.67891156462582 , 222.08702947845805 , 223.49514739229028 , 217.35365079365081 , 218.70367346938772 , 220.0536961451247  , 221.40371882086168 , 234.1431746031746  , 235.55129251700677 , 236.959410430839   , 238.36752834467117 , 204.51460317460317 , 205.72907029478458 , 206.943537414966   , 208.15800453514734 , 178.45473922902494 , 179.50321995464853 , 180.5517006802721  , 181.60018140589565 , 151.73092970521543 , 152.61342403628117 , 153.49591836734692 , 154.3784126984127  , 181.87974489795917 , 182.8002154195011  , 183.7206859410431  , 184.64115646258503 , 217.98212585034014 , 219.0757256235827  , 220.1693253968254  , 221.26292517006803 , 254.77702380952383 , 256.04375283446706 , 257.31048185941046 , 258.57721088435375 , 298.51234126984133 , 299.98105442176865 , 301.44976757369614 , 302.9184807256236  , 293.63269841269846 , 295.0408163265305  , 296.44893424036275 , 297.857052154195   , 314.0247222222223  , 315.49343537414956 , 316.96214852607704 , 318.43086167800453 , 273.5211507936508  , 274.7878798185941  , 276.05460884353744 , 277.32133786848067 , 238.11128684807255 , 239.20488662131524 , 240.2984863945578  , 241.39208616780044 , 202.00890589569156 , 202.92937641723358 , 203.8498469387755  , 204.77031746031744 , 171.99760204081633 , 172.79148526077094 , 173.58536848072566 , 174.37925170068027 , 205.98093537414968 , 206.92413832199546 , 207.8673412698413  , 208.81054421768707 , 240.56154761904762 , 241.65407029478453 , 242.74659297052153 , 243.83911564625848 , 281.60242063492063 , 282.8691496598638  , 284.13587868480727 , 285.4026077097506  , 276.3977777777778  , 277.6122448979591  , 278.8267120181406  , 280.041179138322   , 294.9814682539683  , 296.2481972789115  , 297.5149263038549  , 298.78165532879814 , 256.7278968253968  , 257.82041950113376 , 258.91294217687073 , 260.0054648526077  , 223.34184240362808 , 224.28504535147394 , 225.22824829931972 , 226.1714512471655  , 189.35850907029476 , 190.15239229024945 , 190.94627551020406 , 191.7401587301587  , 159.62107142857144 , 160.3064512471655  , 160.99183106575964 , 161.67721088435374 , 191.0533843537415  , 191.8676757369614  , 192.6819671201814  , 193.49625850340138 , 223.00134353741495 , 223.94454648526076 , 224.8877494331066  , 225.83095238095234 , 260.8755498866213  , 261.96914965986394 , 263.0627494331066  , 264.1563492063492  , 255.64947845804986 , 256.6979591836735  , 257.74643990929707 , 258.7949206349206  , 272.4260260770975  , 273.51962585034016 , 274.6132256235828  , 275.70682539682537 , 236.95816893424032 , 237.90137188208618 , 238.844574829932   , 239.78777777777776 , 206.04150226757363 , 206.85579365079366 , 207.6700850340136  , 208.48437641723353 , 174.6091893424036  , 175.29456916099772 , 175.97994897959182 , 176.66532879818595 , 143.33841836734695 , 143.91529478458048 , 144.49217120181407 , 145.0690476190476  , 171.4850170068027  , 172.17039682539675 , 172.85577664399096 , 173.54115646258506 , 200.06562925170067 , 200.85951247165528 , 201.65339569161003 , 202.44727891156464 , 233.91602607709748 , 234.83649659863943 , 235.75696712018146 , 236.67743764172334 , 228.92566893424032 , 229.80816326530606 , 230.69065759637192 , 231.57315192743764 , 243.63793083900222 , 244.5584013605442  , 245.4788718820862  , 246.3993424036281  , 211.8129308390022  , 212.6068140589569  , 213.4006972789116  , 214.1945804988662  , 184.10034580498862 , 184.78572562358278 , 185.47110544217685 , 186.15648526077098 , 155.9537471655329  , 156.53062358276642 , 157.1075           , 157.68437641723358 , 216.70841836734698 , 217.2852947845805  , 217.862171201814   , 218.43904761904767 , 258.6550170068027  , 259.34039682539685 , 260.0257766439909  , 260.71115646258505 , 301.0356292517007  , 301.82951247165533 , 302.6233956916099  , 303.4172789115646  , 350.98602607709756 , 351.9064965986395  , 352.8269671201814  , 353.7474376417233  , 341.16566893424033 , 342.0481632653062  , 342.9306575963718  , 343.8131519274376  , 360.70793083900224 , 361.6284013605443  , 362.54887188208613 , 363.46934240362816 , 312.7829308390023  , 313.5768140589569  , 314.3706972789116  , 315.1645804988662  , 271.27034580498866 , 271.95572562358274 , 272.64110544217687 , 273.326485260771   , 229.3237471655329  , 229.9006235827664  , 230.47749999999996 , 231.05437641723358 , 268.14617346938775 , 268.8315532879818  , 269.5169331065759  , 270.2023129251701  , 319.990731292517   , 320.805022675737   , 321.6193140589569  , 322.43360544217694 , 372.3509353741497  , 373.2941383219955  , 374.2373412698412  , 375.18054421768704 , 434.0394274376418  , 435.1330272108844  , 436.22662698412694 , 437.32022675736954 , 421.66907029478455 , 422.7175510204082  , 423.7660317460317  , 424.81451247165535 , 445.5899036281179  , 446.68350340136055 , 447.77710317460316 , 448.87070294784587 , 386.3077607709751  , 387.2509637188209  , 388.1941666666667  , 389.1373696145124  , 334.97884920634925 , 335.79314058956913 , 336.60743197278913 , 337.42172335600907 , 283.13429138322    , 283.819671201814   , 284.50505102040813 , 285.19043083900226 , 300.8505952380952  , 301.6444784580498  , 302.43836167800447 , 303.2322448979592  , 352.87882653061223 , 353.82202947845803 , 354.76523242630384 , 355.70843537414976 , 405.5043367346939  , 406.5968594104308  , 407.6893820861677  , 408.78190476190474 , 467.5975907029479  , 468.86431972789114 , 470.13104875283443 , 471.3977777777777  , 437.7915192743764  , 439.00598639455785 , 440.2204535147392  , 441.4349206349207  , 448.0623526077098  , 449.3290816326531  , 450.59581065759636 , 451.86253968253976 , 388.7564002267575  , 389.8489229024944  , 390.94144557823137 , 392.0339682539682  , 337.3254478458051  , 338.2686507936508  , 339.2118537414966  , 340.1550566893424  , 285.2972165532881  , 286.0910997732426  , 286.88498299319724 , 287.67886621315193 , 305.1628968253968  , 306.08336734693864 , 307.0038378684807  , 307.92430839002265 , 358.2625566893424  , 359.356156462585   , 360.44975623582764 , 361.54335600907035 , 412.0547335600907  , 413.32146258503394 , 414.58819160997723 , 415.8549206349206  , 475.62020975056697 , 477.0889229024943  , 478.5576360544217  , 480.0263492063491  , 446.50580498866213 , 447.91392290249433 , 449.3220408163264  , 450.73015873015873 , 458.21830498866217 , 459.68701814058954 , 461.1557312925169  , 462.6244444444445  , 397.8845748299321  , 399.1513038548753  , 400.4180328798186  , 401.6847619047619  , 345.47743197278925 , 346.57103174603174 , 347.66463151927434 , 348.75823129251705 , 292.37777210884366 , 293.29824263038546 , 294.2187131519274  , 295.1391836734694  , 253.13301587301586 , 254.01551020408164 , 254.89800453514738 , 255.78049886621312 , 296.36839002267567 , 297.41687074829923 , 298.4653514739229  , 299.51383219954647 , 340.2677097505669  , 341.4821768707482  , 342.69664399092966 , 343.9111111111111  , 392.25818594104305 , 393.6663038548752  , 395.07442176870745 , 396.48253968253965 , 366.2762811791383  , 367.6263038548752  , 368.9763265306122  , 370.3263492063492  , 374.21628117913843 , 375.62439909297046 , 377.03251700680266 , 378.4406349206349  , 325.3242176870749  , 326.53868480725623 , 327.7531519274376  , 328.96761904761905 , 282.75278911564635 , 283.8012698412698  , 284.84975056689336 , 285.89823129251704 , 239.51741496598635 , 240.39990929705212 , 241.2824036281179  , 242.16489795918363 , 217.6657539682539  , 218.586224489796   , 219.50669501133788 , 220.42716553287977 , 254.30827097505662 , 255.4018707482994  , 256.49547052154196 , 257.58907029478456 , 291.64330498866207 , 292.91003401360547 , 294.17676303854876 , 295.4434920634921  , 336.0087811791383  , 337.47749433106566 , 338.9462074829932  , 340.4149206349206  , 312.65437641723344 , 314.0624943310657  , 315.47061224489795 , 316.87873015873015 , 318.6068764172335  , 320.07558956916085 , 321.54430272108846 , 323.0130158730159  , 277.47314625850333 , 278.73987528344674 , 280.0066043083901  , 281.27333333333326 , 241.52314625850335 , 242.61674603174603 , 243.71034580498866 , 244.80394557823124 , 204.88062925170064 , 205.80109977324258 , 206.72157029478458 , 207.6420408163265  , 166.76932539682537 , 167.56320861678006 , 168.3570918367347  , 169.1509750566893  , 193.57850907029473 , 194.52171201814068 , 195.46491496598637 , 196.40811791383217 , 220.98497165532874 , 222.07749433106585 , 223.1700170068027  , 224.26253968253963 , 253.6560034013605  , 254.9227324263039  , 256.1894614512471  , 257.4561904761904  , 232.6765986394557  , 233.89106575963723 , 235.1055328798186  , 236.3199999999999  , 234.12076530612237 , 235.38749433106577 , 236.6542233560091  , 237.9209523809523  , 204.23703514739225 , 205.32955782312928 , 206.4220804988662  , 207.5146031746031  , 178.0251303854875  , 178.9683333333334  , 179.9115362811791  , 180.8547392290249  , 151.21594671201814 , 152.0098299319728  , 152.80371315192738 , 153.59759637188208 , 119.23769274376419 , 119.92307256235827 , 120.60845238095236 , 121.29383219954651 , 136.8836111111111  , 137.6979024943311  , 138.512193877551   , 139.326485260771   , 155.04517573696145 , 155.98837868480732 , 156.931581632653   , 157.87478458049887 , 176.83525510204078 , 177.92885487528352 , 179.02245464852606 , 180.1160544217687  , 158.1487074829932  , 159.19718820861684 , 160.2456689342403  , 161.29414965986393 , 155.4714455782313  , 156.56504535147394 , 157.6586451247165  , 158.7522448979592  , 136.08771541950114 , 137.03091836734694 , 137.9741213151927  , 138.91732426303858 , 118.9574433106576  , 119.77173469387756 , 120.58602607709747 , 121.40031746031748 , 101.31152494331063 , 101.99690476190477 , 102.68228458049886 , 103.36766439909296 ,  67.79993764172336 ,  68.37681405895691 ,  68.95369047619049 ,  69.53056689342404 ,  75.54789682539683 ,  76.23327664399092 ,  76.91865646258503 ,  77.60403628117915 ,  83.72986961451248 ,  84.5237528344671  ,  85.31763605442178 ,  86.11151927437643 ,  93.7818537414966  ,  94.70232426303853 ,  95.6227947845805  ,  96.54326530612246 ,  77.64530612244899 ,  78.52780045351474 ,  79.4102947845805  ,  80.29278911564623 ,  70.58947278911565 ,  71.5099433106576  ,  72.43041383219955 ,  73.35088435374149 ,  62.56288548752835 ,  63.356768707482985,  64.15065192743764 ,  64.94453514739229 ,  55.24893990929706 ,  55.93431972789116 ,  56.619699546485265,  57.30507936507937 ,  47.50098072562359 ,  48.07785714285714 ,  48.654733560090705,  49.23160997732426 , 108.25565192743761 , 108.83252834467119 , 109.40940476190477 , 109.98628117913835 , 129.80361111111108 , 130.4889909297052  , 131.17437074829934 , 131.85975056689344 , 151.78558390022675 , 152.5794671201814  , 153.37335034013608 , 154.1672335600907  , 177.93756802721086 , 178.8580385487528  , 179.7785090702948  , 180.69897959183672 , 175.25673469387758 , 176.1392290249433  , 177.0217233560091  , 177.9042176870748  , 187.65947278911563 , 188.57994331065757 , 189.50041383219957 , 190.42088435374149 , 163.53288548752835 , 164.32676870748296 , 165.12065192743768 , 165.9145351473923  , 142.41893990929705 , 143.10431972789115 , 143.78969954648525 , 144.47507936507935 , 120.8709807256236  , 121.44785714285715 , 122.0247335600907  , 122.60160997732429 , 139.2947675736961  , 139.98014739229023 , 140.66552721088436 , 141.3509070294785  , 166.90395124716548 , 167.7182426303855  , 168.53253401360544 , 169.3468253968254  , 195.0287811791383  , 195.97198412698413 , 196.91518707482993 , 197.85839002267574 , 228.44267006802716 , 229.5362698412698  , 230.62986961451244 , 231.7234693877551  , 224.55469387755102 , 225.60317460317458 , 226.65165532879814 , 227.70013605442176 , 239.99314625850334 , 241.086746031746   , 242.18034580498863 , 243.2739455782313  , 208.9856065759637  , 209.9288095238095  , 210.87201247165535 , 211.81521541950113 , 181.8920691609977  , 182.7063605442177  , 183.5206519274376  , 184.3349433106576  , 154.28288548752835 , 154.96826530612248 , 155.65364512471655 , 156.33902494331068 , 174.24000566893423 , 175.03388888888887 , 175.82777210884353 , 176.6216553287982  , 208.64510770975053 , 209.58831065759637 , 210.53151360544217 , 211.47471655328798 , 243.6474886621315  , 244.74001133786848 , 245.83253401360543 , 246.9250566893424  , 285.1804251700679  , 286.44715419501136 , 287.71388321995465 , 288.98061224489794 , 279.82816326530605 , 281.04263038548754 , 282.2570975056689  , 283.4715646258503  , 298.5594727891156  , 299.826201814059   , 301.09293083900224 , 302.3596598639455  , 259.8138378684807  , 260.90636054421765 , 261.9988832199547  , 263.09140589569165 , 226.006014739229   , 226.94921768707485 , 227.89242063492057 , 228.83562358276646 , 191.6009126984127  , 192.39479591836738 , 193.18867913832196 , 193.9825623582767  , 219.56659297052153 , 220.48706349206347 , 221.40753401360544 , 222.32800453514741 , 262.7574092970521  , 263.85100907029477 , 264.94460884353737 , 266.03820861678    , 306.6407426303855  , 307.90747165532883 , 309.17420068027207 , 310.44092970521535 , 358.6459013605441  , 360.1146145124717  , 361.58332766439906 , 363.05204081632644 , 351.2853061224489  , 352.6934240362812  , 354.1015419501133  , 355.5096598639455  , 374.1582823129251  , 375.62699546485266 , 377.09570861678    , 378.5644217687074  , 325.3848696145124  , 326.65159863945576 , 327.9183276643991  , 329.18505668934245 , 282.8865702947846  , 283.9801700680272  , 285.0737698412698  , 286.16736961451255 , 239.69575396825397 , 240.61622448979594 , 241.53669501133783 , 242.45716553287988 , 252.4514739229025  , 253.3339682539682  , 254.21646258503404 , 255.09895691609978 , 301.74943310657596 , 302.79791383219947 , 303.8463945578232  , 304.89487528344665 , 351.71133786848077 , 352.92580498866215 , 354.14027210884353 , 355.35473922902486 , 410.77482993197276 , 412.18294784580496 , 413.59106575963705 , 414.99918367346925 , 400.9567346938776  , 402.3067573696145  , 403.6567800453514  , 405.0068027210884  , 425.64721088435374 , 427.055328798186   , 428.463446712018   , 429.8715646258503  , 369.6821315192744  , 370.89659863945576 , 372.11106575963714 , 373.3255328798187  , 321.04811791383213 , 322.0965986394558  , 323.1450793650793  , 324.193560090703   , 271.7501587301587  , 272.6326530612245  , 273.5151473922902  , 274.39764172335606 , 307.06373582766435 , 307.9842063492064  , 308.90467687074835 , 309.82514739229026 , 366.71169501133784 , 367.80529478458044 , 368.8988945578232  , 369.99249433106576 , 427.05217120181413 , 428.3189002267573  , 429.5856292517007  , 430.85235827664394 , 498.2573299319728  , 499.7260430839002  , 501.1947562358277  , 502.6634693877551  , 485.13673469387754 , 486.5448526077097  , 487.95297052154194 , 489.36108843537414 , 513.7697108843538  , 515.2384240362811  , 516.7071371882087  , 518.1758503401361  , 445.796298185941   , 447.0630272108844  , 448.3297562358276  , 449.5964852607709  , 386.8408560090703  , 387.93445578231297 , 389.02805555555557 , 390.1216553287981  , 327.1928968253968  , 328.1133673469388  , 329.0338378684807  , 329.9543083900227  , 279.9657199546485  , 280.7596031746032  , 281.5534863945579  , 282.34736961451244 , 334.2565362811791  , 335.1997392290249  , 336.1429421768708  , 337.08614512471655 , 389.1446315192744  , 390.2371541950113  , 391.3296768707483  , 392.4221995464853  , 453.87756802721094 , 455.14429705215423 , 456.4110260770975  , 457.67775510204075 , 441.56530612244893 , 442.7797732426303  , 443.9942403628118  , 445.2087074829932  , 467.25661564625847 , 468.5233446712018  , 469.7900736961451  , 471.0568027210884  , 405.3109807256235  , 406.4035034013606  , 407.4960260770975  , 408.5885487528344  , 351.61744331065756 , 352.5606462585034  , 353.50384920634923 , 354.447052154195   , 297.32662698412696 , 298.12051020408165 , 298.91439342403623 , 299.7082766439909  , 252.83272675736958 , 253.51810657596369 , 254.20348639455784 , 254.8888662131519  , 301.7970124716553  , 302.61130385487525 , 303.4255952380953  , 304.2398866213152  , 351.27694444444444 , 352.22014739229024 , 353.1633503401361  , 354.10655328798185 , 409.605119047619   , 410.69871882086164 , 411.79231859410436 , 412.8859183673469  , 398.2428571428571  , 399.2913378684807  , 400.3398185941043  , 401.38829931972793 , 421.1555952380952  , 422.24919501133786 , 423.34279478458046 , 424.4363945578231  , 365.2337698412698  , 366.17697278911567 , 367.1201757369614  , 368.0633786848072  , 316.78513038548755 , 317.5994217687075  , 318.4137131519274  , 319.2280045351474  , 267.8208446712018  , 268.5062244897959  , 269.19160430838997 , 269.8769841269842  , 221.7936111111111  , 222.37048752834468 , 222.94736394557822 , 223.5242403628118  , 264.6966723356009  , 265.382052154195   , 266.0674319727891  , 266.7528117913832  , 308.0337471655329  , 308.82763038548757 , 309.6215136054422  , 310.4153968253968  , 359.10001700680266 , 360.0204875283447  , 360.94095804988666 , 361.8614285714286  , 348.94489795918366 , 349.82739229024946 , 350.7098866213152  , 351.59238095238095 , 368.82192176870745 , 369.7423922902494  , 370.6628628117914  , 371.58333333333326 , 319.78104875283447 , 320.5749319727891  , 321.36881519274374 , 322.16269841269843 , 277.3120011337869  , 277.9973809523809  , 278.68276077097505 , 279.3681405895692  , 234.40893990929706 , 234.9858163265306  , 235.56269274376416 , 236.13956916099775 };
  const std::array<int, 4> in_shape = {{ 3, 9, 9, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.2857142857142857  ,  0.32653061224489793 ,  0.36734693877551017 ,  0.40816326530612246 ,  0.18367346938775508 ,  0.2040816326530612  ,  0.22448979591836732 ,  0.24489795918367346 ,  0.2857142857142857  ,  0.32653061224489793 ,  0.36734693877551017 ,  0.4081632653061224  ,  0.7346938775510203  ,  0.8163265306122448  ,  0.8979591836734693  ,  0.9795918367346939  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.0612244897959184  ,  1.1428571428571428  ,  1.2244897959183674  ,  1.306122448979592   ,  0.6122448979591837  ,  0.6530612244897959  ,  0.693877551020408   ,  0.7346938775510203  ,  0.7959183673469388  ,  0.857142857142857   ,  0.9183673469387754  ,  0.9795918367346939  ,  1.8367346938775508  ,  1.9591836734693873  ,  2.081632653061224   ,  2.204081632653061   ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.693877551020408   ,  1.2857142857142856  ,  1.346938775510204   ,  1.4081632653061222  ,  1.4693877551020407  ,  0.7959183673469388  ,  0.857142857142857   ,  0.9183673469387754  ,  0.9795918367346939  ,  1.8367346938775508  ,  1.9591836734693873  ,  2.081632653061224   ,  2.204081632653061   ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.693877551020408   ,  1.2857142857142856  ,  1.346938775510204   ,  1.4081632653061222  ,  1.4693877551020407  ,  0.7959183673469388  ,  0.857142857142857   ,  0.9183673469387754  ,  0.9795918367346939  ,  1.8367346938775508  ,  1.9591836734693873  ,  2.081632653061224   ,  2.204081632653061   ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.693877551020408   ,  1.2857142857142856  ,  1.346938775510204   ,  1.4081632653061222  ,  1.4693877551020407  ,  0.7959183673469388  ,  0.857142857142857   ,  0.9183673469387754  ,  0.9795918367346939  ,  1.8367346938775508  ,  1.9591836734693873  ,  2.081632653061224   ,  2.204081632653061   ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.693877551020408   ,  1.2857142857142856  ,  1.346938775510204   ,  1.4081632653061222  ,  1.4693877551020407  ,  0.7959183673469388  ,  0.857142857142857   ,  0.9183673469387754  ,  0.9795918367346939  ,  1.8367346938775508  ,  1.9591836734693873  ,  2.081632653061224   ,  2.204081632653061   ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.693877551020408   ,  1.2857142857142856  ,  1.346938775510204   ,  1.4081632653061222  ,  1.4693877551020407  ,  0.7755102040816326  ,  0.8163265306122448  ,  0.857142857142857   ,  0.8979591836734693  ,  1.7142857142857144  ,  1.7959183673469385  ,  1.8775510204081631  ,  1.9591836734693877  ,  2.816326530612245   ,  2.9387755102040813  ,  3.0612244897959178  ,  3.183673469387755   ,  2.816326530612245   ,  2.9387755102040813  ,  3.0612244897959178  ,  3.183673469387755   ,  2.816326530612245   ,  2.9387755102040813  ,  3.0612244897959178  ,  3.183673469387755   ,  2.816326530612245   ,  2.9387755102040813  ,  3.0612244897959178  ,  3.183673469387755   ,  2.816326530612245   ,  2.9387755102040813  ,  3.0612244897959178  ,  3.183673469387755   ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  0.5102040816326531  ,  0.5306122448979591  ,  0.5510204081632653  ,  0.5714285714285714  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.2653061224489797  ,  1.3061224489795917  ,  1.3469387755102038  ,  1.387755102040816   ,  0.673469387755102   ,  0.6938775510204082  ,  0.7142857142857142  ,  0.7346938775510203  ,  0.7551020408163265  ,  0.7755102040816326  ,  0.7959183673469387  ,  0.8163265306122448  ,  1.5918367346938775  ,  1.6326530612244898  ,  1.673469387755102   ,  1.714285714285714   ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  1.7551020408163263  ,  1.7959183673469385  ,  1.8367346938775508  ,  1.8775510204081631  ,  0.9183673469387754  ,  0.9387755102040816  ,  0.9591836734693877  ,  0.9795918367346939  ,  1.7551020408163263  ,  1.7959183673469388  ,  1.8367346938775508  ,  1.8775510204081631  ,  3.6734693877551017  ,  3.7551020408163263  ,  3.836734693877551   ,  3.918367346938775   ,  5.755102040816326   ,  5.877551020408163   ,  5.999999999999999   ,  6.1224489795918355  ,  5.755102040816326   ,  5.877551020408163   ,  5.999999999999999   ,  6.1224489795918355  ,  5.755102040816326   ,  5.877551020408163   ,  5.999999999999999   ,  6.1224489795918355  ,  5.755102040816326   ,  5.877551020408163   ,  5.999999999999999   ,  6.1224489795918355  ,  5.755102040816326   ,  5.877551020408163   ,  5.999999999999999   ,  6.1224489795918355  ,  4.                  ,  4.081632653061224   ,  4.163265306122448   ,  4.244897959183673   ,  2.0816326530612246  ,  2.1224489795918364  ,  2.163265306122449   ,  2.204081632653061   ,  2.9999999999999996  ,  3.061224489795918   ,  3.1224489795918364  ,  3.183673469387755   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367347   ,  6.612244897959183   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  6.73469387755102    ,  6.857142857142856   ,  6.979591836734693   ,  7.10204081632653    ,  3.4897959183673466  ,  3.551020408163265   ,  3.612244897959184   ,  3.6734693877551017  ,  2.9999999999999996  ,  3.061224489795918   ,  3.1224489795918364  ,  3.183673469387755   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367347   ,  6.612244897959183   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  6.73469387755102    ,  6.857142857142856   ,  6.979591836734693   ,  7.10204081632653    ,  3.4897959183673466  ,  3.551020408163265   ,  3.612244897959184   ,  3.6734693877551017  ,  2.9999999999999996  ,  3.061224489795918   ,  3.1224489795918364  ,  3.183673469387755   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367347   ,  6.612244897959183   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  6.73469387755102    ,  6.857142857142856   ,  6.979591836734693   ,  7.10204081632653    ,  3.4897959183673466  ,  3.551020408163265   ,  3.612244897959184   ,  3.6734693877551017  ,  2.9999999999999996  ,  3.061224489795918   ,  3.1224489795918364  ,  3.183673469387755   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367347   ,  6.612244897959183   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  6.73469387755102    ,  6.857142857142856   ,  6.979591836734693   ,  7.10204081632653    ,  3.4897959183673466  ,  3.551020408163265   ,  3.612244897959184   ,  3.6734693877551017  ,  2.9999999999999996  ,  3.061224489795918   ,  3.1224489795918364  ,  3.183673469387755   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367347   ,  6.612244897959183   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  9.73469387755102    ,  9.918367346938775   , 10.102040816326529   , 10.285714285714285   ,  6.73469387755102    ,  6.857142857142856   ,  6.979591836734693   ,  7.10204081632653    ,  3.4897959183673466  ,  3.551020408163265   ,  3.612244897959184   ,  3.6734693877551017  ,  2.2448979591836733  ,  2.2857142857142856  ,  2.3265306122448974  ,  2.36734693877551    ,  4.653061224489795   ,  4.73469387755102    ,  4.816326530612244   ,  4.897959183673469   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  4.979591836734693   ,  5.061224489795919   ,  5.142857142857142   ,  5.224489795918367   ,  2.571428571428571   ,  2.6122448979591835  ,  2.6530612244897958  ,  2.6938775510204076  ,  1.2448979591836733  ,  1.2653061224489794  ,  1.2857142857142856  ,  1.3061224489795917  ,  2.571428571428571   ,  2.6122448979591835  ,  2.6530612244897958  ,  2.693877551020408   ,  3.979591836734693   ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  3.979591836734693   ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  3.979591836734693   ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  3.979591836734693   ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  3.979591836734693   ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  1.4081632653061222  ,  1.4285714285714284  ,  1.4489795918367345  ,  1.4693877551020407  ,  1.4897959183673468  ,  1.510204081632653   ,  1.530612244897959   ,  1.5510204081632653  ,  3.061224489795918   ,  3.1020408163265305  ,  3.1428571428571423  ,  3.183673469387755   ,  4.7142857142857135  ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  4.7142857142857135  ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  4.7142857142857135  ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  4.7142857142857135  ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  4.7142857142857135  ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  3.224489795918367   ,  3.265306122448979   ,  3.3061224489795915  ,  3.346938775510204   ,  1.6530612244897958  ,  1.673469387755102   ,  1.693877551020408   ,  1.7142857142857142  ,  3.224489795918367   ,  3.2653061224489797  ,  3.3061224489795915  ,  3.346938775510204   ,  6.612244897959184   ,  6.693877551020408   ,  6.775510204081631   ,  6.857142857142856   , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    ,  6.938775510204081   ,  7.020408163265306   ,  7.10204081632653    ,  7.183673469387754   ,  3.5510204081632653  ,  3.591836734693877   ,  3.63265306122449    ,  3.6734693877551017  ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040816   , 10.653061224489797   , 10.77551020408163    , 10.897959183673468   , 11.020408163265305   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 11.142857142857142   , 11.26530612244898    , 11.387755102040817   , 11.51020408163265    ,  5.6938775510204085  ,  5.755102040816325   ,  5.816326530612245   ,  5.877551020408163   ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040816   , 10.653061224489797   , 10.77551020408163    , 10.897959183673468   , 11.020408163265305   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 11.142857142857142   , 11.26530612244898    , 11.387755102040817   , 11.51020408163265    ,  5.6938775510204085  ,  5.755102040816325   ,  5.816326530612245   ,  5.877551020408163   ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040816   , 10.653061224489797   , 10.77551020408163    , 10.897959183673468   , 11.020408163265305   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 11.142857142857142   , 11.26530612244898    , 11.387755102040817   , 11.51020408163265    ,  5.6938775510204085  ,  5.755102040816325   ,  5.816326530612245   ,  5.877551020408163   ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040816   , 10.653061224489797   , 10.77551020408163    , 10.897959183673468   , 11.020408163265305   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 11.142857142857142   , 11.26530612244898    , 11.387755102040817   , 11.51020408163265    ,  5.6938775510204085  ,  5.755102040816325   ,  5.816326530612245   ,  5.877551020408163   ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040816   , 10.653061224489797   , 10.77551020408163    , 10.897959183673468   , 11.020408163265305   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 11.142857142857142   , 11.26530612244898    , 11.387755102040817   , 11.51020408163265    ,  5.6938775510204085  ,  5.755102040816325   ,  5.816326530612245   ,  5.877551020408163   ,  3.714285714285714   ,  3.7551020408163263  ,  3.795918367346938   ,  3.836734693877551   ,  7.591836734693878   ,  7.673469387755102   ,  7.755102040816325   ,  7.83673469387755    , 11.63265306122449    , 11.755102040816325   , 11.877551020408163   , 12.                  , 11.63265306122449    , 11.755102040816325   , 11.877551020408163   , 12.                  , 11.63265306122449    , 11.755102040816325   , 11.877551020408163   , 12.                  , 11.63265306122449    , 11.755102040816325   , 11.877551020408163   , 12.                  , 11.63265306122449    , 11.755102040816325   , 11.877551020408163   , 12.                  ,  7.9183673469387745  ,  8.                  ,  8.081632653061224   ,  8.163265306122447   ,  4.040816326530612   ,  4.081632653061224   ,  4.122448979591836   ,  4.163265306122449   ,  1.9795918367346936  ,  1.9999999999999998  ,  2.020408163265306   ,  2.0408163265306123  ,  4.040816326530612   ,  4.081632653061224   ,  4.122448979591836   ,  4.163265306122449   ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  4.204081632653061   ,  4.244897959183673   ,  4.285714285714286   ,  4.326530612244897   ,  2.142857142857143   ,  2.1632653061224487  ,  2.183673469387755   ,  2.204081632653061   };
  const std::array<int, 4> in_shape = {{ 3, 9, 9, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  8.613361678004535,  10.5300283446712  ,  12.555198412698413,  14.688871882086168,  14.710102040816327,  15.773435374149658,  18.094070294784576,  16.285907029478455,  14.36924036281179 ,  12.344070294784583,  13.199416099773241,  16.034450113378682,  18.998395691609975,  22.091252834467117,  21.791054421768706,  23.054387755102034,  26.136927437641713,  23.430804988662125,  20.595770975056684,  17.6318253968254  ,  18.87050453514739 ,  22.82798752834467 ,  26.93479024943311 ,  31.1909126984127  ,  30.450238095238095,  31.913571428571423,  35.877063492063485,  32.068900226757364,  28.111417233560083,  24.004614512471655,  26.75264739229025 ,  32.25774943310658 ,  37.93598072562358 ,  43.78734126984127 ,  42.39388888888889 ,  44.09055555555555 ,  49.220714285714266,  43.88874149659863 ,  38.3836394557823  ,  32.705408163265304,  37.29990929705215 ,  44.7692970521542  ,  52.404671201814054,  60.20603174603175 ,  57.59174603174603 ,  59.21841269841269 ,  65.4152380952381  ,  58.11183673469387 ,  50.64244897959183 ,  43.00707482993198 ,  51.05740929705215 ,  61.13393990929706 ,  71.38359977324264 ,  81.80638888888889 ,  77.74626984126985 ,  79.44293650793652 ,  87.23976190476192 ,  77.33636054421768 ,  67.25982993197279 ,  57.01017006802721 ,  48.238758503401364,  57.72005102040817 ,  67.35066326530612 ,  77.13059523809525 ,  73.16769841269843 ,  74.63103174603175 ,  81.81674603174604 ,  72.48477324263038 ,  63.00348072562359 ,  53.37286848072563 ,  44.7377380952381  ,  53.504744897959185,  62.40066326530612 ,  71.42549319727893 ,  67.66497732426305 ,  68.92831065759638 ,  75.47116780045353 ,  66.83307256235827 ,  58.06606575963718 ,  49.17014739229025 ,  40.151683673469385,  48.000323129251704,  55.95746598639456 ,  64.02311224489797 ,  60.58402494331066 ,  61.647358276643985,  67.42831065759637 ,  59.688174603174595,  51.83953514739229 ,  43.882392290249435,  60.532239229024945,  72.21421201814059 ,  84.00468820861677 ,  95.90366780045349 ,  90.22846938775508 ,  91.29180272108842 ,  99.3088662131519  ,  87.7353968253968  ,  76.05342403628117 ,  64.26294784580499 ,  74.88359977324264 ,  89.32067460317461 , 103.88666099773242 , 118.58155895691608 , 111.51350340136054 , 112.77683673469387 , 122.62723356009069 , 108.31907029478457 ,  93.88199546485261 ,  79.3160090702948  ,  90.31999433106576 , 107.71625283446713 , 125.26183106575962 , 142.9567290249433  , 134.37676870748297 , 135.8401020408163  , 147.6428798185941  , 130.39594104308387 , 112.99968253968254 ,  95.45410430839003 , 109.59499433106576 , 130.68172902494334 , 151.94159297052153 , 173.37458616780043 , 162.89184807256234 , 164.58851473922903 , 178.8079591836735  , 157.8943537414966  , 136.80761904761903 , 115.54775510204082 , 116.72439909297053 , 139.13256235827666 , 161.7067120181406  , 184.44684807256237 , 173.11827664399092 , 174.7449433106576  , 189.6560544217687  , 167.41387755102036 , 145.00571428571428 , 122.43156462585033 , 133.89975623582765 , 159.55791950113377 , 185.3892120181406  , 211.39363378684808 , 198.24422902494328 , 199.9408956916099  , 216.82700680272106 , 191.3419727891156  , 165.68380952380951 , 139.8525170068027  , 119.68824829931972 , 142.60831632653063 , 165.67770408163267 , 188.89641156462588 , 177.09422902494333 , 178.55756235827664 , 193.58256235827662 , 170.81181405895688 , 147.89174603174604 , 124.822358276644   , 106.42192176870748 , 126.79096938775508 , 147.28892857142856 , 167.9157993197279  , 157.38742630385485 , 158.65075963718817 , 171.96147392290248 , 151.7213378684807  , 131.3522902494331  , 110.85433106575964 ,  92.07056122448978 , 109.68450680272107 , 127.4069557823129  , 145.2379081632653  , 136.1023922902494  , 137.16572562358274 , 148.6431065759637  , 131.13766439909298 , 113.52371882086169 ,  95.80126984126986 , 112.45111678004535 , 133.89839569160995 , 155.45417800453512 , 177.1184637188208  , 165.74683673469383 , 166.81017006802716 , 180.52366213151922 , 159.18488662131514 , 137.73760770975056 , 116.18182539682539 , 136.567783446712   , 162.6068990929705  , 188.77492630385487 , 215.07186507936504 , 201.23595238095234 , 202.49928571428566 , 219.11753968253964 , 193.207335600907   , 167.16821995464852 , 141.00019274376416 , 161.7694841269841  , 192.60451814058953 , 223.58887188208615 , 254.72254535147388 , 238.30329931972784 , 239.76663265306115 , 259.4086961451247  , 228.7229818594104  , 197.887947845805   , 166.90359410430838 , 192.43734126984123 , 229.10570861678    , 265.94720521541944 , 302.96183106575955 , 283.38980725623577 , 285.0864739229024  , 308.39520408163264 , 271.89996598639453 , 235.2315986394558  , 198.39010204081632 , 196.1488888888889  , 233.49582766439906 , 271.0087528344671  , 308.68766439909297 , 288.6448072562358  , 290.2714739229025  , 313.8968707482993  , 276.71591836734694 , 239.36897959183676 , 201.8560544217687  , 216.7421031746032  , 257.98189909297054 , 299.3948242630386  , 340.9808786848073  , 318.7421882086168  , 320.4388548752834  , 346.4142517006803  , 305.3475850340136  , 264.10778911564626 , 222.6948639455782  , 191.1377380952381  , 227.4965816326531  , 264.0047448979592  , 300.66222789115653 , 281.02075963718823 , 282.48409297052154 , 305.34837868480724 , 269.1388548752834  , 232.78001133786844 , 196.27184807256234 , 168.10610544217687 , 200.077193877551   , 232.17719387755102 , 264.4061054421769  , 247.10987528344668 , 248.37320861678003 , 268.4517800453514  , 236.60960317460317 , 204.63851473922898 , 172.538514739229   , 143.9894387755102  , 171.3686904761905  , 198.8564455782313  , 226.45270408163265 , 211.6207596371882  , 212.6840929705215  , 229.85790249433103 , 202.58715419501132 , 175.20790249433102 , 147.72014739229024 };
  const std::array<int, 4> in_shape = {{ 3, 9, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.18367346938775508 , 0.14285714285714285 , 0.08163265306122448 , 0.12244897959183672 , 0.2857142857142857  , 0.48979591836734687 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.6122448979591837  , 0.44897959183673464 , 0.24489795918367346 , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.3061224489795918  , 0.673469387755102   , 1.1020408163265305  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.2857142857142858  , 0.9183673469387754  , 0.4897959183673469  , 0.2857142857142857  , 0.6122448979591836  , 0.9795918367346939  , 1.3877551020408163  , 1.3877551020408163  , 1.3877551020408163  , 1.3877551020408163  , 1.1020408163265305  , 0.7755102040816326  , 0.40816326530612246 , 0.18367346938775508 , 0.3877551020408163  , 0.6122448979591837  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 , 0.26530612244897955 , 0.5510204081632653  , 0.857142857142857   , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 0.9183673469387754  , 0.6326530612244897  , 0.32653061224489793 , 0.6122448979591837  , 1.2653061224489794  , 1.9591836734693875  , 2.693877551020408   , 2.693877551020408   , 2.693877551020408   , 2.693877551020408   , 2.081632653061224   , 1.4285714285714284  , 0.7346938775510203  , 1.0408163265306123  , 2.142857142857143   , 3.3061224489795915  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.4897959183673466  , 2.387755102040816   , 1.2244897959183674  , 1.0408163265306123  , 2.142857142857143   , 3.3061224489795915  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.4897959183673466  , 2.387755102040816   , 1.2244897959183674  , 1.0408163265306123  , 2.142857142857143   , 3.3061224489795915  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.4897959183673466  , 2.387755102040816   , 1.2244897959183674  , 1.0408163265306123  , 2.142857142857143   , 3.3061224489795915  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.4897959183673466  , 2.387755102040816   , 1.2244897959183674  , 1.0408163265306123  , 2.142857142857143   , 3.3061224489795915  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.4897959183673466  , 2.387755102040816   , 1.2244897959183674  , 0.7755102040816326  , 1.5918367346938775  , 2.4489795918367343  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 2.571428571428571   , 1.7551020408163267  , 0.8979591836734693  , 0.42857142857142855 , 0.8775510204081631  , 1.3469387755102038  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.4081632653061225  , 0.9591836734693877  , 0.4897959183673469  , 0.5102040816326531  , 1.0408163265306123  , 1.5918367346938775  , 2.163265306122449   , 2.163265306122449   , 2.163265306122449   , 2.163265306122449   , 1.6530612244897958  , 1.1224489795918366  , 0.5714285714285714  , 1.1020408163265305  , 2.2448979591836733  , 3.4285714285714284  , 4.653061224489796   , 4.653061224489796   , 4.653061224489796   , 4.653061224489796   , 3.551020408163265   , 2.408163265306122   , 1.2244897959183674  , 1.7755102040816326  , 3.6122448979591835  , 5.510204081632653   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.693877551020408   , 3.8571428571428568  , 1.9591836734693877  , 1.7755102040816326  , 3.6122448979591835  , 5.510204081632653   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.693877551020408   , 3.8571428571428568  , 1.9591836734693877  , 1.7755102040816326  , 3.6122448979591835  , 5.510204081632653   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.693877551020408   , 3.8571428571428568  , 1.9591836734693877  , 1.7755102040816326  , 3.6122448979591835  , 5.510204081632653   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.693877551020408   , 3.8571428571428568  , 1.9591836734693877  , 1.7755102040816326  , 3.6122448979591835  , 5.510204081632653   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.693877551020408   , 3.8571428571428568  , 1.9591836734693877  , 1.2653061224489797  , 2.571428571428571   , 3.9183673469387754  , 5.3061224489795915  , 5.3061224489795915  , 5.3061224489795915  , 5.3061224489795915  , 4.040816326530612   , 2.7346938775510203  , 1.387755102040816   , 0.673469387755102   , 1.3673469387755102  , 2.0816326530612246  , 2.816326530612245   , 2.816326530612245   , 2.816326530612245   , 2.816326530612245   , 2.142857142857143   , 1.4489795918367345  , 0.7346938775510203  };
  const std::array<int, 4> in_shape = {{ 3, 9, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 16.64984693877551 ,  17.22672335600907 ,  20.374676870748296,  21.0600566893424  ,  24.31651360544218 ,  25.110396825396826,  28.475357142857142,  29.377743764172337,  28.581111111111106,  29.420204081632654,  30.707777777777775,  31.546870748299316,  35.285753968253964,  36.18814058956915 ,  31.77793083900226 ,  32.57181405895691 ,  28.053100907029474,  28.73848072562358 ,  24.111264172335602,  24.688140589569166,  25.713452380952383,  26.398832199546483,  31.25460884353741 ,  32.068900226757364,  37.053588435374145,  37.99679138321995 ,  43.11039115646258 ,  44.18250566893423 ,  42.58519274376416 ,  43.58210884353741 ,  45.11185941043083 ,  46.10877551020407 ,  51.20174036281178 ,  52.273854875283426,  45.918407029478445,  46.86160997732425 ,  40.377250566893416,  41.19154195011337 ,  34.57827097505669 ,  35.2636507936508  ,  36.947125850340136,  37.74100907029478 ,  44.71277210884353 ,  45.65597505668934 ,  52.77705782312924 ,  53.86958049886622 ,  61.13998299319727 ,  62.3818253968254  ,  59.745736961451236,  60.90047619047619 ,  62.672403628117905,  63.827142857142846,  70.51228458049886 ,  71.75412698412697 ,  63.04527777777776 ,  64.13780045351473 ,  55.27963151927437 ,  56.222834467120165,  47.215345804988665,  48.00922902494331 ,  52.58482426303855 ,  53.5052947845805  ,  63.42189909297051 ,  64.51549886621316 ,  74.60523242630384 ,  75.87196145124716 ,  86.13482426303854 ,  87.57468253968254 ,  83.44891156462585 ,  84.78777777777778 ,  86.84224489795918 ,  88.1811111111111  ,  97.00157029478457 ,  98.44142857142853 ,  86.51075396825397 ,  87.77748299319725 ,  75.67367913832199 ,  76.7672789115646  ,  64.49034580498866 ,  65.41081632653061 ,  73.71732426303855 ,  74.5998185941043  ,  88.4901133786848  ,  89.5385941043084  , 103.59487528344668 , 104.80934240362811 , 119.03160997732424 , 120.4120634920635  , 113.89986394557822 , 115.18349206349205 , 117.15319727891155 , 118.43682539682538 , 129.45002267573693 , 130.8304761904762  , 115.00920634920634 , 116.22367346938773 , 100.23641723356009 , 101.28489795918367 ,  85.13165532879819 ,  86.01414965986396 , 101.19434807256235 , 102.1148185941043  , 121.17428004535147 , 122.26787981859412 , 141.50047052154196 , 142.76719954648527 , 162.17291950113375 , 163.61277777777778 , 154.15367346938774 , 155.4925396825397  , 157.54700680272106 , 158.88587301587305 , 173.03966553287978 , 174.47952380952384 , 153.40599206349205 , 154.67272108843537 , 133.42606009070295 , 134.51965986394558 , 113.09986961451249 , 114.02034013605441 ,  95.68363378684808 ,  96.47751700680273 , 114.49689909297052 , 115.44010204081634 , 133.60880385487528 , 134.70132653061225 , 153.01934807256234 , 154.2611904761905  , 145.18065759637187 , 146.33539682539686 , 148.10732426303852 , 149.2620634920635  , 162.39164965986393 , 163.63349206349207 , 143.87702380952382 , 144.96954648526076 , 125.06375850340137 , 126.00696145124718 , 105.95185374149659 , 106.74573696145126 ,  88.79009637188209 ,  89.4754761904762  , 106.1951984126984  , 107.00948979591837 , 123.85812358276644 , 124.80132653061224 , 141.77887188208615 , 142.85098639455785 , 134.33303854875282 , 135.3299546485261  , 136.8597052154195  , 137.85662131519277 , 149.87022108843536 , 150.94233560090706 , 132.72294217687076 , 133.66614512471654 , 115.31784013605443 , 116.13213151927437 ,  97.65491496598639 ,  98.3402947845805  ,  79.72649092970521 ,  80.30336734693877 ,  95.31526643990931 ,  96.00064625850341 , 111.12104875283448 , 111.91493197278912 , 127.14383786848073 , 128.04622448979595 , 120.3289569160998  , 121.16804988662132 , 122.45562358276645 , 123.29471655328797 , 133.95423469387757 , 134.85662131519274 , 118.58246598639457 , 119.37634920634919 , 102.99369047619048 , 103.67907029478458 ,  87.1879081632653  ,  87.76478458049887 , 120.48760204081634 , 121.06447845804989 , 143.74304421768707 , 144.42842403628117 , 167.2154931972789  , 168.00937641723354 , 190.90494897959184 , 191.80733560090698 , 179.61784580498866 , 180.45693877551017 , 181.74451247165536 , 182.58360544217683 , 197.71534580498866 , 198.6177324263038  , 174.67691043083903 , 175.4707936507936  , 151.42146825396827 , 152.10684807256234 , 127.94901927437643 , 128.52589569160997 , 149.08181972789117 , 149.76719954648527 , 177.82705782312925 , 178.64134920634922 , 206.83011904761904 , 207.77332199546484 , 236.09100340136055 , 237.16311791383217 , 222.03009070294783 , 223.02700680272108 , 224.55675736961453 , 225.55367346938775 , 244.18235260770976 , 245.25446712018137 , 215.69493764172339 , 216.63814058956913 , 186.94969954648528 , 187.76399092970522 , 157.94663832199547 , 158.6320181405896  , 179.84610544217688 , 180.63998866213151 , 214.48930272108842 , 215.43250566893425 , 249.43113945578227 , 250.52366213151925 , 284.67161564625854 , 285.9134580498866  , 267.598798185941   , 268.75353741496593 , 270.5254648526077  , 271.6802040816326  , 294.0439172335601  , 295.2857596371882  , 259.6993594104309  , 260.79188208616773 , 225.05616213151927 , 225.99936507936508 , 190.1143253968254  , 190.90820861678006 , 218.26951814058955 , 219.18998866213153 , 260.26985827664396 , 261.3634580498867  , 302.61645691609976 , 303.88318594104305 , 345.309314058957   , 346.74917233560086 , 324.4448299319728  , 325.7836961451247  , 327.8381632653061  , 329.17702947845805 , 356.17606009070295 , 357.615918367347   , 314.52197845804994 , 315.7887074829932  , 272.5216383219955  , 273.61523809523806 , 230.17503968253968 , 231.09551020408165 , 232.5663038548753  , 233.44879818594106 , 277.21664399092964 , 278.2651247165533  , 322.1989569160997  , 323.4134240362812  , 367.51324263038543 , 368.89369614512475 , 344.95292517006806 , 346.23655328798185 , 348.2062585034014  , 349.4898866213152  , 377.93165532879823 , 379.3121088435374  , 333.61328798185946 , 334.8277551020407  , 288.962947845805   , 290.01142857142855 , 243.98063492063488 , 244.86312925170066 , 266.87904195011345 , 267.7995124716553  , 318.022239229025   , 319.11583900226753 , 369.51169501133785 , 370.7784240362812  , 421.34740929705214 , 422.78726757369617 , 395.14959183673466 , 396.48845804988656 , 398.54292517006814 , 399.8817913832198  , 432.2141553287982  , 433.6540136054421  , 381.417216553288   , 382.6839455782312  , 330.27401927437637 , 331.36761904761903 , 278.7845634920634  , 279.7050340136054  , 238.5826133786848  , 239.37649659863945 , 284.27342970521545 , 285.21663265306125 , 330.2628854875283  , 331.35540816326534 , 376.5509807256236  , 377.79282312925176 , 353.0337188208617  , 354.18845804988666 , 355.9603854875284  , 357.1151247165533  , 385.92328231292515 , 387.16512471655324 , 340.5311054421768  , 341.62362811791377 , 294.84028911564616 , 295.7834920634921  , 248.85083333333327 , 249.644716553288   , 212.15846371882085 , 212.84384353741495 , 252.76764739229026 , 253.58193877551017 , 293.6346541950114  , 294.5778571428571  , 334.75948412698415 , 335.8315986394558  , 313.77793650793654 , 314.7748526077097  , 316.30460317460313 , 317.30151927437635 , 342.8508333333333  , 343.92294784580497 , 302.4994727891156  , 303.4426757369614  , 261.89028911564617 , 262.7045804988662  , 221.02328231292515 , 221.70866213151928 , 183.56424603174602 , 184.14112244897956 , 218.6836337868481  , 219.36901360544215 , 254.0200283446712  , 254.8139115646258  , 289.5734297052154  , 290.4758163265306  , 271.3656916099773  , 272.2047845804988  , 273.4923582766439  , 274.3314512471655  , 296.3838265306122  , 297.2862131519274  , 261.4814455782313  , 262.27532879818597 , 226.36205782312922 , 227.04743764172338 , 191.02566326530612 , 191.6025396825397  , 224.32535714285714 , 224.9022335600907  , 267.1114115646258  , 267.7967913832199  , 310.1144727891156  , 310.90835600907025 , 353.33454081632647 , 354.2369274376416  , 330.65458049886615 , 331.49367346938766 , 332.7812471655328  , 333.6203401360543  , 360.1449376417233  , 361.04732426303843 , 317.57589002267565 , 318.3697732426303  , 274.7898356009071  , 275.4752154195011  , 231.78677437641727 , 232.36365079365078 , 272.4501870748299  , 273.135566893424   , 324.399506802721   , 325.213798185941   , 376.6066496598639  , 377.54985260770974 , 429.0716156462584  , 430.1437301587301  , 401.4749886621314  , 402.4719047619047  , 404.0016553287981  , 404.9985714285713  , 437.1629648526077  , 438.2350793650793  , 385.4714682539682  , 386.414671201814   , 333.5221485260772  , 334.33643990929704 , 281.3150056689343  , 282.0003854875283  , 322.7450850340135  , 323.5389682539682  , 384.26583333333326 , 385.20903628117907 , 446.0852210884352  , 447.1777437641723  , 508.20324829931957 , 509.44509070294777 , 475.45185941043064 , 476.6065986394557  , 478.3785260770974  , 479.5332653061223  , 517.5755498866213  , 518.8173922902494  , 456.3534410430838  , 457.4459637188208  , 394.83269274376426 , 395.77589569161    , 333.0133049886622  , 333.80718820861676 , 383.95421201814054 , 384.87468253968245 , 457.11781746031744 , 458.21141723356    , 530.6276814058955  , 531.8944104308389  , 604.483803854875   , 605.9236621315191  , 565.4407482993195  , 566.7796145124715  , 568.8340816326529  , 570.1729478458049  , 615.3505498866211  , 616.7904081632653  , 542.5332029478458  , 543.7999319727891  , 469.36959750566905 , 470.4631972789116  , 395.8597335600908  , 396.78020408163263 , 391.415283446712   , 392.2977777777778  , 465.9431746031746  , 466.9916553287981  , 540.8030385487527  , 542.0175056689342  , 601.3663038548752  , 602.7467573696144  , 544.3107482993198  , 545.5943764172334  , 527.0840816326531  , 528.3677097505667  , 548.6380498866215  , 550.0185034013604  , 474.4421315192744  , 475.6565986394558  , 399.9142403628118  , 400.9627210884354  , 325.0543764172335  , 325.9368707482993  , 335.3446882086168  , 336.26515873015876 , 399.36543650793647 , 400.4590362811792  , 463.73244331065763 , 464.999172335601   , 513.8171371882087  , 515.2569954648526  , 463.0407482993198  , 464.3796145124717  , 445.9540816326531  , 447.292947845805   , 461.537216553288   , 462.977074829932   , 397.8627267573696  , 399.12945578231296 , 333.84197845804994 , 334.93557823129254 , 269.4749716553288  , 270.3954421768707  , 284.26254535147393 , 285.05642857142857 , 338.54519841269837 , 339.4884013605443  , 393.12649092970526 , 394.2190136054423  , 433.37785147392293 , 434.61969387755113 , 387.78201814058957 , 388.93675736961455 , 370.2286848072562  , 371.3834240362812  , 379.6034863945578  , 380.8453287981859  , 325.61947278911566 , 326.7119954648526  , 271.3368197278911  , 272.280022675737   , 216.7555272108843  , 217.549410430839   , 238.30778344671205 , 238.99316326530612 , 283.83533446712016 , 284.6496258503401  , 329.62070861678    , 330.56391156462587 , 361.03533446712015 , 362.1074489795919  , 320.11807256235824 , 321.1149886621315  , 302.1647392290249  , 303.1616553287982  , 305.9800170068027  , 307.0521315192744  , 260.7102891156462  , 261.6534920634921  , 215.18273809523808 , 215.99702947845805 , 169.39736394557823 , 170.08274376417233 , 190.18295351473927 , 190.7598299319728  , 226.54723922902497 , 227.23261904761907 , 263.1285317460318  , 263.92241496598643 , 285.29825963718827 , 286.2006462585034  , 249.297664399093   , 250.13675736961451 , 230.9443310657596  , 231.7834240362812  , 228.96198979591836 , 229.8643764172336  , 192.81471088435373 , 193.60859410430842 , 156.450425170068   , 157.13580498866213 , 119.86913265306121 , 120.44600907029479 };
  const std::array<int, 4> in_shape = {{ 3, 9, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612,  0.04081632653061224,  0.08163265306122448,  0.12244897959183673,  0.18367346938775508,  0.24489795918367346,  0.32653061224489793,  0.40816326530612246,  0.32653061224489793,  0.40816326530612246,  0.32653061224489793,  0.40816326530612246,  0.32653061224489793,  0.40816326530612246,  0.30612244897959184,  0.36734693877551017,  0.24489795918367346,  0.2857142857142857 ,  0.14285714285714285,  0.16326530612244897,  0.2040816326530612 ,  0.24489795918367344,  0.48979591836734687,  0.5714285714285714 ,  0.8571428571428571 ,  0.9795918367346937 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.1020408163265305 ,  1.2244897959183674 ,  0.8163265306122447 ,  0.8979591836734693 ,  0.44897959183673464,  0.4897959183673469 ,  0.5510204081632653 ,  0.6122448979591836 ,  1.2244897959183674 ,  1.346938775510204  ,  2.020408163265306  ,  2.204081632653061  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.387755102040816  ,  2.5714285714285716 ,  1.714285714285714  ,  1.8367346938775508 ,  0.9183673469387754 ,  0.9795918367346939 ,  0.5510204081632653 ,  0.6122448979591836 ,  1.2244897959183674 ,  1.346938775510204  ,  2.020408163265306  ,  2.204081632653061  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.387755102040816  ,  2.5714285714285716 ,  1.714285714285714  ,  1.8367346938775508 ,  0.9183673469387754 ,  0.9795918367346939 ,  0.5510204081632653 ,  0.6122448979591836 ,  1.2244897959183674 ,  1.346938775510204  ,  2.020408163265306  ,  2.204081632653061  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.387755102040816  ,  2.5714285714285716 ,  1.714285714285714  ,  1.8367346938775508 ,  0.9183673469387754 ,  0.9795918367346939 ,  0.5510204081632653 ,  0.6122448979591836 ,  1.2244897959183674 ,  1.346938775510204  ,  2.020408163265306  ,  2.204081632653061  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.387755102040816  ,  2.5714285714285716 ,  1.714285714285714  ,  1.8367346938775508 ,  0.9183673469387754 ,  0.9795918367346939 ,  0.5510204081632653 ,  0.6122448979591836 ,  1.2244897959183674 ,  1.346938775510204  ,  2.020408163265306  ,  2.204081632653061  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.387755102040816  ,  2.5714285714285716 ,  1.714285714285714  ,  1.8367346938775508 ,  0.9183673469387754 ,  0.9795918367346939 ,  0.5306122448979591 ,  0.5714285714285714 ,  1.1428571428571428 ,  1.2244897959183672 ,  1.8367346938775508 ,  1.9591836734693877 ,  2.612244897959183  ,  2.7755102040816326 ,  2.612244897959183  ,  2.7755102040816326 ,  2.612244897959183  ,  2.7755102040816326 ,  2.612244897959183  ,  2.7755102040816326 ,  2.0816326530612246 ,  2.204081632653061  ,  1.4693877551020407 ,  1.5510204081632653 ,  0.7755102040816326 ,  0.8163265306122449 ,  0.3469387755102041 ,  0.36734693877551017,  0.7346938775510203 ,  0.7755102040816326 ,  1.163265306122449  ,  1.2244897959183674 ,  1.6326530612244898 ,  1.7142857142857144 ,  1.6326530612244898 ,  1.7142857142857144 ,  1.6326530612244898 ,  1.7142857142857144 ,  1.6326530612244898 ,  1.7142857142857144 ,  1.2857142857142856 ,  1.3469387755102038 ,  0.8979591836734693 ,  0.9387755102040816 ,  0.4693877551020408 ,  0.4897959183673469 ,  0.5102040816326531 ,  0.5306122448979591 ,  1.0612244897959182 ,  1.1020408163265305 ,  1.6530612244897958 ,  1.714285714285714  ,  2.2857142857142856 ,  2.3673469387755097 ,  2.2857142857142856 ,  2.3673469387755097 ,  2.2857142857142856 ,  2.3673469387755097 ,  2.2857142857142856 ,  2.3673469387755097 ,  1.7755102040816326 ,  1.8367346938775508 ,  1.2244897959183674 ,  1.2653061224489794 ,  0.6326530612244897 ,  0.6530612244897959 ,  1.183673469387755  ,  1.2244897959183674 ,  2.4489795918367347 ,  2.530612244897959  ,  3.795918367346938  ,  3.918367346938775  ,  5.224489795918367  ,  5.387755102040816  ,  5.224489795918367  ,  5.387755102040816  ,  5.224489795918367  ,  5.387755102040816  ,  5.224489795918367  ,  5.387755102040816  ,  4.040816326530612  ,  4.163265306122448  ,  2.7755102040816326 ,  2.8571428571428568 ,  1.4285714285714284 ,  1.4693877551020407 ,  2.020408163265306  ,  2.0816326530612246 ,  4.163265306122449  ,  4.285714285714286  ,  6.428571428571428  ,  6.612244897959183  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.795918367346939  ,  6.979591836734693  ,  4.653061224489796  ,  4.775510204081632  ,  2.387755102040816  ,  2.4489795918367347 ,  2.020408163265306  ,  2.0816326530612246 ,  4.163265306122449  ,  4.285714285714286  ,  6.428571428571428  ,  6.612244897959183  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.795918367346939  ,  6.979591836734693  ,  4.653061224489796  ,  4.775510204081632  ,  2.387755102040816  ,  2.4489795918367347 ,  2.020408163265306  ,  2.0816326530612246 ,  4.163265306122449  ,  4.285714285714286  ,  6.428571428571428  ,  6.612244897959183  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.795918367346939  ,  6.979591836734693  ,  4.653061224489796  ,  4.775510204081632  ,  2.387755102040816  ,  2.4489795918367347 ,  2.020408163265306  ,  2.0816326530612246 ,  4.163265306122449  ,  4.285714285714286  ,  6.428571428571428  ,  6.612244897959183  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.795918367346939  ,  6.979591836734693  ,  4.653061224489796  ,  4.775510204081632  ,  2.387755102040816  ,  2.4489795918367347 ,  2.020408163265306  ,  2.0816326530612246 ,  4.163265306122449  ,  4.285714285714286  ,  6.428571428571428  ,  6.612244897959183  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.795918367346939  ,  6.979591836734693  ,  4.653061224489796  ,  4.775510204081632  ,  2.387755102040816  ,  2.4489795918367347 ,  1.510204081632653  ,  1.5510204081632653 ,  3.10204081632653   ,  3.183673469387755  ,  4.775510204081632  ,  4.897959183673469  ,  6.5306122448979576 ,  6.693877551020408  ,  6.5306122448979576 ,  6.693877551020408  ,  6.5306122448979576 ,  6.693877551020408  ,  6.5306122448979576 ,  6.693877551020408  ,  5.020408163265305  ,  5.142857142857142  ,  3.4285714285714284 ,  3.5102040816326534 ,  1.7551020408163263 ,  1.7959183673469385 ,  0.836734693877551  ,  0.8571428571428571 ,  1.7142857142857142 ,  1.7551020408163263 ,  2.63265306122449   ,  2.6938775510204076 ,  3.5918367346938775 ,  3.6734693877551017 ,  3.5918367346938775 ,  3.6734693877551017 ,  3.5918367346938775 ,  3.6734693877551017 ,  3.5918367346938775 ,  3.6734693877551017 ,  2.7551020408163263 ,  2.816326530612245  ,  1.8775510204081631 ,  1.9183673469387754 ,  0.9591836734693877 ,  0.9795918367346939 ,  0.9999999999999999 ,  1.0204081632653061 ,  2.040816326530612  ,  2.0816326530612246 ,  3.1224489795918364 ,  3.183673469387755  ,  4.244897959183673  ,  4.326530612244898  ,  4.244897959183673  ,  4.326530612244898  ,  4.244897959183673  ,  4.326530612244898  ,  4.244897959183673  ,  4.326530612244898  ,  3.244897959183673  ,  3.3061224489795915 ,  2.204081632653061  ,  2.2448979591836733 ,  1.1224489795918366 ,  1.1428571428571428 ,  2.1632653061224487 ,  2.204081632653061  ,  4.408163265306122  ,  4.489795918367347  ,  6.73469387755102   ,  6.857142857142857  ,  9.142857142857142  ,  9.306122448979592  ,  9.142857142857142  ,  9.306122448979592  ,  9.142857142857142  ,  9.306122448979592  ,  9.142857142857142  ,  9.306122448979592  ,  6.979591836734692  ,  7.10204081632653   ,  4.73469387755102   ,  4.816326530612244  ,  2.408163265306122  ,  2.4489795918367347 ,  3.4897959183673466 ,  3.5510204081632653 ,  7.1020408163265305 ,  7.224489795918367  , 10.83673469387755   , 11.020408163265307  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 11.20408163265306   , 11.387755102040815  ,  7.591836734693877  ,  7.7142857142857135 ,  3.8571428571428568 ,  3.9183673469387754 ,  3.4897959183673466 ,  3.5510204081632653 ,  7.1020408163265305 ,  7.224489795918367  , 10.83673469387755   , 11.020408163265307  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 11.20408163265306   , 11.387755102040815  ,  7.591836734693877  ,  7.7142857142857135 ,  3.8571428571428568 ,  3.9183673469387754 ,  3.4897959183673466 ,  3.5510204081632653 ,  7.1020408163265305 ,  7.224489795918367  , 10.83673469387755   , 11.020408163265307  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 11.20408163265306   , 11.387755102040815  ,  7.591836734693877  ,  7.7142857142857135 ,  3.8571428571428568 ,  3.9183673469387754 ,  3.4897959183673466 ,  3.5510204081632653 ,  7.1020408163265305 ,  7.224489795918367  , 10.83673469387755   , 11.020408163265307  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 11.20408163265306   , 11.387755102040815  ,  7.591836734693877  ,  7.7142857142857135 ,  3.8571428571428568 ,  3.9183673469387754 ,  3.4897959183673466 ,  3.5510204081632653 ,  7.1020408163265305 ,  7.224489795918367  , 10.83673469387755   , 11.020408163265307  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 11.20408163265306   , 11.387755102040815  ,  7.591836734693877  ,  7.7142857142857135 ,  3.8571428571428568 ,  3.9183673469387754 ,  2.4897959183673466 ,  2.5306122448979593 ,  5.061224489795919  ,  5.142857142857142  ,  7.7142857142857135 ,  7.836734693877551  , 10.448979591836734  , 10.612244897959183  , 10.448979591836734  , 10.612244897959183  , 10.448979591836734  , 10.612244897959183  , 10.448979591836734  , 10.612244897959183  ,  7.959183673469387  ,  8.081632653061224  ,  5.387755102040816  ,  5.469387755102041  ,  2.7346938775510203 ,  2.775510204081632  ,  1.3265306122448979 ,  1.346938775510204  ,  2.693877551020408  ,  2.7346938775510203 ,  4.1020408163265305 ,  4.163265306122449  ,  5.551020408163265  ,  5.63265306122449   ,  5.551020408163265  ,  5.63265306122449   ,  5.551020408163265  ,  5.63265306122449   ,  5.551020408163265  ,  5.63265306122449   ,  4.224489795918367  ,  4.285714285714286  ,  2.8571428571428568 ,  2.897959183673469  ,  1.4489795918367345 ,  1.4693877551020407 };
  const std::array<int, 4> in_shape = {{ 3, 9, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 32.72281746031746 ,  33.29969387755102 ,  33.876570294784585,  34.45344671201814 ,  40.06397392290249 ,  40.74935374149659 ,  41.434733560090706,  42.1201133786848  ,  47.8391439909297  ,  48.63302721088436 ,  49.426910430838994,  50.22079365079365 ,  56.04832766439909 ,  56.950714285714284,  57.853100907029464,  58.75548752834467 ,  56.32312925170068 ,  57.16222222222221 ,  58.00131519274377 ,  58.84040816326531 ,  60.576462585034015,  61.41555555555555 ,  62.254648526077105,  63.09374149659863 ,  69.66912131519274 ,  70.57150793650793 ,  71.47389455782313 ,  72.3762811791383  ,  62.76197845804988 ,  63.55586167800452 ,  64.34974489795918 ,  65.14362811791382 ,  55.42082199546485 ,  56.10620181405895 ,  56.79158163265306 ,  57.47696145124716 ,  47.64565192743764 ,  48.222528344671204,  48.79940476190476 ,  49.37628117913833 ,  50.74152494331066 ,  51.426904761904765,  52.112284580498866,  52.797664399092966,  61.69492630385488 ,  62.50921768707482 ,  63.32350907029478 ,  64.13780045351473 ,  73.16397392290249 ,  74.10717687074829 ,  75.0503798185941  ,  75.9935827664399  ,  85.1486678004535  ,  86.22078231292517 ,  87.2928968253968  ,  88.36501133786847 ,  84.17346938775509 ,  85.17038548752832 ,  86.1673015873016  ,  87.16421768707482 ,  89.22680272108843 ,  90.22371882086166 ,  91.22063492063492 ,  92.21755102040814 , 101.33136621315192 , 102.40348072562357 , 103.47559523809524 , 104.54770975056685 ,  90.89361111111111 ,  91.83681405895689 ,  92.78001700680272 ,  93.7232199546485  ,  79.94020975056691 ,  80.75450113378683 ,  81.56879251700681 ,  82.38308390022674 ,  68.47116213151928 ,  69.15654195011338 ,  69.84192176870748 ,  70.5273015873016  ,  73.10036848072562 ,  73.89425170068027 ,  74.68813492063491 ,  75.48201814058956 ,  88.48234126984129 ,  89.42554421768706 ,  90.36874716553288 ,  91.31195011337869 , 104.46159297052155 , 105.55411564625848 , 106.64663832199544 , 107.73916099773244 , 121.03812358276642 , 122.27996598639454 , 123.52180839002263 , 124.7636507936508  , 118.33673469387755 , 119.49147392290247 , 120.64621315192743 , 121.80095238095238 , 124.19006802721088 , 125.34480725623581 , 126.49954648526077 , 127.65428571428569 , 139.7827267573696  , 141.02456916099771 , 142.26641156462583 , 143.50825396825394 , 124.99803287981858 , 126.09055555555553 , 127.18307823129251 , 128.27560090702946 , 109.61606009070294 , 110.55926303854874 , 111.50246598639455 , 112.44566893424033 ,  93.63680839002267 ,  94.43069160997733 ,  95.22457482993195 ,  96.01845804988662 , 104.24917800453515 , 105.1696485260771  , 106.09011904761904 , 107.010589569161   , 125.75019841269844 , 126.84379818594103 , 127.93739795918367 , 129.03099773242633 , 147.94373582766443 , 149.21046485260769 , 150.477193877551   , 151.74392290249432 , 170.82979024943305 , 172.26964852607708 , 173.70950680272102 , 175.14936507936508 , 165.55895691609976 , 166.8978231292517  , 168.23668934240362 , 169.57555555555555 , 172.34562358276642 , 173.68448979591835 , 175.02335600907028 , 176.3622222222222  , 192.56328231292514 , 194.00314058956914 , 195.44299886621312 , 196.88285714285706 , 171.75477891156459 , 173.02150793650793 , 174.28823696145122 , 175.5549659863945  , 150.25375850340134 , 151.34735827664397 , 152.4409580498866  , 153.5345578231292  , 128.06022108843536 , 128.98069160997733 , 129.90116213151924 , 130.82163265306122 , 146.55215419501133 , 147.4346485260771  , 148.31714285714284 , 149.1996371882086  , 175.93174603174606 , 176.9802267573696  , 178.02870748299316 , 179.0771882086168  , 205.97528344671204 , 207.18975056689337 , 208.40421768707478 , 209.61868480725622 , 236.6827664399093  , 238.06321995464847 , 239.4436734693877  , 240.824126984127   , 226.51609977324264 , 227.79972789115644 , 229.08335600907026 , 230.3669841269841  , 233.02276643990933 , 234.3063945578231  , 235.59002267573692 , 236.87365079365077 , 257.5195918367347  , 258.90004535147386 , 260.2804988662131  , 261.6609523809524  , 228.8039455782313  , 230.01841269841267 , 231.23287981859409 , 232.44734693877547 , 199.4243537414966  , 200.47283446712018 , 201.5213151927437  , 202.56979591836733 , 169.3808163265306  , 170.26331065759638 , 171.1458049886621  , 172.02829931972792 , 201.46822562358278 , 202.3886961451247  , 203.30916666666664 , 204.2296371882086  , 241.25496031746036 , 242.34856009070293 , 243.44215986394553 , 244.53575963718825 , 281.7342120181406  , 283.0009410430839  , 284.26767006802714 , 285.53439909297055 , 322.9059807256236  , 324.3458390022675  , 325.7856972789116  , 327.22555555555556 , 306.96848072562364 , 308.3073469387755  , 309.6462131519274  , 310.9850793650794  , 313.75514739229027 , 315.0940136054421  , 316.4328798185941  , 317.7717460317461  , 344.63947278911564 , 346.07933106575956 , 347.5191893424036  , 348.9590476190477  , 305.54525510204076 , 306.8119841269841  , 308.07871315192745 , 309.34544217687073 , 265.75852040816324 , 266.8521201814059  , 267.94571995464844 , 269.03931972789115 , 225.279268707483   , 226.19973922902497 , 227.12020975056686 , 228.04068027210883 , 190.5733843537415  , 191.36726757369615 , 192.1611507936508  , 192.95503401360546 , 228.05059523809524 , 228.99379818594105 , 229.9370011337868  , 230.88020408163268 , 266.1250850340136  , 267.21760770975055 , 268.31013038548747 , 269.4026530612245  , 304.7968537414966  , 306.0386961451247  , 307.2805385487528  , 308.522380952381   , 289.2065759637188  , 290.36131519274375 , 291.51605442176873 , 292.6707936507937  , 295.0599092970521  , 296.21464852607704 , 297.36938775510197 , 298.524126984127   , 323.5414569160997  , 324.78329931972786 , 326.02514172335594 , 327.26698412698414 , 286.6615249433106  , 287.75404761904764 , 288.84657029478456 , 289.93909297052153 , 249.1843140589569  , 250.12751700680275 , 251.0707199546485  , 252.01392290249436 , 211.10982426303852 , 211.90370748299318 , 212.69759070294782 , 213.49147392290251 , 176.89481292517007 , 177.58019274376417 , 178.26557256235827 , 178.9509523809524  , 211.57610544217687 , 212.3903968253968  , 213.20468820861677 , 214.01897959183674 , 246.77304421768704 , 247.71624716553288 , 248.65945011337865 , 249.6026530612245  , 282.4856292517007  , 283.5577437641723  , 284.629858276644   , 285.7019727891157  , 267.66916099773243 , 268.66607709750565 , 269.66299319727887 , 270.6599092970522  , 272.7224943310657  , 273.719410430839   , 274.71632653061226 , 275.71324263038554 , 298.6683276643991  , 299.7404421768707  , 300.8125566893424  , 301.8846712018141  , 264.5026814058957  , 265.4458843537415  , 266.3890873015873  , 267.3322902494331  , 229.82138888888886 , 230.63568027210886 , 231.44997165532877 , 232.26426303854873 , 194.62445011337869 , 195.30982993197279 , 195.99520975056686 , 196.680589569161   , 158.87610544217688 , 159.45298185941041 , 160.029858276644   , 160.60673469387754 , 189.94515306122446 , 190.63053287981862 , 191.3159126984127  , 192.00129251700682 , 221.44821428571424 , 222.24209750566897 , 223.03598072562357 , 223.82986394557824 , 253.38528911564626 , 254.28767573696146 , 255.19006235827663 , 256.0924489795919  , 239.81882086167798 , 240.6579138321996  , 241.49700680272107 , 242.33609977324264 , 244.0721541950113  , 244.9112471655329  , 245.7503401360544  , 246.58943310657594 , 267.0060827664399  , 267.90846938775513 , 268.8108560090703  , 269.7132426303855  , 236.37104875283444 , 237.16493197278913 , 237.95881519274374 , 238.75269841269838 , 205.30200113378683 , 205.98738095238096 , 206.67276077097503 , 207.35814058956916 , 173.79893990929705 , 174.3758163265306  , 174.95269274376415 , 175.52956916099774 , 240.3983276643991  , 240.97520408163268 , 241.55208049886622 , 242.12895691609978 , 286.80070861678007 , 287.48608843537414 , 288.17146825396827 , 288.85684807256234 , 333.6371031746032  , 334.4309863945578  , 335.22486961451244 , 336.0187528344671  , 380.90751133786847 , 381.8098979591837  , 382.7122845804988  , 383.61467120181396 , 358.39659863945576 , 359.2356916099773  , 360.0747845804988  , 360.91387755102033 , 348.0213605442177  , 348.8604535147393  , 349.6995464852607  , 350.53863945578223 , 361.61401927437635 , 362.5164058956916  , 363.4187925170067  , 364.3211791383219  , 315.64565192743765 , 316.43953514739235 , 317.2334183673469  , 318.0273015873015  , 269.24327097505665 , 269.92865079365083 , 270.6140306122449  , 271.299410430839   , 222.40687641723352 , 222.98375283446714 , 223.56062925170073 , 224.13750566893427 , 241.92451814058956 , 242.6098979591837  , 243.29527777777778 , 243.98065759637188 , 288.8371031746032  , 289.6513945578231  , 290.46568594104315 , 291.27997732426303 , 336.2653344671202  , 337.2085374149659  , 338.15174036281184 , 339.0949433106576  , 384.2092120181406  , 385.2813265306122  , 386.35344104308393 , 387.4255555555555  , 362.25782312925173 , 363.25473922902495 , 364.25165532879817 , 365.2485714285714  , 352.6825850340137  , 353.6795011337869  , 354.67641723356013 , 355.6733333333333  , 367.47762471655324 , 368.54973922902496 , 369.6218537414966  , 370.6939682539682  , 321.0806859410431  , 322.02388888888896 , 322.96709183673477 , 323.91029478458046 , 274.16810090702944 , 274.9823922902495  , 275.7966836734695  , 276.61097505668937 , 226.73986961451243 , 227.4252494331066  , 228.11062925170071 , 228.79600907029484 , 247.7908446712018  , 248.5847278911565  , 249.37861111111113 , 250.17249433106574 , 296.02996031746034 , 296.9731632653061  , 297.91636621315195 , 298.85956916099775 , 344.8663548752835  , 345.95887755102035 , 347.0514002267574  , 348.14392290249435 , 394.3000283446712  , 395.5418707482993  , 396.78371315192743 , 398.0255555555555  , 372.43197278911566 , 373.5867120181406  , 374.7414512471655  , 375.8961904761905  , 363.6567346938776  , 364.81147392290256 , 365.9662131519275  , 367.12095238095236 , 380.13034580498856 , 381.37218820861676 , 382.61403061224485 , 383.855873015873   , 332.48850907029475 , 333.5810317460318  , 334.67355442176876 , 335.7660770975057  , 284.2493934240362  , 285.19259637188213 , 286.135799319728   , 287.07900226757374 , 235.41299886621312 , 236.20688208616784 , 237.00076530612247 , 237.79464852607714 , 259.6983843537415  , 260.6188548752835  , 261.5393253968254  , 262.4597959183673  , 310.43750000000006 , 311.5310997732426  , 312.6246995464853  , 313.71829931972786 , 361.8691326530613  , 363.13586167800446 , 364.4025907029479  , 365.66931972789115 , 413.9932823129252  , 415.4331405895691  , 416.8729988662132  , 418.31285714285707 , 391.66689342403635 , 393.0057596371882  , 394.34462585034015 , 395.68349206349205 , 383.8249886621316  , 385.1638548752835  , 386.50272108843546 , 387.84158730158725 , 402.81248866213144 , 404.2523469387755  , 405.6922052154195  , 407.1320634920634  , 352.7658900226757  , 354.03261904761905 , 355.29934807256245 , 356.5660770975056  , 302.02677437641717 , 303.1203741496599  , 304.21397392290265 , 305.30757369614514 , 250.595141723356   , 251.515612244898   , 252.4360827664399  , 253.3565532879819  , 210.55469387755096 , 211.4371882086168  , 212.3196825396826  , 213.2021768707483  , 251.9723809523809  , 253.02086167800448 , 254.0693424036281  , 255.11782312925172 , 294.05401360544215 , 295.2684807256236  , 296.482947845805   , 297.69741496598647 , 336.7995918367347  , 338.18004535147384 , 339.5604988662132  , 340.94095238095247 , 319.6107029478458  , 320.89433106575956 , 322.17795918367347 , 323.46158730158743 , 311.4887981859411  , 312.77242630385484 , 314.0560544217687  , 315.3396825396826  , 324.72213151927434 , 326.10258503401354 , 327.48303854875286 , 328.8634920634921  , 283.9683900226758  , 285.18285714285713 , 286.3973242630385  , 287.61179138321995 , 242.55070294784582 , 243.5991836734694  , 244.64766439909295 , 245.69614512471662 , 200.46907029478456 , 201.3515646258504  , 202.23405895691604 , 203.1165532879819  , 181.92314625850338 , 182.84361678004535 , 183.76408730158732 , 184.68455782312927 , 218.0336904761905  , 219.12729024943306 , 220.22089002267572 , 221.31448979591835 , 254.8367517006803  , 256.1034807256235  , 257.37020975056686 , 258.6369387755102  , 292.33232993197277 , 293.7721882086168  , 295.2120464852607  , 296.6519047619047  , 278.5392743764172  , 279.87814058956917 , 281.217006802721   , 282.5558730158729  , 270.69736961451247 , 272.03623582766437 , 273.3751020408163  , 274.7139682539683  , 281.1515362811791  , 282.59139455782315 , 284.031252834467   , 285.4711111111112  , 245.73350907029482 , 247.00023809523805 , 248.26696712018136 , 249.5336961451248  , 209.62296485260777 , 210.7165646258503  , 211.81016439909297 , 212.90376417233563 , 172.8199036281179  , 173.74037414965983 , 174.66084467120183 , 175.58131519274374 , 125.45687641723356 , 126.25075963718822 , 127.04464285714286 , 127.8385260770975  , 150.68646825396823 , 151.62967120181403 , 152.57287414965987 , 153.5160770975057  , 176.51333900226757 , 177.60586167800452 , 178.6983843537415  , 179.79090702947852 , 202.93748866213153 , 204.17933106575958 , 205.42117346938772 , 206.66301587301595 , 194.49165532879817 , 195.6463945578231  , 196.80113378684808 , 197.95587301587307 , 185.7164172335601  , 186.871156462585   , 188.02589569161    , 189.18063492063493 , 188.767806122449   , 190.00964852607706 , 191.2514909297052  , 192.49333333333334 , 164.13549319727892 , 165.22801587301586 , 166.32053854875284 , 167.41306122448978 , 138.9059013605442  , 139.84910430839005 , 140.79230725623583 , 141.73551020408163 , 113.07903061224488 , 113.87291383219954 , 114.66679705215418 , 115.46068027210885 ,  72.7170804988662  ,  73.40246031746032 ,  74.08784013605442 ,  74.77321995464852 ,  87.80381519274376 ,  88.61810657596372 ,  89.43239795918367 ,  90.24668934240361 , 103.40619614512472 , 104.34939909297053 , 105.29260204081633 , 106.23580498866211 , 119.52422335600907 , 120.59633786848073 , 121.66845238095239 , 122.74056689342402 , 116.13791383219954 , 117.1348299319728  , 118.13174603174603 , 119.12866213151925 , 121.19124716553286 , 122.18816326530612 , 123.18507936507937 , 124.18199546485259 , 135.70692176870747 , 136.77903628117915 , 137.8511507936508  , 138.92326530612246 , 121.13583333333332 , 122.07903628117913 , 123.02223922902495 , 123.96544217687075 , 106.04909863945576 , 106.86339002267576 , 107.6776814058957  , 108.49197278911565 ,  90.44671768707481 ,  91.13209750566892 ,  91.81747732426305 ,  92.50285714285714 ,  71.19089002267573 ,  71.7677664399093  ,  72.34464285714286 ,  72.92151927437642 ,  85.76742063492063 ,  86.45280045351474 ,  87.13818027210885 ,  87.82356009070293 , 100.7779648526077  , 101.57184807256236 , 102.36573129251701 , 103.15961451247163 , 116.22252267573695 , 117.12490929705217 , 118.02729591836734 , 118.92968253968253 , 112.27668934240361 , 113.11578231292518 , 113.95487528344671 , 114.79396825396825 , 116.53002267573694 , 117.3691156462585  , 118.20820861678006 , 119.04730158730158 , 129.8433163265306  , 130.7457029478458  , 131.64808956916102 , 132.5504761904762  , 115.70079931972788 , 116.49468253968254 , 117.2885657596372  , 118.08244897959183 , 101.12426870748298 , 101.8096485260771  , 102.49502834467121 , 103.1804081632653  ,  86.1137244897959  ,  86.69060090702948 ,  87.26747732426304 ,  87.8443537414966  , 152.71311224489796 , 153.2899886621315  , 153.8668650793651  , 154.44374149659865 , 182.62297619047615 , 183.30835600907022 , 183.99373582766444 , 184.6791156462585  , 212.96685374149655 , 213.7607369614512  , 214.55462018140594 , 215.34850340136055 , 243.74474489795915 , 244.6471315192743  , 245.5495181405896  , 246.45190476190476 , 230.85446712018137 , 231.6935600907029  , 232.5326530612245  , 233.37174603174603 , 235.1078004535147  , 235.9468934240362  , 236.7859863945578  , 237.6250793650794  , 257.3655385487528  , 258.267925170068   , 259.1703117913832  , 260.0726984126984  , 227.88968820861675 , 228.68357142857144 , 229.47745464852605 , 230.2713378684807  , 197.97982426303852 , 198.66520408163268 , 199.3505839002267  , 200.03596371882085 , 167.63594671201813 , 168.21282312925172 , 168.78969954648525 , 169.36657596371884 , 193.30052721088433 , 193.98590702947843 , 194.6712868480726  , 195.35666666666665 , 231.06753401360538 , 231.88182539682532 , 232.6961167800454  , 233.51040816326528 , 269.3501870748299  , 270.2933900226757  , 271.2365929705216  , 272.17979591836735 , 308.1484863945578  , 309.2206009070294  , 310.2927154195012  , 311.36482993197274 , 291.5320181405895  , 292.5289342403628  , 293.52585034013606 , 294.5227664399093  , 296.58535147392286 , 297.5822675736961  , 298.5791836734694  , 299.5760997732426  , 324.3311848072562  , 325.4032993197278  , 326.47541383219954 , 327.54752834467115 , 287.0798242630385  , 288.0230272108843  , 288.9662301587301  , 289.90943310657593 , 249.31281746031743 , 250.12710884353746 , 250.94140022675728 , 251.75569160997733 , 211.03016439909297 , 211.7155442176871  , 212.40092403628114 , 213.08630385487533 , 238.2280782312925  , 239.02196145124714 , 239.81584467120186 , 240.60972789115644 , 284.66855442176865 , 285.61175736961445 , 286.55496031746037 , 287.4981632653061  , 331.70630952380947 , 332.79883219954644 , 333.8913548752835  , 334.98387755102044 , 379.3413435374149  , 380.583185941043   , 381.8250283446713  , 383.0668707482993  , 358.52249433106573 , 359.67723356009066 , 360.83197278911564 , 361.9867120181406  , 364.3758276643991  , 365.53056689342395 , 366.685306122449   , 367.840045351474   , 398.08594671201814 , 399.32778911564617 , 400.5696315192744  , 401.8114739229025  , 352.2427494331066  , 353.3352721088435  , 354.4277947845805  , 355.5203174603175  , 305.8022732426304  , 306.74547619047627 , 307.6886791383219  , 308.6318820861679  , 258.7645181405896  , 259.5584013605442  , 260.3522845804988  , 261.14616780045355 , 295.7070464852608  , 296.6275170068027  , 297.5479875283447  , 298.4684580498866  , 353.2189512471655  , 354.3125510204081  , 355.40615079365085 , 356.4997505668934  , 411.423373015873   , 412.69010204081627 , 413.95683106575973 , 415.22356009070296 , 470.3203117913832  , 471.7601700680271  , 473.2000283446713  , 474.63988662131516 , 444.0431292517007  , 445.38199546485254 , 446.7208616780045  , 448.05972789115646 , 450.8297959183674  , 452.16866213151917 , 453.5075283446712  , 454.84639455782315 , 492.0538038548753  , 493.49366213151916 , 494.9335204081633  , 496.3733786848072  , 435.2344160997732  , 436.5011451247165  , 437.76787414965986 , 439.03460317460315 , 377.7225113378685  , 378.8161111111112  , 379.9097108843537  , 381.0033106575964  , 319.51808956916096 , 320.43856009070294 , 321.35903061224485 , 322.2795011337868  , 330.11097505668926 , 330.9934693877551  , 331.87596371882086 , 332.7584580498866  , 394.0157369614512  , 395.06421768707486 , 396.1126984126984  , 397.161179138322   , 458.58444444444444 , 459.7989115646258  , 461.01337868480726 , 462.22784580498865 , 509.1885260770975  , 510.5689795918367  , 511.949433106576   , 513.3298866213152  , 461.81551020408165 , 463.09913832199544 , 464.3827664399093  , 465.6663945578231  , 447.8421768707484  , 449.12580498866214 , 450.4094331065759  , 451.6930612244898  , 466.87868480725626 , 468.2591383219954  , 469.63959183673467 , 471.0200453514739  , 403.63786848072573 , 404.852335600907   , 406.0668027210884  , 407.2812698412698  , 339.7331065759637  , 340.78158730158725 , 341.8300680272109  , 342.87854875283443 , 275.1643990929705  , 276.0468934240362  , 276.929387755102   , 277.8118820861678  , 295.7070464852608  , 296.62751700680275 , 297.5479875283446  , 298.4684580498866  , 353.2189512471656  , 354.31255102040814 , 355.4061507936507  , 356.49975056689345 , 411.423373015873   , 412.69010204081627 , 413.95683106575956 , 415.2235600907031  , 455.6917403628118  , 457.1315986394558  , 458.5714569160997  , 460.0113151927438  , 412.34789115646265 , 413.6867573696145  , 415.02562358276634 , 416.36448979591836 , 398.65455782312927 , 399.99342403628117 , 401.3322902494331  , 402.67115646258503 , 414.27856575963716 , 415.71842403628114 , 417.1582823129251  , 418.59814058956914 , 357.45917800453515 , 358.7259070294784  , 359.9926360544218  , 361.259365079365   , 299.94727324263033 , 301.04087301587293 , 302.13447278911565 , 303.2280725623583  , 241.7428514739229  , 242.66332199546477 , 243.58379251700677 , 244.5042630385488  , 258.48204648526075 , 259.2759297052154  , 260.06981292517    , 260.86369614512466 , 308.73204648526087 , 309.6752494331066  , 310.6184523809523  , 311.56165532879817 , 359.57932539682537 , 360.67184807256234 , 361.76437074829926 , 362.85689342403634 , 396.3953117913832  , 397.63715419501136 , 398.8789965986394  , 400.1208390022676  , 356.28757369614516 , 357.44231292517003 , 358.59705215419496 , 359.7517913832199  , 341.6609070294785  , 342.8156462585033  , 343.97038548752835 , 345.1251247165533  , 351.99324829931965 , 353.2350907029478  , 354.476933106576   , 355.71877551020407 , 302.3405272108843  , 303.43304988662123 , 304.52557256235826 , 305.6180952380953  , 252.09052721088435 , 253.0337301587301  , 253.97693310657593 , 254.92013605442182 , 201.24324829931973 , 202.0371315192743  , 202.83101473922898 , 203.62489795918373 , 222.23476757369613 , 222.92014739229026 , 223.60552721088436 , 224.2909070294784  , 265.4439512471656  , 266.25824263038544 , 267.0725340136054  , 267.8868253968254  , 309.16878117913836 , 310.1119841269841  , 311.0551870748299  , 311.9983900226757  , 338.78068594104303 , 339.8528004535147  , 340.9249149659863  , 341.99702947845805 , 301.922947845805   , 302.9198639455782  , 303.9167800453514  , 304.9136961451247  , 286.49628117913835 , 287.49319727891145 , 288.4901133786848  , 289.4870294784581  , 291.8167176870748  , 292.8888321995464  , 293.9609467120181  , 295.03306122448987 , 249.1231802721088  , 250.06638321995464 , 251.0095861678004  , 251.95278911564628 , 205.91399659863947 , 206.72828798185938 , 207.5425793650793  , 208.35687074829937 , 162.18916666666667 , 162.87454648526074 , 163.55992630385487 , 164.24530612244902 , 181.64735260770973 , 182.2242290249433  , 182.80110544217686 , 183.3779818594104  , 216.99939342403624 , 217.68477324263043 , 218.3701530612245  , 219.05553287981854 , 252.78544784580498 , 253.57933106575965 , 254.37321428571428 , 255.1670975056689  , 274.3769444444444  , 275.2793310657596  , 276.1817176870748  , 277.08410430839    , 241.24539682539682 , 242.08448979591836 , 242.9235827664399  , 243.76267573696146 , 225.01873015873014 , 225.85782312925173 , 226.6969160997732  , 227.53600907029474 , 224.85107142857143 , 225.7534580498866  , 226.65584467120178 , 227.558231292517   , 189.93304421768707 , 190.7269274376417  , 191.52081065759634 , 192.314693877551   , 154.5810034013606  , 155.2663832199546  , 155.95176303854873 , 156.6371428571429  , 118.79494897959182 , 119.37182539682541 , 119.94870181405895 , 120.52557823129249 };
  const std::array<int, 4> in_shape = {{ 3, 9, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x9x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5510204081632653  ,  0.6122448979591837  ,  0.6734693877551019  ,  0.7346938775510203  ,  0.44897959183673464 ,  0.4897959183673469  ,  0.5306122448979591  ,  0.5714285714285714  ,  0.26530612244897955 ,  0.2857142857142857  ,  0.3061224489795918  ,  0.32653061224489793 ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  1.0204081632653061  ,  1.0612244897959182  ,  1.1020408163265305  ,  1.1428571428571428  ,  2.204081632653061   ,  2.2857142857142856  ,  2.3673469387755097  ,  2.4489795918367343  ,  3.5510204081632653  ,  3.6734693877551017  ,  3.795918367346938   ,  3.9183673469387754  ,  5.061224489795918   ,  5.224489795918366   ,  5.387755102040815   ,  5.551020408163265   ,  5.061224489795918   ,  5.224489795918366   ,  5.387755102040815   ,  5.551020408163265   ,  5.061224489795918   ,  5.224489795918366   ,  5.387755102040815   ,  5.551020408163265   ,  5.061224489795918   ,  5.224489795918366   ,  5.387755102040815   ,  5.551020408163265   ,  4.040816326530612   ,  4.163265306122449   ,  4.285714285714285   ,  4.408163265306122   ,  2.8571428571428568  ,  2.9387755102040813  ,  3.020408163265306   ,  3.1020408163265305  ,  1.510204081632653   ,  1.5510204081632653  ,  1.5918367346938775  ,  1.6326530612244898  ,  0.673469387755102   ,  0.6938775510204082  ,  0.7142857142857142  ,  0.7346938775510203  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  2.265306122448979   ,  2.326530612244898   ,  2.387755102040816   ,  2.4489795918367347  ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  1.7551020408163263  ,  1.7959183673469385  ,  1.8367346938775508  ,  1.8775510204081631  ,  0.9183673469387754  ,  0.9387755102040816  ,  0.9591836734693877  ,  0.9795918367346939  ,  0.9999999999999999  ,  1.0204081632653061  ,  1.040816326530612   ,  1.0612244897959182  ,  2.081632653061224   ,  2.1224489795918364  ,  2.1632653061224487  ,  2.204081632653061   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  3.4897959183673466  ,  3.5510204081632653  ,  3.6122448979591835  ,  3.6734693877551017  ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  1.2448979591836733  ,  1.2653061224489794  ,  1.2857142857142856  ,  1.3061224489795917  ,  2.326530612244898   ,  2.36734693877551    ,  2.408163265306122   ,  2.4489795918367347  ,  4.816326530612244   ,  4.8979591836734695  ,  4.979591836734693   ,  5.061224489795918   ,  7.46938775510204    ,  7.591836734693876   ,  7.714285714285714   ,  7.83673469387755    , 10.285714285714285   , 10.448979591836734   , 10.612244897959183   , 10.775510204081632   , 10.285714285714285   , 10.448979591836734   , 10.612244897959183   , 10.775510204081632   , 10.285714285714285   , 10.448979591836734   , 10.612244897959183   , 10.775510204081632   , 10.285714285714285   , 10.448979591836734   , 10.612244897959183   , 10.775510204081632   ,  7.959183673469386   ,  8.081632653061224   ,  8.204081632653061   ,  8.326530612244897   ,  5.46938775510204    ,  5.551020408163265   ,  5.63265306122449    ,  5.7142857142857135  ,  2.816326530612245   ,  2.8571428571428568  ,  2.897959183673469   ,  2.9387755102040813  ,  3.9795918367346936  ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  8.204081632653061   ,  8.326530612244898   ,  8.448979591836734   ,  8.571428571428571   , 12.6734693877551     , 12.857142857142856   , 13.040816326530612   , 13.224489795918366   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 13.40816326530612    , 13.591836734693878   , 13.775510204081632   , 13.959183673469386   ,  9.183673469387754   ,  9.306122448979592   ,  9.428571428571429   ,  9.551020408163264   ,  4.714285714285714   ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  3.9795918367346936  ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  8.204081632653061   ,  8.326530612244898   ,  8.448979591836734   ,  8.571428571428571   , 12.6734693877551     , 12.857142857142856   , 13.040816326530612   , 13.224489795918366   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 13.40816326530612    , 13.591836734693878   , 13.775510204081632   , 13.959183673469386   ,  9.183673469387754   ,  9.306122448979592   ,  9.428571428571429   ,  9.551020408163264   ,  4.714285714285714   ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  3.9795918367346936  ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  8.204081632653061   ,  8.326530612244898   ,  8.448979591836734   ,  8.571428571428571   , 12.6734693877551     , 12.857142857142856   , 13.040816326530612   , 13.224489795918366   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 13.40816326530612    , 13.591836734693878   , 13.775510204081632   , 13.959183673469386   ,  9.183673469387754   ,  9.306122448979592   ,  9.428571428571429   ,  9.551020408163264   ,  4.714285714285714   ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  3.9795918367346936  ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  8.204081632653061   ,  8.326530612244898   ,  8.448979591836734   ,  8.571428571428571   , 12.6734693877551     , 12.857142857142856   , 13.040816326530612   , 13.224489795918366   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 13.40816326530612    , 13.591836734693878   , 13.775510204081632   , 13.959183673469386   ,  9.183673469387754   ,  9.306122448979592   ,  9.428571428571429   ,  9.551020408163264   ,  4.714285714285714   ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  3.9795918367346936  ,  4.040816326530612   ,  4.1020408163265305  ,  4.163265306122449   ,  8.204081632653061   ,  8.326530612244898   ,  8.448979591836734   ,  8.571428571428571   , 12.6734693877551     , 12.857142857142856   , 13.040816326530612   , 13.224489795918366   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 13.40816326530612    , 13.591836734693878   , 13.775510204081632   , 13.959183673469386   ,  9.183673469387754   ,  9.306122448979592   ,  9.428571428571429   ,  9.551020408163264   ,  4.714285714285714   ,  4.775510204081632   ,  4.836734693877551   ,  4.8979591836734695  ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  1.6530612244897958  ,  1.673469387755102   ,  1.693877551020408   ,  1.7142857142857142  ,  3.387755102040816   ,  3.4285714285714284  ,  3.4693877551020407  ,  3.5102040816326525  ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040815   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  1.8979591836734693  ,  1.9183673469387754  ,  1.9387755102040816  ,  1.9591836734693877  ,  1.9795918367346936  ,  1.9999999999999998  ,  2.020408163265306   ,  2.0408163265306123  ,  4.040816326530612   ,  4.081632653061224   ,  4.122448979591836   ,  4.163265306122449   ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  8.408163265306122   ,  8.489795918367346   ,  8.571428571428571   ,  8.653061224489797   ,  8.408163265306122   ,  8.489795918367346   ,  8.571428571428571   ,  8.653061224489797   ,  8.408163265306122   ,  8.489795918367346   ,  8.571428571428571   ,  8.653061224489797   ,  8.408163265306122   ,  8.489795918367346   ,  8.571428571428571   ,  8.653061224489797   ,  6.428571428571429   ,  6.489795918367346   ,  6.551020408163264   ,  6.612244897959183   ,  4.36734693877551    ,  4.408163265306122   ,  4.448979591836734   ,  4.489795918367347   ,  2.2244897959183674  ,  2.2448979591836733  ,  2.265306122448979   ,  2.2857142857142856  ,  4.285714285714285   ,  4.326530612244897   ,  4.36734693877551    ,  4.408163265306122   ,  8.73469387755102    ,  8.816326530612244   ,  8.89795918367347    ,  8.979591836734693   , 13.346938775510203   , 13.46938775510204    , 13.591836734693876   , 13.714285714285714   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 13.836734693877549   , 13.959183673469385   , 14.081632653061224   , 14.20408163265306    ,  9.387755102040817   ,  9.46938775510204    ,  9.551020408163264   ,  9.632653061224488   ,  4.775510204081632   ,  4.816326530612244   ,  4.857142857142857   ,  4.8979591836734695  ,  6.9183673469387745  ,  6.979591836734693   ,  7.040816326530612   ,  7.1020408163265305  , 14.081632653061224   , 14.204081632653061   , 14.326530612244898   , 14.448979591836734   , 21.489795918367346   , 21.6734693877551     , 21.857142857142854   , 22.040816326530614   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 22.224489795918366   , 22.40816326530612    , 22.591836734693874   , 22.77551020408163    , 15.061224489795919   , 15.183673469387754   , 15.30612244897959    , 15.428571428571427   ,  7.653061224489795   ,  7.7142857142857135  ,  7.775510204081632   ,  7.836734693877551   ,  6.9183673469387745  ,  6.979591836734693   ,  7.040816326530612   ,  7.1020408163265305  , 14.081632653061224   , 14.204081632653061   , 14.326530612244898   , 14.448979591836734   , 21.489795918367346   , 21.6734693877551     , 21.857142857142854   , 22.040816326530614   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 22.224489795918366   , 22.40816326530612    , 22.591836734693874   , 22.77551020408163    , 15.061224489795919   , 15.183673469387754   , 15.30612244897959    , 15.428571428571427   ,  7.653061224489795   ,  7.7142857142857135  ,  7.775510204081632   ,  7.836734693877551   ,  6.9183673469387745  ,  6.979591836734693   ,  7.040816326530612   ,  7.1020408163265305  , 14.081632653061224   , 14.204081632653061   , 14.326530612244898   , 14.448979591836734   , 21.489795918367346   , 21.6734693877551     , 21.857142857142854   , 22.040816326530614   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 22.224489795918366   , 22.40816326530612    , 22.591836734693874   , 22.77551020408163    , 15.061224489795919   , 15.183673469387754   , 15.30612244897959    , 15.428571428571427   ,  7.653061224489795   ,  7.7142857142857135  ,  7.775510204081632   ,  7.836734693877551   ,  6.9183673469387745  ,  6.979591836734693   ,  7.040816326530612   ,  7.1020408163265305  , 14.081632653061224   , 14.204081632653061   , 14.326530612244898   , 14.448979591836734   , 21.489795918367346   , 21.6734693877551     , 21.857142857142854   , 22.040816326530614   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 22.224489795918366   , 22.40816326530612    , 22.591836734693874   , 22.77551020408163    , 15.061224489795919   , 15.183673469387754   , 15.30612244897959    , 15.428571428571427   ,  7.653061224489795   ,  7.7142857142857135  ,  7.775510204081632   ,  7.836734693877551   ,  6.9183673469387745  ,  6.979591836734693   ,  7.040816326530612   ,  7.1020408163265305  , 14.081632653061224   , 14.204081632653061   , 14.326530612244898   , 14.448979591836734   , 21.489795918367346   , 21.6734693877551     , 21.857142857142854   , 22.040816326530614   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 22.224489795918366   , 22.40816326530612    , 22.591836734693874   , 22.77551020408163    , 15.061224489795919   , 15.183673469387754   , 15.30612244897959    , 15.428571428571427   ,  7.653061224489795   ,  7.7142857142857135  ,  7.775510204081632   ,  7.836734693877551   ,  4.938775510204081   ,  4.979591836734693   ,  5.020408163265305   ,  5.061224489795919   , 10.04081632653061    , 10.122448979591837   , 10.204081632653061   , 10.285714285714285   , 15.30612244897959    , 15.428571428571427   , 15.551020408163263   , 15.673469387755102   , 20.734693877551017   , 20.897959183673468   , 21.061224489795915   , 21.224489795918366   , 20.734693877551017   , 20.897959183673468   , 21.061224489795915   , 21.224489795918366   , 20.734693877551017   , 20.897959183673468   , 21.061224489795915   , 21.224489795918366   , 20.734693877551017   , 20.897959183673468   , 21.061224489795915   , 21.224489795918366   , 15.795918367346937   , 15.918367346938775   , 16.04081632653061    , 16.163265306122447   , 10.693877551020407   , 10.775510204081632   , 10.857142857142858   , 10.938775510204081   ,  5.428571428571429   ,  5.469387755102041   ,  5.5102040816326525  ,  5.551020408163264   ,  2.6326530612244894  ,  2.6530612244897958  ,  2.6734693877551017  ,  2.693877551020408   ,  5.346938775510203   ,  5.387755102040816   ,  5.428571428571428   ,  5.469387755102041   ,  8.142857142857142   ,  8.204081632653061   ,  8.26530612244898    ,  8.326530612244898   , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  5.673469387755102   ,  5.7142857142857135  ,  5.755102040816326   ,  5.795918367346938   ,  2.877551020408163   ,  2.897959183673469   ,  2.9183673469387754  ,  2.9387755102040813  };
  const std::array<int, 4> in_shape = {{ 3, 9, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  7.15218253968254 ,   8.794019274376419,  10.836082766439908,  13.43846371882086 ,  14.767630385487529,  12.924773242630383,  11.262471655328797,   9.729138321995464,  10.870209750566895,  13.2671485260771  ,  16.213973922902493,  19.93064058956916 ,  21.509807256235824,  18.69552154195011 ,  16.19988662131519 ,  13.931859410430839,  15.456264172335601,  18.77157029478458 ,  22.813633786848072,  27.873157596371875,  29.70232426303854 ,  25.68803854875283 ,  22.168594104308387,  19.002607709750567,  20.910345804988662,  25.307284580498866,  30.63506235827664 ,  37.266014739229014,  39.34518140589568 ,  33.902324263038544,  29.168594104308387,  24.94138321995465 ,  27.855782312925168,  33.5265306122449  ,  40.32653061224489 ,  48.70748299319727 ,  50.6408163265306  ,  43.364625850340126,  37.117006802721086,  31.604081632653063,  36.36244897959183 ,  43.63319727891156 ,  52.299863945578224,  62.9208163265306  ,  64.85414965986392 ,  55.33795918367347 ,  47.223673469387755,  40.11074829931973 ,  48.15193310657597 ,  57.672681405895695,  68.97823696145124 ,  82.78252267573696 ,  84.86168934240362 ,  72.24549886621315 ,  61.53399092970521 ,  52.182970521541954,  45.301933106575966,  54.230844671201815,  64.82211451247166 ,  77.74068594104308 ,  79.56985260770976 ,  67.69651927437643 ,  57.627868480725624,  48.84827664399093 ,  41.583905895691615,  49.75771541950113 ,  59.44422335600907 ,  71.24850907029479 ,  72.82767573696145 ,  61.92577097505669 ,  52.69045351473923 ,  44.64555555555556 ,  36.9978514739229  ,  44.25329365079365 ,  52.8445634920635  ,  63.30599206349206 ,  64.63515873015874 ,  54.93325396825397 ,  46.72174603174604 ,  39.57480725623583 ,  53.30229591836735 ,  63.62440476190475 ,  75.79345238095239 ,  90.54821428571428 ,  91.87738095238096 ,  77.88214285714288 ,  66.09285714285714 ,  55.87925170068027 ,  65.70059523809525 ,  78.41045918367345 ,  93.38903061224491 , 111.5437925170068  , 113.12295918367349 ,  95.87057823129255 ,  81.34319727891157 ,  68.76224489795919 ,  78.96692176870748 ,  94.22780612244895 , 112.20637755102041 , 133.98971088435374 , 135.81887755102042 , 115.08078231292521 ,  97.6248299319728  ,  82.51326530612246 ,  93.10127551020408 , 111.07644557823126 , 132.24549319727893 , 157.88596938775515 , 159.96513605442183 , 135.51275510204084 , 114.93775510204082 ,  97.13231292517008 ,  94.98321995464852 , 113.27981859410428 , 134.809977324263   , 160.86712018140594 , 162.80045351473925 , 137.84807256235828 , 116.8702947845805  ,  98.73151927437641 , 103.4898866213152  , 123.38648526077097 , 146.78331065759636 , 175.08045351473925 , 177.01378684807258 , 149.8214058956916  , 126.97696145124715 , 107.23818594104307 , 120.34286281179138 , 143.44184240362816 , 170.58866780045352 , 203.40247732426303 , 205.4816439909297  , 173.85592970521546 , 147.30315192743763 , 124.37390022675736 , 108.81259070294784 , 129.6870804988662  , 154.21485827664404 , 183.85723922902494 , 185.6864058956916  , 157.08926303854872 , 133.08410430839    , 112.35893424036281 ,  96.41429138321996 , 114.90102607709751 , 136.61928004535147 , 162.86166099773246 , 164.4408276643991  , 139.10082766439908 , 117.8337641723356  ,  99.4759410430839  ,  83.1479648526077  ,  99.08367913832198 , 117.80193310657596 , 140.4157426303855  , 141.74490929705215 , 119.89062358276642 , 101.55213151927437 ,  85.72492063492064 ,  99.45240929705217 , 118.45479024943313 , 140.7508219954649  , 167.65796485260773 , 168.9871315192744  , 142.83951247165533 , 120.92324263038549 , 102.02936507936508 , 120.53098072562359 , 143.55376984126985 , 170.56408730158734 , 203.15694444444446 , 204.73611111111114 , 173.0456349206349  , 146.48650793650793 , 123.59263038548751 , 142.47757936507938 , 169.68404195011337 , 201.59912131519275 , 240.10626417233559 , 241.93543083900227 , 204.47352607709746 , 173.08106575963714 , 146.0239229024943  , 165.29220521541953 , 196.84560657596373 , 233.8559240362812  , 278.50592403628116 , 280.5850907029478  , 237.12318594104306 , 200.70691609977322 , 169.32324263038547 , 162.1106575963719  , 193.03310657596373 , 229.29342403628115 , 273.02675736961453 , 274.9600907029478  , 232.3315192743764  , 196.6235827664399  , 165.85895691609977 , 170.61732426303854 , 203.13977324263035 , 241.26675736961448 , 287.2400907029479  , 289.17342403628123 , 244.30485260770973 , 206.73024943310656 , 174.36562358276643 , 192.53379251700673 , 229.21100340136047 , 272.1990986394557  , 324.0224319727891  , 326.1015986394558  , 275.46636054421765 , 233.07231292517002 , 196.56482993197278 , 172.3232482993197  , 205.14331632653057 , 243.60760204081626 , 289.97379251700676 , 291.8029591836734  , 246.48200680272103 , 208.5403401360544  , 175.86959183673468 , 151.24467687074826 , 180.04433673469384 , 213.79433673469384 , 254.47481292517    , 256.05397959183665 , 216.27588435374145 , 182.97707482993198 , 154.3063265306122  , 129.29807823129252 , 153.91406462585036 , 182.7593027210884  , 217.52549319727888 , 218.85465986394553 , 184.84799319727887 , 156.3825170068027  , 131.87503401360544 };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.061224489795918366, 0.04081632653061224 , 0.08163265306122448 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.20408163265306123 , 0.12244897959183673 , 0.18367346938775508 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.24489795918367346 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.32653061224489793 , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.7346938775510203  , 0.40816326530612246 , 0.30612244897959184 , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.36734693877551017 , 0.24489795918367346 , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.5306122448979591  , 0.2857142857142857  , 0.14285714285714285 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.30612244897959184 , 0.16326530612244897 , 0.18367346938775508 , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.3877551020408163  , 0.2040816326530612  , 0.4081632653061224  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.8571428571428572  , 0.44897959183673464 , 0.6734693877551019  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 0.7346938775510203  , 0.9795918367346936  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.0612244897959182  , 0.9795918367346936  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.0612244897959182  , 0.9795918367346936  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.0612244897959182  , 0.9795918367346936  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 2.0408163265306123  , 1.0612244897959182  , 0.7959183673469387  , 1.6530612244897955  , 1.6530612244897955  , 1.6530612244897955  , 1.6530612244897955  , 1.6530612244897955  , 1.6530612244897955  , 0.857142857142857   , 0.5714285714285714  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 1.1836734693877549  , 0.6122448979591837  , 0.3061224489795918  , 0.6326530612244897  , 0.6326530612244897  , 0.6326530612244897  , 0.6326530612244897  , 0.6326530612244897  , 0.6326530612244897  , 0.32653061224489793 , 0.3469387755102041  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.7142857142857142  , 0.36734693877551017 , 0.7346938775510203  , 1.510204081632653   , 1.510204081632653   , 1.510204081632653   , 1.510204081632653   , 1.510204081632653   , 1.510204081632653   , 0.7755102040816326  , 1.163265306122449   , 2.387755102040816   , 2.387755102040816   , 2.387755102040816   , 2.387755102040816   , 2.387755102040816   , 2.387755102040816   , 1.2244897959183674  , 1.6326530612244898  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 1.7142857142857144  , 1.6326530612244898  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 1.7142857142857144  , 1.6326530612244898  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 1.7142857142857144  , 1.6326530612244898  , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 3.346938775510204   , 1.7142857142857144  , 1.2857142857142856  , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 1.3469387755102038  , 0.8979591836734693  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 1.8367346938775508  , 0.9387755102040816  , 0.4693877551020408  , 0.9591836734693877  , 0.9591836734693877  , 0.9591836734693877  , 0.9591836734693877  , 0.9591836734693877  , 0.9591836734693877  , 0.4897959183673469  };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 13.72748866213152 ,  14.30436507936508 ,  16.90265873015873 ,  17.588038548752838,  20.860198412698413,  21.672165532879816,  25.91305555555556 ,  26.87692743764172 ,  28.571388888888887,  29.535260770975057,  25.037579365079367,  25.849546485260767,  21.839563492063494,  22.524943310657594,  18.88140022675737 ,  19.458276643990928,  21.055039682539682,  21.74041950113379 ,  25.720005668934242,  26.5342970521542  ,  31.46325963718821 ,  32.42794784580499 ,  38.716116780045354,  39.86128117913832 ,  41.874450113378686,  43.01961451247165 ,  36.426354875283444,  37.39104308390022 ,  31.58548185941043 ,  32.39977324263038 ,  27.17833900226757 ,  27.863718820861678,  30.11864512471655 ,  30.912528344671202,  36.59993764172336 ,  37.54314058956916 ,  44.509858276643996,  45.627267573696145,  54.419858276644   ,  55.74631519274375 ,  58.07819160997733 ,  59.40464852607708 ,  50.258667800453516,  51.37607709750566 ,  43.393985260770975,  44.33718820861677 ,  37.21133219954648 ,  38.005215419501134,  40.91830498866213 ,  41.820691609977324,  49.54245464852608 ,  50.61456916099773 ,  59.999994331065764,  61.27012471655328 ,  73.02428004535149 ,  74.53202947845803 ,  77.1826133786848  ,  78.69036281179136 ,  66.53451814058957 ,  67.80464852607709 ,  57.26507369614513 ,  58.33718820861677 ,  48.98037981859411 ,  49.8827664399093  ,  54.8724716553288  ,  55.711564625850336,  66.05614512471656 ,  67.0530612244898  ,  79.47201814058958 ,  80.65306122448978 ,  96.01297052154196 ,  97.41496598639453 ,  99.87963718820862 , 101.2816326530612  ,  85.54820861678004 ,  86.72925170068025 ,  73.23709750566894 ,  74.23401360544217 ,  62.36907029478458 ,  63.208163265306126,  71.88580498866214 ,  72.72489795918366 ,  86.26947845804989 ,  87.26639455782312 , 103.41868480725623 , 104.59972789115645 , 124.43963718820861 , 125.8416326530612  , 128.30630385487527 , 129.70829931972784 , 109.49487528344675 , 110.67591836734694 ,  93.45043083900227 ,  94.44734693877551 ,  79.3824036281179  ,  80.22149659863946 ,  95.40147959183673 ,  96.30386621315193 , 114.27324829931972 , 115.34536281179139 , 136.68634353741498 , 137.9564739229025  , 164.05729591836737 , 165.5650453514739  , 168.2156292517007  , 169.72337868480724 , 143.22086734693877 , 144.4909977324263  , 121.99586734693874 , 123.06798185941042 , 103.46355442176869 , 104.36594104308391 ,  89.80998299319727 ,  90.60386621315193 , 107.51848639455781 , 108.46168934240363 , 128.52681972789117 , 129.64422902494331 , 154.15491496598642 , 155.48137188208617 , 157.81324829931975 , 159.13970521541953 , 134.27562925170065 , 135.39303854875286 , 114.31253401360541 , 115.25573696145125 ,  96.90267006802718 ,  97.69655328798186 ,  82.48243197278912 ,  83.16781179138323 ,  98.7011394557823  ,  99.51543083900226 , 117.92375850340134 , 118.88844671201814 , 141.35185374149657 , 142.49701814058957 , 144.5101870748299  , 145.6553514739229  , 122.88685374149657 , 123.85154195011339 , 104.56661564625847 , 105.38090702947846 ,  88.60573129251699 ,  89.29111111111112 ,  73.41882653061224 ,  73.9957029478458  ,  87.82120748299317 ,  88.5065873015873  , 104.87715986394555 , 105.689126984127   , 125.64811224489793 , 126.61198412698413 , 128.30644557823126 , 129.27031746031747 , 109.0545408163265  , 109.86650793650794 ,  92.75811224489793 ,  93.44349206349207 ,  78.5727380952381  ,  79.14961451247166 , 106.02771541950113 , 106.6045918367347  , 126.56342970521543 , 127.2488095238095  , 150.77493764172337 , 151.58690476190478 , 180.13255668934247 , 181.09642857142856 , 182.79089002267577 , 183.75476190476192 , 154.95231859410433 , 155.76428571428576 , 131.50033446712018 , 132.18571428571428 , 111.18162698412698 , 111.75850340136054 , 130.71581065759636 , 131.4011904761905  , 156.00662698412702 , 156.8209183673469  , 185.81337301587305 , 186.77806122448982 , 221.94242063492072 , 223.0875850340136  , 225.10075396825403 , 226.24591836734697 , 190.7764682539683  , 191.7411564625851  , 161.87210317460318 , 162.68639455782315 , 136.83910997732426 , 137.52448979591838 , 157.13996031746032 , 157.93384353741496 , 187.51240929705222 , 188.4556122448979  , 223.29534580498873 , 224.41275510204082 , 266.65296485260785 , 267.9794217687075  , 270.3112981859411  , 271.63775510204084 , 229.04415532879824 , 230.16156462585042 , 194.3064569160998  , 195.2496598639456  , 164.23264739229026 , 165.02653061224493 , 185.30016439909298 , 186.20255102040815 , 221.080776643991   , 222.15289115646252 , 263.22085600907036 , 264.49098639455786 , 314.26418934240377 , 315.7719387755103  , 318.422522675737   , 319.93027210884367 , 269.7553798185942  , 271.0255102040817  , 228.80339569160998 , 229.87551020408165 , 193.36223922902494 , 194.26462585034017 , 189.12734693877547 , 189.96643990929704 , 225.56272108843535 , 226.55963718820857 , 268.4389115646258  , 269.619954648526   , 320.3322448979593  , 321.7342403628119  , 324.1989115646259  , 325.6009070294785  , 274.5151020408163  , 275.69614512471657 , 232.74367346938772 , 233.740589569161   , 196.62394557823126 , 197.46303854875282 , 206.14068027210882 , 206.9797732426304  , 245.77605442176866 , 246.77297052154194 , 292.38557823129247 , 293.5666213151927  , 348.75891156462575 , 350.1609070294785  , 352.6255782312924  , 354.02757369614517 , 298.461768707483   , 299.6428117913832  , 252.9570068027211  , 253.9539229024943  , 213.63727891156464 , 214.47637188208614 , 239.78333900226752 , 240.68572562358275 , 285.81157029478453 , 286.8836848072563  , 339.9072052154195  , 341.17733560090704 , 405.2972052154195  , 406.80495464852606 , 409.4555385487528  , 410.9632879818594  , 346.4417290249433  , 347.7118594104309  , 293.5341893424037  , 294.60630385487525 , 247.84541383219957 , 248.7478004535147  , 216.831298185941   , 217.6251814058957  , 258.4309580498866  , 259.3741609977324  , 307.3123072562358  , 308.4297165532881  , 366.38802154195014 , 367.7144784580499  , 370.04635487528344 , 371.3728117913832  , 313.0611167800454  , 314.17852607709744 , 265.2250056689342  , 266.16820861678    , 223.92398526077093 , 224.71786848072563 , 192.1432029478458  , 192.82858276643992 , 228.98776077097503 , 229.80205215419502 , 272.27387188208615 , 273.23856009070295 , 324.5781575963719  , 325.7233219954649  , 327.7364909297052  , 328.8816553287982  , 277.23696712018136 , 278.20165532879815 , 234.85323696145122 , 235.6675283446712  , 198.26650226757366 , 198.9518820861678  , 165.71905328798186 , 166.2959297052154  , 197.48197845804987 , 198.16735827664397 , 234.7918990929705  , 235.60386621315192 , 279.86761337868484 , 280.831485260771   , 282.52594671201814 , 283.4898185941043  , 238.96928004535147 , 239.78124716553285 , 202.41888321995464 , 203.10426303854874 , 170.8729648526077  , 171.44984126984127 , 198.32794217687072 , 198.90481859410434 , 236.2242006802721  , 236.90958049886626 , 280.6896768707484  , 281.5016439909298  , 334.3520578231294  , 335.31592970521547 , 337.01039115646273 , 337.9742630385488  , 284.8670578231293  , 285.67902494331065 , 241.16110544217688 , 241.84648526077098 , 203.48185374149656 , 204.05873015873016 , 240.37658163265303 , 241.06196145124719 , 286.2932482993197  , 287.1075396825397  , 340.16348639455794 , 341.12817460317467 , 405.16872448979615 , 406.3138888888889  , 408.32705782312945 , 409.4722222222223  , 345.12658163265314 , 346.0912698412698  , 292.158724489796   , 292.97301587301587 , 246.49988095238092 , 247.18526077097502 , 284.16127551020406 , 284.95515873015876 , 338.42488095238093 , 339.36808390022674 , 402.08083333333343 , 403.1982426303855  , 478.88607142857165 , 480.21252834467117 , 482.54440476190496 , 483.87086167800453 , 407.8296428571429  , 408.9470521541949  , 345.2189285714286  , 346.1621315192743  , 291.253962585034   , 292.0478458049886  , 329.68202380952386 , 330.58441043083906 , 392.61909863945584 , 393.69121315192746 , 466.441717687075   , 467.7118480725624  , 555.504098639456   , 557.0118480725623  , 559.6624319727892  , 561.1701814058956  , 472.9762414965988  , 474.2463718820861  , 400.34171768707495 , 401.41383219954645 , 337.74409863945584 , 338.64648526077093 , 323.38222222222225 , 324.2213151927438  , 385.0692970521543  , 386.06621315192746 , 457.4058049886622  , 458.5868480725623  , 544.6515192743766  , 546.0535147392291  , 548.5181859410433  , 549.9201814058956  , 463.4819954648527  , 464.6630385487528  , 392.25024943310666 , 393.2471655328798  , 330.878820861678   , 331.71791383219954 , 340.3955555555556  , 341.2346485260771  , 405.2826303854876  , 406.2795464852607  , 481.35247165532894 , 482.53351473922896 , 573.0781859410432  , 574.4801814058958  , 576.9448526077098  , 578.3468480725625  , 487.42866213151933 , 488.60970521541947 , 412.46358276643986 , 413.46049886621313 , 347.89215419501136 , 348.73124716553286 , 384.1651984126985  , 385.06758503401346 , 457.3498922902495  , 458.42200680272094 , 543.128066893424   , 544.3981972789114  , 646.5371145124717  , 648.0448639455782  , 650.6954478458049  , 652.2031972789116  , 549.6625907029479  , 550.9327210884353  , 465.07251133786855 , 466.14462585034005 , 392.22727324263036 , 393.12965986394556 , 343.8526133786848  , 344.6464965986394  , 409.3434297052155  , 410.28663265306113 , 486.09779478458057 , 487.2152040816325  , 578.6211281179138  , 579.9475850340135  , 582.2794614512472  , 583.6059183673468  , 491.84660430839006 , 492.96401360544206 , 416.13747732426305 , 417.0806802721088  , 350.9453004535148  , 351.73918367346937 , 301.8039739229025  , 302.48935374149653 , 359.27438208616786 , 360.0886734693877  , 426.62398526077106 , 427.5886734693877  , 507.80446145124733 , 508.94962585034    , 510.96279478458064 , 512.1079591836733  , 431.5870804988662  , 432.5517687074829  , 365.139858276644   , 365.95414965986396 , 307.9272732426304  , 308.6126530612244  , 258.0192800453514  , 258.59615646258504 , 307.14274943310653 , 307.8281292517007  , 364.7066383219955  , 365.5186054421768  , 434.0871145124717  , 435.05098639455775 , 436.7454478458051  , 437.70931972789106 , 368.88401927437644 , 369.69598639455774 , 312.07965419501136 , 312.7650340136054  , 263.1731916099773  , 263.7500680272109  };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.04081632653061224 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.08163265306122448 , 0.12244897959183673 , 0.061224489795918366, 0.08163265306122448 , 0.12244897959183672 , 0.16326530612244897 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.32653061224489793 , 0.40816326530612246 , 0.20408163265306123 , 0.24489795918367346 , 0.3061224489795918  , 0.36734693877551017 , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.7346938775510203  , 0.8571428571428572  , 0.42857142857142855 , 0.4897959183673469  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5714285714285714  , 0.6530612244897959  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 1.3061224489795917  , 1.4693877551020407  , 0.7346938775510203  , 0.8163265306122449  , 0.5510204081632653  , 0.6122448979591837  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 1.2244897959183672  , 1.3469387755102038  , 0.6734693877551019  , 0.7346938775510203  , 0.44897959183673464 , 0.4897959183673469  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.9795918367346936  , 1.0612244897959182  , 0.5306122448979591  , 0.5714285714285714  , 0.26530612244897955 , 0.2857142857142857  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.5714285714285714  , 0.6122448979591837  , 0.3061224489795918  , 0.32653061224489793 , 0.3469387755102041  , 0.36734693877551017 , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.7346938775510203  , 0.7755102040816326  , 0.3877551020408163  , 0.4081632653061224  , 0.7755102040816326  , 0.8163265306122448  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 1.6326530612244898  , 1.7142857142857144  , 0.8571428571428571  , 0.8979591836734693  , 1.2857142857142856  , 1.3469387755102038  , 2.693877551020408   , 2.816326530612245   , 2.693877551020408   , 2.816326530612245   , 2.693877551020408   , 2.816326530612245   , 2.693877551020408   , 2.816326530612245   , 2.693877551020408   , 2.816326530612245   , 2.693877551020408   , 2.816326530612245   , 1.4081632653061225  , 1.4693877551020407  , 1.8775510204081631  , 1.9591836734693873  , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 2.0408163265306123  , 2.1224489795918364  , 1.8775510204081631  , 1.9591836734693873  , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 3.9183673469387754  , 4.081632653061225   , 2.0408163265306123  , 2.1224489795918364  , 1.530612244897959   , 1.5918367346938773  , 3.183673469387755   , 3.306122448979591   , 3.183673469387755   , 3.306122448979591   , 3.183673469387755   , 3.306122448979591   , 3.183673469387755   , 3.306122448979591   , 3.183673469387755   , 3.306122448979591   , 3.183673469387755   , 3.306122448979591   , 1.6530612244897958  , 1.714285714285714   , 1.1020408163265305  , 1.1428571428571428  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 2.2857142857142856  , 2.3673469387755097  , 1.183673469387755   , 1.2244897959183674  , 0.5918367346938775  , 0.6122448979591836  , 1.2244897959183674  , 1.2653061224489794  , 1.2244897959183674  , 1.2653061224489794  , 1.2244897959183674  , 1.2653061224489794  , 1.2244897959183674  , 1.2653061224489794  , 1.2244897959183674  , 1.2653061224489794  , 1.2244897959183674  , 1.2653061224489794  , 0.6326530612244897  , 0.6530612244897959  , 0.673469387755102   , 0.6938775510204082  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 1.387755102040816   , 1.4285714285714284  , 0.7142857142857142  , 0.7346938775510203  , 1.4285714285714284  , 1.4693877551020407  , 2.938775510204081   , 3.020408163265306   , 2.938775510204081   , 3.020408163265306   , 2.938775510204081   , 3.020408163265306   , 2.938775510204081   , 3.020408163265306   , 2.938775510204081   , 3.020408163265306   , 2.938775510204081   , 3.020408163265306   , 1.510204081632653   , 1.5510204081632653  , 2.265306122448979   , 2.326530612244898   , 4.653061224489795   , 4.775510204081632   , 4.653061224489795   , 4.775510204081632   , 4.653061224489795   , 4.775510204081632   , 4.653061224489795   , 4.775510204081632   , 4.653061224489795   , 4.775510204081632   , 4.653061224489795   , 4.775510204081632   , 2.387755102040816   , 2.4489795918367347  , 3.1836734693877546  , 3.2653061224489797  , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 3.346938775510204   , 3.428571428571429   , 3.1836734693877546  , 3.2653061224489797  , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 6.5306122448979576  , 6.693877551020408   , 3.346938775510204   , 3.428571428571429   , 2.510204081632653   , 2.571428571428571   , 5.142857142857142   , 5.26530612244898    , 5.142857142857142   , 5.26530612244898    , 5.142857142857142   , 5.26530612244898    , 5.142857142857142   , 5.26530612244898    , 5.142857142857142   , 5.26530612244898    , 5.142857142857142   , 5.26530612244898    , 2.63265306122449    , 2.6938775510204076  , 1.7551020408163263  , 1.7959183673469385  , 3.5918367346938775  , 3.6734693877551017  , 3.5918367346938775  , 3.6734693877551017  , 3.5918367346938775  , 3.6734693877551017  , 3.5918367346938775  , 3.6734693877551017  , 3.5918367346938775  , 3.6734693877551017  , 3.5918367346938775  , 3.6734693877551017  , 1.8367346938775508  , 1.8775510204081631  , 0.9183673469387754  , 0.9387755102040816  , 1.8775510204081631  , 1.9183673469387754  , 1.8775510204081631  , 1.9183673469387754  , 1.8775510204081631  , 1.9183673469387754  , 1.8775510204081631  , 1.9183673469387754  , 1.8775510204081631  , 1.9183673469387754  , 1.8775510204081631  , 1.9183673469387754  , 0.9591836734693877  , 0.9795918367346939  };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 26.878100907029477,  27.45497732426304 ,  28.031853741496597,  28.60873015873016 ,  33.119937641723354,  33.80531746031746 ,  34.49069727891156 ,  35.176077097505676,  40.90842970521542 ,  41.720396825396826,  42.532363945578226,  43.34433106575963 ,  50.862239229024944,  51.82611111111112 ,  52.78998299319728 ,  53.75385487528344 ,  56.178905895691614,  57.14277777777777 ,  58.10664965986395 ,  59.070521541950114,  49.263191609977326,  50.07515873015873 ,  50.88712585034013 ,  51.699092970521534,  42.993747165532874,  43.67912698412699 ,  44.36450680272108 ,  45.04988662131519 ,  37.18592403628118 ,  37.76280045351474 ,  38.33967687074829 ,  38.916553287981856,  41.42469954648526 ,  42.110079365079365,  42.795459183673465,  43.48083900226758 ,  50.62571995464852 ,  51.440011337868484,  52.25430272108843 ,  53.0685941043084  ,  61.961831065759625,  62.92651927437642 ,  63.89120748299319 ,  64.85589569160997 ,  76.28706916099772 ,  77.43223356009071 ,  78.57739795918367 ,  79.72256235827663 ,  82.6037358276644  ,  83.74890022675737 ,  84.89406462585035 ,  86.0392290249433  ,  71.88802154195011 ,  72.85270975056689 ,  73.81739795918367 ,  74.78208616780044 ,  62.356672335600905,  63.17096371882086 ,  63.98525510204081 ,  64.79954648526076 ,  53.67129818594104 ,  54.35667800453514 ,  55.04205782312925 ,  55.727437641723355,  59.44340702947846 ,  60.2372902494331  ,  61.031173469387745,  61.825056689342404,  72.2566723356009  ,  73.19987528344672 ,  74.1430782312925  ,  75.08628117913833 ,  87.9023072562358  ,  89.01971655328799 ,  90.13712585034013 ,  91.25453514739229 , 107.51325963718818 , 108.839716553288   , 110.16617346938774 , 111.4926303854875  , 114.82992630385486 , 116.15638321995466 , 117.48284013605442 , 118.80929705215416 ,  99.39992630385487 , 100.51733560090703 , 101.63474489795917 , 102.75215419501131 ,  85.84476757369615 ,  86.78797052154195 ,  87.73117346938774 ,  88.67437641723355 ,  73.62878117913833 ,  74.42266439909297 ,  75.21654761904762 ,  76.01043083900227 ,  80.93422335600908 ,  81.83660997732426 ,  82.73899659863945 ,  83.64138321995465 ,  98.01279478458049 ,  99.08490929705216 , 100.15702380952379 , 101.22913832199546 , 118.72985827664397 , 119.99998866213153 , 121.27011904761903 , 122.54024943310657 , 144.54081065759635 , 146.04856009070298 , 147.5563095238095  , 149.06405895691606 , 152.85747732426302 , 154.3652267573696  , 155.8729761904762  , 157.38072562358272 , 131.7989058956916  , 133.06903628117914 , 134.33916666666664 , 135.60929705215418 , 113.45803287981859 , 114.53014739229026 , 115.60226190476189 , 116.67437641723355 ,  97.05837301587302 ,  97.96075963718822 ,  98.86314625850339 ,  99.7655328798186  , 108.90585034013606 , 109.7449433106576  , 110.58403628117911 , 111.42312925170067 , 131.11537414965986 , 132.11229024943313 , 133.10920634920632 , 134.1061224489796  , 157.7629931972789  , 158.94403628117917 , 160.1250793650793  , 161.30612244897955 , 190.6239455782313  , 192.02594104308392 , 193.4279365079365  , 194.82993197278907 , 198.3572789115646  , 199.75927437641724 , 201.16126984126984 , 202.5632653061224  , 169.91537414965984 , 171.0964172335601  , 172.2774603174603  , 173.4585034013605  , 145.4772789115646  , 146.47419501133788 , 147.4711111111111  , 148.46802721088434 , 123.89904761904764 , 124.73814058956916 , 125.57723356009069 , 126.41632653061225 , 142.93251700680273 , 143.7716099773243  , 144.61070294784577 , 145.44979591836733 , 171.54204081632656 , 172.53895691609978 , 173.535873015873   , 174.53278911564624 , 205.65632653061223 , 206.83736961451245 , 208.0184126984127  , 209.1994557823129  , 247.4772789115646  , 248.87927437641721 , 250.28126984126982 , 251.6832653061224  , 255.21061224489796 , 256.61260770975053 , 258.01460317460317 , 259.4165986394557  , 217.8087074829932  , 218.9897505668935  , 220.17079365079363 , 221.35183673469388 , 185.9039455782313  , 186.90086167800453 , 187.89777777777778 , 188.89469387755102 , 157.9257142857143  , 158.7648072562358  , 159.60390022675736 , 160.44299319727892 , 189.9005725623583  , 190.80295918367347 , 191.70534580498867 , 192.60773242630387 , 227.47438208616782 , 228.54649659863944 , 229.61861111111114 , 230.69072562358278 , 272.1025566893424  , 273.37268707482997 , 274.6428174603175  , 275.912947845805   , 326.60684240362815 , 328.11459183673475 , 329.6223412698412  , 331.1300907029478  , 334.9235090702948  , 336.4312585034014  , 337.93900793650795 , 339.4467573696145  , 285.17160430839    , 286.44173469387755 , 287.7118650793651  , 288.9819954648526  , 242.91962018140592 , 243.99173469387748 , 245.06384920634923 , 246.13596371882085 , 206.02472222222224 , 206.92710884353738 , 207.8294954648526  , 208.73188208616781 , 178.8260827664399  , 179.61996598639453 , 180.41384920634923 , 181.20773242630386 , 214.09376984126985 , 215.03697278911562 , 215.98017573696146 , 216.92337868480726 , 255.93623015873018 , 257.05363945578233 , 258.1710487528345  , 259.28845804988663 , 306.98337301587304 , 308.30982993197284 , 309.63628684807253 , 310.96274376417233 , 314.3000396825397  , 315.6264965986395  , 316.95295351473925 , 318.27941043083905 , 267.43384920634924 , 268.5512585034013  , 269.66866780045353 , 270.7860770975057  , 227.68186507936508 , 228.62506802721083 , 229.56827097505672 , 230.5114739229025  , 193.01145691609977 , 193.80534013605435 , 194.5992233560091  , 195.3931065759637  , 164.2794841269841  , 164.96486394557823 , 165.6502437641724  , 166.33562358276646 , 196.58798752834466 , 197.4022789115646  , 198.21657029478462 , 199.03086167800453 , 234.88282879818595 , 235.8475170068027  , 236.81220521541954 , 237.77689342403627 , 281.5585430839002  , 282.70370748299314 , 283.8488718820862  , 284.99403628117915 , 287.8752097505669  , 289.0203741496598  , 290.1655385487529  , 291.3107029478458  , 244.80901927437642 , 245.77370748299313 , 246.73839569161004 , 247.70308390022677 , 208.31893990929706 , 209.13323129251694 , 209.947522675737   , 210.76181405895693 , 176.5260827664399  , 177.21146258503398 , 177.89684240362814 , 178.58222222222224 , 146.26077664399094 , 146.83765306122447 , 147.41452947845806 , 147.9914058956916  , 174.95703514739228 , 175.64241496598635 , 176.32779478458053 , 177.0131746031746  , 208.94235260770972 , 209.7543197278911  , 210.56628684807262 , 211.378253968254   , 250.33235260770974 , 251.29622448979586 , 252.26009637188213 , 253.22396825396825 , 255.64901927437643 , 256.6128911564625  , 257.57676303854885 , 258.54063492063494 , 217.29711451247164 , 218.109081632653   , 218.9210487528345  , 219.7330158730159  , 184.83084467120182 , 185.51622448979586 , 186.20160430839002 , 186.88698412698415 , 156.5685997732426  , 157.1454761904762  , 157.72235260770972 , 158.29922902494332 , 211.4785544217687  , 212.05543083900227 , 212.6323072562358  , 213.2091836734694  , 252.44147959183672 , 253.12685941043085 , 253.81223922902493 , 254.497619047619   , 300.7379081632653  , 301.54987528344674 , 302.3618424036281  , 303.17380952380955 , 359.3012414965986  , 360.26511337868493 , 361.22898526077097 , 362.1928571428571  , 364.6179081632653  , 365.58178004535154 , 366.54565192743775 , 367.50952380952384 , 309.09267006802725 , 309.90463718820865 , 310.71660430839    , 311.5285714285715  , 262.3152891156463  , 263.00066893424037 , 263.6860487528344  , 264.37142857142857 , 221.7863775510204  , 222.36325396825396 , 222.9401303854875  , 223.51700680272108 , 260.74624149659866 , 261.43162131519273 , 262.1170011337868  , 262.802380952381   , 311.198962585034   , 312.01325396825405 , 312.82754535147393 , 313.6418367346938  , 370.66205782312926 , 371.6267460317461  , 372.5914342403628  , 373.55612244897964 , 442.73967687074827 , 443.88484126984144 , 445.0300056689342  , 446.1751700680272  , 449.05634353741505 , 450.20150793650805 , 451.346672335601   , 452.49183673469395 , 380.58824829931984 , 381.5529365079366  , 382.51762471655326 , 383.4823129251702  , 322.9299149659865  , 323.74420634920637 , 324.5584977324262  , 325.3727891156463  , 272.9928401360544  , 273.6782199546485  , 274.3635997732426  , 275.04897959183677 , 313.486037414966   , 314.27992063492064 , 315.0738038548752  , 315.8676870748299  , 374.0816156462585  , 375.02481859410443 , 375.9680215419501  , 376.9112244897958  , 445.4732823129252  , 446.59069160997745 , 447.70810090702946 , 448.82551020408164 , 531.9794727891157  , 533.3059297052157  , 534.6323866213152  , 535.958843537415   , 539.2961394557824  , 540.6225963718822  , 541.949053287982   , 543.2755102040817  , 456.9709013605444  , 458.0883106575965  , 459.2057199546485  , 460.32312925170083 , 387.6697108843539  , 388.6129138321996  , 389.5561167800452  , 390.4993197278912  , 327.6714115646259  , 328.4652947845805  , 329.2591780045351  , 330.05306122448985 , 314.14420068027215 , 315.0465873015873  , 315.9489739229024  , 316.8513605442177  , 375.08671768707484 , 376.15883219954657 , 377.2309467120181  , 378.30306122448974 , 446.97838435374155 , 448.2485147392291  , 449.5186451247165  , 450.7887755102041  , 534.1988605442177  , 535.7066099773245  , 537.214359410431   , 538.7221088435374  , 542.5155272108844  , 544.023276643991   , 545.5310260770979  , 547.0387755102041  , 460.0474319727893  , 461.3175623582767  , 462.5876927437641  , 463.85782312925187 , 390.53195578231305 , 391.60407029478455 , 392.67618480725605 , 393.74829931972795 , 330.26835034013607 , 331.1707369614512  , 332.07312358276636 , 332.97551020408173 , 257.0491609977324  , 257.8882539682539  , 258.72734693877544 , 259.5664399092971  , 307.12263038548764 , 308.1195464852607  , 309.11646258503396 , 310.1133786848073  , 366.2781859410432  , 367.4592290249433  , 368.6402721088435  , 369.8213151927437  , 438.14866213151936 , 439.55065759637193 , 440.95265306122434 , 442.35464852607714 , 445.8819954648528  , 447.2839909297052  , 448.6859863945577  , 450.0879818594105  , 378.43056689342416 , 379.6116099773242  , 380.7926530612243  , 381.9736961451248  , 321.4845351473923  , 322.4814512471654  , 323.4783673469387  , 324.47528344671207 , 272.04235827664394 , 272.88145124716544 , 273.72054421768706 , 274.5596371882086  , 213.30058956916093 , 214.13968253968258 , 214.97877551020412 , 215.81786848072565 , 255.1454875283446  , 256.1424036281179  , 257.1393197278912  , 258.13623582766445 , 304.70104308390023 , 305.8820861678004  , 307.0631292517006  , 308.2441723356009  , 365.0515192743764  , 366.45351473922904 , 367.8555102040815  , 369.2575056689343  , 372.78485260770975 , 374.1868480725623  , 375.58884353741485 , 376.99083900226765 , 316.85342403628107 , 318.0344671201814  , 319.2155102040815  , 320.39655328798193 , 269.5073922902493  , 270.5043083900228  , 271.50122448979585 , 272.4981405895691  , 228.29378684807253 , 229.13287981859415 , 229.97197278911563 , 230.8110657596372  , 183.30356575963717 , 184.2059523809524  , 185.1083390022676  , 186.01072562358274 , 219.63655895691605 , 220.70867346938778 , 221.78078798185945 , 222.8529024943311  , 262.8171145124716  , 264.08724489795924 , 265.35737528344663 , 266.62750566893425 , 315.5842573696144  , 317.09200680272124 , 318.59975623582744 , 320.1075056689342  , 323.90092403628114 , 325.40867346938785 , 326.91642290249405 , 328.42417233560093 , 275.88616213151926 , 277.1562925170068  , 278.42642290249427 , 279.6965532879819  , 235.0817970521542  , 236.15391156462587 , 237.22602607709752 , 238.29814058956913 , 199.42771541950114 , 200.33010204081637 , 201.23248866213152 , 202.1348752834467  , 137.50798752834467 , 138.3018707482993  , 139.09575396825397 , 139.8896371882086  , 165.004246031746   , 165.94744897959188 , 166.89065192743766 , 167.83385487528344 , 197.78003968253967 , 198.89744897959187 , 200.01485827664402 , 201.13226757369614 , 237.94718253968253 , 239.27363945578233 , 240.6000963718821  , 241.92655328798185 , 245.2638492063492  , 246.59030612244902 , 247.9167630385488  , 249.24321995464848 , 209.27765873015872 , 210.3950680272109  , 211.51247732426307 , 212.62988662131517 , 178.59234126984128 , 179.5355442176871  , 180.47874716553292 , 181.42195011337867 , 151.69336167800458 , 152.48724489795916 , 153.28112811791385 , 154.0750113378685  ,  88.24030045351473 ,  88.92568027210883 ,  89.61106009070294 ,  90.29643990929706 , 106.24676303854876 , 107.0610544217687  , 107.87534580498863 , 108.68963718820864 , 127.85589002267575 , 128.82057823129253 , 129.78526643990926 , 130.7499546485261  , 154.5087471655329  , 155.65391156462584 , 156.79907596371882 , 157.9442403628118  , 160.8254138321996  , 161.9705782312925  , 163.1157426303855  , 164.26090702947846 , 137.78208049886624 , 138.746768707483   , 139.71145691609973 , 140.67614512471658 , 117.97771541950117 , 118.79200680272108 , 119.60629818594104 , 120.42058956916101 , 100.48689909297053 , 101.1722789115646  , 101.85765873015873 , 102.54303854875285 ,  35.50050453514739 ,  36.077380952380956,  36.65425736961451 ,  37.231133786848076,  43.36410997732426 ,  44.04948979591837 ,  44.73486961451247 ,  45.42024943310658 ,  53.04466553287982 ,  53.85663265306122 ,  54.668599773242626,  55.480566893424026,  65.26895124716553 ,  66.2328231292517  ,  67.19669501133787 ,  68.16056689342405 ,  70.5856179138322  ,  71.54948979591836 ,  72.51336167800453 ,  73.47723356009071 ,  61.39942743764172 ,  62.21139455782313 ,  63.023361678004534,  63.83532879818594 ,  53.23791950113379 ,  53.92329931972789 ,  54.608679138321996,  55.2940589569161  ,  45.80832766439909 ,  46.38520408163265 ,  46.962080498866214,  47.53895691609978 , 100.71828231292517 , 101.29515873015872 , 101.8720351473923  , 102.44891156462585 , 120.8485544217687  , 121.5339342403628  , 122.2193140589569  , 122.90469387755103 , 144.84022108843538 , 145.65218820861676 , 146.46415532879817 , 147.27612244897958 , 174.2378401360544  , 175.20171201814065 , 176.16558390022678 , 177.12945578231293 , 179.5545068027211  , 180.5183786848073  , 181.48225056689344 , 182.4461224489796  , 153.1949829931973  , 154.00695011337868 , 154.81891723356011 , 155.6308843537415  , 130.72236394557822 , 131.40774376417232 , 132.09312358276645 , 132.77850340136052 , 111.02610544217686 , 111.60298185941042 , 112.17985827664398 , 112.75673469387753 , 129.15331632653061 , 129.8386961451247  , 130.52407596371884 , 131.20945578231292 , 154.8550170068027  , 155.66930839002268 , 156.48359977324262 , 157.29789115646258 , 185.4419217687075  , 186.40660997732428 , 187.37129818594101 , 188.33598639455778 , 222.86811224489793 , 224.01327664399102 , 225.1584410430839  , 226.30360544217683 , 229.18477891156465 , 230.32994331065765 , 231.47510770975057 , 232.6202721088435  , 195.368112244898   , 196.33280045351475 , 197.29748866213154 , 198.26217687074825 , 166.5859693877551  , 167.40026077097505 , 168.21455215419502 , 169.0288435374149  , 141.39991496598637 , 142.0852947845805  , 142.7706746031746  , 143.45605442176867 , 161.0604591836735  , 161.8543424036281  , 162.64822562358276 , 163.4421088435374  , 192.98664965986396 , 193.92985260770976 , 194.8730555555555  , 195.81625850340134 , 230.9306972789116  , 232.04810657596374 , 233.1655158730158  , 234.28292517006795 , 277.2997448979591  , 278.62620181405913 , 279.95265873015876 , 281.27911564625845 , 284.6164115646258  , 285.9428684807257  , 287.2693253968254  , 288.59578231292517 , 242.42831632653068 , 243.54572562358277 , 244.66313492063492 , 245.780544217687   , 206.57474489795922 , 207.51794784580497 , 208.46115079365077 , 209.40435374149652 , 175.24583333333334 , 176.03971655328797 , 176.8335997732426  , 177.62748299319722 , 196.43971088435376 , 197.3420975056689  , 198.24448412698413 , 199.1468707482993  , 235.2434523809524  , 236.31556689342406 , 237.38768140589565 , 238.45979591836732 , 281.3065476190476  , 282.5766780045352  , 283.84680839002266 , 285.11693877551016 , 337.5327380952379  , 339.04048752834484 , 340.5482369614513  , 342.05598639455775 , 345.8494047619047  , 347.3571541950114  , 348.864903628118   , 350.37265306122447 , 294.37559523809523 , 295.64572562358285 , 296.9158560090703  , 298.18598639455774 , 250.68869047619052 , 251.76080498866213 , 252.83291950113374 , 253.90503401360542 , 212.5638605442177  , 213.46624716553288 , 214.36863378684802 , 215.27102040816322 , 216.30975056689346 , 217.14884353741496 , 217.9879365079365  , 218.82702947845806 , 258.72063492063495 , 259.71755102040817 , 260.7144671201814  , 261.71138321995466 , 308.93650793650795 , 310.11755102040814 , 311.2985941043083  , 312.4796371882085  , 370.07936507936506 , 371.48136054421775 , 372.8833560090702  , 374.28535147392284 , 377.8126984126984  , 379.21469387755116 , 380.6166893424035  , 382.01868480725614 , 321.0888888888889  , 322.26993197278915 , 323.45097505668923 , 324.63201814058954 , 273.08253968253973 , 274.07945578231295 , 275.0763718820861  , 276.07328798185944 , 231.302947845805   , 232.1420408163265  , 232.98113378684803 , 233.82022675736965 , 250.3364172335601  , 251.17551020408163 , 252.01460317460317 , 252.8536961451247  , 299.1473015873016  , 300.1442176870748  , 301.1411337868481  , 302.13804988662133 , 356.8298412698413  , 358.0108843537415  , 359.1919274376417  , 360.37297052154196 , 426.93269841269847 , 428.33469387755105 , 429.7366893424035  , 431.13868480725625 , 434.66603174603176 , 436.0680272108844  , 437.47002267573686 , 438.8720181405896  , 368.98222222222233 , 370.16326530612236 , 371.34430839002266 , 372.525351473923   , 313.50920634920635 , 314.50612244897957 , 315.5030385487528  , 316.4999546485261  , 265.3296145124716  , 266.16870748299317 , 267.00780045351473 , 267.8468934240363  , 305.4060600907029  , 306.3084467120181  , 307.2108333333333  , 308.1132199546485  , 364.7050396825396  , 365.7771541950113  , 366.849268707483   , 367.92138321995463 , 434.679246031746   , 435.94937641723357 , 437.2195068027211  , 438.48963718820863 , 519.5987698412698  , 521.1065192743764  , 522.614268707483   , 524.1220181405896  , 527.9154365079364  , 529.4231859410431  , 530.9309353741496  , 532.4386848072563  , 447.7482936507936  , 449.01842403628115 , 450.2885544217687  , 451.5586848072563  , 380.1502777777777  , 381.2223922902494  , 382.29450680272106 , 383.36662131519273 , 321.5302097505669  , 322.4325963718821  , 323.33498299319723 , 324.2373696145125  , 280.44313492063486 , 281.23701814058956 , 282.03090136054425 , 282.82478458049883 , 334.82374716553284 , 335.76695011337864 , 336.7101530612245  , 337.65335600907025 , 398.96462018140585 , 400.082029478458   , 401.1994387755102  , 402.3168480725624  , 476.769858276644   , 478.09631519274376 , 479.42277210884356 , 480.74922902494336 , 484.0865249433107  , 485.4129818594104  , 486.73943877551017 , 488.06589569160997 , 410.4622392290249  , 411.57964852607705 , 412.6970578231293  , 413.81446712018135 , 348.41184240362816 , 349.3550453514739  , 350.2982482993197  , 351.2414512471655  , 294.6285090702948  , 295.42239229024943 , 296.21627551020407 , 297.01015873015876 , 252.00810090702947 , 252.69348072562357 , 253.3788605442177  , 254.06424036281174 , 300.81728458049884 , 301.6315759637188  , 302.4458673469388  , 303.2601587301587  , 358.3629195011338  , 359.32760770975057 , 360.29229591836736 , 361.25698412698404 , 428.1395861678005  , 429.2847505668934  , 430.4299149659864  , 431.5750793650793  , 434.4562528344671  , 435.60141723356    , 436.7465816326531  , 437.891746031746   , 368.28910997732424 , 369.25379818594104 , 370.21848639455783 , 371.1831746031745  , 312.54823696145127 , 313.3625283446712  , 314.17681972789114 , 314.9911111111111  , 264.2546995464853  , 264.9400793650793  , 265.62545918367346 , 266.3108390022676  , 220.10095804988663 , 220.67783446712016 , 221.25471088435376 , 221.83158730158726 , 262.6856519274377  , 263.37103174603175 , 264.0564115646258  , 264.74179138321995 , 312.87414399092967 , 313.6861111111111  , 314.49807823129254 , 315.3100453514739  , 373.7079535147392  , 374.67182539682545 , 375.6356972789115  , 376.59956916099765 , 379.02462018140585 , 379.98849206349206 , 380.95236394557827 , 381.91623582766437 , 321.2289058956917  , 322.040873015873   , 322.8528401360544  , 323.6648072562358  , 272.5594614512472  , 273.2448412698413  , 273.93022108843536 , 274.6156009070295  , 230.40878117913834 , 230.98565759637185 , 231.56253401360541 , 232.139410430839   };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.1020408163265306  ,  0.12244897959183673 ,  0.14285714285714285 ,  0.16326530612244897 ,  0.2040816326530612  ,  0.24489795918367344 ,  0.2857142857142857  ,  0.32653061224489793 ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.36734693877551017 ,  0.40816326530612246 ,  0.44897959183673464 ,  0.4897959183673469  ,  0.5510204081632653  ,  0.6122448979591836  ,  0.673469387755102   ,  0.7346938775510203  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  0.7959183673469388  ,  0.8571428571428571  ,  0.9183673469387754  ,  0.9795918367346939  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.2244897959183674  ,  1.3061224489795917  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  1.3877551020408163  ,  1.4693877551020407  ,  1.5510204081632653  ,  1.6326530612244898  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.2244897959183674  ,  1.3061224489795917  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  1.3877551020408163  ,  1.4693877551020407  ,  1.5510204081632653  ,  1.6326530612244898  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.2244897959183674  ,  1.3061224489795917  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  1.3877551020408163  ,  1.4693877551020407  ,  1.5510204081632653  ,  1.6326530612244898  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.2244897959183674  ,  1.3061224489795917  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  1.3877551020408163  ,  1.4693877551020407  ,  1.5510204081632653  ,  1.6326530612244898  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183674  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.6938775510204076  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.6938775510204076  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.6938775510204076  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.6938775510204076  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.6938775510204076  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.6938775510204076  ,  1.2857142857142856  ,  1.3469387755102038  ,  1.4081632653061225  ,  1.4693877551020407  ,  0.8571428571428572  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.8775510204081631  ,  1.9591836734693873  ,  2.0408163265306123  ,  2.1224489795918364  ,  1.0204081632653061  ,  1.0612244897959182  ,  1.1020408163265305  ,  1.1428571428571428  ,  0.5102040816326531  ,  0.5306122448979591  ,  0.5510204081632653  ,  0.5714285714285714  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  1.1020408163265305  ,  1.1428571428571428  ,  1.183673469387755   ,  1.2244897959183674  ,  0.5918367346938775  ,  0.6122448979591836  ,  0.6326530612244897  ,  0.6530612244897959  ,  0.673469387755102   ,  0.6938775510204082  ,  0.7142857142857142  ,  0.7346938775510203  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  1.4285714285714284  ,  1.4693877551020407  ,  1.510204081632653   ,  1.5510204081632653  ,  0.7551020408163265  ,  0.7755102040816326  ,  0.7959183673469387  ,  0.8163265306122448  ,  1.510204081632653   ,  1.5510204081632653  ,  1.5918367346938775  ,  1.6326530612244896  ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  3.1836734693877546  ,  3.2653061224489797  ,  3.346938775510204   ,  3.428571428571429   ,  1.673469387755102   ,  1.7142857142857142  ,  1.7551020408163263  ,  1.7959183673469385  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  5.265306122448979   ,  5.387755102040816   ,  5.5102040816326525  ,  5.63265306122449    ,  5.265306122448979   ,  5.387755102040816   ,  5.5102040816326525  ,  5.63265306122449    ,  5.265306122448979   ,  5.387755102040816   ,  5.5102040816326525  ,  5.63265306122449    ,  5.265306122448979   ,  5.387755102040816   ,  5.5102040816326525  ,  5.63265306122449    ,  5.265306122448979   ,  5.387755102040816   ,  5.5102040816326525  ,  5.63265306122449    ,  5.265306122448979   ,  5.387755102040816   ,  5.5102040816326525  ,  5.63265306122449    ,  2.7551020408163263  ,  2.816326530612245   ,  2.8775510204081627  ,  2.9387755102040813  ,  3.6734693877551017  ,  3.7551020408163263  ,  3.836734693877551   ,  3.9183673469387745  ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  3.9999999999999996  ,  4.081632653061225   ,  4.163265306122448   ,  4.244897959183673   ,  3.6734693877551017  ,  3.7551020408163263  ,  3.836734693877551   ,  3.9183673469387745  ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  3.9999999999999996  ,  4.081632653061225   ,  4.163265306122448   ,  4.244897959183673   ,  3.6734693877551017  ,  3.7551020408163263  ,  3.836734693877551   ,  3.9183673469387745  ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  3.9999999999999996  ,  4.081632653061225   ,  4.163265306122448   ,  4.244897959183673   ,  3.6734693877551017  ,  3.7551020408163263  ,  3.836734693877551   ,  3.9183673469387745  ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  3.9999999999999996  ,  4.081632653061225   ,  4.163265306122448   ,  4.244897959183673   ,  3.                  ,  3.061224489795918   ,  3.1224489795918364  ,  3.1836734693877546  ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367346   ,  6.612244897959182   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367346   ,  6.612244897959182   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367346   ,  6.612244897959182   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367346   ,  6.612244897959182   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367346   ,  6.612244897959182   ,  6.244897959183673   ,  6.36734693877551    ,  6.489795918367346   ,  6.612244897959182   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  2.3265306122448974  ,  2.36734693877551    ,  2.408163265306122   ,  2.4489795918367347  ,  1.163265306122449   ,  1.183673469387755   ,  1.2040816326530612  ,  1.2244897959183672  ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  1.2448979591836733  ,  1.2653061224489794  ,  1.2857142857142856  ,  1.3061224489795917  ,  1.3265306122448979  ,  1.346938775510204   ,  1.3673469387755102  ,  1.3877551020408163  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  1.4081632653061222  ,  1.4285714285714284  ,  1.4489795918367345  ,  1.4693877551020407  ,  2.816326530612245   ,  2.8571428571428568  ,  2.8979591836734695  ,  2.9387755102040813  ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  2.9795918367346936  ,  3.020408163265306   ,  3.0612244897959178  ,  3.1020408163265305  ,  4.469387755102041   ,  4.530612244897958   ,  4.591836734693878   ,  4.653061224489796   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   ,  4.7142857142857135  ,  4.775510204081632   ,  4.83673469387755    ,  4.8979591836734695  ,  6.285714285714286   ,  6.367346938775509   ,  6.448979591836735   ,  6.530612244897959   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  6.612244897959183   ,  6.693877551020408   ,  6.775510204081631   ,  6.857142857142858   ,  6.285714285714286   ,  6.367346938775509   ,  6.448979591836735   ,  6.530612244897959   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  6.612244897959183   ,  6.693877551020408   ,  6.775510204081631   ,  6.857142857142858   ,  6.285714285714286   ,  6.367346938775509   ,  6.448979591836735   ,  6.530612244897959   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  6.612244897959183   ,  6.693877551020408   ,  6.775510204081631   ,  6.857142857142858   ,  6.285714285714286   ,  6.367346938775509   ,  6.448979591836735   ,  6.530612244897959   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  6.612244897959183   ,  6.693877551020408   ,  6.775510204081631   ,  6.857142857142858   ,  4.959183673469387   ,  5.020408163265306   ,  5.081632653061224   ,  5.142857142857142   , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    ,  5.204081632653061   ,  5.26530612244898    ,  5.326530612244897   ,  5.387755102040815   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  7.1020408163265305  ,  7.183673469387755   ,  7.265306122448979   ,  7.346938775510203   ,  3.63265306122449    ,  3.6734693877551017  ,  3.714285714285714   ,  3.7551020408163263  ,  1.8163265306122447  ,  1.8367346938775508  ,  1.857142857142857   ,  1.8775510204081631  ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  1.8979591836734693  ,  1.9183673469387754  ,  1.9387755102040816  ,  1.9591836734693877  };
  const std::array<int, 4> in_shape = {{ 3, 10, 8, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  7.882772108843537,   9.66202380952381 ,  11.549778911564626,  13.87874716553288 ,  14.47124716553288 ,  16.30922335600907 ,  14.486604308390024,  12.815856009070295,  11.036604308390022,  12.034812925170067,  14.65079931972789 ,  17.395697278911566,  20.748475056689344,  21.276689342403625,  23.63609410430839 ,  20.884903628117918,  18.39782879818594 ,  15.781842403628119,  17.163384353741495,  20.799778911564623,  24.58549319727891 ,  29.176366213151926,  29.57600907029478 ,  32.52112811791383 ,  28.627080498866217,  25.14000566893424 ,  21.50361111111111 ,  23.268486394557826,  28.108962585034014,  33.11916666666667 ,  39.16242063492063 ,  39.369206349206344,  42.964325396825394,  37.71313492063492 ,  33.04238662131519 ,  28.201910430839   ,  31.100034013605445,  37.38098639455782 ,  43.819761904761904,  51.515793650793654,  51.085079365079366,  55.051031746031754,  48.09150793650793 ,  41.968378684807256,  35.68742630385487 ,  40.670034013605445,  48.75098639455783 ,  56.989761904761906,  66.78579365079366 ,  65.72507936507937 ,  70.32103174603175 ,  61.26150793650793 ,  53.33837868480725 ,  45.25742630385487 ,  53.91527210884354 ,  64.52003401360544 ,  75.29452380952382 ,  88.0627777777778  ,  86.25206349206353 ,  91.86468253968256 ,  79.88849206349207 ,  69.45345804988662 ,  58.84869614512471 ,  50.739761904761906,  60.69146258503402 ,  70.79248299319728 ,  82.75121315192746 ,  80.94049886621316 ,  86.09597505668935 ,  74.83407029478458 ,  65.03168934240362 ,  55.07998866213151 ,  46.58772108843537 ,  55.70268707482993 ,  64.94656462585034 ,  75.88148526077099 ,  74.1350566893424  ,  78.76910430839003 ,  68.43577097505668 ,  59.44971655328798 ,  50.33475056689341 ,  41.45914965986395 ,  49.55370748299319 ,  57.75676870748299 ,  67.45359410430838 ,  65.83573696145123 ,  69.88407029478456 ,  60.69359410430838 ,  52.707539682539675,  44.61298185941043 ,  59.80164965986393 ,  71.34620748299321 ,  82.999268707483   ,  96.72109410430836 ,  93.89573696145123 ,  99.15157029478456 ,  85.93609410430838 ,  74.50003968253968 ,  62.95548185941042 ,  73.71899659863944 ,  87.93702380952382 , 102.28396258503402 , 119.17245464852606 , 115.63995464852606 , 122.0600736961451  , 105.77316893424035 ,  91.68405328798185 ,  77.4660260770975  ,  88.61287414965985 , 105.6880442176871  , 122.91253401360545 , 143.18197845804988 , 138.87804988662128 , 146.52674036281178 , 126.95412131519272 , 110.02827097505669 ,  92.95310090702947 , 104.48328231292516 , 124.59926870748302 , 144.88498299319727 , 168.7496655328798  , 163.61002267573693 , 172.55157029478457 , 149.47895124716553 , 129.53269274376416 , 109.41670634920632 , 106.61840136054423 , 127.10343537414967 , 147.7462925170068  , 172.0137528344671  , 166.6116099773243  , 175.54899092970524 , 152.01803854875283 , 131.69082766439908 , 111.20579365079364 , 116.18840136054422 , 138.47343537414966 , 160.91629251700684 , 187.28375283446715 , 181.25160997732428 , 190.81899092970522 , 165.18803854875281 , 143.06082766439908 , 120.77579365079362 , 135.1300680272109  , 161.01034013605445 , 187.06034013605446 , 217.65002267573695 , 210.49287981859408 , 221.4519274376417  , 191.65430839002266 , 165.94376417233556 , 140.06349206349205 , 122.18925170068029 , 145.57972789115647 , 169.11952380952383 , 196.75682539682543 , 190.24253968253967 , 200.1015873015873  , 173.1611111111111  , 149.91995464852604 , 126.5294784580499  , 108.27190476190476 , 128.98891156462585 , 149.83482993197282 , 174.3054648526077  , 168.49832199546483 , 177.19308390022672 , 153.3240362811791  , 132.7359410430839  , 112.01893424036281 ,  93.37802721088437 , 111.2378911564626  , 129.2062585034014  , 150.2959410430839  , 145.26022675736962 , 152.72641723356006 , 132.14308390022677 , 114.39172335600908 ,  96.53185941043084 , 111.72052721088436 , 133.0303911564626  , 154.44875850340136 , 179.5634410430839  , 173.32022675736962 , 181.9939172335601  , 157.38558390022678 , 136.18422335600906 , 114.87435941043084 , 135.40318027210884 , 161.22324829931975 , 187.17222789115647 , 217.5964342403628  , 210.00321995464853 , 220.48405328798185 , 190.6614342403628  , 164.97027777777774 , 139.1502097505669  , 160.06236394557823 , 190.57630952380956 , 221.239574829932   , 257.1875907029479  , 248.18009070294784 , 260.5323526077097  , 225.28116213151927 , 194.9165362811791  , 164.40259070294783 , 185.6980782312925  , 221.089574829932   , 256.6507993197279  , 298.33691043083905 , 287.8508390022676  , 302.1388151927437  , 261.24476757369615 , 226.0229988662131  , 190.63150226757367 , 182.13676870748296 , 216.82588435374146 , 251.67282312925164 , 292.5117120181406  , 282.13814058956916 , 296.04695011337867 , 255.9445691609977  , 221.41327664399086 , 186.72416099773238 , 191.70676870748298 , 228.19588435374146 , 264.84282312925166 , 307.7817120181405  , 296.7781405895691  , 311.31695011337865 , 269.1145691609977  , 232.78327664399092 , 196.29416099773243 , 216.34486394557825 , 257.5006462585035  , 298.826156462585   , 347.2372675736961  , 334.73369614512467 , 351.03917233560094 , 303.4201247165533  , 262.43407029478453 , 221.2782879818594  , 193.63874149659867 , 230.46799319727893 , 267.4465646258503  , 310.76243764172335 , 299.54458049886625 , 314.10719954648533 , 271.4881519274377  , 234.8082199546485  , 197.97896825396825 , 169.95608843537414 , 202.27513605442178 , 234.72309523809525 , 272.7294444444445  , 262.8615873015873  , 275.6170634920635  , 238.21230158730157 , 206.0221655328798  , 173.70311791383216 , 145.29690476190478 , 172.92207482993197 , 200.65574829931973 , 233.1382879818594  , 224.68471655328796 , 235.5687641723356  , 203.5925736961451  , 176.07590702947843 , 148.45073696145127 };
  const std::array<int, 4> in_shape = {{ 3, 10, 9, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.02040816326530612 , 0.061224489795918366, 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.12244897959183673 , 0.10204081632653061 , 0.061224489795918366, 0.1020408163265306  , 0.24489795918367346 , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.4285714285714286  , 0.326530612244898   , 0.18367346938775508 , 0.24489795918367346 , 0.5510204081632653  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.9183673469387754  , 0.673469387755102   , 0.36734693877551017 , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.44897959183673464 , 0.9795918367346939  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.1428571428571428  , 0.6122448979591837  , 0.4285714285714285  , 0.9183673469387754  , 1.469387755102041   , 1.469387755102041   , 1.469387755102041   , 1.469387755102041   , 1.469387755102041   , 1.0408163265306123  , 0.5510204081632653  , 0.346938775510204   , 0.7346938775510203  , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 1.163265306122449   , 0.8163265306122449  , 0.42857142857142855 , 0.2040816326530612  , 0.4285714285714285  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.6734693877551019  , 0.4693877551020408  , 0.24489795918367346 , 0.26530612244897955 , 0.5510204081632653  , 0.857142857142857   , 0.857142857142857   , 0.857142857142857   , 0.857142857142857   , 0.857142857142857   , 0.5918367346938775  , 0.3061224489795918  , 0.5918367346938775  , 1.2244897959183672  , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.897959183673469   , 1.3061224489795917  , 0.6734693877551019  , 0.9795918367346939  , 2.020408163265306   , 3.1224489795918364  , 3.1224489795918364  , 3.1224489795918364  , 3.1224489795918364  , 3.1224489795918364  , 2.142857142857143   , 1.1020408163265305  , 1.4285714285714284  , 2.9387755102040813  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.1020408163265305  , 1.5918367346938775  , 1.4285714285714284  , 2.9387755102040813  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.1020408163265305  , 1.5918367346938775  , 1.4285714285714284  , 2.9387755102040813  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.1020408163265305  , 1.5918367346938775  , 1.4285714285714284  , 2.9387755102040813  , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 4.530612244897958   , 3.1020408163265305  , 1.5918367346938775  , 1.1632653061224487  , 2.387755102040816   , 3.673469387755102   , 3.673469387755102   , 3.673469387755102   , 3.673469387755102   , 3.673469387755102   , 2.510204081632653   , 1.2857142857142856  , 0.836734693877551   , 1.714285714285714   , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 2.63265306122449    , 1.7959183673469385  , 0.9183673469387754  , 0.44897959183673464 , 0.9183673469387754  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 1.4081632653061225  , 0.9591836734693877  , 0.4897959183673469  , 0.5102040816326531  , 1.0408163265306123  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.5918367346938775  , 1.0816326530612244  , 0.5510204081632653  , 1.0816326530612246  , 2.204081632653061   , 3.36734693877551    , 3.36734693877551    , 3.36734693877551    , 3.36734693877551    , 3.36734693877551    , 2.2857142857142856  , 1.1632653061224487  , 1.7142857142857144  , 3.4897959183673466  , 5.326530612244897   , 5.326530612244897   , 5.326530612244897   , 5.326530612244897   , 5.326530612244897   , 3.6122448979591835  , 1.8367346938775508  , 2.4081632653061225  , 4.8979591836734695  , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.061224489795918   , 2.571428571428571   , 2.4081632653061225  , 4.8979591836734695  , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.061224489795918   , 2.571428571428571   , 2.4081632653061225  , 4.8979591836734695  , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.061224489795918   , 2.571428571428571   , 2.4081632653061225  , 4.8979591836734695  , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 7.469387755102041   , 5.061224489795918   , 2.571428571428571   , 1.897959183673469   , 3.8571428571428568  , 5.877551020408164   , 5.877551020408164   , 5.877551020408164   , 5.877551020408164   , 5.877551020408164   , 3.979591836734693   , 2.020408163265306   , 1.3265306122448979  , 2.6938775510204076  , 4.1020408163265305  , 4.1020408163265305  , 4.1020408163265305  , 4.1020408163265305  , 4.1020408163265305  , 2.775510204081632   , 1.4081632653061225  , 0.6938775510204082  , 1.4081632653061225  , 2.142857142857143   , 2.142857142857143   , 2.142857142857143   , 2.142857142857143   , 2.142857142857143   , 1.4489795918367345  , 0.7346938775510203  };
  const std::array<int, 4> in_shape = {{ 3, 10, 9, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 15.188667800453512,  15.765544217687074,  18.63866780045351 ,  19.32404761904762 ,  22.3056746031746  ,  23.099557823129253,  26.837023809523814,  27.75749433106576 ,  28.060000000000002,  28.94249433106576 ,  31.697976190476187,  32.61844671201814 ,  28.179325396825394,  28.97320861678005 ,  24.946332199546482,  25.63171201814059 ,  21.496332199546483,  22.073208616780043,  23.384246031746027,  24.069625850340135,  28.487307256235823,  29.30159863945578 ,  33.84819160997732 ,  34.79139455782313 ,  40.403350340136065,  41.49695011337869 ,  41.50489795918368 ,  42.55337868480725 ,  46.17858843537415 ,  47.27218820861678 ,  40.826604308390024,  41.769807256235836,  35.98136621315193 ,  36.79565759637188 ,  30.878304988662126,  31.563684807256237,  33.53288548752834 ,  34.32676870748299 ,  40.65635487528344 ,  41.599557823129246,  48.078463718820856,  49.17098639455782 ,  57.08600340136055 ,  58.35273242630385 ,  57.937551020408165,  59.15201814058956 ,  63.77552721088435 ,  65.04225623582767 ,  56.16163832199546 ,  57.254160997732434,  49.336808390022675,  50.28001133786848 ,  42.21333900226756 ,  43.00722222222222 ,  45.63458616780045 ,  46.53697278911565 ,  55.145810657596364,  56.21792517006803 ,  64.9964909297052  ,  66.23833333333334 ,  76.8849829931973  ,  78.32484126984126 ,  77.35795918367347 ,  78.73841269841269 ,  84.4887925170068  ,  85.92865079365079 ,  74.18442743764172 ,  75.42626984126984 ,  65.01265873015872 ,  66.08477324263038 ,  55.5014342403628  ,  56.403820861678   ,  61.36097505668933 ,  62.20006802721089 ,  73.76505668934239 ,  74.76197278911565 ,  86.48478458049885 ,  87.63952380952381 , 101.69272108843538 , 103.03158730158731 , 100.8865306122449  , 102.17015873015873 , 108.76319727891155 , 110.10206349206351 ,  95.02827664399092 ,  96.18301587301586 ,  82.93984126984125 ,  83.93675736961451 ,  70.53575963718819 ,  71.37485260770974 ,  80.50097505668933 ,  81.34006802721089 ,  96.50505668934238 ,  97.50197278911565 , 112.82478458049884 , 113.97952380952381 , 132.23272108843534 , 133.57158730158733 , 130.16653061224488 , 131.45015873015873 , 139.30319727891157 , 140.6420634920635  , 121.36827664399091 , 122.52301587301586 , 105.67984126984125 , 106.6767573696145  ,  89.6757596371882  ,  90.51485260770974 , 106.92815759637188 , 107.83054421768708 , 127.96795351473921 , 129.04006802721088 , 149.34720521541948 , 150.58904761904765 , 174.68569727891153 , 176.1255555555556  , 171.12367346938774 , 172.50412698412705 , 182.28950680272106 , 183.72936507936512 , 158.535141723356   , 159.77698412698413 , 137.83480158730157 , 138.90691609977324 , 116.79500566893424 , 117.69739229024943 , 100.68564058956916 , 101.47952380952381 , 120.43972222222222 , 121.38292517006803 , 140.49244331065756 , 141.58496598639456 , 164.23569727891152 , 165.50242630385492 , 160.66653061224486 , 161.88099773242632 , 170.92522108843534 , 172.1919501133787  , 148.5756179138322  , 149.66814058956916 , 129.12017573696147 , 130.06337868480725 , 109.3660941043084  , 110.15997732426302 ,  92.49006235827665 ,  93.17544217687075 , 110.5910827664399  , 111.40537414965986 , 128.94992630385485 , 129.89312925170069 , 150.6693707482993  , 151.76297052154197 , 147.2216326530612  , 148.2701133786848  , 156.4446088435374  , 157.53820861678005 , 135.9283390022676  , 136.87154195011337 , 118.08514172335602 , 118.89943310657596 ,  99.98412131519275 , 100.66950113378682 ,  82.34142290249434 ,  82.9182993197279  ,  98.42203514739231 ,  99.10741496598638 , 114.71965419501134 , 115.51353741496598 , 133.98671768707482 , 134.90718820861676 , 130.78897959183675 , 131.67147392290246 , 138.84767006802724 , 139.76814058956913 , 120.59330498866215 , 121.38718820861676 , 104.72969954648528 , 105.41507936507935 ,  88.6490873015873  ,  89.22596371882086 , 119.02642290249433 , 119.60329931972787 , 142.0070351473923  , 142.69241496598642 , 165.20465419501133 , 165.998537414966   , 192.52171768707484 , 193.44218820861673 , 186.90897959183673 , 187.79147392290247 , 197.3826700680272  , 198.30314058956913 , 171.07830498866213 , 171.87218820861676 , 148.31469954648526 , 149.00007936507936 , 125.33408730158729 , 125.91096371882084 , 146.7526133786848  , 147.43799319727887 , 175.05975623582765 , 175.87404761904764 , 203.6247222222222  , 204.56792517006804 , 237.2513095238095  , 238.3449092970521  , 230.23142857142855 , 231.27990929705211 , 243.02654761904762 , 244.1201473922902  , 210.60313492063491 , 211.5463378684807  , 182.55381519274377 , 183.3681065759637  , 154.2466723356009  , 154.932052154195   , 176.43186507936505 , 177.2257482993197  , 210.43288548752832 , 211.3760884353742  , 244.7325453514739  , 245.8250680272109  , 285.0972278911565  , 286.36395691609977 , 276.54163265306124 , 277.75609977324257 , 291.78675170068027 , 293.05348072562356 , 252.81571995464853 , 253.90824263038544 , 219.1133390022676  , 220.05654195011337 , 185.1123185941043  , 185.90620181405893 , 208.06417800453514 , 208.9665646258503  , 248.1264229024943  , 249.19853741496604 , 288.5281235827664  , 289.76996598639454 , 336.0594727891156  , 337.4993310657596  , 325.83959183673466 , 327.22004535147386 , 343.66328231292516 , 345.10314058956914 , 297.71606009070297 , 298.95790249433105 , 257.9932709750567  , 259.0653854875283  , 217.93102607709747 , 218.83341269841264 , 212.39770975056692 , 213.23680272108845 , 253.2099546485261  , 254.20687074829934 , 294.33784580498866 , 295.4925850340136  , 342.6886394557823  , 344.0275056689342  , 331.9395918367347  , 333.2232199546486  , 349.75911564625846 , 351.0979818594105  , 302.8813378684806  , 304.03607709750565 , 262.3847392290249  , 263.38165532879816 , 221.5724943310657  , 222.41158730158728 , 231.5377097505669  , 232.37680272108844 , 275.9499546485261  , 276.9468707482993  , 320.67784580498864 , 321.8325850340137  , 373.2286394557823  , 374.5675056689343  , 361.21959183673465 , 362.50321995464856 , 380.29911564625843 , 381.63798185941044 , 329.2213378684807  , 330.37607709750563 , 285.1247392290249  , 286.12165532879817 , 240.71249433106576 , 241.55158730158723 , 269.3577494331066  , 270.2601360544218  , 320.9485657596372  , 322.0206802721089  , 372.8788378684807  , 374.1206802721089  , 433.86018707482987 , 435.3000453514739  , 419.60530612244895 , 420.98575963718815 , 441.4639965986394  , 442.9038548752834  , 382.06677437641724 , 383.3086167800453  , 330.81541383219957 , 331.8875283446711  , 279.22459750566895 , 280.1269841269841  , 243.58462018140594 , 244.37850340136058 , 290.2162528344671  , 291.15945578231293 , 337.1465249433106  , 338.23904761904765 , 392.24692176870747 , 393.51365079365087 , 379.27061224489796 , 380.48507936507934 , 398.9364455782313  , 400.2031746031746  , 345.2296995464853  , 346.3222222222222  , 298.8967063492064  , 299.8399092970521  , 252.26507369614515 , 253.0589569160998  , 215.85842970521543 , 216.54380952380953 , 257.16353174603177 , 257.9778231292517  , 298.7264569160997  , 299.66965986394564 , 347.5173299319728  , 348.6109297052154  , 335.9481632653061  , 336.99664399092967 , 353.2925680272109  , 354.38616780045345 , 305.7048696145125  , 306.6480725623582  , 264.6575907029478  , 265.4718820861678  , 223.35248866213152 , 224.03786848072562 , 186.17917800453515 , 186.75605442176874 , 221.79040249433106 , 222.4757823129252  , 257.6186337868481  , 258.4125170068028  , 299.6714115646258  , 300.5918820861678  , 289.6379591836735  , 290.52045351473924 , 304.53236394557825 , 305.4528344671201  , 263.4922845804989  , 264.28616780045354 , 228.09806689342403 , 228.78344671201816 , 192.4868424036281  , 193.06371882086168 , 222.86417800453518 , 223.4410544217687  , 265.37540249433107 , 266.0607823129252  , 308.1036337868481  , 308.89751700680273 , 358.2064115646259  , 359.1268820861678  , 345.75795918367345 , 346.64045351473925 , 363.0673639455782  , 363.9878344671202  , 313.977284580499   , 314.77116780045355 , 271.68306689342404 , 272.3684467120181  , 229.17184240362812 , 229.74871882086168 , 270.1209807256236  , 270.8063605442177  , 321.63220521541956 , 322.4464965986395  , 373.4012528344672  , 374.34445578231293 , 434.0992687074831  , 435.1928684807256  , 418.95795918367344 , 420.00643990929706 , 439.87450680272104 , 440.9681065759637  , 380.37966553287987 , 381.3228684807256  , 329.12626417233554 , 329.9405555555555  , 277.61503968253965 , 278.3004195011338  , 319.33084467120176 , 320.12472789115645 , 380.2094160997732  , 381.1526190476191  , 441.38662698412696 , 442.479149659864   , 513.1084523809524  , 514.3751814058958  , 495.1457142857142  , 496.3601814058957  , 519.7979761904761  , 521.0647052154194  , 449.4698015873016  , 450.56232426303853 , 388.8898696145124  , 389.8330725623582  , 328.01129818594103 , 328.80518140589567 , 370.4937698412698  , 371.396156462585   , 441.10703514739225 , 442.179149659864   , 512.0597562358276  , 513.3015986394558  , 595.2339625850341  , 596.6738208616781  , 574.3212244897958  , 575.7016780045352  , 602.8377721088434  , 604.2776303854874  , 521.2476927437642  , 522.4895351473923  , 450.9738832199546  , 452.0459977324262  , 380.3606179138322  , 381.26300453514733 , 363.4344444444446  , 364.2735374149659  , 432.65485260770976 , 433.6517687074829  , 502.1909070294784  , 503.3456462585033  , 583.6845578231292  , 585.0234240362812  , 562.9926530612245  , 564.2762811791383  , 590.7550340136055  , 592.0939002267573  , 510.7343990929704  , 511.8891383219954  , 441.82963718820855 , 442.8265532879817  , 372.6092290249432  , 373.44832199546477 , 382.5744444444445  , 383.41353741496596 , 440.76628117913833 , 441.7631972789115  , 499.27376417233563 , 500.42850340136044 , 567.9007482993196  , 569.2396145124716  , 525.468843537415   , 526.7524716553288  , 528.891224489796   , 530.2300907029479  , 444.6705895691609  , 445.82532879818586 , 372.16582766439893 , 373.16274376417226 , 313.9739909297051  , 314.81308390022673 , 334.56829365079363 , 335.4706802721089  , 383.7958446712018  , 384.8679591836736  , 433.36285147392283 , 434.604693877551   , 491.5870578231292  , 493.0269160997732  , 452.559319727891   , 453.9397732426304  , 453.1108673469386  , 454.5507256235828  , 379.4041213151926  , 380.64596371882084 , 315.88745464852593 , 316.9595691609977  , 266.65990362811783 , 267.5622902494331  , 289.264552154195   , 290.0584353741497  , 329.8594501133786  , 330.80265306122453 , 370.7529875283446  , 371.8455102040816  , 418.81052721088435 , 420.07725623582763 , 382.34707482993184 , 383.56154195011345 , 379.4200510204079  , 380.68678004535155 , 315.68949546485254 , 316.7820181405896  , 260.7646655328798  , 261.7078684807256  , 220.16976757369616 , 220.96365079365083 , 242.0077494331066  , 242.69312925170064 , 273.60264739229024 , 274.41693877551023 , 305.45536848072555 , 306.3985714285715  , 342.9176700680271  , 344.0112698412699  , 309.1470748299319  , 310.1955555555556  , 302.6129081632653  , 303.70650793650793 , 249.28711451247165 , 250.23031746031742 , 203.32146825396825 , 204.1357596371882  , 171.72657029478455 , 172.41195011337865 , 192.79788548752836 , 193.37476190476187 , 215.02543650793652 , 215.7108163265306  , 237.46999433106575 , 238.26387755102039 , 263.90848639455777 , 264.8289569160998  , 232.95931972789117 , 233.84181405895686 , 222.68943877551018 , 223.60990929705213 , 180.19697845804987 , 180.99086167800453 , 143.55786281179138 , 144.24324263038548 , 121.33031179138322 , 121.90718820861677 };
  const std::array<int, 4> in_shape = {{ 3, 10, 9, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612,  0.04081632653061224,  0.08163265306122448,  0.12244897959183673,  0.18367346938775508,  0.24489795918367346,  0.18367346938775508,  0.24489795918367346,  0.18367346938775508,  0.24489795918367346,  0.18367346938775508,  0.24489795918367346,  0.18367346938775508,  0.24489795918367346,  0.16326530612244897,  0.20408163265306123,  0.1020408163265306 ,  0.12244897959183673,  0.16326530612244897,  0.2040816326530612 ,  0.4081632653061224 ,  0.4897959183673469 ,  0.7346938775510203 ,  0.8571428571428572 ,  0.7346938775510203 ,  0.8571428571428572 ,  0.7346938775510203 ,  0.8571428571428572 ,  0.7346938775510203 ,  0.8571428571428572 ,  0.7346938775510203 ,  0.8571428571428572 ,  0.5714285714285714 ,  0.653061224489796  ,  0.32653061224489793,  0.36734693877551017,  0.4285714285714285 ,  0.4897959183673469 ,  0.9795918367346936 ,  1.1020408163265305 ,  1.6530612244897958 ,  1.8367346938775508 ,  1.6530612244897958 ,  1.8367346938775508 ,  1.6530612244897958 ,  1.8367346938775508 ,  1.6530612244897958 ,  1.8367346938775508 ,  1.6530612244897958 ,  1.8367346938775508 ,  1.2244897959183672 ,  1.346938775510204  ,  0.673469387755102  ,  0.7346938775510203 ,  0.8163265306122448 ,  0.8979591836734693 ,  1.7959183673469385 ,  1.9591836734693877 ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.1224489795918364 ,  2.2857142857142856 ,  1.1428571428571428 ,  1.2244897959183674 ,  0.8163265306122448 ,  0.8979591836734693 ,  1.7959183673469385 ,  1.9591836734693877 ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.1224489795918364 ,  2.2857142857142856 ,  1.1428571428571428 ,  1.2244897959183674 ,  0.8163265306122448 ,  0.8979591836734693 ,  1.7959183673469385 ,  1.9591836734693877 ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.1224489795918364 ,  2.2857142857142856 ,  1.1428571428571428 ,  1.2244897959183674 ,  0.8163265306122448 ,  0.8979591836734693 ,  1.7959183673469385 ,  1.9591836734693877 ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.1224489795918364 ,  2.2857142857142856 ,  1.1428571428571428 ,  1.2244897959183674 ,  0.7959183673469388 ,  0.857142857142857  ,  1.7142857142857142 ,  1.8367346938775508 ,  2.7551020408163263 ,  2.938775510204082  ,  2.7551020408163263 ,  2.938775510204082  ,  2.7551020408163263 ,  2.938775510204082  ,  2.7551020408163263 ,  2.938775510204082  ,  2.7551020408163263 ,  2.938775510204082  ,  1.9591836734693877 ,  2.0816326530612246 ,  1.0408163265306123 ,  1.1020408163265305 ,  0.6530612244897959 ,  0.693877551020408  ,  1.3877551020408163 ,  1.4693877551020407 ,  2.204081632653061  ,  2.326530612244898  ,  2.204081632653061  ,  2.326530612244898  ,  2.204081632653061  ,  2.326530612244898  ,  2.204081632653061  ,  2.326530612244898  ,  2.204081632653061  ,  2.326530612244898  ,  1.5510204081632653 ,  1.6326530612244898 ,  0.8163265306122449 ,  0.8571428571428571 ,  0.3877551020408163 ,  0.4081632653061224 ,  0.8163265306122449 ,  0.857142857142857  ,  1.2857142857142856 ,  1.3469387755102038 ,  1.2857142857142856 ,  1.3469387755102038 ,  1.2857142857142856 ,  1.3469387755102038 ,  1.2857142857142856 ,  1.3469387755102038 ,  1.2857142857142856 ,  1.3469387755102038 ,  0.8979591836734693 ,  0.9387755102040816 ,  0.4693877551020408 ,  0.4897959183673469 ,  0.5102040816326531 ,  0.5306122448979591 ,  1.0612244897959182 ,  1.1020408163265305 ,  1.6530612244897958 ,  1.714285714285714  ,  1.6530612244897958 ,  1.714285714285714  ,  1.6530612244897958 ,  1.714285714285714  ,  1.6530612244897958 ,  1.714285714285714  ,  1.6530612244897958 ,  1.714285714285714  ,  1.1428571428571428 ,  1.183673469387755  ,  0.5918367346938775 ,  0.6122448979591836 ,  1.1428571428571428 ,  1.183673469387755  ,  2.36734693877551   ,  2.4489795918367343 ,  3.6734693877551017 ,  3.795918367346938  ,  3.6734693877551017 ,  3.795918367346938  ,  3.6734693877551017 ,  3.795918367346938  ,  3.6734693877551017 ,  3.795918367346938  ,  3.6734693877551017 ,  3.795918367346938  ,  2.5306122448979593 ,  2.6122448979591835 ,  1.3061224489795917 ,  1.3469387755102038 ,  1.8979591836734693 ,  1.9591836734693877 ,  3.918367346938775  ,  4.040816326530612  ,  6.061224489795918  ,  6.244897959183673  ,  6.061224489795918  ,  6.244897959183673  ,  6.061224489795918  ,  6.244897959183673  ,  6.061224489795918  ,  6.244897959183673  ,  6.061224489795918  ,  6.244897959183673  ,  4.163265306122449  ,  4.285714285714286  ,  2.142857142857143  ,  2.204081632653061  ,  2.7755102040816326 ,  2.8571428571428568 ,  5.7142857142857135 ,  5.877551020408163  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.040816326530612  ,  6.204081632653061  ,  3.1020408163265305 ,  3.183673469387755  ,  2.7755102040816326 ,  2.8571428571428568 ,  5.7142857142857135 ,  5.877551020408163  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.040816326530612  ,  6.204081632653061  ,  3.1020408163265305 ,  3.183673469387755  ,  2.7755102040816326 ,  2.8571428571428568 ,  5.7142857142857135 ,  5.877551020408163  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.040816326530612  ,  6.204081632653061  ,  3.1020408163265305 ,  3.183673469387755  ,  2.7755102040816326 ,  2.8571428571428568 ,  5.7142857142857135 ,  5.877551020408163  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  8.816326530612244  ,  9.061224489795917  ,  6.040816326530612  ,  6.204081632653061  ,  3.1020408163265305 ,  3.183673469387755  ,  2.265306122448979  ,  2.3265306122448974 ,  4.653061224489795  ,  4.775510204081632  ,  7.163265306122449  ,  7.346938775510204  ,  7.163265306122449  ,  7.346938775510204  ,  7.163265306122449  ,  7.346938775510204  ,  7.163265306122449  ,  7.346938775510204  ,  7.163265306122449  ,  7.346938775510204  ,  4.897959183673469  ,  5.020408163265306  ,  2.510204081632653  ,  2.571428571428571  ,  1.6326530612244898 ,  1.673469387755102  ,  3.346938775510204  ,  3.428571428571428  ,  5.142857142857142  ,  5.26530612244898   ,  5.142857142857142  ,  5.26530612244898   ,  5.142857142857142  ,  5.26530612244898   ,  5.142857142857142  ,  5.26530612244898   ,  5.142857142857142  ,  5.26530612244898   ,  3.510204081632653  ,  3.591836734693877  ,  1.7959183673469385 ,  1.8367346938775508 ,  0.8775510204081632 ,  0.8979591836734693 ,  1.7959183673469385 ,  1.8367346938775508 ,  2.7551020408163263 ,  2.816326530612245  ,  2.7551020408163263 ,  2.816326530612245  ,  2.7551020408163263 ,  2.816326530612245  ,  2.7551020408163263 ,  2.816326530612245  ,  2.7551020408163263 ,  2.816326530612245  ,  1.8775510204081631 ,  1.9183673469387754 ,  0.9591836734693877 ,  0.9795918367346939 ,  0.9999999999999999 ,  1.0204081632653061 ,  2.040816326530612  ,  2.0816326530612246 ,  3.1224489795918364 ,  3.183673469387755  ,  3.1224489795918364 ,  3.183673469387755  ,  3.1224489795918364 ,  3.183673469387755  ,  3.1224489795918364 ,  3.183673469387755  ,  3.1224489795918364 ,  3.183673469387755  ,  2.1224489795918364 ,  2.1632653061224487 ,  1.0816326530612244 ,  1.1020408163265305 ,  2.1224489795918364 ,  2.163265306122449  ,  4.326530612244897  ,  4.408163265306122  ,  6.612244897959183  ,  6.73469387755102   ,  6.612244897959183  ,  6.73469387755102   ,  6.612244897959183  ,  6.73469387755102   ,  6.612244897959183  ,  6.73469387755102   ,  6.612244897959183  ,  6.73469387755102   ,  4.489795918367347  ,  4.571428571428571  ,  2.2857142857142856 ,  2.3265306122448974 ,  3.3673469387755097 ,  3.428571428571429  ,  6.857142857142857  ,  6.979591836734693  , 10.46938775510204   , 10.653061224489795  , 10.46938775510204   , 10.653061224489795  , 10.46938775510204   , 10.653061224489795  , 10.46938775510204   , 10.653061224489795  , 10.46938775510204   , 10.653061224489795  ,  7.1020408163265305 ,  7.224489795918367  ,  3.6122448979591835 ,  3.6734693877551017 ,  4.73469387755102   ,  4.816326530612245  ,  9.632653061224488  ,  9.795918367346939  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  ,  9.959183673469386  , 10.122448979591836  ,  5.061224489795918  ,  5.142857142857142  ,  4.73469387755102   ,  4.816326530612245  ,  9.632653061224488  ,  9.795918367346939  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  ,  9.959183673469386  , 10.122448979591836  ,  5.061224489795918  ,  5.142857142857142  ,  4.73469387755102   ,  4.816326530612245  ,  9.632653061224488  ,  9.795918367346939  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  ,  9.959183673469386  , 10.122448979591836  ,  5.061224489795918  ,  5.142857142857142  ,  4.73469387755102   ,  4.816326530612245  ,  9.632653061224488  ,  9.795918367346939  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  , 14.693877551020407  , 14.938775510204081  ,  9.959183673469386  , 10.122448979591836  ,  5.061224489795918  ,  5.142857142857142  ,  3.7346938775510203 ,  3.795918367346938  ,  7.591836734693876  ,  7.7142857142857135 , 11.57142857142857   , 11.755102040816327  , 11.57142857142857   , 11.755102040816327  , 11.57142857142857   , 11.755102040816327  , 11.57142857142857   , 11.755102040816327  , 11.57142857142857   , 11.755102040816327  ,  7.83673469387755   ,  7.959183673469386  ,  3.979591836734694  ,  4.040816326530612  ,  2.6122448979591835 ,  2.6530612244897958 ,  5.3061224489795915 ,  5.387755102040815  ,  8.081632653061224  ,  8.204081632653061  ,  8.081632653061224  ,  8.204081632653061  ,  8.081632653061224  ,  8.204081632653061  ,  8.081632653061224  ,  8.204081632653061  ,  8.081632653061224  ,  8.204081632653061  ,  5.469387755102041  ,  5.551020408163264  ,  2.775510204081632  ,  2.816326530612245  ,  1.3673469387755102 ,  1.3877551020408163 ,  2.775510204081632  ,  2.816326530612245  ,  4.224489795918367  ,  4.285714285714286  ,  4.224489795918367  ,  4.285714285714286  ,  4.224489795918367  ,  4.285714285714286  ,  4.224489795918367  ,  4.285714285714286  ,  4.224489795918367  ,  4.285714285714286  ,  2.8571428571428568 ,  2.897959183673469  ,  1.4489795918367345 ,  1.4693877551020407 };
  const std::array<int, 4> in_shape = {{ 3, 10, 9, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 29.800459183673464,  30.377335600907024,  30.954212018140588,  31.531088435374148,  36.59195578231292 ,  37.27733560090702 ,  37.96271541950113 ,  38.64809523809524 ,  43.81746598639456 ,  44.6113492063492  ,  45.405232426303854,  46.199115646258505,  52.75357709750567 ,  53.67404761904763 ,  54.594518140589564,  55.51498866213152 ,  55.23750566893423 ,  56.120000000000005,  57.00249433106575 ,  57.88498866213152 ,  62.47548185941042 ,  63.39595238095237 ,  64.31642290249434 ,  65.23689342403628 ,  55.56476757369614 ,  56.35865079365079 ,  57.15253401360544 ,  57.9464172335601  ,  49.20728458049886 ,  49.892664399092965,  50.57804421768707 ,  51.26342403628118 ,  42.4157879818594  ,  42.992664399092966,  43.56954081632652 ,  44.146417233560086,  46.08311224489796 ,  46.768492063492054,  47.45387188208617 ,  48.13925170068027 ,  56.1603231292517  ,  56.974614512471646,  57.788905895691606,  58.60319727891156 ,  66.75318027210885 ,  67.69638321995464 ,  68.63958616780045 ,  69.58278911564626 ,  79.71310090702949 ,  80.80670068027213 ,  81.90030045351473 ,  82.99390022675738 ,  81.96131519274377 ,  83.00979591836736 ,  84.05827664399091 ,  85.1067573696145  ,  91.26357709750566 ,  92.3571768707483  ,  93.45077664399092 ,  94.54437641723356 ,  80.71000566893422 ,  81.65320861678005 ,  82.59641156462584 ,  83.53961451247167 ,  71.14844104308389 ,  71.96273242630386 ,  72.7770238095238  ,  73.59131519274376 ,  61.07123015873015 ,  61.75660997732425 ,  62.44198979591836 ,  63.127369614512475,  66.27188775510204 ,  67.06577097505668 ,  67.85965419501134 ,  68.65353741496598 ,  80.36950680272109 ,  81.31270975056688 ,  82.2559126984127  ,  83.19911564625849 ,  95.06440476190477 ,  96.15692743764171 ,  97.24945011337869 ,  98.34197278911564 , 112.90527777777778 , 114.1720068027211  , 115.4387358276644  , 116.7054648526077  , 114.66063492063493 , 115.87510204081633 , 117.08956916099771 , 118.30403628117912 , 126.2843253968254  , 127.5510544217687  , 128.817783446712   , 130.08451247165533 , 111.23075396825395 , 112.32327664399092 , 113.41579931972788 , 114.50832199546487 ,  97.73041383219955 ,  98.67361678004535 ,  99.61681972789114 , 100.56002267573696 ,  83.6327947845805  ,  84.42667800453512 ,  85.22056122448978 ,  86.01444444444444 ,  90.36678571428573 ,  91.2691723356009  ,  92.17155895691609 ,  93.0739455782313  , 109.2195068027211  , 110.29162131519273 , 111.36373582766439 , 112.43585034013606 , 128.75113945578232 , 129.9929818594104  , 131.23482426303855 , 132.4766666666667  , 152.33010770975056 , 153.7699659863946  , 155.20982426303854 , 156.64968253968252 , 153.33546485260774 , 154.71591836734694 , 156.09637188208612 , 157.47682539682538 , 167.5377267573696  , 168.9775850340136  , 170.41744331065757 , 171.85730158730158 , 147.1270124716553  , 148.36885487528343 , 149.61069727891154 , 150.85253968253969 , 128.9532029478458  , 130.02531746031744 , 131.0974319727891  , 132.16954648526075 , 110.10048185941042 , 111.0028684807256  , 111.90525510204081 , 112.807641723356   , 121.88285714285716 , 122.72195011337865 , 123.5610430839002  , 124.40013605442178 , 146.53319727891156 , 147.53011337868477 , 148.52702947845805 , 149.5239455782313  , 171.81482993197278 , 172.9695691609977  , 174.12430839002266 , 175.27904761904762 , 202.0465759637188  , 203.38544217687075 , 204.72430839002266 , 206.06317460317462 , 200.489433106576   , 201.7730612244898  , 203.0566893424036  , 204.34031746031746 , 216.18752834467122 , 217.5263945578231  , 218.86526077097506 , 220.20412698412702 , 188.90181405895692 , 190.05655328798184 , 191.21129251700683 , 192.36603174603172 , 164.88276643990932 , 165.8796825396825  , 166.87659863945578 , 167.87351473922902 , 140.23242630385488 , 141.07151927437639 , 141.91061224489798 , 142.74970521541948 , 160.16285714285715 , 161.00195011337865 , 161.84104308390022 , 162.68013605442178 , 192.01319727891155 , 193.01011337868476 , 194.00702947845804 , 195.0039455782313  , 224.4948299319728  , 225.6495691609977  , 226.80430839002264 , 227.95904761904762 , 263.1265759637188  , 264.4654421768707  , 265.80430839002264 , 267.14317460317466 , 259.049433106576   , 260.33306122448977 , 261.61668934240356 , 262.90031746031747 , 277.2675283446712  , 278.60639455782314 , 279.945260770975   , 281.284126984127   , 241.58181405895695 , 242.73655328798182 , 243.8912925170068  , 245.04603174603173 , 210.36276643990934 , 211.3596825396825  , 212.35659863945583 , 213.353514739229   , 178.51242630385488 , 179.3515192743764  , 180.19061224489795 , 181.02970521541948 , 212.95392857142858 , 213.85631519274375 , 214.75870181405898 , 215.66108843537415 , 254.86379251700677 , 255.93590702947841 , 257.00802154195014 , 258.08013605442176 , 297.4525680272108  , 298.69441043083896 , 299.9362528344671  , 301.1780952380953  , 347.93153628117915 , 349.37139455782307 , 350.8112528344671  , 352.2511111111112  , 340.8668934240363  , 342.2473469387755  , 343.6278004535147  , 345.0082539682541  , 363.1391553287982  , 364.5790136054421  , 366.0188718820861  , 367.45873015873025 , 315.8284410430839  , 317.070283446712   , 318.3121258503401  , 319.55396825396826 , 274.5974886621315  , 275.66960317460314 , 276.7417176870748  , 277.8138321995465  , 232.6876247165533  , 233.59001133786848 , 234.49239795918365 , 235.39478458049885 , 200.57739795918366 , 201.37128117913832 , 202.16516439909296 , 202.95904761904762 , 239.93624149659863 , 240.87944444444443 , 241.82264739229026 , 242.76585034013607 , 279.89236394557815 , 280.9848866213151  , 282.0774092970522  , 283.16993197278913 , 327.2046655328798  , 328.47139455782303 , 329.73812358276643 , 331.00485260770984 , 320.1185941043084  , 321.3330612244897  , 322.5475283446712  , 323.76199546485265 , 340.58371315192744 , 341.8504421768707  , 343.1171712018141  , 344.3839002267574  , 296.0587131519274  , 297.1512358276644  , 298.2437585034013  , 299.3362811791383  , 257.2971485260771  , 258.24035147392294 , 259.1835544217687  , 260.1267573696145  , 217.93830498866214 , 218.7321882086168  , 219.5260714285714  , 220.31995464852605 , 184.29474489795916 , 184.9801247165533  , 185.66550453514742 , 186.3508843537415  , 220.36787414965983 , 221.1821655328798  , 221.9964569160998  , 222.81074829931973 , 256.9566496598639  , 257.8998526077097  , 258.8430555555556  , 259.78625850340137 , 300.245141723356   , 301.3387414965986  , 302.43234126984134 , 303.52594104308395 , 293.3947845804988  , 294.4432653061224  , 295.49174603174606 , 296.5402267573696  , 311.7956179138322  , 312.8892176870748  , 313.98281746031745 , 315.0764172335601  , 270.9134750566893  , 271.8566780045352  , 272.79988095238093 , 273.74308390022674 , 235.35599206349207 , 236.17028344671203 , 236.98457482993197 , 237.7988662131519  , 199.2828628117914  , 199.9682426303855  , 200.65362244897958 , 201.33900226757365 , 164.1059693877551  , 164.6828458049887  , 165.25972222222225 , 165.8365986394558  , 196.15869047619043 , 196.84407029478461 , 197.5294501133787  , 198.21482993197276 , 228.645425170068   , 229.4393083900227  , 230.23319160997735 , 231.02707482993196 , 267.05296485260766 , 267.97343537414963 , 268.89390589569166 , 269.8143764172335  , 260.69546485260764 , 261.5779591836735  , 262.46045351473924 , 263.34294784580493 , 276.77486961451245 , 277.6953401360545  , 278.6158106575964  , 279.53628117913826 , 240.39272675736962 , 241.1866099773243  , 241.98049319727892 , 242.77437641723353 , 208.77401927437643 , 209.45939909297056 , 210.14477891156463 , 210.8301587301587  , 176.72129818594104 , 177.2981746031746  , 177.87505102040816 , 178.45192743764173 , 237.47596938775507 , 238.05284580498866 , 238.62972222222223 , 239.20659863945573 , 283.32869047619045 , 284.0140702947846  , 284.69945011337865 , 285.38482993197283 , 329.615425170068   , 330.40930839002266 , 331.20319160997724 , 331.997074829932   , 384.1229648526077  , 385.0434353741497  , 385.96390589569154 , 386.88437641723345 , 372.9354648526077  , 373.81795918367345 , 374.7004535147392  , 375.58294784580494 , 393.84486961451245 , 394.7653401360544  , 395.68581065759633 , 396.60628117913825 , 341.36272675736967 , 342.15660997732425 , 342.95049319727894 , 343.7443764172335  , 295.9440192743764  , 296.6293990929705  , 297.31477891156464 , 298.0001587301587  , 250.09129818594104 , 250.66817460317458 , 251.2450510204082  , 251.82192743764168 , 270.1803911564625  , 270.86577097505665 , 271.55115079365083 , 272.23653061224485 , 316.21678571428566 , 317.0310770975056  , 317.8453684807256  , 318.65965986394565 , 362.7688265306122  , 363.71202947845796 , 364.65523242630377 , 365.5984353741497  , 417.68112811791383 , 418.77472789115643 , 419.86832766439903 , 420.96192743764163 , 389.0579138321996  , 390.1063945578231  , 391.1548752834467  , 392.20335600907026 , 396.31731859410434 , 397.41091836734694 , 398.50451814058954 , 399.59811791383214 , 343.81136621315204 , 344.75456916099773 , 345.6977721088436  , 346.64097505668934 , 298.29061791383225 , 299.1049092970522  , 299.9192006802721  , 300.73349206349206 , 252.25422335600905 , 252.93960317460312 , 253.6249829931973  , 254.31036281179135 , 273.87664965986386 , 274.67053287981855 , 275.4644160997733  , 276.2582993197279  , 320.8314115646258  , 321.7746145124716  , 322.71781746031746 , 323.6610204081634  , 368.38345238095235 , 369.47597505668926 , 370.56849773242624 , 371.6610204081633  , 424.5576587301587  , 425.824387755102   , 427.0911167800453  , 428.3578458049886  , 396.5273015873016  , 397.74176870748295 , 398.95623582766444 , 400.17070294784577 , 405.0224206349207  , 406.28914965986394 , 407.5558786848073  , 408.8226077097505  , 351.635515873016   , 352.7280385487528  , 353.8205612244899  , 354.91308390022675 , 305.2780328798187  , 306.22123582766443 , 307.16443877551023 , 308.107641723356   , 258.3232709750567  , 259.11715419501127 , 259.911037414966   , 260.7049206349206  , 281.4790306122448  , 282.38141723356    , 283.2838038548753  , 284.1861904761905  , 330.08685374149655 , 331.15896825396817 , 332.2310827664399  , 333.30319727891174 , 379.37358843537413 , 380.61543083900216 , 381.8572732426303  , 383.0991156462586  , 437.6668424036281  , 439.10670068027207 , 440.54655895691604 , 441.9864172335601  , 409.9721995464853  , 411.3526530612245  , 412.73310657596375 , 414.11356009070295 , 419.9601757369615  , 421.4000340136055  , 422.83989229024945 , 424.27975056689337 , 364.83517573696156 , 366.0770181405896  , 367.3188605442178  , 368.5607029478458  , 316.9062641723357  , 317.97837868480735 , 319.05049319727897 , 320.1226077097505  , 268.29844104308387 , 269.20082766439907 , 270.10321428571433 , 271.0056009070294  , 225.39668934240365 , 226.23578231292518 , 227.07487528344672 , 227.91396825396822 , 263.32594104308384 , 264.3228571428571  , 265.3197732426304  , 266.31668934240355 , 301.8864852607709  , 303.04122448979587 , 304.19596371882085 , 305.3507029478458  , 347.61029478458045 , 348.9491609977324  , 350.2880272108843  , 351.62689342403627 , 323.1198185941044  , 324.4034467120182  , 325.68707482993204 , 326.9707029478458  , 328.83696145124736 , 330.1758276643991  , 331.5146938775511  , 332.8535600907029  , 286.05918367346936 , 287.21392290249435 , 288.36866213151933 , 289.52340136054414 , 248.76122448979584 , 249.75814058956908 , 250.75505668934238 , 251.75197278911565 , 210.8319727891156  , 211.67106575963712 , 212.51015873015868 , 213.34925170068024 , 185.90145124716557 , 186.74054421768707 , 187.5796371882086  , 188.4187301587301  , 216.40213151927438 , 217.39904761904762 , 218.39596371882087 , 219.3928798185941  , 247.53410430839003 , 248.68884353741493 , 249.84358276643985 , 250.99832199546486 , 284.5912471655328  , 285.9301133786847  , 287.26897959183674 , 288.6078458049886  , 262.7007709750567  , 263.9843990929704  , 265.2680272108843  , 266.5516553287982  , 265.8179138321995  , 267.1567800453514  , 268.49564625850337 , 269.8345124716554  , 231.70680272108842 , 232.86154195011335 , 234.01628117913833 , 235.1710204081633  , 201.83741496598634 , 202.8343310657596  , 203.83124716553286 , 204.82816326530616 , 171.33673469387756 , 172.1758276643991  , 173.0149206349206  , 173.8540136054422  , 164.2591893424036  , 165.16157596371883 , 166.06396258503398 , 166.9663492063492  , 190.81939342403626 , 191.89150793650794 , 192.96362244897955 , 194.03573696145122 , 218.05850907029475 , 219.30035147392286 , 220.542193877551   , 221.78403628117917 , 250.62954081632654 , 252.06939909297049 , 253.50925736961446 , 254.94911564625855 , 230.65156462585034 , 232.03201814058954 , 233.41247165532874 , 234.79292517006806 , 232.92287414965986 , 234.3627324263038  , 235.80259070294784 , 237.24244897959184 , 203.5200963718821  , 204.76193877551017 , 206.00378117913831 , 207.24562358276648 , 177.63880385487528 , 178.7109183673469  , 179.7830328798186  , 180.85514739229026 , 151.07859977324262 , 151.98098639455782 , 152.883373015873   , 153.7857596371882  , 112.8214342403628  , 113.61531746031746 , 114.40920068027212 , 115.20308390022677 , 129.48367913832197 , 130.4268820861678  , 131.37008503401364 , 132.31328798185942 , 146.74320294784576 , 147.83572562358273 , 148.92824829931976 , 150.0207709750567  , 167.57613945578228 , 168.8428684807256  , 170.10959750566892 , 171.37632653061226 , 150.14816326530612 , 151.36263038548753 , 152.57709750566895 , 153.79156462585033 , 148.0409013605442  , 149.30763038548756 , 150.57435941043084 , 151.84108843537413 , 129.9952664399093  , 131.08778911564627 , 132.18031179138325 , 133.27283446712016 , 113.93030045351473 , 114.87350340136055 , 115.81670634920636 , 116.75990929705215 ,  97.26805555555555 ,  98.06193877551019 ,  98.85582199546486 ,  99.64970521541949 ,  80.11701247165534 ,  80.80239229024943 ,  81.48777210884353 ,  82.17315192743764 ,  96.59558390022677 ,  97.40987528344672 ,  98.22416666666668 ,  99.03845804988661 , 113.5898015873016  , 114.5330045351474  , 115.47620748299319 , 116.419410430839   , 134.01797619047616 , 135.11157596371885 , 136.20517573696145 , 137.29877551020408 , 134.0257142857143  , 135.07419501133788 , 136.12267573696144 , 137.17115646258503 , 145.56845238095238 , 146.66205215419504 , 147.75565192743764 , 148.84925170068024 , 127.54662698412697 , 128.4898299319728  , 129.4330328798186  , 130.3762358276644  , 111.58370181405894 , 112.39799319727891 , 113.21228458049887 , 114.02657596371881 ,  95.10513038548753 ,  95.79051020408161 ,  96.47589002267574 ,  97.16126984126984 ,  76.42075396825398 ,  76.99763038548753 ,  77.57450680272109 ,  78.15138321995465 ,  91.98095804988664 ,  92.66633786848072 ,  93.35171768707482 ,  94.03709750566894 , 107.97517573696145 , 108.76905895691611 , 109.56294217687073 , 110.3568253968254  , 127.14144557823128 , 128.06191609977327 , 128.9823866213152  , 129.90285714285716 , 126.55632653061222 , 127.43882086167801 , 128.32131519274375 , 129.20380952380953 , 136.86335034013604 , 137.783820861678   , 138.70429138321998 , 139.6247619047619  , 119.72247732426304 , 120.51636054421769 , 121.31024376417234 , 122.10412698412696 , 104.59628684807257 , 105.28166666666667 , 105.96704648526078 , 106.65242630385487 ,  89.0360827664399  ,  89.61295918367347 ,  90.18983560090703 ,  90.76671201814058 , 149.79075396825397 , 150.36763038548753 , 150.94450680272107 , 151.52138321995463 , 179.15095804988664 , 179.8363378684807  , 180.52171768707484 , 181.2070975056689  , 208.94517573696146 , 209.73905895691607 , 210.5329421768708  , 211.32682539682537 , 244.21144557823132 , 245.1319160997732  , 246.05238662131518 , 246.97285714285715 , 238.79632653061228 , 239.678820861678   , 240.56131519274376 , 241.4438095238095  , 253.9333503401361  , 254.853820861678   , 255.77429138321995 , 256.6947619047619  , 220.69247732426308 , 221.4863605442177  , 222.28024376417233 , 223.07412698412702 , 191.76628684807258 , 192.4516666666667  , 193.13704648526073 , 193.8224263038549  , 162.4060827664399  , 162.98295918367347 , 163.55983560090698 , 164.13671201814066 , 188.64211451247166 , 189.32749433106576 , 190.01287414965984 , 190.69825396825394 , 225.5329308390023  , 226.3472222222222  , 227.1615136054422  , 227.9758049886621  , 262.93939342403627 , 263.8825963718821  , 264.82579931972793 , 265.7690022675737  , 307.1818537414966  , 308.27545351473924 , 309.3690532879819  , 310.4626530612245  , 300.045306122449   , 301.09378684807257 , 302.14226757369613 , 303.1907482993197  , 318.7323299319728  , 319.8259297052154  , 320.919529478458   , 322.01312925170066 , 276.89621882086175 , 277.8394217687075  , 278.78262471655324 , 279.7258276643991  , 240.52104875283447 , 241.33534013605444 , 242.14963151927435 , 242.96392290249435 , 203.63023242630385 , 204.31561224489795 , 205.00099206349202 , 205.6863718820862  , 231.39959750566894 , 232.1934807256236  , 232.9873639455782  , 233.78124716553285 , 276.55571995464857 , 277.4989229024943  , 278.4421258503402  , 279.3853287981859  , 322.3091213151927  , 323.4016439909297  , 324.49416666666673 , 325.5866893424036  , 376.38491496598635 , 377.6516439909297  , 378.91837301587304 , 380.18510204081633 , 367.2697959183673  , 368.4842630385487  , 369.69873015873014 , 370.9131972789115  , 389.763962585034   , 391.0306916099772  , 392.2974206349206  , 393.564149659864   , 338.475470521542   , 339.56799319727884 , 340.6605158730158  , 341.7530385487529  , 293.91662698412694 , 294.85982993197274 , 295.8030328798186  , 296.74623582766446 , 248.7605045351474  , 249.55438775510206 , 250.34827097505664 , 251.14215419501136 , 278.0632029478458  , 278.965589569161   , 279.86797619047616 , 280.7703628117913  , 332.21932539682547 , 333.291439909297   , 334.3635544217687  , 335.4356689342403  , 387.05435941043083 , 388.2962018140589  , 389.53804421768706 , 390.77988662131514 , 451.82062925170067 , 453.26048752834464 , 454.7003458049886  , 456.14020408163265 , 440.4697959183673  , 441.8502494331065  , 443.2307029478457  , 444.61115646258503 , 467.02824829931967 , 468.4681065759636  , 469.9079648526077  , 471.3478231292517  , 405.43023242630386 , 406.6720748299319  , 407.91391723356    , 409.1557596371883  , 351.95302154195    , 353.0251360544217  , 354.0972505668934  , 355.16936507936515 , 297.7968990929705  , 298.69928571428574 , 299.6016723356009  , 300.50405895691614 , 296.4141950113378  , 297.25328798185944 , 298.09238095238095 , 298.93147392290246 , 353.891746031746   , 354.88866213151925 , 355.88557823129247 , 356.8824943310657  , 412.000589569161   , 413.1553287981859  , 414.31006802721083 , 415.4648072562358  , 480.5307482993197  , 481.86961451247157 , 483.2084807256235  , 484.5473469387754  , 467.484081632653   , 468.7677097505668  , 470.05133786848063 , 471.33496598639454 , 494.6717006802721  , 496.01056689342386 , 497.34943310657593 , 498.68829931972795 , 429.08757369614517 , 430.2423129251699  , 431.39705215419497 , 432.55179138322    , 372.24131519274374 , 373.23823129251696 , 374.2351473922903  , 375.2320634920635  , 314.7637641723357  , 315.6028571428571  , 316.4419501133787  , 317.28104308390016 , 334.69419501133785 , 335.53328798185936 , 336.372380952381   , 337.2114739229025  , 384.7431746031745  , 385.7400907029478  , 386.73700680272106 , 387.7339229024943  , 435.4234467120181  , 436.578185941043   , 437.732925170068   , 438.88766439909296 , 495.28693877551024 , 496.6258049886621  , 497.964671201814   , 499.303537414966   , 459.24027210884356 , 460.52390022675735 , 461.8075283446712  , 463.09115646258493 , 463.3478911564626  , 464.68675736961444 , 466.0256235827664  , 467.36448979591825 , 389.36376417233555 , 390.5185034013604  , 391.6732426303856  , 392.8279818594104  , 325.3175056689343  , 326.31442176870746 , 327.3113378684807  , 328.3082539682539  , 275.26852607709765 , 276.10761904761904 , 276.94671201814054 , 277.7858049886621  , 303.431298185941   , 304.3336848072562  , 305.23607142857145 , 306.1384580498866  , 347.7302777777777  , 348.8023922902494  , 349.8745068027211  , 350.9466213151927  , 392.70816893424035 , 393.9500113378685  , 395.19185374149663 , 396.43369614512466 , 445.9744387755102  , 447.41429705215415 , 448.8541553287982  , 450.29401360544205 , 412.47360544217685 , 413.85405895691605 , 415.2345124716553  , 416.61496598639445 , 415.10205782312926 , 416.5419160997732  , 417.98177437641726 , 419.4216326530611  , 347.9373752834468  , 349.17921768707475 , 350.42106009070295 , 351.66290249433104 , 289.68873582766446 , 290.760850340136   , 291.8329648526077  , 292.9050793650793  , 245.38975623582775 , 246.2921428571429  , 247.19452947845804 , 248.0969160997732  , 268.4860600907029  , 269.2799433106576  , 270.0738265306123  , 270.8677097505668  , 305.9891213151927  , 306.93232426303854 , 307.8755272108844  , 308.8187301587301  , 344.08946145124713 , 345.18198412698405 , 346.27450680272113 , 347.36702947845805 , 389.23668367346943 , 390.50341269841266 , 391.770141723356   , 393.03687074829924 , 357.20013605442176 , 358.41460317460314 , 359.62907029478464 , 360.8435374149659  , 356.535731292517   , 357.80246031746026 , 359.06918934240366 , 360.3359183673469  , 297.10914399092974 , 298.20166666666665 , 299.2941893424037  , 300.38671201814054 , 245.57479024943316 , 246.51799319727894 , 247.46119614512472 , 248.4043990929705  , 208.07172902494335 , 208.865612244898   , 209.6594954648526  , 210.4533786848072  , 229.63469954648525 , 230.3200793650794  , 231.00545918367345 , 231.69083900226758 , 259.6071485260771  , 260.421439909297   , 261.2357312925171  , 262.05002267573695 , 290.0952437641723  , 291.03844671201813 , 291.981649659864   , 292.9248526077097  , 326.26627551020414 , 327.3598752834467  , 328.45347505668934 , 329.5470748299319  , 295.951156462585   , 296.9996371882086  , 298.0481179138323  , 299.0965986394557  , 291.73675170068026 , 292.83035147392286 , 293.9239512471656  , 295.0175510204081  , 240.9054024943311  , 241.8486054421769  , 242.79180839002265 , 243.73501133786843 , 196.82002834467124 , 197.63431972789118 , 198.4486111111111  , 199.26290249433103 , 166.84757936507938 , 167.5329591836735  , 168.21833900226756 , 168.90371882086166 , 186.87721655328798 , 187.4540929705216  , 188.03096938775508 , 188.60784580498867 , 208.58435941043086 , 209.269739229025   , 209.95511904761904 , 210.64049886621316 , 230.7255158730159  , 231.5193990929706  , 232.3132823129251  , 233.1071655328798  , 257.06321428571437 , 257.98368480725634 , 258.90415532879814 , 259.8246258503401  , 228.72666666666672 , 229.6091609977325  , 230.49165532879815 , 231.37414965986395 , 220.70511904761906 , 221.62558956916106 , 222.54606009070292 , 223.4665306122449  , 179.3261507936508  , 180.1200340136055  , 180.91391723356006 , 181.70780045351472 , 143.42445011337873 , 144.1098299319728  , 144.79520975056687 , 145.48058956916097 , 121.71730725623581 , 122.2941836734694  , 122.87106009070294 , 123.4479365079365  };
  const std::array<int, 4> in_shape = {{ 3, 10, 9, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x9x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.2857142857142857  ,  0.32653061224489793 ,  0.36734693877551017 ,  0.40816326530612246 ,  0.18367346938775508 ,  0.2040816326530612  ,  0.22448979591836732 ,  0.24489795918367346 ,  0.2857142857142857  ,  0.32653061224489793 ,  0.36734693877551017 ,  0.4081632653061224  ,  0.7346938775510203  ,  0.8163265306122448  ,  0.8979591836734693  ,  0.9795918367346939  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.346938775510204   ,  1.4693877551020407  ,  1.5918367346938775  ,  1.7142857142857144  ,  1.0612244897959184  ,  1.1428571428571428  ,  1.2244897959183674  ,  1.306122448979592   ,  0.6122448979591837  ,  0.6530612244897959  ,  0.693877551020408   ,  0.7346938775510203  ,  0.7959183673469388  ,  0.857142857142857   ,  0.9183673469387754  ,  0.9795918367346939  ,  1.8367346938775508  ,  1.9591836734693873  ,  2.081632653061224   ,  2.204081632653061   ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  3.122448979591837   ,  3.3061224489795915  ,  3.4897959183673466  ,  3.6734693877551017  ,  2.326530612244898   ,  2.4489795918367343  ,  2.571428571428571   ,  2.693877551020408   ,  1.2857142857142856  ,  1.346938775510204   ,  1.4081632653061222  ,  1.4693877551020407  ,  1.5510204081632653  ,  1.6326530612244896  ,  1.714285714285714   ,  1.7959183673469385  ,  3.428571428571428   ,  3.591836734693877   ,  3.755102040816326   ,  3.9183673469387754  ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.081632653061224   ,  4.244897959183673   ,  4.408163265306122   ,  4.571428571428571   ,  2.204081632653061   ,  2.2857142857142856  ,  2.36734693877551    ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244896  ,  1.714285714285714   ,  1.7959183673469385  ,  3.428571428571428   ,  3.591836734693877   ,  3.755102040816326   ,  3.9183673469387754  ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.081632653061224   ,  4.244897959183673   ,  4.408163265306122   ,  4.571428571428571   ,  2.204081632653061   ,  2.2857142857142856  ,  2.36734693877551    ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244896  ,  1.714285714285714   ,  1.7959183673469385  ,  3.428571428571428   ,  3.591836734693877   ,  3.755102040816326   ,  3.9183673469387754  ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.081632653061224   ,  4.244897959183673   ,  4.408163265306122   ,  4.571428571428571   ,  2.204081632653061   ,  2.2857142857142856  ,  2.36734693877551    ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244896  ,  1.714285714285714   ,  1.7959183673469385  ,  3.428571428571428   ,  3.591836734693877   ,  3.755102040816326   ,  3.9183673469387754  ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.081632653061224   ,  4.244897959183673   ,  4.408163265306122   ,  4.571428571428571   ,  2.204081632653061   ,  2.2857142857142856  ,  2.36734693877551    ,  2.4489795918367347  ,  1.530612244897959   ,  1.5918367346938775  ,  1.6530612244897958  ,  1.714285714285714   ,  3.3061224489795915  ,  3.4285714285714284  ,  3.551020408163265   ,  3.6734693877551017  ,  5.326530612244897   ,  5.5102040816326525  ,  5.693877551020407   ,  5.877551020408164   ,  5.326530612244897   ,  5.5102040816326525  ,  5.693877551020407   ,  5.877551020408164   ,  5.326530612244897   ,  5.5102040816326525  ,  5.693877551020407   ,  5.877551020408164   ,  5.326530612244897   ,  5.5102040816326525  ,  5.693877551020407   ,  5.877551020408164   ,  5.326530612244897   ,  5.5102040816326525  ,  5.693877551020407   ,  5.877551020408164   ,  3.7959183673469385  ,  3.9183673469387754  ,  4.040816326530612   ,  4.163265306122449   ,  2.020408163265306   ,  2.0816326530612246  ,  2.142857142857143   ,  2.204081632653061   ,  1.2653061224489797  ,  1.3061224489795917  ,  1.3469387755102038  ,  1.387755102040816   ,  2.693877551020408   ,  2.7755102040816326  ,  2.8571428571428568  ,  2.9387755102040813  ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897959   ,  4.653061224489796   ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897959   ,  4.653061224489796   ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897959   ,  4.653061224489796   ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897959   ,  4.653061224489796   ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897959   ,  4.653061224489796   ,  3.020408163265306   ,  3.1020408163265305  ,  3.1836734693877546  ,  3.2653061224489797  ,  1.5918367346938775  ,  1.6326530612244898  ,  1.673469387755102   ,  1.7142857142857142  ,  0.7551020408163265  ,  0.7755102040816326  ,  0.7959183673469387  ,  0.8163265306122448  ,  1.5918367346938775  ,  1.6326530612244898  ,  1.673469387755102   ,  1.714285714285714   ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  2.510204081632653   ,  2.571428571428571   ,  2.63265306122449    ,  2.6938775510204076  ,  1.7551020408163263  ,  1.7959183673469385  ,  1.8367346938775508  ,  1.8775510204081631  ,  0.9183673469387754  ,  0.9387755102040816  ,  0.9591836734693877  ,  0.9795918367346939  ,  0.9999999999999999  ,  1.0204081632653061  ,  1.040816326530612   ,  1.0612244897959182  ,  2.081632653061224   ,  2.1224489795918364  ,  2.1632653061224487  ,  2.204081632653061   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  2.2448979591836733  ,  2.2857142857142856  ,  2.326530612244898   ,  2.36734693877551    ,  1.163265306122449   ,  1.183673469387755   ,  1.2040816326530612  ,  1.2244897959183672  ,  2.2448979591836733  ,  2.2857142857142856  ,  2.3265306122448974  ,  2.36734693877551    ,  4.653061224489795   ,  4.73469387755102    ,  4.816326530612244   ,  4.897959183673469   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  7.224489795918366   ,  7.346938775510203   ,  7.469387755102041   ,  7.591836734693876   ,  4.979591836734693   ,  5.061224489795919   ,  5.142857142857142   ,  5.224489795918367   ,  2.571428571428571   ,  2.6122448979591835  ,  2.6530612244897958  ,  2.6938775510204076  ,  3.7346938775510203  ,  3.7959183673469385  ,  3.8571428571428568  ,  3.9183673469387754  ,  7.714285714285713   ,  7.83673469387755    ,  7.959183673469386   ,  8.081632653061224   , 11.938775510204081   , 12.122448979591836   , 12.306122448979592   , 12.489795918367346   , 11.938775510204081   , 12.122448979591836   , 12.306122448979592   , 12.489795918367346   , 11.938775510204081   , 12.122448979591836   , 12.306122448979592   , 12.489795918367346   , 11.938775510204081   , 12.122448979591836   , 12.306122448979592   , 12.489795918367346   , 11.938775510204081   , 12.122448979591836   , 12.306122448979592   , 12.489795918367346   ,  8.204081632653061   ,  8.326530612244898   ,  8.448979591836734   ,  8.571428571428571   ,  4.224489795918367   ,  4.285714285714286   ,  4.346938775510203   ,  4.408163265306122   ,  5.469387755102041   ,  5.551020408163265   ,  5.632653061224489   ,  5.7142857142857135  , 11.265306122448976   , 11.428571428571427   , 11.591836734693876   , 11.755102040816325   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 11.918367346938775   , 12.081632653061224   , 12.244897959183673   , 12.408163265306122   ,  6.122448979591836   ,  6.204081632653061   ,  6.285714285714285   ,  6.36734693877551    ,  5.469387755102041   ,  5.551020408163265   ,  5.632653061224489   ,  5.7142857142857135  , 11.265306122448976   , 11.428571428571427   , 11.591836734693876   , 11.755102040816325   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 11.918367346938775   , 12.081632653061224   , 12.244897959183673   , 12.408163265306122   ,  6.122448979591836   ,  6.204081632653061   ,  6.285714285714285   ,  6.36734693877551    ,  5.469387755102041   ,  5.551020408163265   ,  5.632653061224489   ,  5.7142857142857135  , 11.265306122448976   , 11.428571428571427   , 11.591836734693876   , 11.755102040816325   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 11.918367346938775   , 12.081632653061224   , 12.244897959183673   , 12.408163265306122   ,  6.122448979591836   ,  6.204081632653061   ,  6.285714285714285   ,  6.36734693877551    ,  5.469387755102041   ,  5.551020408163265   ,  5.632653061224489   ,  5.7142857142857135  , 11.265306122448976   , 11.428571428571427   , 11.591836734693876   , 11.755102040816325   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 17.387755102040813   , 17.632653061224488   , 17.877551020408163   , 18.122448979591834   , 11.918367346938775   , 12.081632653061224   , 12.244897959183673   , 12.408163265306122   ,  6.122448979591836   ,  6.204081632653061   ,  6.285714285714285   ,  6.36734693877551    ,  4.469387755102041   ,  4.530612244897958   ,  4.591836734693877   ,  4.653061224489795   ,  9.183673469387754   ,  9.30612244897959    ,  9.428571428571429   ,  9.551020408163264   , 14.14285714285714    , 14.326530612244898   , 14.510204081632653   , 14.693877551020408   , 14.14285714285714    , 14.326530612244898   , 14.510204081632653   , 14.693877551020408   , 14.14285714285714    , 14.326530612244898   , 14.510204081632653   , 14.693877551020408   , 14.14285714285714    , 14.326530612244898   , 14.510204081632653   , 14.693877551020408   , 14.14285714285714    , 14.326530612244898   , 14.510204081632653   , 14.693877551020408   ,  9.673469387755102   ,  9.795918367346937   ,  9.918367346938776   , 10.040816326530612   ,  4.959183673469387   ,  5.020408163265306   ,  5.081632653061224   ,  5.142857142857142   ,  3.224489795918367   ,  3.2653061224489797  ,  3.3061224489795915  ,  3.346938775510204   ,  6.612244897959184   ,  6.693877551020408   ,  6.775510204081631   ,  6.857142857142856   , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    , 10.163265306122447   , 10.285714285714285   , 10.408163265306122   , 10.53061224489796    ,  6.938775510204081   ,  7.020408163265306   ,  7.10204081632653    ,  7.183673469387754   ,  3.5510204081632653  ,  3.591836734693877   ,  3.63265306122449    ,  3.6734693877551017  ,  1.7346938775510203  ,  1.7551020408163265  ,  1.7755102040816324  ,  1.7959183673469385  ,  3.5510204081632653  ,  3.591836734693877   ,  3.6326530612244894  ,  3.6734693877551017  ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  5.448979591836735   ,  5.5102040816326525  ,  5.571428571428571   ,  5.63265306122449    ,  3.714285714285714   ,  3.7551020408163263  ,  3.7959183673469385  ,  3.836734693877551   ,  1.8979591836734693  ,  1.9183673469387754  ,  1.9387755102040816  ,  1.9591836734693877  ,  1.9795918367346936  ,  1.9999999999999998  ,  2.020408163265306   ,  2.0408163265306123  ,  4.040816326530612   ,  4.081632653061224   ,  4.122448979591836   ,  4.163265306122449   ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  6.183673469387754   ,  6.244897959183673   ,  6.3061224489795915  ,  6.36734693877551    ,  4.204081632653061   ,  4.244897959183673   ,  4.285714285714286   ,  4.326530612244897   ,  2.142857142857143   ,  2.1632653061224487  ,  2.183673469387755   ,  2.204081632653061   ,  4.204081632653061   ,  4.244897959183673   ,  4.285714285714285   ,  4.326530612244898   ,  8.571428571428571   ,  8.653061224489795   ,  8.734693877551019   ,  8.816326530612244   , 13.102040816326529   , 13.224489795918366   , 13.346938775510203   , 13.46938775510204    , 13.102040816326529   , 13.224489795918366   , 13.346938775510203   , 13.46938775510204    , 13.102040816326529   , 13.224489795918366   , 13.346938775510203   , 13.46938775510204    , 13.102040816326529   , 13.224489795918366   , 13.346938775510203   , 13.46938775510204    , 13.102040816326529   , 13.224489795918366   , 13.346938775510203   , 13.46938775510204    ,  8.897959183673468   ,  8.979591836734693   ,  9.061224489795919   ,  9.142857142857142   ,  4.530612244897959   ,  4.571428571428571   ,  4.612244897959183   ,  4.653061224489795   ,  6.673469387755102   ,  6.7346938775510194  ,  6.795918367346937   ,  6.857142857142858   , 13.591836734693878   , 13.714285714285714   , 13.836734693877549   , 13.959183673469386   , 20.755102040816322   , 20.93877551020408    , 21.122448979591834   , 21.30612244897959    , 20.755102040816322   , 20.93877551020408    , 21.122448979591834   , 21.30612244897959    , 20.755102040816322   , 20.93877551020408    , 21.122448979591834   , 21.30612244897959    , 20.755102040816322   , 20.93877551020408    , 21.122448979591834   , 21.30612244897959    , 20.755102040816322   , 20.93877551020408    , 21.122448979591834   , 21.30612244897959    , 14.081632653061222   , 14.204081632653061   , 14.326530612244898   , 14.448979591836734   ,  7.163265306122449   ,  7.224489795918367   ,  7.285714285714285   ,  7.346938775510203   ,  9.387755102040815   ,  9.46938775510204    ,  9.551020408163264   ,  9.63265306122449    , 19.102040816326532   , 19.265306122448976   , 19.428571428571423   , 19.591836734693878   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 19.755102040816322   , 19.918367346938773   , 20.081632653061224   , 20.24489795918367    , 10.040816326530612   , 10.122448979591836   , 10.204081632653061   , 10.285714285714285   ,  9.387755102040815   ,  9.46938775510204    ,  9.551020408163264   ,  9.63265306122449    , 19.102040816326532   , 19.265306122448976   , 19.428571428571423   , 19.591836734693878   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 19.755102040816322   , 19.918367346938773   , 20.081632653061224   , 20.24489795918367    , 10.040816326530612   , 10.122448979591836   , 10.204081632653061   , 10.285714285714285   ,  9.387755102040815   ,  9.46938775510204    ,  9.551020408163264   ,  9.63265306122449    , 19.102040816326532   , 19.265306122448976   , 19.428571428571423   , 19.591836734693878   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 19.755102040816322   , 19.918367346938773   , 20.081632653061224   , 20.24489795918367    , 10.040816326530612   , 10.122448979591836   , 10.204081632653061   , 10.285714285714285   ,  9.387755102040815   ,  9.46938775510204    ,  9.551020408163264   ,  9.63265306122449    , 19.102040816326532   , 19.265306122448976   , 19.428571428571423   , 19.591836734693878   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 29.14285714285714    , 29.387755102040813   , 29.632653061224485   , 29.877551020408163   , 19.755102040816322   , 19.918367346938773   , 20.081632653061224   , 20.24489795918367    , 10.040816326530612   , 10.122448979591836   , 10.204081632653061   , 10.285714285714285   ,  7.408163265306122   ,  7.469387755102041   ,  7.530612244897958   ,  7.591836734693876   , 15.061224489795917   , 15.183673469387752   , 15.306122448979592   , 15.428571428571427   , 22.959183673469386   , 23.14285714285714    , 23.3265306122449     , 23.510204081632654   , 22.959183673469386   , 23.14285714285714    , 23.3265306122449     , 23.510204081632654   , 22.959183673469386   , 23.14285714285714    , 23.3265306122449     , 23.510204081632654   , 22.959183673469386   , 23.14285714285714    , 23.3265306122449     , 23.510204081632654   , 22.959183673469386   , 23.14285714285714    , 23.3265306122449     , 23.510204081632654   , 15.551020408163264   , 15.6734693877551     , 15.795918367346939   , 15.918367346938773   ,  7.897959183673468   ,  7.959183673469388   ,  8.020408163265305   ,  8.081632653061224   ,  5.183673469387754   ,  5.224489795918367   ,  5.26530612244898    ,  5.3061224489795915  , 10.53061224489796    , 10.612244897959183   , 10.693877551020407   , 10.77551020408163    , 16.04081632653061    , 16.163265306122447   , 16.285714285714285   , 16.408163265306122   , 16.04081632653061    , 16.163265306122447   , 16.285714285714285   , 16.408163265306122   , 16.04081632653061    , 16.163265306122447   , 16.285714285714285   , 16.408163265306122   , 16.04081632653061    , 16.163265306122447   , 16.285714285714285   , 16.408163265306122   , 16.04081632653061    , 16.163265306122447   , 16.285714285714285   , 16.408163265306122   , 10.857142857142856   , 10.938775510204081   , 11.020408163265305   , 11.102040816326529   ,  5.5102040816326525  ,  5.551020408163264   ,  5.591836734693877   ,  5.63265306122449    ,  2.714285714285714   ,  2.7346938775510203  ,  2.7551020408163263  ,  2.7755102040816326  ,  5.5102040816326525  ,  5.551020408163264   ,  5.591836734693877   ,  5.63265306122449    ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  5.673469387755102   ,  5.7142857142857135  ,  5.755102040816326   ,  5.795918367346938   ,  2.877551020408163   ,  2.897959183673469   ,  2.9183673469387754  ,  2.9387755102040813  };
  const std::array<int, 4> in_shape = {{ 3, 10, 9, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {  8.613361678004535,  10.5300283446712  ,  12.555198412698413,  14.688871882086168,  14.710102040816327,  15.773435374149658,  18.094070294784576,  16.285907029478455,  14.36924036281179 ,  12.344070294784583,  13.199416099773241,  16.034450113378682,  18.998395691609975,  22.091252834467117,  21.791054421768706,  23.054387755102034,  26.136927437641713,  23.430804988662125,  20.595770975056684,  17.6318253968254  ,  18.87050453514739 ,  22.82798752834467 ,  26.93479024943311 ,  31.1909126984127  ,  30.450238095238095,  31.913571428571423,  35.877063492063485,  32.068900226757364,  28.111417233560083,  24.004614512471655,  25.626626984126982,  30.910640589569162,  36.3643820861678  ,  41.9878514739229  ,  40.68765306122449 ,  42.350986394557815,  47.31447845804988 ,  42.20019274376416 ,  36.916179138321986,  31.46243764172336 ,  34.34428571428571 ,  41.23544217687075 ,  48.28442176870748 ,  55.49122448979592 ,  53.128526077097504,  54.67519274376416 ,  60.44424036281178 ,  53.71090702947845 ,  46.81975056689342 ,  39.770770975056685,  44.97761904761904 ,  53.86877551020408 ,  62.917755102040815,  72.12455782312925 ,  68.59519274376417 ,  70.14185941043084 ,  77.07757369614512 ,  68.34424036281179 ,  59.45308390022675 ,  50.40410430839003 ,  59.67861111111111 ,  71.36738662131519 ,  83.22589002267573 ,  95.25412131519273 ,  90.2178117913832  ,  91.88114512471654 , 100.58074829931971 ,  89.06170068027211 ,  77.37292517006803 ,  65.51442176870749 ,  56.17759070294784 ,  67.15208049886621 ,  78.27589002267572 ,  89.5490192743764  ,  84.71509070294783 ,  86.17842403628117 ,  94.2351700680272  ,  83.41             ,  72.43551020408164 ,  61.31170068027211 ,  51.59153628117914 ,  61.64765873015873 ,  71.83269274376417 ,  82.14663832199545 ,  77.63413832199545 ,  78.89747165532879 ,  86.19231292517006 ,  76.26510204081633 ,  66.20897959183674 ,  56.0239455782313  ,  45.920447845804986,  54.85412131519274 ,  63.89629818594105 ,  73.04697845804988 ,  68.97495464852608 ,  70.03828798185941 ,  76.4521768707483  ,  67.6270068027211  ,  58.693333333333335,  49.651156462585035,  66.30100340136055 ,  79.06801020408163 ,  91.94352040816328 , 104.92753401360545 ,  98.61939909297054 ,  99.68273242630386 , 108.33273242630385 ,  95.67422902494332 ,  82.90722222222223 ,  70.03171201814058 ,  81.73739795918367 ,  97.46358843537413 , 113.31869047619048 , 129.30270408163267 , 121.48266439909298 , 122.74599773242629 , 133.34837868480724 , 117.75109977324263 , 102.02490929705216 ,  86.16980725623581 ,  98.25882653061223 , 117.14828231292515 , 136.18705782312924 , 155.3751530612245  , 145.92416099773243 , 147.38749433106574 , 160.06130385487526 , 141.32116780045354 , 122.43171201814059 , 103.39293650793648 , 115.86528911564625 , 138.12209183673468 , 160.5486224489796  , 183.14488095238096 , 171.9438888888889  , 173.6072222222222  , 188.47150793650792 , 166.38443310657598 , 144.12763038548752 , 121.7010997732426  , 118.2535827664399  , 140.92705215419497 , 163.7583446712017  , 186.74746031746025 , 175.17841269841267 , 176.72507936507932 , 191.70047619047622 , 169.18482993197276 , 146.51136054421767 , 123.68006802721085 , 128.88691609977326 , 153.56038548752835 , 178.39167800453512 , 203.3807936507936  , 190.64507936507937 , 192.19174603174605 , 208.33380952380955 , 183.81816326530614 , 159.14469387755102 , 134.31340136054422 , 149.91727324263036 , 178.57883786848072 , 207.4101303854875  , 236.41115079365082 , 221.4740476190476  , 223.13738095238097 , 241.73777777777775 , 213.24594104308392 , 184.58437641723353 , 155.75308390022676 , 135.56591269841266 , 161.47237528344667 , 187.52815759637184 , 213.7332596371882  , 200.18901360544217 , 201.65234693877548 , 218.41941043083898 , 192.66226757369614 , 166.7558049886621  , 140.70002267573696 , 120.12951814058957 , 143.07679705215418 , 166.15298752834465 , 189.35808956916097 , 177.3257482993197  , 178.589081632653   , 193.40376417233557 , 170.5853968253968  , 147.6381179138322  , 124.56192743764173 , 103.608089569161   , 123.39210317460318 , 143.2846201814059  , 163.28564058956914 , 152.88425170068027 , 153.94758503401357 , 166.69083900226755 , 147.01532879818592 , 127.23131519274378 , 107.33879818594104 , 123.98864512471656 , 147.60599206349204 , 171.3318424036281  , 195.16619614512473 , 182.52869614512468 , 183.59202947845804 , 198.57139455782314 , 175.06255102040816 , 151.44520408163265 , 127.71935374149658 , 150.2753798185941  , 178.8927267573696  , 207.63898526077094 , 236.51415532879818 , 221.17427437641717 , 222.43760770975052 , 240.55982993197276 , 212.07139455782308 , 183.4540476190476  , 154.7077891156462  , 177.64714852607707 , 211.46857709750563 , 245.43932539682535 , 279.55939342403633 , 261.3980839002267  , 262.86141723356    , 284.24554421768704 , 250.57343537414962 , 216.75200680272107 , 182.7812585034013  , 206.10395124716553 , 245.3335430839002  , 284.7328628117914  , 324.3019104308391  , 303.2001247165533  , 304.8634580498867  , 329.6285374149661  , 290.5686734693878  , 251.33908163265303 , 211.93976190476184 , 202.1628798185941  , 240.61866213151927 , 279.2322675736961  , 318.0036961451247  , 297.2282993197278  , 298.77496598639453 , 322.9567120181406  , 284.6587528344671  , 246.20297052154194 , 207.58936507936508 , 212.79621315192742 , 253.25199546485257 , 293.8656009070295  , 334.637029478458   , 312.6949659863946  , 314.24163265306123 , 339.5900453514739  , 299.29208616780045 , 258.83630385487527 , 218.2226984126984  , 240.15593537414964 , 285.7902891156462  , 331.5943707482993  , 377.5681802721088  , 352.730283446712   , 354.3936167800453  , 382.8948072562358  , 337.4301814058956  , 291.7958276643991  , 245.991746031746   , 214.95423469387754 , 255.7926700680272  , 296.780425170068   , 337.91749999999996 , 315.6629365079365  , 317.12626984126985 , 342.60365079365073 , 301.91453514739226 , 261.0760997732426  , 220.0883446712018  , 188.6675           , 224.50593537414963 , 260.47328231292516 , 296.5695408163265  , 277.017358276644   , 278.2806916099773  , 300.6152154195011  , 264.90569160997734 , 229.06725623582767 , 193.09990929705214 , 161.29573129251702 , 191.9300850340136  , 222.67294217687075 , 253.5243027210884  , 236.79354875283448 , 237.8568820861678  , 256.9295011337868  , 226.40365079365077 , 195.7692970521542  , 165.02643990929704 };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 1 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.061224489795918366,  0.12244897959183673 ,  0.20408163265306123 ,  0.20408163265306123 ,  0.20408163265306123 ,  0.20408163265306123 ,  0.18367346938775508 ,  0.14285714285714285 ,  0.08163265306122448 ,  0.12244897959183672 ,  0.2857142857142857  ,  0.48979591836734687 ,  0.7346938775510203  ,  0.7346938775510203  ,  0.7346938775510203  ,  0.7346938775510203  ,  0.6122448979591837  ,  0.44897959183673464 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.673469387755102   ,  1.1020408163265305  ,  1.5918367346938775  ,  1.5918367346938775  ,  1.5918367346938775  ,  1.5918367346938775  ,  1.2857142857142858  ,  0.9183673469387754  ,  0.4897959183673469  ,  0.5714285714285714  ,  1.2244897959183674  ,  1.9591836734693875  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.2040816326530615  ,  1.551020408163265   ,  0.8163265306122449  ,  0.5714285714285714  ,  1.2244897959183674  ,  1.9591836734693875  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.2040816326530615  ,  1.551020408163265   ,  0.8163265306122449  ,  0.5714285714285714  ,  1.2244897959183674  ,  1.9591836734693875  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.2040816326530615  ,  1.551020408163265   ,  0.8163265306122449  ,  0.5714285714285714  ,  1.2244897959183674  ,  1.9591836734693875  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.7755102040816326  ,  2.2040816326530615  ,  1.551020408163265   ,  0.8163265306122449  ,  0.5510204081632653  ,  1.1632653061224487  ,  1.8367346938775506  ,  2.571428571428571   ,  2.571428571428571   ,  2.571428571428571   ,  2.571428571428571   ,  2.020408163265306   ,  1.4081632653061222  ,  0.7346938775510203  ,  0.44897959183673464 ,  0.9387755102040816  ,  1.4693877551020407  ,  2.0408163265306123  ,  2.0408163265306123  ,  2.0408163265306123  ,  2.0408163265306123  ,  1.5918367346938773  ,  1.1020408163265305  ,  0.5714285714285714  ,  0.26530612244897955 ,  0.5510204081632653  ,  0.857142857142857   ,  1.1836734693877549  ,  1.1836734693877549  ,  1.1836734693877549  ,  1.1836734693877549  ,  0.9183673469387754  ,  0.6326530612244897  ,  0.32653061224489793 ,  0.3469387755102041  ,  0.7142857142857142  ,  1.1020408163265305  ,  1.510204081632653   ,  1.510204081632653   ,  1.510204081632653   ,  1.510204081632653   ,  1.163265306122449   ,  0.7959183673469388  ,  0.4081632653061224  ,  0.7755102040816326  ,  1.5918367346938775  ,  2.4489795918367343  ,  3.346938775510204   ,  3.346938775510204   ,  3.346938775510204   ,  3.346938775510204   ,  2.571428571428571   ,  1.7551020408163267  ,  0.8979591836734693  ,  1.2857142857142856  ,  2.63265306122449    ,  4.040816326530612   ,  5.5102040816326525  ,  5.5102040816326525  ,  5.5102040816326525  ,  5.5102040816326525  ,  4.224489795918367   ,  2.8775510204081636  ,  1.4693877551020407  ,  1.8775510204081631  ,  3.836734693877551   ,  5.877551020408164   ,  8.                  ,  8.                  ,  8.                  ,  8.                  ,  6.122448979591836   ,  4.163265306122449   ,  2.1224489795918364  ,  1.8775510204081631  ,  3.836734693877551   ,  5.877551020408164   ,  8.                  ,  8.                  ,  8.                  ,  8.                  ,  6.122448979591836   ,  4.163265306122449   ,  2.1224489795918364  ,  1.8775510204081631  ,  3.836734693877551   ,  5.877551020408164   ,  8.                  ,  8.                  ,  8.                  ,  8.                  ,  6.122448979591836   ,  4.163265306122449   ,  2.1224489795918364  ,  1.8775510204081631  ,  3.836734693877551   ,  5.877551020408164   ,  8.                  ,  8.                  ,  8.                  ,  8.                  ,  6.122448979591836   ,  4.163265306122449   ,  2.1224489795918364  ,  1.530612244897959   ,  3.122448979591836   ,  4.775510204081632   ,  6.489795918367346   ,  6.489795918367346   ,  6.489795918367346   ,  6.489795918367346   ,  4.959183673469386   ,  3.36734693877551    ,  1.714285714285714   ,  1.1020408163265305  ,  2.2448979591836733  ,  3.4285714285714284  ,  4.653061224489796   ,  4.653061224489796   ,  4.653061224489796   ,  4.653061224489796   ,  3.551020408163265   ,  2.408163265306122   ,  1.2244897959183674  ,  0.5918367346938775  ,  1.204081632653061   ,  1.8367346938775508  ,  2.4897959183673466  ,  2.4897959183673466  ,  2.4897959183673466  ,  2.4897959183673466  ,  1.897959183673469   ,  1.2857142857142856  ,  0.6530612244897959  ,  0.673469387755102   ,  1.3673469387755102  ,  2.0816326530612246  ,  2.816326530612245   ,  2.816326530612245   ,  2.816326530612245   ,  2.816326530612245   ,  2.142857142857143   ,  1.4489795918367345  ,  0.7346938775510203  ,  1.4285714285714284  ,  2.897959183673469   ,  4.408163265306122   ,  5.959183673469387   ,  5.959183673469387   ,  5.959183673469387   ,  5.959183673469387   ,  4.530612244897958   ,  3.061224489795918   ,  1.5510204081632653  ,  2.265306122448979   ,  4.591836734693877   ,  6.979591836734693   ,  9.428571428571427   ,  9.428571428571427   ,  9.428571428571427   ,  9.428571428571427   ,  7.163265306122448   ,  4.836734693877551   ,  2.4489795918367347  ,  3.1836734693877546  ,  6.448979591836734   ,  9.795918367346939   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 10.040816326530612   ,  6.775510204081633   ,  3.428571428571429   ,  3.1836734693877546  ,  6.448979591836734   ,  9.795918367346939   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 10.040816326530612   ,  6.775510204081633   ,  3.428571428571429   ,  3.1836734693877546  ,  6.448979591836734   ,  9.795918367346939   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 10.040816326530612   ,  6.775510204081633   ,  3.428571428571429   ,  3.1836734693877546  ,  6.448979591836734   ,  9.795918367346939   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 13.224489795918366   , 10.040816326530612   ,  6.775510204081633   ,  3.428571428571429   ,  2.510204081632653   ,  5.081632653061224   ,  7.7142857142857135  , 10.408163265306122   , 10.408163265306122   , 10.408163265306122   , 10.408163265306122   ,  7.897959183673469   ,  5.326530612244897   ,  2.6938775510204076  ,  1.7551020408163263  ,  3.5510204081632653  ,  5.387755102040815   ,  7.265306122448979   ,  7.265306122448979   ,  7.265306122448979   ,  7.265306122448979   ,  5.510204081632653   ,  3.7142857142857144  ,  1.8775510204081631  ,  0.9183673469387754  ,  1.857142857142857   ,  2.816326530612245   ,  3.795918367346939   ,  3.795918367346939   ,  3.795918367346939   ,  3.795918367346939   ,  2.877551020408163   ,  1.9387755102040816  ,  0.9795918367346939  };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 1 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 16.64984693877551 ,  17.22672335600907 ,  20.374676870748296,  21.0600566893424  ,  24.31651360544218 ,  25.110396825396826,  28.475357142857142,  29.377743764172337,  28.581111111111106,  29.420204081632654,  30.707777777777775,  31.546870748299316,  35.285753968253964,  36.18814058956915 ,  31.77793083900226 ,  32.57181405895691 ,  28.053100907029474,  28.73848072562358 ,  24.111264172335602,  24.688140589569166,  25.713452380952383,  26.398832199546483,  31.25460884353741 ,  32.068900226757364,  37.053588435374145,  37.99679138321995 ,  43.11039115646258 ,  44.18250566893423 ,  42.58519274376416 ,  43.58210884353741 ,  45.11185941043083 ,  46.10877551020407 ,  51.20174036281178 ,  52.273854875283426,  45.918407029478445,  46.86160997732425 ,  40.377250566893416,  41.19154195011337 ,  34.57827097505669 ,  35.2636507936508  ,  36.947125850340136,  37.74100907029478 ,  44.71277210884353 ,  45.65597505668934 ,  52.77705782312924 ,  53.86958049886622 ,  61.13998299319727 ,  62.3818253968254  ,  59.745736961451236,  60.90047619047619 ,  62.672403628117905,  63.827142857142846,  70.51228458049886 ,  71.75412698412697 ,  63.04527777777776 ,  64.13780045351473 ,  55.27963151927437 ,  56.222834467120165,  47.215345804988665,  48.00922902494331 ,  50.35086734693877 ,  51.253253968253965,  60.74916666666665 ,  61.821281179138325,  71.48692176870746 ,  72.7287641723356  ,  82.56413265306122 ,  83.9757029478458  ,  80.06274376417231 ,  81.37530612244898 ,  83.38941043083898 ,  84.70197278911563 ,  93.21738662131516 ,  94.62895691609975 ,  83.1585430839002  ,  84.40038548752833 ,  72.76024376417232 ,  73.83235827664397 ,  62.02248866213152 ,  62.92487528344672 ,  67.84947845804989 ,  68.68857142857142 ,  81.47396825396824 ,  82.4708843537415  ,  95.41410430839    ,  96.56884353741496 , 109.66988662131516 , 110.98244897959184 , 105.03655328798182 , 106.25705215419501 , 108.12988662131517 , 109.35038548752831 , 119.5759183673469  , 120.88848072562357 , 106.26707482993194 , 107.4218140589569  ,  92.64258503401359 ,  93.63950113378684 ,  78.70244897959184 ,  79.54154195011337 ,  89.11614512471654 ,  89.95523809523807 , 106.7406349206349  , 107.73755102040816 , 124.68077097505666 , 125.83551020408163 , 142.9365532879818  , 144.2491156462585  , 135.96988662131517 , 137.19038548752835 , 139.0632199546485  , 140.28371882086168 , 152.84258503401358 , 154.15514739229025 , 135.5337414965986  , 136.68848072562358 , 117.90925170068026 , 118.9061678004535  ,  99.96911564625852 , 100.80820861678006 , 118.45483560090703 , 119.35722222222222 , 141.6626587301587  , 142.73477324263038 , 165.20993764172334 , 166.45178004535146 , 189.09667233560086 , 190.50824263038547 , 179.12306122448976 , 180.4356235827664  , 182.44972789115644 , 183.76229024943308 , 199.74992630385483 , 201.16149659863942 , 176.88155895691605 , 178.12340136054422 , 153.6737358276644  , 154.74585034013606 , 130.12645691609978 , 131.02884353741499 , 111.56129818594104 , 112.35518140589568 , 133.36095804988662 , 134.30416099773242 , 155.45925736961448 , 156.55178004535145 , 177.8561961451247  , 179.0980385487528  , 168.2754421768707  , 169.43018140589567 , 171.2021088435374  , 172.35684807256234 , 187.22849773242626 , 188.4703401360544  , 165.72747732426302 , 166.82             , 143.92781746031744 , 144.87102040816328 , 121.82951814058958 , 122.62340136054422 , 102.49769274376418 , 103.18307256235828 , 122.4810260770975  , 123.29531746031746 , 142.72218253968254 , 143.66538548752834 , 163.22116213151926 , 164.2932766439909  , 154.27136054421766 , 155.2682766439909  , 156.79802721088433 , 157.79494331065757 , 171.31251133786847 , 172.38462585034011 , 151.58700113378683 , 152.53020408163266 , 131.6036678004535  , 132.41795918367347 , 111.36251133786848 , 112.0478911564626  ,  91.26401927437644 ,  91.84089569160997 , 109.02286281179138 , 109.70824263038548 , 126.99871315192743 , 127.7925963718821  , 145.19157029478458 , 146.09395691609976 , 137.1108163265306  , 137.94990929705216 , 139.2374829931973  , 140.07657596371882 , 152.00196712018138 , 152.9043537414966  , 134.46013038548753 , 135.2540136054422  , 116.70128684807256 , 117.38666666666667 ,  98.72543650793651 ,  99.30231292517007 , 132.02513038548753 , 132.6020068027211  , 157.45064058956916 , 158.13602040816326 , 183.09315759637187 , 183.88704081632656 , 208.95268140589567 , 209.8550680272109  , 196.39970521541946 , 197.23879818594108 , 198.52637188208615 , 199.36546485260772 , 215.76307823129252 , 216.6654648526077  , 190.55457482993197 , 191.34845804988663 , 165.12906462585033 , 165.81444444444446 , 139.48654761904763 , 140.06342403628116 , 162.78941609977323 , 163.47479591836733 , 194.11288548752833 , 194.92717687074827 , 225.6941780045351  , 226.63738095238097 , 257.5332936507936  , 258.60540816326534 , 241.96841269841264 , 242.96532879818596 , 244.49507936507936 , 245.49199546485258 , 265.6246428571429  , 266.6967573696145  , 234.55899659863945 , 235.50219954648526 , 203.23552721088436 , 204.04981859410432 , 171.65423469387756 , 172.33961451247163 , 195.7237698412698  , 196.51765306122445 , 233.3533616780045  , 234.2965646258503  , 271.28159297052144 , 272.3741156462585  , 309.5084637188208  , 310.750306122449   , 290.6935827664398  , 291.84832199546486 , 293.6202494331066  , 294.7749886621315  , 318.8807653061225  , 320.1226077097505  , 281.5498129251701  , 282.6423356009071  , 243.92022108843537 , 244.86342403628117 , 205.99198979591836 , 206.78587301587297 , 230.8281916099773  , 231.7305782312925  , 275.1720691609977  , 276.24418367346937 , 319.855402494331   , 321.0972448979592  , 364.87819160997725 , 366.2897619047619  , 342.57521541950103 , 343.8877777777778  , 345.90188208616786 , 347.2144444444444  , 375.53144557823134 , 376.94301587301584 , 331.5270238095238  , 332.76886621315197 , 287.18314625850337 , 288.25526077097504 , 242.49981292517006 , 243.4021995464852  , 235.6680725623583  , 236.5071655328798  , 280.8571882086167  , 281.85410430838994 , 326.36195011337855 , 327.5166893424034  , 372.1823582766439  , 373.4949206349205  , 349.13632653061217 , 350.35682539682534 , 352.2296598639454  , 353.45015873015865 , 382.08839002267564 , 383.40095238095245 , 337.2149206349205  , 338.3696598639455  , 292.02580498866206 , 293.02272108843533 , 246.52104308390022 , 247.3601360544217  , 256.93473922902496 , 257.7738321995465  , 306.1238548752834  , 307.1207709750567  , 355.6286167800453  , 356.78335600907025 , 405.4490249433106  , 406.7615873015872  , 380.0696598639455  , 381.29015873015874 , 383.16299319727887 , 384.3834920634921  , 415.35505668934223 , 416.6676190476191  , 366.4815873015872  , 367.6363265306123  , 317.29247165532877 , 318.28938775510204 , 267.7877097505669  , 268.62680272108844 , 298.93215986394557 , 299.8345464852607  , 356.0855612244898  , 357.15767573696144 , 413.578418367347   , 414.820260770975   , 471.410731292517   , 472.82230158730164 , 441.6355328798186  , 442.9480952380952  , 444.96219954648524 , 446.27476190476193 , 482.0639852607709  , 483.4755555555555  , 425.2500396825397  , 426.49188208616783 , 368.09663832199544 , 369.16875283446706 , 310.6037811791383  , 311.5061678004535  , 270.33794217687074 , 271.1318253968253  , 322.00154761904764 , 322.94475056689333 , 373.9637925170069  , 375.0563151927437  , 426.2246768707483  , 427.4665192743764  , 399.22328798185936 , 400.37802721088434 , 402.1499546485261  , 403.30469387755096 , 435.5969784580499  , 436.83882086167796 , 384.2320124716553  , 385.3245351473923  , 332.56840702947846 , 333.5116099773242  , 280.6061621315193  , 281.4000453514739  , 239.57365646258506 , 240.25903628117914 , 285.3393027210885  , 286.15359410430835 , 331.36277210884356 , 332.3059750566893  , 377.6440646258504  , 378.71617913832193 , 353.6545804988662  , 354.6514965986394  , 356.1812471655329  , 357.178163265306   , 385.7354138321996  , 386.80752834467114 , 340.22759070294785 , 341.1707936507936  , 294.46194444444444 , 295.2762358276644  , 248.43847505668933 , 249.12385487528346 , 206.63930272108843 , 207.216179138322   , 246.09882653061226 , 246.78420634920636 , 285.77535714285716 , 286.5692403628118  , 325.66889455782314 , 326.5712811791383  , 304.92941043083897 , 305.76850340136053 , 307.05607709750564 , 307.89517006802714 , 332.47929138321996 , 333.3816780045351  , 293.23677437641726 , 294.03065759637184 , 253.7772505668934  , 254.46263038548756 , 214.10071995464853 , 214.6775963718821  , 247.40041383219955 , 247.9772902494331  , 294.52660430839    , 295.2119841269841  , 341.8698015873015  , 342.6636848072562  , 389.43000566893414 , 390.33239229024946 , 364.21829931972786 , 365.05739229024937 , 366.3449659863945  , 367.1840589569161  , 396.240402494331   , 397.1427891156463  , 349.3312188208616  , 350.12510204081633 , 302.2050283446711  , 302.8904081632653  , 254.8618310657596  , 255.43870748299315 , 299.86537981859414 , 300.5507596371882  , 356.9711621315193  , 357.7854535147392  , 414.33476757369607 , 415.2779705215419  , 471.95619614512464 , 473.02831065759636 , 441.3516326530612  , 442.34854875283435 , 443.87829931972783 , 444.87521541950105 , 480.04754535147384 , 481.1196598639455  , 423.1995861678003  , 424.14278911564617 , 366.09380385487515 , 366.9080952380952  , 308.7301984126983  , 309.4155782312924  , 354.50041383219957 , 355.29429705215415 , 421.99395124716557 , 422.93715419501126 , 489.7861281179138  , 490.8786507936507  , 547.4279648526077  , 548.6698072562359  , 499.0019727891156  , 500.1567120181404  , 487.30006802721084 , 488.4548072562357  , 511.69550453514734 , 512.9373469387755  , 444.5006065759636  , 445.5931292517006  , 377.0070691609976  , 377.9502721088435  , 309.21489229024934 , 310.0087755102039  , 355.7517743764172  , 356.65416099773233 , 423.59225056689337 , 424.6643650793649  , 491.77218253968243 , 493.0140249433105  , 549.842590702948   , 551.2541609977327  , 501.64278911564617 , 502.9553514739227  , 490.34088435374144 , 491.65344671201797 , 515.3910827664398  , 516.8026530612245  , 447.89006235827657 , 449.13190476190465 , 380.0495861678004  , 381.12170068027206 , 311.86965419501126 , 312.77204081632635 , 283.12022675736955 , 283.95931972789106 , 337.2345124716553  , 338.2314285714285  , 391.6644444444444  , 392.81918367346935 , 435.96104308390034 , 437.27360544217686 , 395.5181859410431  , 396.7386848072561  , 383.98294784580503 , 385.2034467120181  , 400.76231292517    , 402.07487528344666 , 346.9636734693878  , 348.11841269841267 , 292.84938775510204 , 293.84630385487526 , 238.41945578231292 , 239.25854875283446 , 226.61165532879815 , 227.45074829931977 , 270.09736961451244 , 271.0942857142857  , 313.8987301587302  , 315.05346938775506 , 347.5667573696145  , 348.8793197278911  , 313.32390022675736 , 314.5443990929705  , 301.78866213151935 , 303.00916099773235 , 312.3680272108844  , 313.6805895691609  , 269.1979591836735  , 270.3526984126983  , 225.7122448979591  , 226.70916099773243 , 181.91088435374147 , 182.74997732426303 , 184.04875850340136 , 184.95114512471662 , 219.59399659863945 , 220.66611111111115 , 255.47869047619045 , 256.7205328798186  , 281.2538605442177  , 282.6654308390023  , 251.8929478458049  , 253.2055102040817  , 240.59104308390016 , 241.90360544217688 , 246.8023526077097  , 248.21392290249432 , 211.59657029478458 , 212.8384126984127  , 176.05133219954647 , 177.12344671201816 , 140.16663832199544 , 141.0690249433107  , 133.75386054421767 , 134.54774376417234 , 159.72767006802718 , 160.67087301587307 , 186.00011904761902 , 187.0926417233561  , 202.1222278911564  , 203.36407029478465 , 177.91607709750562 , 179.07081632653072 , 166.21417233560092 , 167.36891156462585 , 166.3897675736961  , 167.63160997732425 , 140.7145975056689  , 141.80712018140593 , 114.74078798185936 , 115.68399092970526 ,  88.46833900226756 ,  89.26222222222222 ,  81.28889455782314 ,  81.9742743764172  ,  97.28311224489798 ,  98.09740362811789 , 113.5351530612245  , 114.47835600907027 , 119.596037414966   , 120.66815192743762 , 100.78274376417234 , 101.77965986394555 ,  88.68083900226756 ,  89.67775510204079 ,  82.58262471655328 ,  83.65473922902494 ,  66.84623015873015 ,  67.78943310657596 ,  50.852012471655335,  51.666303854875274,  34.5999716553288  ,  35.2853514739229  ,  26.65386054421769 ,  27.230736961451246,  32.2603231292517  ,  32.94570294784581 ,  38.0837925170068  ,  38.87767573696145 ,  44.124268707483   ,  45.02665532879819 ,  43.13240362811792 ,  43.971496598639455,  45.25907029478459 ,  46.09816326530612 ,  50.934665532879826,  51.83705215419501 ,  45.545209750566904,  46.339092970521534,  39.93874716553288 ,  40.62412698412698 ,  34.11527777777778 ,  34.69215419501134 };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 2 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612,  0.04081632653061224,  0.08163265306122448,  0.12244897959183673,  0.18367346938775508,  0.24489795918367346,  0.32653061224489793,  0.40816326530612246,  0.32653061224489793,  0.40816326530612246,  0.32653061224489793,  0.40816326530612246,  0.32653061224489793,  0.40816326530612246,  0.30612244897959184,  0.36734693877551017,  0.24489795918367346,  0.2857142857142857 ,  0.14285714285714285,  0.16326530612244897,  0.2040816326530612 ,  0.24489795918367344,  0.48979591836734687,  0.5714285714285714 ,  0.8571428571428571 ,  0.9795918367346937 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.3061224489795917 ,  1.4693877551020407 ,  1.1020408163265305 ,  1.2244897959183674 ,  0.8163265306122447 ,  0.8979591836734693 ,  0.44897959183673464,  0.4897959183673469 ,  0.5510204081632653 ,  0.6122448979591836 ,  1.2244897959183674 ,  1.346938775510204  ,  2.020408163265306  ,  2.204081632653061  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.938775510204081  ,  3.183673469387755  ,  2.387755102040816  ,  2.5714285714285716 ,  1.714285714285714  ,  1.8367346938775508 ,  0.9183673469387754 ,  0.9795918367346939 ,  1.0612244897959182 ,  1.1428571428571428 ,  2.2857142857142856 ,  2.4489795918367347 ,  3.6734693877551017 ,  3.918367346938775  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  4.163265306122448  ,  4.408163265306123  ,  2.9387755102040813 ,  3.10204081632653   ,  1.5510204081632653 ,  1.6326530612244898 ,  1.0612244897959182 ,  1.1428571428571428 ,  2.2857142857142856 ,  2.4489795918367347 ,  3.6734693877551017 ,  3.918367346938775  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  4.163265306122448  ,  4.408163265306123  ,  2.9387755102040813 ,  3.10204081632653   ,  1.5510204081632653 ,  1.6326530612244898 ,  1.0612244897959182 ,  1.1428571428571428 ,  2.2857142857142856 ,  2.4489795918367347 ,  3.6734693877551017 ,  3.918367346938775  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  4.163265306122448  ,  4.408163265306123  ,  2.9387755102040813 ,  3.10204081632653   ,  1.5510204081632653 ,  1.6326530612244898 ,  1.0612244897959182 ,  1.1428571428571428 ,  2.2857142857142856 ,  2.4489795918367347 ,  3.6734693877551017 ,  3.918367346938775  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  5.224489795918366  ,  5.551020408163265  ,  4.163265306122448  ,  4.408163265306123  ,  2.9387755102040813 ,  3.10204081632653   ,  1.5510204081632653 ,  1.6326530612244898 ,  1.0408163265306123 ,  1.1020408163265305 ,  2.204081632653061  ,  2.3265306122448974 ,  3.4897959183673466 ,  3.6734693877551012 ,  4.897959183673469  ,  5.142857142857142  ,  4.897959183673469  ,  5.142857142857142  ,  4.897959183673469  ,  5.142857142857142  ,  4.897959183673469  ,  5.142857142857142  ,  3.857142857142857  ,  4.040816326530612  ,  2.693877551020408  ,  2.8163265306122445 ,  1.4081632653061225 ,  1.4693877551020407 ,  0.8571428571428572 ,  0.8979591836734693 ,  1.7959183673469385 ,  1.8775510204081631 ,  2.816326530612245  ,  2.9387755102040813 ,  3.9183673469387754 ,  4.081632653061225  ,  3.9183673469387754 ,  4.081632653061225  ,  3.9183673469387754 ,  4.081632653061225  ,  3.9183673469387754 ,  4.081632653061225  ,  3.061224489795918  ,  3.1836734693877546 ,  2.1224489795918364 ,  2.204081632653061  ,  1.1020408163265305 ,  1.1428571428571428 ,  0.5102040816326531 ,  0.5306122448979591 ,  1.0612244897959182 ,  1.1020408163265305 ,  1.6530612244897958 ,  1.714285714285714  ,  2.2857142857142856 ,  2.3673469387755097 ,  2.2857142857142856 ,  2.3673469387755097 ,  2.2857142857142856 ,  2.3673469387755097 ,  2.2857142857142856 ,  2.3673469387755097 ,  1.7755102040816326 ,  1.8367346938775508 ,  1.2244897959183674 ,  1.2653061224489794 ,  0.6326530612244897 ,  0.6530612244897959 ,  0.673469387755102  ,  0.6938775510204082 ,  1.387755102040816  ,  1.4285714285714284 ,  2.1428571428571423 ,  2.204081632653061  ,  2.938775510204081  ,  3.020408163265306  ,  2.938775510204081  ,  3.020408163265306  ,  2.938775510204081  ,  3.020408163265306  ,  2.938775510204081  ,  3.020408163265306  ,  2.265306122448979  ,  2.326530612244898  ,  1.5510204081632653 ,  1.5918367346938775 ,  0.7959183673469387 ,  0.8163265306122448 ,  1.510204081632653  ,  1.5510204081632653 ,  3.10204081632653   ,  3.183673469387755  ,  4.775510204081632  ,  4.897959183673469  ,  6.5306122448979576 ,  6.693877551020408  ,  6.5306122448979576 ,  6.693877551020408  ,  6.5306122448979576 ,  6.693877551020408  ,  6.5306122448979576 ,  6.693877551020408  ,  5.020408163265305  ,  5.142857142857142  ,  3.4285714285714284 ,  3.5102040816326534 ,  1.7551020408163263 ,  1.7959183673469385 ,  2.510204081632653  ,  2.571428571428571  ,  5.1428571428571415 ,  5.26530612244898   ,  7.897959183673469  ,  8.081632653061224  , 10.77551020408163   , 11.020408163265305  , 10.77551020408163   , 11.020408163265305  , 10.77551020408163   , 11.020408163265305  , 10.77551020408163   , 11.020408163265305  ,  8.265306122448978  ,  8.448979591836734  ,  5.632653061224489  ,  5.755102040816327  ,  2.8775510204081627 ,  2.9387755102040813 ,  3.6734693877551017 ,  3.7551020408163263 ,  7.510204081632652  ,  7.673469387755102  , 11.51020408163265   , 11.755102040816327  , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 11.999999999999996  , 12.244897959183673  ,  8.163265306122447  ,  8.326530612244898  ,  4.163265306122448  ,  4.244897959183673  ,  3.6734693877551017 ,  3.7551020408163263 ,  7.510204081632652  ,  7.673469387755102  , 11.51020408163265   , 11.755102040816327  , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 11.999999999999996  , 12.244897959183673  ,  8.163265306122447  ,  8.326530612244898  ,  4.163265306122448  ,  4.244897959183673  ,  3.6734693877551017 ,  3.7551020408163263 ,  7.510204081632652  ,  7.673469387755102  , 11.51020408163265   , 11.755102040816327  , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 11.999999999999996  , 12.244897959183673  ,  8.163265306122447  ,  8.326530612244898  ,  4.163265306122448  ,  4.244897959183673  ,  3.6734693877551017 ,  3.7551020408163263 ,  7.510204081632652  ,  7.673469387755102  , 11.51020408163265   , 11.755102040816327  , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 15.673469387755098  , 16.                 , 11.999999999999996  , 12.244897959183673  ,  8.163265306122447  ,  8.326530612244898  ,  4.163265306122448  ,  4.244897959183673  ,  3.                 ,  3.061224489795918  ,  6.122448979591836  ,  6.244897959183672  ,  9.36734693877551   ,  9.551020408163264  , 12.734693877551017  , 12.979591836734691  , 12.734693877551017  , 12.979591836734691  , 12.734693877551017  , 12.979591836734691  , 12.734693877551017  , 12.979591836734691  ,  9.73469387755102   ,  9.918367346938773  ,  6.612244897959182  ,  6.73469387755102   ,  3.36734693877551   ,  3.428571428571428  ,  2.1632653061224487 ,  2.204081632653061  ,  4.408163265306122  ,  4.489795918367347  ,  6.73469387755102   ,  6.857142857142857  ,  9.142857142857142  ,  9.306122448979592  ,  9.142857142857142  ,  9.306122448979592  ,  9.142857142857142  ,  9.306122448979592  ,  9.142857142857142  ,  9.306122448979592  ,  6.979591836734692  ,  7.10204081632653   ,  4.73469387755102   ,  4.816326530612244  ,  2.408163265306122  ,  2.4489795918367347 ,  1.163265306122449  ,  1.183673469387755  ,  2.36734693877551   ,  2.408163265306122  ,  3.6122448979591835 ,  3.6734693877551017 ,  4.8979591836734695 ,  4.979591836734693  ,  4.8979591836734695 ,  4.979591836734693  ,  4.8979591836734695 ,  4.979591836734693  ,  4.8979591836734695 ,  4.979591836734693  ,  3.7346938775510203 ,  3.795918367346938  ,  2.530612244897959  ,  2.571428571428571  ,  1.2857142857142856 ,  1.3061224489795917 ,  1.3265306122448979 ,  1.346938775510204  ,  2.693877551020408  ,  2.7346938775510203 ,  4.1020408163265305 ,  4.163265306122449  ,  5.551020408163265  ,  5.63265306122449   ,  5.551020408163265  ,  5.63265306122449   ,  5.551020408163265  ,  5.63265306122449   ,  5.551020408163265  ,  5.63265306122449   ,  4.224489795918367  ,  4.285714285714286  ,  2.8571428571428568 ,  2.897959183673469  ,  1.4489795918367345 ,  1.4693877551020407 ,  2.816326530612245  ,  2.8571428571428568 ,  5.714285714285714  ,  5.795918367346938  ,  8.693877551020408  ,  8.816326530612244  , 11.755102040816325  , 11.918367346938775  , 11.755102040816325  , 11.918367346938775  , 11.755102040816325  , 11.918367346938775  , 11.755102040816325  , 11.918367346938775  ,  8.938775510204081  ,  9.061224489795917  ,  6.040816326530612  ,  6.122448979591836  ,  3.0612244897959178 ,  3.1020408163265305 ,  4.469387755102041  ,  4.530612244897958  ,  9.061224489795919  ,  9.183673469387754  , 13.775510204081632  , 13.959183673469386  , 18.612244897959187  , 18.857142857142854  , 18.612244897959187  , 18.857142857142854  , 18.612244897959187  , 18.857142857142854  , 18.612244897959187  , 18.857142857142854  , 14.142857142857142  , 14.326530612244897  ,  9.551020408163264  ,  9.673469387755102  ,  4.83673469387755   ,  4.8979591836734695 ,  6.285714285714286  ,  6.367346938775509  , 12.73469387755102   , 12.897959183673468  , 19.3469387755102    , 19.591836734693878  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 19.83673469387755   , 20.081632653061224  , 13.387755102040815  , 13.551020408163266  ,  6.775510204081631  ,  6.857142857142858  ,  6.285714285714286  ,  6.367346938775509  , 12.73469387755102   , 12.897959183673468  , 19.3469387755102    , 19.591836734693878  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 19.83673469387755   , 20.081632653061224  , 13.387755102040815  , 13.551020408163266  ,  6.775510204081631  ,  6.857142857142858  ,  6.285714285714286  ,  6.367346938775509  , 12.73469387755102   , 12.897959183673468  , 19.3469387755102    , 19.591836734693878  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 19.83673469387755   , 20.081632653061224  , 13.387755102040815  , 13.551020408163266  ,  6.775510204081631  ,  6.857142857142858  ,  6.285714285714286  ,  6.367346938775509  , 12.73469387755102   , 12.897959183673468  , 19.3469387755102    , 19.591836734693878  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 26.122448979591837  , 26.448979591836732  , 19.83673469387755   , 20.081632653061224  , 13.387755102040815  , 13.551020408163266  ,  6.775510204081631  ,  6.857142857142858  ,  4.959183673469387  ,  5.020408163265306  , 10.040816326530612  , 10.163265306122447  , 15.244897959183673  , 15.428571428571427  , 20.571428571428566  , 20.816326530612244  , 20.571428571428566  , 20.816326530612244  , 20.571428571428566  , 20.816326530612244  , 20.571428571428566  , 20.816326530612244  , 15.612244897959183  , 15.795918367346937  , 10.530612244897958  , 10.653061224489795  ,  5.326530612244897  ,  5.387755102040815  ,  3.4693877551020407 ,  3.5102040816326525 ,  7.020408163265305  ,  7.1020408163265305 , 10.653061224489795  , 10.77551020408163   , 14.367346938775508  , 14.530612244897958  , 14.367346938775508  , 14.530612244897958  , 14.367346938775508  , 14.530612244897958  , 14.367346938775508  , 14.530612244897958  , 10.897959183673468  , 11.020408163265307  ,  7.346938775510203  ,  7.428571428571429  ,  3.714285714285714  ,  3.7551020408163263 ,  1.8163265306122447 ,  1.8367346938775508 ,  3.6734693877551017 ,  3.714285714285714  ,  5.571428571428571  ,  5.63265306122449   ,  7.5102040816326525 ,  7.591836734693878  ,  7.5102040816326525 ,  7.591836734693878  ,  7.5102040816326525 ,  7.591836734693878  ,  7.5102040816326525 ,  7.591836734693878  ,  5.693877551020408  ,  5.755102040816326  ,  3.836734693877551  ,  3.877551020408163  ,  1.9387755102040816 ,  1.9591836734693877 };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 2 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, SAME3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 32.72281746031746 ,  33.29969387755102 ,  33.876570294784585,  34.45344671201814 ,  40.06397392290249 ,  40.74935374149659 ,  41.434733560090706,  42.1201133786848  ,  47.8391439909297  ,  48.63302721088436 ,  49.426910430838994,  50.22079365079365 ,  56.04832766439909 ,  56.950714285714284,  57.853100907029464,  58.75548752834467 ,  56.32312925170068 ,  57.16222222222221 ,  58.00131519274377 ,  58.84040816326531 ,  60.576462585034015,  61.41555555555555 ,  62.254648526077105,  63.09374149659863 ,  69.66912131519274 ,  70.57150793650793 ,  71.47389455782313 ,  72.3762811791383  ,  62.76197845804988 ,  63.55586167800452 ,  64.34974489795918 ,  65.14362811791382 ,  55.42082199546485 ,  56.10620181405895 ,  56.79158163265306 ,  57.47696145124716 ,  47.64565192743764 ,  48.222528344671204,  48.79940476190476 ,  49.37628117913833 ,  50.74152494331066 ,  51.426904761904765,  52.112284580498866,  52.797664399092966,  61.69492630385488 ,  62.50921768707482 ,  63.32350907029478 ,  64.13780045351473 ,  73.16397392290249 ,  74.10717687074829 ,  75.0503798185941  ,  75.9935827664399  ,  85.1486678004535  ,  86.22078231292517 ,  87.2928968253968  ,  88.36501133786847 ,  84.17346938775509 ,  85.17038548752832 ,  86.1673015873016  ,  87.16421768707482 ,  89.22680272108843 ,  90.22371882086166 ,  91.22063492063492 ,  92.21755102040814 , 101.33136621315192 , 102.40348072562357 , 103.47559523809524 , 104.54770975056685 ,  90.89361111111111 ,  91.83681405895689 ,  92.78001700680272 ,  93.7232199546485  ,  79.94020975056691 ,  80.75450113378683 ,  81.56879251700681 ,  82.38308390022674 ,  68.47116213151928 ,  69.15654195011338 ,  69.84192176870748 ,  70.5273015873016  ,  73.10036848072562 ,  73.89425170068027 ,  74.68813492063491 ,  75.48201814058956 ,  88.48234126984129 ,  89.42554421768706 ,  90.36874716553288 ,  91.31195011337869 , 104.46159297052155 , 105.55411564625848 , 106.64663832199544 , 107.73916099773244 , 121.03812358276642 , 122.27996598639454 , 123.52180839002263 , 124.7636507936508  , 118.33673469387755 , 119.49147392290247 , 120.64621315192743 , 121.80095238095238 , 124.19006802721088 , 125.34480725623581 , 126.49954648526077 , 127.65428571428569 , 139.7827267573696  , 141.02456916099771 , 142.26641156462583 , 143.50825396825394 , 124.99803287981858 , 126.09055555555553 , 127.18307823129251 , 128.27560090702946 , 109.61606009070294 , 110.55926303854874 , 111.50246598639455 , 112.44566893424033 ,  93.63680839002267 ,  94.43069160997733 ,  95.22457482993195 ,  96.01845804988662 ,  99.79934807256237 , 100.70173469387754 , 101.60412131519273 , 102.50650793650793 , 120.4262188208617  , 121.4983333333333  , 122.570447845805   , 123.64256235827665 , 141.73200113378687 , 142.97384353741492 , 144.21568594104306 , 145.4575283446712  , 163.71669501133783 , 165.12826530612244 , 166.539835600907   , 167.9514058956916  , 158.812925170068   , 160.12548752834462 , 161.43804988662134 , 162.75061224489795 , 165.46625850340135 , 166.77882086167796 , 168.09138321995468 , 169.40394557823126 , 185.0232029478458  , 186.4347732426303  , 187.84634353741498 , 189.2579138321995  , 165.0752437641723  , 166.3170861678004  , 167.5589285714286  , 168.80077097505665 , 144.44837301587302 , 145.52048752834463 , 146.59260204081633 , 147.66471655328795 , 123.14259070294783 , 124.04497732426304 , 124.9473639455782  , 125.84975056689343 , 134.8598639455782  , 135.69895691609977 , 136.5380498866213  , 137.37714285714284 , 161.9510204081633  , 162.94793650793648 , 163.94485260770975 , 164.941768707483   , 189.67346938775512 , 190.82820861678    , 191.98294784580497 , 193.13768707482993 , 218.02721088435374 , 219.33977324263032 , 220.652335600907   , 221.96489795918367 , 208.85260770975057 , 210.07310657596364 , 211.2936054421769  , 212.51410430839002 , 215.03927437641727 , 216.25977324263033 , 217.48027210884356 , 218.70077097505663 , 237.83927437641725 , 239.1518367346938  , 240.46439909297052 , 241.77696145124713 , 211.37941043083902 , 212.53414965986389 , 213.6888888888889  , 214.8436281179138  , 184.28825396825397 , 185.28517006802718 , 186.28208616780043 , 187.27900226757367 , 156.5658049886621  , 157.40489795918367 , 158.24399092970518 , 159.08308390022674 , 177.39319727891157 , 178.23229024943308 , 179.07138321995467 , 179.91047619047615 , 212.48435374149665 , 213.4812698412698  , 214.47818594104314 , 215.47510204081632 , 248.20680272108845 , 249.36154195011332 , 250.51628117913836 , 251.67102040816326 , 284.56054421768704 , 285.8731065759636  , 287.1856689342404  , 288.498231292517   , 270.7192743764172  , 271.93977324263034 , 273.16027210884357 , 274.3807709750567  , 276.90594104308394 , 278.126439909297   , 279.34693877551024 , 280.56743764172336 , 304.3726077097506  , 305.68517006802716 , 306.99773242630386 , 308.3102947845805  , 269.9127437641723  , 271.0674829931972  , 272.2222222222222  , 273.37696145124715 , 234.82158730158727 , 235.81850340136052 , 236.8154195011337  , 237.812335600907   , 199.09913832199544 , 199.93823129251703 , 200.77732426303848 , 201.61641723356013 , 236.00728458049886 , 236.90967120181406 , 237.81205782312927 , 238.71444444444444 , 282.2532029478458  , 283.3253174603174  , 284.39743197278915 , 285.46954648526076 , 329.17803287981855 , 330.4198752834467  , 331.66171768707494 , 332.9035600907029  , 376.7817743764172  , 378.1933446712017  , 379.60491496598644 , 381.01648526077093 , 356.9335600907029  , 358.2461224489795  , 359.55868480725627 , 360.8712471655328  , 363.5868934240362  , 364.8994557823129  , 366.2120181405896  , 367.52458049886616 , 398.0882823129251  , 399.49985260770967 , 400.91142290249434 , 402.32299319727883 , 352.52127551020396 , 353.7631179138321  , 355.0049603174603  , 356.24680272108844 , 306.2753571428571  , 307.3474716553288  , 308.4195861678004  , 309.4917006802721  , 259.35052721088437 , 260.25291383219957 , 261.15530045351466 , 262.05768707482997 , 222.32871315192742 , 223.12259637188208 , 223.91647959183675 , 224.71036281179136 , 265.77871315192743 , 266.72191609977324 , 267.6651190476191  , 268.60832199546485 , 309.825992063492   , 310.91851473922895 , 312.01103741496604 , 313.1035600907029  , 354.47054988662126 , 355.7123922902494  , 356.9542346938776  , 358.1960770975056  , 335.3961451247165  , 336.5508843537414  , 337.70562358276646 , 338.86036281179133 , 341.2494784580498  , 342.4042176870748  , 343.55895691609976 , 344.7136961451247  , 373.2151530612244  , 374.4569954648525  , 375.6988378684807  , 376.9406802721088  , 330.36243197278907 , 331.45495464852604 , 332.547477324263   , 333.64             , 286.9124319727891  , 287.8556349206349  , 288.79883786848063 , 289.74204081632655 , 242.8651530612245  , 243.65903628117917 , 244.45291950113375 , 245.24680272108844 , 204.31000566893425 , 204.99538548752835 , 205.68076530612245 , 206.36614512471655 , 244.14776077097505 , 244.962052154195   , 245.77634353741496 , 246.59063492063493 , 284.50116213151927 , 285.44436507936507 , 286.38756802721093 , 287.3307709750567  , 325.3702097505668  , 326.44232426303853 , 327.5144387755102  , 328.5865532879818  , 307.54580498866204 , 308.5427210884353  , 309.53963718820864 , 310.5365532879818  , 312.5991383219954  , 313.59605442176866 , 314.59297052154193 , 315.58988662131515 , 341.5529081632653  , 342.62502267573694 , 343.69713718820856 , 344.76925170068023 , 302.23079931972785 , 303.17400226757366 , 304.11720521541946 , 305.0604081632653  , 262.3930442176871  , 263.207335600907   , 264.0216269841269  , 264.83591836734695 , 222.03964285714287 , 222.72502267573697 , 223.41040249433104 , 224.0957823129252  , 181.95116213151928 , 182.52803854875287 , 183.10491496598638 , 183.68179138321995 , 217.36034580498867 , 218.04572562358277 , 218.73110544217687 , 219.41648526077097 , 253.20354308390023 , 253.99742630385487 , 254.79130952380953 , 255.5851927437642  , 289.48075396825396 , 290.38314058956917 , 291.28552721088437 , 292.1879138321995  , 273.3825396825397  , 274.2216326530612  , 275.06072562358275 , 275.8998185941043  , 277.635873015873   , 278.4749659863946  , 279.3140589569161  , 280.15315192743765 , 303.1015476190476  , 304.00393424036275 , 304.90632086167795 , 305.8087074829932  , 268.1263775510204  , 268.92026077097506 , 269.71414399092964 , 270.5080272108844  , 232.71719387755104 , 233.4025736961451  , 234.0879535147392  , 234.77333333333334 , 196.87399659863948 , 197.45087301587301 , 198.02774943310658 , 198.60462585034014 , 207.91964285714283 , 208.4965192743764  , 209.07339569161    , 209.65027210884352 , 248.21318027210881 , 248.89856009070294 , 249.58393990929704 , 250.26931972789112 , 288.940731292517   , 289.7346145124716  , 290.52849773242633 , 291.322380952381   , 330.1022959183673  , 331.00468253968245 , 331.90706916099776 , 332.80945578231297 , 311.15487528344676 , 311.9939682539682  , 312.8330612244898  , 313.6721541950114  , 298.34154195011354 , 299.18063492063493 , 300.01972789115655 , 300.858820861678   , 305.3230895691611  , 306.22547619047623 , 307.1278628117915  , 308.0302494331065  , 265.46356575963716 , 266.25744897959186 , 267.0513321995466  , 267.84521541950113 , 225.17002834467118 , 225.8554081632653  , 226.54078798185935 , 227.22616780045354 , 184.44247732426302 , 185.0193537414966  , 185.5962301587301  , 186.17310657596377 , 213.78596938775507 , 214.47134920634917 , 215.15672902494333 , 215.84210884353737 , 255.40603741496597 , 256.2203287981859  , 257.0346201814059  , 257.84891156462584 , 297.54175170068027 , 298.484954648526   , 299.4281575963719  , 300.3713605442178  , 340.1931122448979  , 341.26522675736953 , 342.33734126984126 , 343.409455782313   , 321.3290249433107  , 322.32594104308384 , 323.3228571428572  , 324.3197732426305  , 309.3156916099774  , 310.3126077097506  , 311.3095238095239  , 312.30643990929707 , 317.9758106575964  , 319.047925170068   , 320.12003968253975 , 321.1921541950113  , 276.8713888888888  , 277.8145918367347  , 278.7577947845806  , 279.70099773242634 , 235.25132086167798 , 236.06561224489798 , 236.87990362811786 , 237.69419501133788 , 193.1156065759637  , 193.80098639455784 , 194.48636621315185 , 195.17174603174607 , 223.99243197278903 , 224.78631519274376 , 225.58019841269845 , 226.374081632653   , 267.7553571428571  , 268.6985600907029  , 269.64176303854873 , 270.58496598639454 , 312.1155612244898  , 313.2080839002267  , 314.3006065759637  , 315.39312925170077 , 357.073044217687   , 358.3148866213151  , 359.55672902494325 , 360.79857142857145 , 337.8160997732426  , 338.9708390022675  , 340.1255782312925  , 341.2803174603175  , 326.6027664399094  , 327.7575056689342  , 328.9122448979592  , 330.0669841269841  , 337.4176473922903  , 338.6594897959183  , 339.9013321995465  , 341.1431746031745  , 294.2520011337868  , 295.34452380952376 , 296.43704648526085 , 297.5295691609977  , 250.4890759637188  , 251.43227891156465 , 252.37548185941037 , 253.31868480725626 , 206.12887188208614 , 206.92275510204084 , 207.7166383219954  , 208.51052154195017 , 238.53903061224483 , 239.44141723356006 , 240.3438038548753  , 241.2461904761904  , 285.2611394557823  , 286.333253968254   , 287.4053684807256  , 288.47748299319727 , 332.6621598639456  , 333.9040022675737  , 335.14584467120176 , 336.38768707483    , 380.74209183673463 , 382.15366213151924 , 383.5652324263038  , 384.97680272108846 , 360.61609977324264 , 361.9286621315192  , 363.24122448979585 , 364.5537868480726  , 350.2027664399094  , 351.5153287981859  , 352.8278911564626  , 354.1404535147392  , 363.6485997732427  , 365.0601700680272  , 366.47174036281183 , 367.88331065759627 , 317.60540249433103 , 318.8472448979592  , 320.08908730158737 , 321.3309297052154  , 270.88329365079363 , 271.95540816326536 , 273.0275226757369  , 274.09963718820865 , 223.48227324263036 , 224.3846598639456  , 225.28704648526067 , 226.189433106576   , 183.46938775510196 , 184.30848072562364 , 185.14757369614514 , 185.98666666666662 , 219.70340136054415 , 220.70031746031748 , 221.6972335600907  , 222.6941496598639  , 256.5687074829931  , 257.7234467120182  , 258.8781859410431  , 260.0329251700679  , 294.0653061224489  , 295.3778684807256  , 296.69043083900226 , 298.00299319727884 , 279.55736961451237 , 280.7778684807256  , 281.9983673469388  , 283.2188662131519  , 268.6773696145124  , 269.8978684807256  , 271.1183673469387  , 272.3388662131519  , 275.47736961451244 , 276.78993197278913 , 278.1024943310657  , 279.41505668934246 , 239.87464852607707 , 241.029387755102   , 242.18412698412695 , 243.33886621315196 , 203.64063492063488 , 204.63755102040815 , 205.63446712018137 , 206.6313832199546  , 166.7753287981859  , 167.61442176870747 , 168.453514739229   , 169.29260770975054 , 148.2274829931973  , 149.0665759637188  , 149.9056689342404  , 150.7447619047619  , 177.83292517006797 , 178.8298412698413  , 179.82675736961457 , 180.82367346938773 , 208.0696598639455  , 209.22439909297057 , 210.37913832199553 , 211.53387755102042 , 238.93768707482988 , 240.2502494331066  , 241.5628117913832  , 242.87537414965985 , 228.29641723356008 , 229.51691609977325 , 230.73741496598637 , 231.95791383219952 , 217.41641723356003 , 218.63691609977326 , 219.8574149659864  , 221.07791383219953 , 220.34975056689342 , 221.66231292517008 , 222.97487528344672 , 224.2874376417233  , 191.37560090702942 , 192.53034013605446 , 193.6850793650794  , 194.83981859410432 , 161.77015873015876 , 162.767074829932   , 163.76399092970522 , 164.76090702947846 , 131.53342403628122 , 132.37251700680272 , 133.21160997732423 , 134.05070294784582 , 134.93998299319728 , 135.84236961451248 , 136.74475623582765 , 137.64714285714282 , 162.17637755102044 , 163.24849206349205 , 164.32060657596367 , 165.3927210884354  , 190.09168367346942 , 191.33352607709747 , 192.5753684807256  , 193.81721088435378 , 218.68590136054425 , 220.09747165532877 , 221.50904195011336 , 222.920612244898   , 209.92657596371885 , 211.23913832199545 , 212.55170068027206 , 213.86426303854878 , 216.5799092970522  , 217.8924716553288  , 219.20503401360537 , 220.5175963718821  , 239.9924092970522  , 241.40397959183673 , 242.81554988662128 , 244.2271201814059  , 213.43492630385492 , 214.67676870748298 , 215.9186111111111  , 217.16045351473926 , 186.19853174603176 , 187.2706462585034  , 188.34276077097505 , 189.41487528344672 , 158.28322562358278 , 159.18561224489795 , 160.08799886621316 , 160.99038548752836 , 133.4137925170068  , 134.20767573696145 , 135.00155895691609 , 135.79544217687072 , 160.13998299319732 , 161.08318594104307 , 162.02638888888885 , 162.9695918367347  , 187.4634523809524  , 188.5559750566893  , 189.64849773242625 , 190.74102040816334 , 215.38420068027213 , 216.62604308390019 , 217.8678854875283  , 219.1097278911565  , 206.06535147392293 , 207.22009070294783 , 208.37482993197273 , 209.5295691609978  , 211.91868480725628 , 213.07342403628115 , 214.22816326530605 , 215.3829024943311  , 234.12880385487531 , 235.3706462585034  , 236.61248866213145 , 237.85433106575965 , 207.99989229024948 , 209.0924149659864  , 210.18493764172334 , 211.27746031746034 , 181.27370181405897 , 182.21690476190477 , 183.16010770975058 , 184.10331065759638 , 153.95023242630387 , 154.7441156462585  , 155.53799886621314 , 156.3318820861678  , 127.54746598639456 , 128.23284580498864 , 128.91822562358277 , 129.60360544217687 , 152.94712585034017 , 153.76141723356008 , 154.57570861678002 , 155.39000000000001 , 178.86243197278915 , 179.8056349206349  , 180.74883786848065 , 181.69204081632657 , 205.29338435374152 , 206.36549886621313 , 207.43761337868474 , 208.50972789115653 , 195.891201814059   , 196.8881179138322  , 197.88503401360538 , 198.8819501133787  , 200.94453514739234 , 201.94145124716553 , 202.93836734693872 , 203.93528344671202 , 221.47608276643996 , 222.54819727891157 , 223.6203117913832  , 224.6924263038549  , 196.59206916099774 , 197.53527210884354 , 198.47847505668932 , 199.42167800453518 , 171.19240929705217 , 172.0067006802721  , 172.82099206349207 , 173.635283446712   , 145.27710317460318 , 145.96248299319728 , 146.64786281179138 , 147.33324263038548 , 117.34100340136054 , 117.91787981859412 , 118.49475623582767 , 119.07163265306123 , 140.597806122449   , 141.2831859410431  , 141.9685657596372  , 142.6539455782313  , 164.28862244897962 , 165.08250566893423 , 165.87638888888884 , 166.67027210884353 , 188.4134523809524  , 189.31583900226755 , 190.21822562358273 , 191.12061224489798 , 179.404126984127   , 180.24321995464854 , 181.08231292517002 , 181.92140589569163 , 183.65746031746033 , 184.49655328798187 , 185.33564625850337 , 186.17473922902496 , 202.03424603174605 , 202.9366326530612  , 203.83901927437637 , 204.74140589569163 , 179.21145691609976 , 180.00534013605443 , 180.79922335600907 , 181.5931065759637  , 155.95465419501136 , 156.64003401360546 , 157.32541383219956 , 158.01079365079366 , 132.26383786848072 , 132.84071428571428 , 133.41759070294785 , 133.9944671201814  , 198.8632256235828  , 199.44010204081633 , 200.01697845804986 , 200.59385487528343 , 237.45336167800457 , 238.13874149659864 , 238.82412131519274 , 239.5095011337868  , 276.4775113378685  , 277.2713945578231  , 278.0652777777778  , 278.85916099773243 , 315.93567460317456 , 316.8380612244897  , 317.74044784580497 , 318.64283446712017 , 297.9819047619048  , 298.8209977324263  , 299.66009070294785 , 300.4991836734694  , 302.2352380952381  , 303.0743310657596  , 303.9134240362812  , 304.75251700680275 , 329.5564682539683  , 330.45885487528346 , 331.36124149659867 , 332.2636281179139  , 291.4003458049887  , 292.1942290249433  , 292.98811224489793 , 293.7819954648526  , 252.81020975056688 , 253.49558956916096 , 254.18096938775508 , 254.86634920634924 , 213.78606009070296 , 214.3629365079365  , 214.9398129251701  , 215.51668934240362 , 248.13091269841271 , 248.81629251700676 , 249.5016723356009  , 250.18705215419502 , 296.2108446712018  , 297.0251360544218  , 297.83942743764175 , 298.6537188208616  , 344.8064229024943  , 345.7496258503401  , 346.69282879818593 , 347.6360317460318  , 393.91764739229023 , 394.98976190476185 , 396.0618764172335  , 397.13399092970525 , 371.285306122449   , 372.28222222222223 , 373.2791383219955  , 374.2760544217688  , 376.3386394557823  , 377.3355555555556  , 378.33247165532885 , 379.3293877551021  , 410.1003458049887  , 411.17246031746026 , 412.24457482993205 , 413.3166893424038  , 362.53606009070296 , 363.47926303854865 , 364.42246598639457 , 365.36566893424043 , 314.4561281179138  , 315.2704195011337  , 316.0847108843538  , 316.8990022675738  , 265.8605498866213  , 266.54592970521537 , 267.23130952380956 , 267.91668934240363 , 301.7387358276644  , 302.532619047619   , 303.32650226757374 , 304.1203854875284  , 360.1247902494331  , 361.0679931972789  , 362.0111961451247  , 362.95439909297045 , 419.10812358276644 , 420.20064625850335 , 421.2931689342404  , 422.38569160997736 , 468.23975623582766 , 469.4815986394557  , 470.7234410430839  , 471.965283446712   , 428.2621768707483  , 429.41691609977323 , 430.5716553287983  , 431.7263945578232  , 419.48693877551017 , 420.64167800453515 , 421.79641723356013 , 422.9511564625851  , 441.879597505669   , 443.121439909297   , 444.3632823129252  , 445.6051247165534  , 384.09082199546486 , 385.1833446712017  , 386.27586734693875 , 387.3683900226758  , 325.70476757369613 , 326.6479705215419  , 327.5911734693878  , 328.53437641723366 , 266.7214342403628  , 267.5153174603174  , 268.3092006802721  , 269.10308390022675 , 304.1329535147392  , 305.03534013605434 , 305.9377267573697  , 306.8401133786849  , 363.192477324263   , 364.26459183673467 , 365.3367063492064  , 366.408820861678   , 422.93091269841267 , 424.17275510204075 , 425.414597505669   , 426.65643990929715 , 472.8992800453514  , 474.3108503401359  , 475.7224206349207  , 477.1339909297053  , 433.3859863945578  , 434.69854875283437 , 436.01111111111123 , 437.3236734693879  , 425.4107482993196  , 426.7233106575963  , 428.0358730158731  , 429.3484353741498  , 449.1010260770975  , 450.512596371882   , 451.92416666666674 , 453.3357369614514  , 390.72041383219954 , 391.96225623582757 , 393.20409863945576 , 394.44594104308396 , 331.6608900226757  , 332.7330045351473  , 333.8051190476191  , 334.8772335600908  , 271.922454648526   , 272.8248412698412  , 273.7272278911565  , 274.6296145124717  , 256.1521995464853  , 256.9912925170068  , 257.8303854875283  , 258.6694784580499  , 306.05696145124716 , 307.0538775510204  , 308.0507936507937  , 309.047709750567   , 356.5930158730158  , 357.74775510204074 , 358.9024943310657  , 360.0572335600908  , 397.3113832199547  , 398.62394557823126 , 399.936507936508   , 401.2490702947847  , 362.6383673469387  , 363.8588662131518  , 365.0793650793652  , 366.29986394557847 , 354.1964625850338  , 355.416961451247   , 356.6374603174604  , 357.85795918367364 , 372.01868480725614 , 373.33124716553283 , 374.64380952380964 , 375.9563718820863  , 322.74521541950105 , 323.89995464852603 , 325.054693877551   , 326.20943310657594 , 272.8404535147392  , 273.83736961451245 , 274.8342857142858  , 275.831201814059   , 222.30439909297053 , 223.143492063492   , 223.98258503401357 , 224.8216780045352  , 220.91029478458051 , 221.74938775510205 , 222.58848072562355 , 223.42757369614506 , 264.18648526077095 , 265.1834013605443  , 266.18031746031744 , 267.17723356009066 , 308.0939682539684  , 309.24870748299315 , 310.40344671201814 , 311.55818594104323 , 342.18376417233566 , 343.4963265306121  , 344.808888888889   , 346.1214512471656  , 311.3774149659864  , 312.5979138321995  , 313.8184126984128  , 315.038911564626   , 302.93551020408154 , 304.1560090702947  , 305.376507936508   , 306.5970068027211  , 316.8910657596372  , 318.2036281179138  , 319.51619047619056 , 320.8287528344671  , 274.2461678004535  , 275.4009070294784  , 276.5556462585034  , 277.71038548752836 , 230.96997732426306 , 231.96689342403621 , 232.96380952380946 , 233.96072562358282 , 187.06249433106578 , 187.90158730158723 , 188.7406802721088  , 189.57977324263047 , 200.53390589569162 , 201.43629251700682 , 202.33867913832196 , 203.24106575963708 , 240.10771541950115 , 241.17982993197282 , 242.2519444444444  , 243.32405895691602 , 280.3604365079365  , 281.60227891156467 , 282.8441213151927  , 284.08596371882084 , 310.843089569161   , 312.2546598639456  , 313.66623015873006 , 315.07780045351467 , 282.696462585034   , 284.0090249433107  , 285.3215873015872  , 286.6341496598639  , 274.72122448979593 , 276.03378684807257 , 277.34634920634915 , 278.65891156462584 , 287.0448356009071  , 288.45640589569155 , 289.8679761904761  , 291.2795464852608  , 248.14993764172337 , 249.3917800453514  , 250.63362244897954 , 251.8754648526078  , 208.57612811791387 , 209.6482426303854  , 210.7203571428571  , 211.79247165532888 , 168.32340702947843 , 169.22579365079363 , 170.1281802721089  , 171.030566893424   , 155.60635487528344 , 156.4002380952381  , 157.19412131519272 , 157.98800453514733 , 186.50669501133785 , 187.4498979591837  , 188.39310090702944 , 189.3363038548752  , 218.0043140589569  , 219.09683673469388 , 220.18935941043077 , 221.28188208616774 , 239.65023242630383 , 240.892074829932   , 242.13391723356003 , 243.37575963718814 , 215.70598639455787 , 216.86072562358277 , 218.0154648526076  , 219.17020408163262 , 206.9307482993197  , 208.08548752834466 , 209.24022675736958 , 210.39496598639448 , 213.2900736961451  , 214.5319160997732  , 215.77375850340138 , 217.01560090702947 , 182.9870124716553  , 184.07953514739225 , 185.17205782312928 , 186.26458049886622 , 152.0866723356009  , 153.02987528344673 , 153.97307823129253 , 154.91628117913825 , 120.58905328798187 , 121.38293650793652 , 122.17681972789114 , 122.9707029478458  , 106.3386678004535  , 107.02404761904761 , 107.70942743764175 , 108.39480725623582 , 127.74921201814057 , 128.56350340136055 , 129.3777947845805  , 130.19208616780045 , 149.67540249433108 , 150.61860544217686 , 151.56180839002266 , 152.50501133786844 , 161.6682596371882  , 162.74037414965986 , 163.81248866213153 , 164.88460317460311 , 142.4025850340136  , 143.3995011337868  , 144.39641723356016 , 145.39333333333335 , 132.82734693877552 , 133.82426303854874 , 134.821179138322   , 135.81809523809525 , 132.74619614512474 , 133.81831065759638 , 134.890425170068   , 135.96253968253967 , 111.85129818594105 , 112.79450113378685 , 113.73770408163264 , 114.68090702947845 ,  90.44075396825396 ,  91.25504535147394 ,  92.06933673469388 ,  92.88362811791382 ,  68.5145634920635  ,  69.1999433106576  ,  69.8853231292517  ,  70.5707029478458  ,  52.7308446712018  ,  53.30772108843538 ,  53.884597505668935,  54.46147392290249 ,  63.83526643990929 ,  64.5206462585034  ,  65.2060260770975  ,  65.89140589569162 ,  75.37370181405896 ,  76.1675850340136  ,  76.96146825396826 ,  77.7553514739229  ,  87.34615079365079 ,  88.248537414966   ,  89.15092403628118 ,  90.05331065759638 ,  85.42571428571428 ,  86.26480725623584 ,  87.10390022675736 ,  87.94299319727891 ,  89.67904761904762 ,  90.51814058956919 ,  91.3572335600907  ,  92.19632653061224 , 100.96694444444444 , 101.86933106575965 , 102.77171768707483 , 103.67410430839001 ,  90.29653628117914 ,  91.09041950113381 ,  91.88430272108843 ,  92.67818594104307 ,  79.19211451247165 ,  79.87749433106576 ,  80.56287414965986 ,  81.24825396825396 ,  67.65367913832199 ,  68.23055555555555 ,  68.80743197278912 ,  69.38430839002268 };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 4 }};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow7Stride1Grad, VALID3x10x10x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = { 0.02040816326530612 ,  0.04081632653061224 ,  0.061224489795918366,  0.08163265306122448 ,  0.12244897959183672 ,  0.16326530612244897 ,  0.20408163265306123 ,  0.24489795918367346 ,  0.3061224489795918  ,  0.36734693877551017 ,  0.42857142857142855 ,  0.4897959183673469  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5714285714285714  ,  0.6530612244897959  ,  0.7346938775510203  ,  0.8163265306122449  ,  0.5510204081632653  ,  0.6122448979591837  ,  0.6734693877551019  ,  0.7346938775510203  ,  0.44897959183673464 ,  0.4897959183673469  ,  0.5306122448979591  ,  0.5714285714285714  ,  0.26530612244897955 ,  0.2857142857142857  ,  0.3061224489795918  ,  0.32653061224489793 ,  0.3673469387755102  ,  0.4081632653061224  ,  0.4489795918367347  ,  0.48979591836734687 ,  0.8979591836734693  ,  0.9795918367346937  ,  1.0612244897959182  ,  1.1428571428571428  ,  1.5918367346938775  ,  1.7142857142857142  ,  1.8367346938775508  ,  1.9591836734693875  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.4489795918367347  ,  2.6122448979591835  ,  2.7755102040816326  ,  2.9387755102040813  ,  2.0816326530612246  ,  2.204081632653061   ,  2.326530612244898   ,  2.4489795918367347  ,  1.5510204081632653  ,  1.6326530612244894  ,  1.714285714285714   ,  1.7959183673469385  ,  0.8571428571428571  ,  0.8979591836734693  ,  0.9387755102040816  ,  0.9795918367346939  ,  1.0408163265306123  ,  1.1020408163265305  ,  1.163265306122449   ,  1.2244897959183672  ,  2.3265306122448974  ,  2.4489795918367347  ,  2.571428571428571   ,  2.693877551020408   ,  3.8571428571428568  ,  4.040816326530612   ,  4.224489795918367   ,  4.408163265306122   ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  5.63265306122449    ,  5.877551020408162   ,  6.122448979591837   ,  6.36734693877551    ,  4.591836734693877   ,  4.775510204081632   ,  4.959183673469387   ,  5.142857142857143   ,  3.3061224489795915  ,  3.428571428571428   ,  3.551020408163265   ,  3.6734693877551017  ,  1.7755102040816326  ,  1.8367346938775508  ,  1.8979591836734693  ,  1.9591836734693877  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.0408163265306123  ,  2.1224489795918364  ,  2.204081632653061   ,  2.2857142857142856  ,  4.408163265306122   ,  4.571428571428571   ,  4.7346938775510194  ,  4.8979591836734695  ,  7.1020408163265305  ,  7.346938775510203   ,  7.591836734693876   ,  7.83673469387755    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    , 10.122448979591836   , 10.448979591836732   , 10.775510204081634   , 11.10204081632653    ,  8.081632653061224   ,  8.326530612244897   ,  8.57142857142857    ,  8.816326530612246   ,  5.7142857142857135  ,  5.877551020408163   ,  6.040816326530612   ,  6.20408163265306    ,  3.020408163265306   ,  3.1020408163265305  ,  3.183673469387755   ,  3.2653061224489797  ,  2.020408163265306   ,  2.0816326530612246  ,  2.1428571428571423  ,  2.204081632653061   ,  4.285714285714286   ,  4.408163265306122   ,  4.530612244897958   ,  4.653061224489795   ,  6.795918367346939   ,  6.979591836734693   ,  7.163265306122447   ,  7.3469387755102025  ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  9.551020408163264   ,  9.795918367346937   , 10.04081632653061    , 10.285714285714285   ,  7.530612244897959   ,  7.714285714285714   ,  7.897959183673468   ,  8.081632653061224   ,  5.26530612244898    ,  5.387755102040816   ,  5.5102040816326525  ,  5.632653061224489   ,  2.7551020408163263  ,  2.816326530612245   ,  2.877551020408163   ,  2.9387755102040813  ,  1.673469387755102   ,  1.7142857142857144  ,  1.7551020408163263  ,  1.7959183673469385  ,  3.5102040816326525  ,  3.591836734693877   ,  3.6734693877551017  ,  3.7551020408163263  ,  5.5102040816326525  ,  5.63265306122449    ,  5.755102040816325   ,  5.877551020408163   ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  7.673469387755102   ,  7.836734693877551   ,  7.999999999999999   ,  8.16326530612245    ,  6.                  ,  6.122448979591836   ,  6.244897959183673   ,  6.367346938775509   ,  4.163265306122449   ,  4.244897959183673   ,  4.326530612244897   ,  4.408163265306122   ,  2.1632653061224487  ,  2.204081632653061   ,  2.2448979591836733  ,  2.2857142857142856  ,  0.9999999999999999  ,  1.0204081632653061  ,  1.040816326530612   ,  1.0612244897959182  ,  2.081632653061224   ,  2.1224489795918364  ,  2.1632653061224487  ,  2.204081632653061   ,  3.244897959183673   ,  3.3061224489795915  ,  3.36734693877551    ,  3.428571428571428   ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  4.489795918367346   ,  4.571428571428571   ,  4.653061224489796   ,  4.7346938775510194  ,  3.4897959183673466  ,  3.5510204081632653  ,  3.6122448979591835  ,  3.6734693877551017  ,  2.408163265306122   ,  2.4489795918367347  ,  2.4897959183673466  ,  2.530612244897959   ,  1.2448979591836733  ,  1.2653061224489794  ,  1.2857142857142856  ,  1.3061224489795917  ,  1.3265306122448979  ,  1.346938775510204   ,  1.3673469387755102  ,  1.3877551020408163  ,  2.7346938775510203  ,  2.775510204081632   ,  2.816326530612245   ,  2.8571428571428568  ,  4.224489795918367   ,  4.285714285714285   ,  4.346938775510204   ,  4.408163265306122   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  5.795918367346938   ,  5.877551020408162   ,  5.959183673469388   ,  6.040816326530612   ,  4.469387755102041   ,  4.530612244897958   ,  4.591836734693877   ,  4.653061224489796   ,  3.061224489795918   ,  3.1020408163265305  ,  3.1428571428571423  ,  3.183673469387755   ,  1.5714285714285714  ,  1.5918367346938773  ,  1.6122448979591835  ,  1.6326530612244896  ,  2.9795918367346936  ,  3.020408163265306   ,  3.061224489795918   ,  3.1020408163265305  ,  6.122448979591836   ,  6.20408163265306    ,  6.285714285714285   ,  6.36734693877551    ,  9.428571428571427   ,  9.551020408163264   ,  9.673469387755102   ,  9.795918367346937   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   , 12.897959183673468   , 13.061224489795915   , 13.224489795918368   , 13.387755102040815   ,  9.918367346938775   , 10.04081632653061    , 10.163265306122447   , 10.285714285714285   ,  6.775510204081632   ,  6.857142857142857   ,  6.9387755102040805  ,  7.020408163265307   ,  3.4693877551020407  ,  3.5102040816326525  ,  3.5510204081632653  ,  3.591836734693877   ,  4.959183673469387   ,  5.020408163265306   ,  5.081632653061224   ,  5.142857142857142   , 10.16326530612245    , 10.285714285714283   , 10.40816326530612    , 10.53061224489796    , 15.612244897959181   , 15.795918367346937   , 15.979591836734691   , 16.163265306122447   , 21.306122448979586   , 21.55102040816326    , 21.79591836734694    , 22.04081632653061    , 21.306122448979586   , 21.55102040816326    , 21.79591836734694    , 22.04081632653061    , 21.306122448979586   , 21.55102040816326    , 21.79591836734694    , 22.04081632653061    , 21.306122448979586   , 21.55102040816326    , 21.79591836734694    , 22.04081632653061    , 16.346938775510203   , 16.530612244897956   , 16.71428571428571    , 16.897959183673468   , 11.142857142857142   , 11.265306122448978   , 11.387755102040815   , 11.510204081632654   ,  5.6938775510204085  ,  5.755102040816325   ,  5.816326530612244   ,  5.877551020408163   ,  7.265306122448979   ,  7.346938775510203   ,  7.428571428571427   ,  7.5102040816326525  , 14.857142857142858   , 15.020408163265303   , 15.183673469387752   , 15.346938775510203   , 22.77551020408163    , 23.0204081632653     , 23.265306122448976   , 23.510204081632654   , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 23.755102040816325   , 23.999999999999993   , 24.24489795918367    , 24.489795918367346   , 16.163265306122447   , 16.326530612244895   , 16.489795918367346   , 16.653061224489797   ,  8.244897959183675   ,  8.326530612244897   ,  8.408163265306122   ,  8.489795918367346   ,  7.265306122448979   ,  7.346938775510203   ,  7.428571428571427   ,  7.5102040816326525  , 14.857142857142858   , 15.020408163265303   , 15.183673469387752   , 15.346938775510203   , 22.77551020408163    , 23.0204081632653     , 23.265306122448976   , 23.510204081632654   , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 23.755102040816325   , 23.999999999999993   , 24.24489795918367    , 24.489795918367346   , 16.163265306122447   , 16.326530612244895   , 16.489795918367346   , 16.653061224489797   ,  8.244897959183675   ,  8.326530612244897   ,  8.408163265306122   ,  8.489795918367346   ,  7.265306122448979   ,  7.346938775510203   ,  7.428571428571427   ,  7.5102040816326525  , 14.857142857142858   , 15.020408163265303   , 15.183673469387752   , 15.346938775510203   , 22.77551020408163    , 23.0204081632653     , 23.265306122448976   , 23.510204081632654   , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 23.755102040816325   , 23.999999999999993   , 24.24489795918367    , 24.489795918367346   , 16.163265306122447   , 16.326530612244895   , 16.489795918367346   , 16.653061224489797   ,  8.244897959183675   ,  8.326530612244897   ,  8.408163265306122   ,  8.489795918367346   ,  7.265306122448979   ,  7.346938775510203   ,  7.428571428571427   ,  7.5102040816326525  , 14.857142857142858   , 15.020408163265303   , 15.183673469387752   , 15.346938775510203   , 22.77551020408163    , 23.0204081632653     , 23.265306122448976   , 23.510204081632654   , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 31.0204081632653     , 31.346938775510196   , 31.6734693877551     , 32.                  , 23.755102040816325   , 23.999999999999993   , 24.24489795918367    , 24.489795918367346   , 16.163265306122447   , 16.326530612244895   , 16.489795918367346   , 16.653061224489797   ,  8.244897959183675   ,  8.326530612244897   ,  8.408163265306122   ,  8.489795918367346   ,  5.938775510204081   ,  6.                  ,  6.061224489795918   ,  6.122448979591836   , 12.122448979591837   , 12.244897959183673   , 12.36734693877551    , 12.489795918367344   , 18.551020408163264   , 18.73469387755102    , 18.918367346938773   , 19.10204081632653    , 25.224489795918366   , 25.469387755102034   , 25.71428571428571    , 25.959183673469383   , 25.224489795918366   , 25.469387755102034   , 25.71428571428571    , 25.959183673469383   , 25.224489795918366   , 25.469387755102034   , 25.71428571428571    , 25.959183673469383   , 25.224489795918366   , 25.469387755102034   , 25.71428571428571    , 25.959183673469383   , 19.285714285714285   , 19.46938775510204    , 19.653061224489797   , 19.836734693877546   , 13.102040816326529   , 13.224489795918364   , 13.346938775510203   , 13.46938775510204    ,  6.673469387755102   ,  6.73469387755102    ,  6.795918367346939   ,  6.857142857142856   ,  4.285714285714285   ,  4.326530612244897   ,  4.36734693877551    ,  4.408163265306122   ,  8.73469387755102    ,  8.816326530612244   ,  8.89795918367347    ,  8.979591836734693   , 13.346938775510203   , 13.46938775510204    , 13.591836734693876   , 13.714285714285714   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 18.122448979591834   , 18.285714285714285   , 18.448979591836732   , 18.612244897959183   , 13.836734693877549   , 13.959183673469385   , 14.081632653061224   , 14.20408163265306    ,  9.387755102040817   ,  9.46938775510204    ,  9.551020408163264   ,  9.632653061224488   ,  4.775510204081632   ,  4.816326530612244   ,  4.857142857142857   ,  4.8979591836734695  ,  2.3061224489795915  ,  2.326530612244898   ,  2.346938775510204   ,  2.36734693877551    ,  4.693877551020408   ,  4.73469387755102    ,  4.775510204081632   ,  4.816326530612244   ,  7.163265306122448   ,  7.224489795918367   ,  7.285714285714285   ,  7.346938775510203   ,  9.714285714285714   ,  9.795918367346939   ,  9.877551020408163   ,  9.959183673469386   ,  9.714285714285714   ,  9.795918367346939   ,  9.877551020408163   ,  9.959183673469386   ,  9.714285714285714   ,  9.795918367346939   ,  9.877551020408163   ,  9.959183673469386   ,  9.714285714285714   ,  9.795918367346939   ,  9.877551020408163   ,  9.959183673469386   ,  7.408163265306122   ,  7.469387755102041   ,  7.530612244897959   ,  7.591836734693876   ,  5.020408163265306   ,  5.061224489795918   ,  5.1020408163265305  ,  5.142857142857142   ,  2.5510204081632653  ,  2.571428571428571   ,  2.5918367346938775  ,  2.6122448979591835  ,  2.6326530612244894  ,  2.6530612244897958  ,  2.6734693877551017  ,  2.693877551020408   ,  5.346938775510203   ,  5.387755102040816   ,  5.428571428571428   ,  5.469387755102041   ,  8.142857142857142   ,  8.204081632653061   ,  8.26530612244898    ,  8.326530612244898   , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    , 11.020408163265305   , 11.10204081632653    , 11.183673469387756   , 11.26530612244898    ,  8.387755102040815   ,  8.448979591836734   ,  8.510204081632653   ,  8.571428571428571   ,  5.673469387755102   ,  5.7142857142857135  ,  5.755102040816326   ,  5.795918367346938   ,  2.877551020408163   ,  2.897959183673469   ,  2.9183673469387754  ,  2.9387755102040813  ,  5.591836734693877   ,  5.63265306122449    ,  5.673469387755102   ,  5.7142857142857135  , 11.346938775510203   , 11.428571428571429   , 11.51020408163265    , 11.591836734693876   , 17.26530612244898    , 17.387755102040817   , 17.51020408163265    , 17.632653061224488   , 23.346938775510203   , 23.51020408163265    , 23.6734693877551     , 23.83673469387755    , 23.346938775510203   , 23.51020408163265    , 23.6734693877551     , 23.83673469387755    , 23.346938775510203   , 23.51020408163265    , 23.6734693877551     , 23.83673469387755    , 23.346938775510203   , 23.51020408163265    , 23.6734693877551     , 23.83673469387755    , 17.755102040816325   , 17.877551020408163   , 18.                  , 18.122448979591834   , 12.                  , 12.081632653061224   , 12.163265306122447   , 12.244897959183673   ,  6.081632653061224   ,  6.1224489795918355  ,  6.163265306122449   ,  6.204081632653061   ,  8.877551020408163   ,  8.938775510204081   ,  9.                  ,  9.061224489795917   , 17.999999999999996   , 18.122448979591837   , 18.24489795918367    , 18.36734693877551    , 27.36734693877551    , 27.551020408163264   , 27.734693877551017   , 27.918367346938773   , 36.97959183673469    , 37.22448979591837    , 37.46938775510204    , 37.71428571428571    , 36.97959183673469    , 37.22448979591837    , 37.46938775510204    , 37.71428571428571    , 36.97959183673469    , 37.22448979591837    , 37.46938775510204    , 37.71428571428571    , 36.97959183673469    , 37.22448979591837    , 37.46938775510204    , 37.71428571428571    , 28.10204081632653    , 28.285714285714285   , 28.46938775510204    , 28.653061224489793   , 18.97959183673469    , 19.10204081632653    , 19.224489795918366   , 19.346938775510203   ,  9.612244897959183   ,  9.6734693877551     ,  9.73469387755102    ,  9.795918367346939   , 12.489795918367346   , 12.571428571428571   , 12.653061224489797   , 12.734693877551019   , 25.306122448979586   , 25.46938775510204    , 25.632653061224488   , 25.795918367346935   , 38.44897959183673    , 38.6938775510204     , 38.938775510204074   , 39.183673469387756   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 39.42857142857142    , 39.6734693877551     , 39.91836734693877    , 40.16326530612245    , 26.612244897959183   , 26.77551020408163    , 26.938775510204078   , 27.102040816326532   , 13.46938775510204    , 13.551020408163263   , 13.63265306122449    , 13.714285714285715   , 12.489795918367346   , 12.571428571428571   , 12.653061224489797   , 12.734693877551019   , 25.306122448979586   , 25.46938775510204    , 25.632653061224488   , 25.795918367346935   , 38.44897959183673    , 38.6938775510204     , 38.938775510204074   , 39.183673469387756   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 39.42857142857142    , 39.6734693877551     , 39.91836734693877    , 40.16326530612245    , 26.612244897959183   , 26.77551020408163    , 26.938775510204078   , 27.102040816326532   , 13.46938775510204    , 13.551020408163263   , 13.63265306122449    , 13.714285714285715   , 12.489795918367346   , 12.571428571428571   , 12.653061224489797   , 12.734693877551019   , 25.306122448979586   , 25.46938775510204    , 25.632653061224488   , 25.795918367346935   , 38.44897959183673    , 38.6938775510204     , 38.938775510204074   , 39.183673469387756   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 39.42857142857142    , 39.6734693877551     , 39.91836734693877    , 40.16326530612245    , 26.612244897959183   , 26.77551020408163    , 26.938775510204078   , 27.102040816326532   , 13.46938775510204    , 13.551020408163263   , 13.63265306122449    , 13.714285714285715   , 12.489795918367346   , 12.571428571428571   , 12.653061224489797   , 12.734693877551019   , 25.306122448979586   , 25.46938775510204    , 25.632653061224488   , 25.795918367346935   , 38.44897959183673    , 38.6938775510204     , 38.938775510204074   , 39.183673469387756   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 51.91836734693877    , 52.244897959183675   , 52.57142857142857    , 52.897959183673464   , 39.42857142857142    , 39.6734693877551     , 39.91836734693877    , 40.16326530612245    , 26.612244897959183   , 26.77551020408163    , 26.938775510204078   , 27.102040816326532   , 13.46938775510204    , 13.551020408163263   , 13.63265306122449    , 13.714285714285715   ,  9.857142857142856   ,  9.918367346938775   ,  9.979591836734693   , 10.040816326530612   , 19.959183673469386   , 20.081632653061224   , 20.20408163265306    , 20.326530612244895   , 30.306122448979586   , 30.489795918367346   , 30.6734693877551     , 30.857142857142854   , 40.897959183673464   , 41.14285714285713    , 41.38775510204081    , 41.63265306122449    , 40.897959183673464   , 41.14285714285713    , 41.38775510204081    , 41.63265306122449    , 40.897959183673464   , 41.14285714285713    , 41.38775510204081    , 41.63265306122449    , 40.897959183673464   , 41.14285714285713    , 41.38775510204081    , 41.63265306122449    , 31.040816326530607   , 31.224489795918366   , 31.408163265306115   , 31.591836734693874   , 20.93877551020408    , 21.061224489795915   , 21.183673469387752   , 21.30612244897959    , 10.591836734693878   , 10.653061224489795   , 10.714285714285714   , 10.77551020408163    ,  6.8979591836734695  ,  6.938775510204081   ,  6.979591836734693   ,  7.020408163265305   , 13.959183673469386   , 14.04081632653061    , 14.122448979591837   , 14.204081632653061   , 21.18367346938775    , 21.30612244897959    , 21.428571428571427   , 21.55102040816326    , 28.571428571428566   , 28.734693877551017   , 28.897959183673464   , 29.061224489795915   , 28.571428571428566   , 28.734693877551017   , 28.897959183673464   , 29.061224489795915   , 28.571428571428566   , 28.734693877551017   , 28.897959183673464   , 29.061224489795915   , 28.571428571428566   , 28.734693877551017   , 28.897959183673464   , 29.061224489795915   , 21.6734693877551     , 21.795918367346935   , 21.918367346938773   , 22.040816326530614   , 14.612244897959183   , 14.693877551020407   , 14.775510204081632   , 14.857142857142858   ,  7.387755102040815   ,  7.428571428571428   ,  7.469387755102041   ,  7.5102040816326525  ,  3.6122448979591835  ,  3.6326530612244894  ,  3.6530612244897958  ,  3.6734693877551017  ,  7.3061224489795915  ,  7.346938775510203   ,  7.387755102040815   ,  7.428571428571428   , 11.081632653061224   , 11.142857142857142   , 11.20408163265306    , 11.26530612244898    , 14.938775510204081   , 15.020408163265305   , 15.102040816326529   , 15.183673469387756   , 14.938775510204081   , 15.020408163265305   , 15.102040816326529   , 15.183673469387756   , 14.938775510204081   , 15.020408163265305   , 15.102040816326529   , 15.183673469387756   , 14.938775510204081   , 15.020408163265305   , 15.102040816326529   , 15.183673469387756   , 11.326530612244898   , 11.387755102040815   , 11.448979591836734   , 11.510204081632653   ,  7.632653061224489   ,  7.673469387755102   ,  7.7142857142857135  ,  7.755102040816326   ,  3.8571428571428568  ,  3.877551020408163   ,  3.897959183673469   ,  3.9183673469387754  };
  const std::array<int, 4> in_shape = {{ 3, 10, 10, 4 }};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}

