/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.13.2.

#include <gtest/gtest.h>

#include "sycldnn/padding_mode.h"

#include "sycldnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/kernel_data_types.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using GTestTypePairs = sycldnn::types::ToGTestTypes<SNNTypePairs>::type;

template <typename Pair>
using AvgWindow5Stride1Grad =
    PoolingFixture<typename Pair::FirstType, typename Pair::SecondType,
                   pooling::Average, pooling::Backpropagate>;
TYPED_TEST_SUITE(AvgWindow5Stride1Grad, GTestTypePairs);
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.177777777777778,
                                         5.584444444444443,
                                         7.538611111111111,
                                         8.844166666666665,
                                         7.4775,
                                         6.2275,
                                         7.2844444444444445,
                                         9.571111111111112,
                                         12.67527777777778,
                                         14.314166666666665,
                                         11.947500000000002,
                                         9.8575,
                                         12.342777777777778,
                                         16.029444444444444,
                                         20.94611111111111,
                                         23.001666666666665,
                                         19.01,
                                         15.57,
                                         20.176111111111112,
                                         25.862777777777776,
                                         33.279444444444444,
                                         35.335,
                                         28.843333333333334,
                                         23.403333333333336,
                                         18.642777777777777,
                                         23.829444444444444,
                                         30.55861111111111,
                                         32.197500000000005,
                                         26.205833333333334,
                                         21.215833333333336,
                                         16.47611111111111,
                                         21.022777777777776,
                                         26.901944444444442,
                                         28.2075,
                                         22.915833333333335,
                                         18.52583333333333};
  const std::array<int, 4> in_shape = {{1, 6, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.04, 0.12, 0.12, 0.12, 0.12, 0.08, 0.16, 0.4,  0.4,  0.4,  0.4,  0.24,
      0.16, 0.4,  0.4,  0.4,  0.4,  0.24, 0.16, 0.4,  0.4,  0.4,  0.4,  0.24,
      0.16, 0.4,  0.4,  0.4,  0.4,  0.24, 0.12, 0.28, 0.28, 0.28, 0.28, 0.16};
  const std::array<int, 4> in_shape = {{1, 6, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {7.741944444444444,  8.355555555555556,
                                         10.398611111111112, 11.168888888888887,
                                         14.111111111111112, 15.077222222222222,
                                         16.72222222222222,  17.68833333333333,
                                         14.184722222222224, 14.955,
                                         11.84138888888889,  12.455,
                                         13.79861111111111,  14.568888888888889,
                                         18.17527777777778,  19.142222222222223,
                                         24.137777777777778, 25.35055555555556,
                                         27.415555555555553, 28.62833333333333,
                                         22.928055555555556, 23.895000000000003,
                                         18.944722222222225, 19.715,
                                         23.71944444444444,  24.685555555555556,
                                         30.846111111111114, 32.05888888888889,
                                         40.37111111111111,  41.89222222222222,
                                         44.48222222222222,  46.00333333333333,
                                         36.80722222222222,  38.02,
                                         30.17388888888889,  31.14,
                                         39.38611111111111,  40.352222222222224,
                                         50.512777777777785, 51.72555555555555,
                                         65.03777777777779,  66.55888888888889,
                                         69.14888888888889,  70.67,
                                         56.47388888888889,  57.68666666666667,
                                         45.840555555555554, 46.80666666666667,
                                         36.51527777777778,  37.285555555555554,
                                         46.69194444444445,  47.65888888888889,
                                         59.90444444444445,  61.11722222222222,
                                         63.18222222222222,  64.39500000000001,
                                         51.444722222222225, 52.41166666666667,
                                         41.66138888888889,  42.43166666666667,
                                         32.33861111111111,  32.95222222222222,
                                         41.27527777777778,  42.04555555555555,
                                         52.83777777777778,  53.803888888888885,
                                         55.44888888888889,  56.415,
                                         45.061388888888885, 45.83166666666667,
                                         36.43805555555555,  37.05166666666666};
  const std::array<int, 4> in_shape = {{1, 6, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.48000000000000004,
                                         0.56,
                                         0.48000000000000004,
                                         0.56,
                                         0.48000000000000004,
                                         0.56,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32};
  const std::array<int, 4> in_shape = {{1, 6, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {14.870277777777776,
                                         15.483888888888888,
                                         16.0975,
                                         16.711111111111112,
                                         20.026944444444446,
                                         20.797222222222224,
                                         21.5675,
                                         22.337777777777774,
                                         27.256111111111114,
                                         28.222222222222225,
                                         29.188333333333333,
                                         30.154444444444444,
                                         32.47833333333333,
                                         33.44444444444444,
                                         34.410555555555554,
                                         35.37666666666666,
                                         27.59916666666667,
                                         28.369444444444447,
                                         29.139722222222225,
                                         29.91,
                                         23.069166666666668,
                                         23.68277777777778,
                                         24.29638888888889,
                                         24.91,
                                         26.826944444444443,
                                         27.59722222222222,
                                         28.3675,
                                         29.137777777777778,
                                         35.383611111111115,
                                         36.35055555555556,
                                         37.317499999999995,
                                         38.284444444444446,
                                         47.06277777777778,
                                         48.275555555555556,
                                         49.48833333333333,
                                         50.70111111111112,
                                         53.61833333333334,
                                         54.831111111111106,
                                         56.04388888888889,
                                         57.25666666666666,
                                         44.889166666666675,
                                         45.85611111111111,
                                         46.823055555555555,
                                         47.790000000000006,
                                         37.119166666666665,
                                         37.88944444444445,
                                         38.65972222222223,
                                         39.43,
                                         46.47277777777778,
                                         47.43888888888888,
                                         48.405,
                                         49.37111111111111,
                                         60.479444444444454,
                                         61.69222222222223,
                                         62.905,
                                         64.11777777777777,
                                         79.22111111111111,
                                         80.74222222222222,
                                         82.26333333333332,
                                         83.78444444444445,
                                         87.44333333333334,
                                         88.96444444444444,
                                         90.48555555555555,
                                         92.00666666666666,
                                         72.40166666666667,
                                         73.61444444444444,
                                         74.82722222222223,
                                         76.04,
                                         59.38166666666667,
                                         60.34777777777778,
                                         61.31388888888889,
                                         62.28,
                                         77.80611111111111,
                                         78.77222222222223,
                                         79.73833333333333,
                                         80.70444444444445,
                                         99.81277777777777,
                                         101.02555555555557,
                                         102.23833333333333,
                                         103.4511111111111,
                                         128.55444444444444,
                                         130.07555555555558,
                                         131.59666666666666,
                                         133.11777777777777,
                                         136.77666666666667,
                                         138.29777777777778,
                                         139.8188888888889,
                                         141.34,
                                         111.73500000000001,
                                         112.94777777777777,
                                         114.16055555555556,
                                         115.37333333333333,
                                         90.715,
                                         91.68111111111111,
                                         92.64722222222223,
                                         93.61333333333334,
                                         72.26027777777777,
                                         73.03055555555557,
                                         73.80083333333333,
                                         74.57111111111111,
                                         92.41694444444445,
                                         93.3838888888889,
                                         94.35083333333334,
                                         95.31777777777778,
                                         118.59611111111111,
                                         119.8088888888889,
                                         121.02166666666666,
                                         122.23444444444443,
                                         125.15166666666667,
                                         126.36444444444444,
                                         127.57722222222222,
                                         128.79000000000002,
                                         101.92250000000001,
                                         102.88944444444445,
                                         103.85638888888887,
                                         104.82333333333334,
                                         82.55250000000001,
                                         83.32277777777777,
                                         84.09305555555555,
                                         84.86333333333334,
                                         64.0636111111111,
                                         64.67722222222223,
                                         65.29083333333332,
                                         65.90444444444444,
                                         81.78027777777777,
                                         82.55055555555556,
                                         83.32083333333334,
                                         84.0911111111111,
                                         104.70944444444446,
                                         105.67555555555556,
                                         106.64166666666667,
                                         107.60777777777777,
                                         109.93166666666667,
                                         110.89777777777778,
                                         111.86388888888888,
                                         112.83,
                                         89.3525,
                                         90.12277777777777,
                                         90.89305555555555,
                                         91.66333333333334,
                                         72.2625,
                                         72.8761111111111,
                                         73.48972222222221,
                                         74.10333333333332};
  const std::array<int, 4> in_shape = {{1, 6, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64};
  const std::array<int, 4> in_shape = {{1, 6, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.686944444444444,
                                         6.2236111111111105,
                                         7.916944444444443,
                                         8.451666666666666,
                                         10.266944444444443,
                                         8.886944444444444,
                                         7.350277777777778,
                                         8.26361111111111,
                                         10.800277777777776,
                                         13.53361111111111,
                                         13.951666666666666,
                                         16.483611111111106,
                                         14.143611111111111,
                                         11.606944444444446,
                                         14.105277777777777,
                                         18.241944444444442,
                                         22.62527777777778,
                                         22.751666666666665,
                                         26.325277777777774,
                                         22.435277777777777,
                                         18.298611111111114,
                                         23.244166666666665,
                                         29.714166666666664,
                                         36.430833333333325,
                                         35.584999999999994,
                                         40.13083333333333,
                                         33.907500000000006,
                                         27.4375,
                                         21.515,
                                         27.435000000000002,
                                         33.55166666666666,
                                         32.56,
                                         36.50166666666667,
                                         30.778333333333336,
                                         24.858333333333334,
                                         19.034999999999997,
                                         24.235,
                                         29.591666666666672,
                                         28.6,
                                         31.94166666666667,
                                         26.898333333333333,
                                         21.69833333333333};
  const std::array<int, 4> in_shape = {{1, 6, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.24,
                                         0.24,
                                         0.2,
                                         0.12,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.16,
                                         0.36,
                                         0.6,
                                         0.6,
                                         0.6,
                                         0.44,
                                         0.24};
  const std::array<int, 4> in_shape = {{1, 6, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {8.760277777777778,  9.373888888888889,
                                         11.676944444444445, 12.447222222222221,
                                         14.906944444444447, 15.833888888888886,
                                         16.041666666666668, 16.903333333333332,
                                         19.606944444444448, 20.533888888888885,
                                         17.003611111111113, 17.773888888888887,
                                         14.086944444444445, 14.700555555555557,
                                         15.756944444444446, 16.52722222222222,
                                         20.63361111111111,  21.60055555555555,
                                         25.90361111111111,  27.06722222222222,
                                         26.821666666666665, 27.903333333333332,
                                         31.803611111111113, 32.96722222222221,
                                         27.32027777777778,  28.287222222222223,
                                         22.443611111111114, 23.213888888888892,
                                         27.244444444444447, 28.210555555555555,
                                         35.27111111111111,  36.483888888888885,
                                         43.79111111111111,  45.25055555555556,
                                         44.14666666666666,  45.50333333333333,
                                         51.19111111111111,  52.65055555555555,
                                         43.65777777777778,  44.870555555555555,
                                         35.63111111111111,  36.59722222222223,
                                         45.522222222222226, 46.48833333333333,
                                         58.215555555555554, 59.42833333333333,
                                         71.40222222222222,  72.86166666666665,
                                         69.81333333333333,  71.16999999999999,
                                         78.80222222222221,  80.26166666666666,
                                         66.60222222222222,  67.81500000000001,
                                         53.90888888888889,  54.875,
                                         42.25972222222222,  43.03,
                                         53.903055555555554, 54.870000000000005,
                                         65.93972222222223,  67.10333333333332,
                                         64.03833333333333,  65.12,
                                         71.83972222222222,  73.00333333333334,
                                         60.58972222222222,  61.55666666666667,
                                         48.94638888888889,  49.71666666666667,
                                         37.45638888888889,  38.06999999999999,
                                         47.69972222222222,  48.47,
                                         58.256388888888885, 59.183333333333344,
                                         56.33833333333333,  57.2,
                                         62.95638888888889,  63.88333333333334,
                                         53.02638888888889,  53.79666666666667,
                                         42.783055555555556, 43.39666666666666};
  const std::array<int, 4> in_shape = {{1, 6, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.32,
                                         0.4,
                                         0.2,
                                         0.24,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.28,
                                         0.32,
                                         0.64,
                                         0.72,
                                         1.08,
                                         1.2,
                                         1.08,
                                         1.2,
                                         1.08,
                                         1.2,
                                         0.8,
                                         0.88,
                                         0.44,
                                         0.48};
  const std::array<int, 4> in_shape = {{1, 6, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.906944444444445,
                                         17.520555555555557,
                                         18.13416666666667,
                                         18.747777777777777,
                                         22.583611111111114,
                                         23.35388888888889,
                                         24.124166666666667,
                                         24.894444444444442,
                                         28.886944444444445,
                                         29.813888888888894,
                                         30.74083333333333,
                                         31.667777777777772,
                                         31.22166666666667,
                                         32.083333333333336,
                                         32.945,
                                         33.806666666666665,
                                         38.286944444444444,
                                         39.213888888888896,
                                         40.14083333333333,
                                         41.06777777777777,
                                         33.23694444444445,
                                         34.007222222222225,
                                         34.777499999999996,
                                         35.547777777777775,
                                         27.560277777777777,
                                         28.17388888888889,
                                         28.7875,
                                         29.401111111111113,
                                         30.74361111111111,
                                         31.513888888888893,
                                         32.28416666666667,
                                         33.05444444444444,
                                         40.30027777777779,
                                         41.26722222222222,
                                         42.23416666666667,
                                         43.2011111111111,
                                         50.64361111111111,
                                         51.80722222222222,
                                         52.970833333333324,
                                         54.13444444444444,
                                         52.561666666666675,
                                         53.64333333333333,
                                         54.724999999999994,
                                         55.806666666666665,
                                         62.44361111111111,
                                         63.60722222222223,
                                         64.77083333333333,
                                         65.93444444444442,
                                         53.673611111111114,
                                         54.64055555555556,
                                         55.607499999999995,
                                         56.574444444444445,
                                         44.11694444444444,
                                         44.88722222222223,
                                         45.6575,
                                         46.427777777777784,
                                         53.522777777777776,
                                         54.488888888888894,
                                         55.455000000000005,
                                         56.42111111111111,
                                         69.32944444444445,
                                         70.54222222222222,
                                         71.755,
                                         72.96777777777777,
                                         86.12277777777777,
                                         87.58222222222221,
                                         89.04166666666666,
                                         90.50111111111111,
                                         86.93666666666668,
                                         88.29333333333332,
                                         89.64999999999999,
                                         91.00666666666666,
                                         100.92277777777778,
                                         102.38222222222223,
                                         103.84166666666665,
                                         105.3011111111111,
                                         86.10277777777779,
                                         87.31555555555556,
                                         88.52833333333332,
                                         89.74111111111111,
                                         70.29611111111112,
                                         71.26222222222222,
                                         72.22833333333332,
                                         73.19444444444446,
                                         90.07833333333333,
                                         91.04444444444445,
                                         92.01055555555556,
                                         92.97666666666666,
                                         115.21833333333335,
                                         116.43111111111111,
                                         117.64388888888888,
                                         118.85666666666665,
                                         141.345,
                                         142.80444444444444,
                                         144.26388888888886,
                                         145.7233333333333,
                                         138.27,
                                         139.62666666666667,
                                         140.98333333333332,
                                         142.33999999999997,
                                         156.14500000000004,
                                         157.60444444444443,
                                         159.06388888888884,
                                         160.5233333333333,
                                         131.99166666666667,
                                         133.20444444444445,
                                         134.4172222222222,
                                         135.63000000000002,
                                         106.85166666666667,
                                         107.81777777777778,
                                         108.78388888888887,
                                         109.75,
                                         83.74916666666667,
                                         84.51944444444445,
                                         85.28972222222222,
                                         86.06,
                                         106.83916666666667,
                                         107.80611111111111,
                                         108.77305555555554,
                                         109.74000000000001,
                                         130.71583333333334,
                                         131.87944444444446,
                                         133.04305555555553,
                                         134.20666666666665,
                                         126.995,
                                         128.07666666666665,
                                         129.15833333333333,
                                         130.24,
                                         142.51583333333335,
                                         143.67944444444444,
                                         144.84305555555554,
                                         146.0066666666667,
                                         120.2125,
                                         121.17944444444444,
                                         122.14638888888888,
                                         123.11333333333334,
                                         97.1225,
                                         97.89277777777778,
                                         98.66305555555554,
                                         99.43333333333334,
                                         74.29916666666666,
                                         74.91277777777778,
                                         75.52638888888887,
                                         76.13999999999999,
                                         94.62916666666668,
                                         95.39944444444444,
                                         96.1697222222222,
                                         96.94,
                                         115.58583333333334,
                                         116.51277777777777,
                                         117.4397222222222,
                                         118.36666666666669,
                                         111.81500000000001,
                                         112.67666666666666,
                                         113.53833333333331,
                                         114.4,
                                         124.98583333333333,
                                         125.91277777777778,
                                         126.8397222222222,
                                         127.76666666666668,
                                         105.2825,
                                         106.05277777777778,
                                         106.82305555555554,
                                         107.59333333333333,
                                         84.9525,
                                         85.56611111111111,
                                         86.17972222222222,
                                         86.79333333333332};
  const std::array<int, 4> in_shape = {{1, 6, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         1.2000000000000002,
                                         1.28,
                                         1.3599999999999999,
                                         1.44,
                                         2.04,
                                         2.16,
                                         2.28,
                                         2.4,
                                         2.04,
                                         2.16,
                                         2.28,
                                         2.4,
                                         2.04,
                                         2.16,
                                         2.28,
                                         2.4,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         0.92,
                                         0.96};
  const std::array<int, 4> in_shape = {{1, 6, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      5.196111111111111,  6.862777777777778,  8.686111111111112,
      8.671666666666667,  9.650833333333333,  11.963055555555556,
      10.296388888888888, 8.473055555555556,  9.242777777777778,
      12.029444444444444, 15.012777777777778, 14.531666666666666,
      15.760833333333334, 19.12638888888889,  16.33972222222222,
      13.356388888888889, 15.867777777777778, 20.454444444444444,
      25.28777777777778,  23.956666666666667, 25.498333333333335,
      30.447222222222223, 25.860555555555553, 21.02722222222222,
      26.312222222222225, 33.565555555555555, 41.065555555555555,
      37.95666666666666,  39.49833333333333,  46.224999999999994,
      38.971666666666664, 31.471666666666668, 24.38722222222222,
      31.040555555555553, 37.89055555555556,  34.83166666666666,
      36.06083333333333,  42.00416666666666,  35.350833333333334,
      28.500833333333333, 21.59388888888889,  27.447222222222226,
      33.45722222222223,  30.651666666666667, 31.630833333333335,
      36.73416666666667,  30.88083333333333,  24.870833333333334};
  const std::array<int, 4> in_shape = {{1, 6, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.4,
                                         0.4,
                                         0.36,
                                         0.28,
                                         0.16,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.2,
                                         0.44,
                                         0.72,
                                         1.04,
                                         1.04,
                                         0.8400000000000001,
                                         0.6000000000000001,
                                         0.32};
  const std::array<int, 4> in_shape = {{1, 6, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {9.778611111111111,
                                         10.392222222222221,
                                         12.955277777777779,
                                         13.725555555555555,
                                         16.44527777777778,
                                         17.372222222222224,
                                         16.520833333333336,
                                         17.343333333333334,
                                         18.479166666666668,
                                         19.301666666666666,
                                         22.999166666666667,
                                         23.926111111111112,
                                         19.822499999999998,
                                         20.592777777777776,
                                         16.3325,
                                         16.94611111111111,
                                         17.71527777777778,
                                         18.485555555555557,
                                         23.091944444444447,
                                         24.058888888888887,
                                         28.861944444444447,
                                         30.025555555555556,
                                         28.030833333333337,
                                         29.063333333333333,
                                         30.48916666666667,
                                         31.52166666666667,
                                         37.08916666666667,
                                         38.25277777777778,
                                         31.7125,
                                         32.67944444444444,
                                         25.9425,
                                         26.712777777777777,
                                         30.769444444444442,
                                         31.735555555555557,
                                         39.696111111111115,
                                         40.90888888888889,
                                         49.11611111111111,
                                         50.57555555555556,
                                         46.61833333333333,
                                         47.913333333333334,
                                         49.70166666666667,
                                         50.99666666666667,
                                         59.435,
                                         60.894444444444446,
                                         50.50833333333333,
                                         51.72111111111111,
                                         41.08833333333333,
                                         42.05444444444444,
                                         51.65833333333333,
                                         52.62444444444445,
                                         65.91833333333334,
                                         67.13111111111111,
                                         80.67166666666667,
                                         82.13111111111111,
                                         74.61833333333333,
                                         75.91333333333333,
                                         77.70166666666665,
                                         78.99666666666666,
                                         90.99055555555555,
                                         92.44999999999999,
                                         76.73055555555555,
                                         77.94333333333333,
                                         61.977222222222224,
                                         62.943333333333335,
                                         48.00416666666666,
                                         48.77444444444444,
                                         61.11416666666666,
                                         62.081111111111106,
                                         74.6175,
                                         75.78111111111112,
                                         68.63083333333333,
                                         69.66333333333333,
                                         71.08916666666666,
                                         72.12166666666666,
                                         82.84472222222222,
                                         84.00833333333333,
                                         69.73472222222222,
                                         70.70166666666667,
                                         56.23138888888889,
                                         57.001666666666665,
                                         42.57416666666666,
                                         43.18777777777778,
                                         54.12416666666666,
                                         54.89444444444445,
                                         65.9875,
                                         66.91444444444446,
                                         60.48083333333332,
                                         61.303333333333335,
                                         62.439166666666665,
                                         63.26166666666667,
                                         72.54138888888889,
                                         73.46833333333333,
                                         60.99138888888889,
                                         61.76166666666666,
                                         49.128055555555555,
                                         49.74166666666667};
  const std::array<int, 4> in_shape = {{1, 6, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.6000000000000001,
                                         0.72,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.36,
                                         0.4,
                                         0.8,
                                         0.88,
                                         1.32,
                                         1.44,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.56,
                                         1.6800000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         0.6,
                                         0.64};
  const std::array<int, 4> in_shape = {{1, 6, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         60.57277777777778,
                                         61.538888888888884,
                                         62.505,
                                         63.471111111111114,
                                         78.17944444444444,
                                         79.39222222222223,
                                         80.605,
                                         81.81777777777778,
                                         96.77277777777779,
                                         98.23222222222222,
                                         99.69166666666668,
                                         101.15111111111112,
                                         91.94166666666666,
                                         93.23666666666666,
                                         94.53166666666667,
                                         95.82666666666667,
                                         98.10833333333333,
                                         99.40333333333334,
                                         100.69833333333332,
                                         101.99333333333334,
                                         117.41055555555556,
                                         118.87,
                                         120.32944444444445,
                                         121.78888888888889,
                                         99.8038888888889,
                                         101.01666666666667,
                                         102.22944444444444,
                                         103.44222222222221,
                                         81.21055555555556,
                                         82.17666666666666,
                                         83.14277777777778,
                                         84.10888888888888,
                                         102.35055555555556,
                                         103.31666666666666,
                                         104.2827777777778,
                                         105.2488888888889,
                                         130.62388888888887,
                                         131.83666666666667,
                                         133.04944444444445,
                                         134.26222222222222,
                                         159.8838888888889,
                                         161.34333333333333,
                                         162.80277777777778,
                                         164.26222222222222,
                                         147.94166666666666,
                                         149.23666666666665,
                                         150.53166666666667,
                                         151.82666666666665,
                                         154.10833333333332,
                                         155.4033333333333,
                                         156.69833333333332,
                                         157.9933333333333,
                                         180.52166666666665,
                                         181.9811111111111,
                                         183.44055555555556,
                                         184.89999999999998,
                                         152.2483333333333,
                                         153.4611111111111,
                                         154.6738888888889,
                                         155.88666666666666,
                                         122.98833333333334,
                                         123.95444444444445,
                                         124.92055555555555,
                                         125.88666666666667,
                                         95.23805555555556,
                                         96.00833333333333,
                                         96.77861111111112,
                                         97.54888888888888,
                                         121.26138888888889,
                                         122.22833333333332,
                                         123.1952777777778,
                                         124.16222222222221,
                                         148.0713888888889,
                                         149.235,
                                         150.39861111111114,
                                         151.56222222222223,
                                         136.22916666666666,
                                         137.26166666666666,
                                         138.29416666666668,
                                         139.32666666666665,
                                         141.14583333333331,
                                         142.1783333333333,
                                         143.21083333333337,
                                         144.2433333333333,
                                         164.52583333333334,
                                         165.68944444444443,
                                         166.85305555555558,
                                         168.01666666666665,
                                         138.5025,
                                         139.46944444444443,
                                         140.4363888888889,
                                         141.40333333333334,
                                         111.69250000000001,
                                         112.46277777777777,
                                         113.23305555555555,
                                         114.00333333333333,
                                         84.53472222222223,
                                         85.14833333333333,
                                         85.76194444444445,
                                         86.37555555555556,
                                         107.47805555555556,
                                         108.24833333333332,
                                         109.01861111111113,
                                         109.7888888888889,
                                         131.04805555555555,
                                         131.975,
                                         132.90194444444447,
                                         133.8288888888889,
                                         120.13916666666665,
                                         120.96166666666664,
                                         121.78416666666669,
                                         122.60666666666667,
                                         124.05583333333334,
                                         124.87833333333333,
                                         125.70083333333335,
                                         126.52333333333334,
                                         144.15583333333333,
                                         145.08277777777778,
                                         146.00972222222222,
                                         146.93666666666667,
                                         121.2125,
                                         121.98277777777778,
                                         122.75305555555556,
                                         123.52333333333333,
                                         97.6425,
                                         98.25611111111111,
                                         98.86972222222221,
                                         99.48333333333333};
  const std::array<int, 4> in_shape = {{1, 6, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.68,
                                         0.72,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.,
                                         3.12,
                                         3.24,
                                         3.3600000000000003,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         1.24,
                                         1.28};
  const std::array<int, 4> in_shape = {{1, 6, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.177777777777778,
                                         5.584444444444443,
                                         7.538611111111111,
                                         8.844166666666665,
                                         7.4775,
                                         6.2275,
                                         7.2844444444444445,
                                         9.571111111111112,
                                         12.67527777777778,
                                         14.314166666666665,
                                         11.947500000000002,
                                         9.8575,
                                         11.331111111111111,
                                         14.73777777777778,
                                         19.291944444444447,
                                         21.264166666666668,
                                         17.5975,
                                         14.427499999999998,
                                         17.086666666666666,
                                         21.926666666666662,
                                         28.251666666666665,
                                         30.085,
                                         24.584999999999997,
                                         19.965,
                                         25.43111111111111,
                                         32.437777777777775,
                                         41.491944444444435,
                                         43.46416666666666,
                                         35.29750000000001,
                                         28.527500000000003,
                                         23.264444444444447,
                                         29.631111111111114,
                                         37.835277777777776,
                                         39.47416666666667,
                                         32.00750000000001,
                                         25.8375,
                                         20.157777777777778,
                                         25.64444444444445,
                                         32.69861111111111,
                                         34.00416666666667,
                                         27.5375,
                                         22.207499999999996};
  const std::array<int, 4> in_shape = {{1, 7, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.08,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.32,
                                         0.72,
                                         0.72,
                                         0.72,
                                         0.72,
                                         0.4,
                                         0.2,
                                         0.44,
                                         0.44,
                                         0.44,
                                         0.44,
                                         0.24};
  const std::array<int, 4> in_shape = {{1, 7, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {7.741944444444444,  8.355555555555556,
                                         10.398611111111112, 11.168888888888887,
                                         14.111111111111112, 15.077222222222222,
                                         16.72222222222222,  17.68833333333333,
                                         14.184722222222224, 14.955,
                                         11.84138888888889,  12.455,
                                         13.79861111111111,  14.568888888888889,
                                         18.17527777777778,  19.142222222222223,
                                         24.137777777777778, 25.35055555555556,
                                         27.415555555555553, 28.62833333333333,
                                         22.928055555555556, 23.895000000000003,
                                         18.944722222222225, 19.715,
                                         21.735277777777778, 22.662222222222223,
                                         28.311944444444446, 29.47555555555556,
                                         37.12444444444445,  38.58388888888889,
                                         41.068888888888885, 42.528333333333336,
                                         34.03138888888889,  35.195,
                                         27.92805555555556,  28.854999999999997,
                                         33.31166666666667,  34.17333333333333,
                                         42.77166666666667,  43.853333333333325,
                                         55.146666666666675, 56.50333333333333,
                                         58.81333333333333,  60.17,
                                         48.08833333333334,  49.169999999999995,
                                         39.068333333333335, 39.93,
                                         49.93527777777778,  50.86222222222222,
                                         63.71194444444445,  64.87555555555555,
                                         81.52444444444446,  82.98388888888887,
                                         85.4688888888889,   86.92833333333331,
                                         69.43138888888888,  70.59500000000001,
                                         56.128055555555555, 57.05500000000001,
                                         45.758611111111115, 46.52888888888889,
                                         58.29527777777778,  59.26222222222223,
                                         74.45777777777778,  75.67055555555555,
                                         77.73555555555555,  78.94833333333334,
                                         63.04805555555555,  64.01500000000001,
                                         50.90472222222222,  51.675,
                                         39.70194444444444,  40.315555555555555,
                                         50.518611111111106, 51.2888888888889,
                                         64.43111111111111,  65.39722222222223,
                                         67.04222222222222,  68.00833333333334,
                                         54.30472222222222,  55.075,
                                         43.80138888888889,  44.41499999999999};
  const std::array<int, 4> in_shape = {{1, 7, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         1.28,
                                         1.44,
                                         1.28,
                                         1.44,
                                         1.28,
                                         1.44,
                                         1.28,
                                         1.44,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.44,
                                         0.48};
  const std::array<int, 4> in_shape = {{1, 7, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {14.870277777777776,
                                         15.483888888888888,
                                         16.0975,
                                         16.711111111111112,
                                         20.026944444444446,
                                         20.797222222222224,
                                         21.5675,
                                         22.337777777777774,
                                         27.256111111111114,
                                         28.222222222222225,
                                         29.188333333333333,
                                         30.154444444444444,
                                         32.47833333333333,
                                         33.44444444444444,
                                         34.410555555555554,
                                         35.37666666666666,
                                         27.59916666666667,
                                         28.369444444444447,
                                         29.139722222222225,
                                         29.91,
                                         23.069166666666668,
                                         23.68277777777778,
                                         24.29638888888889,
                                         24.91,
                                         26.826944444444443,
                                         27.59722222222222,
                                         28.3675,
                                         29.137777777777778,
                                         35.383611111111115,
                                         36.35055555555556,
                                         37.317499999999995,
                                         38.284444444444446,
                                         47.06277777777778,
                                         48.275555555555556,
                                         49.48833333333333,
                                         50.70111111111112,
                                         53.61833333333334,
                                         54.831111111111106,
                                         56.04388888888889,
                                         57.25666666666666,
                                         44.889166666666675,
                                         45.85611111111111,
                                         46.823055555555555,
                                         47.790000000000006,
                                         37.119166666666665,
                                         37.88944444444445,
                                         38.65972222222223,
                                         39.43,
                                         42.54361111111112,
                                         43.470555555555556,
                                         44.3975,
                                         45.324444444444445,
                                         55.46027777777779,
                                         56.62388888888889,
                                         57.787499999999994,
                                         58.95111111111112,
                                         72.78944444444446,
                                         74.2488888888889,
                                         75.70833333333333,
                                         77.16777777777779,
                                         80.67833333333334,
                                         82.13777777777777,
                                         83.59722222222221,
                                         85.05666666666667,
                                         66.89916666666667,
                                         68.06277777777778,
                                         69.22638888888889,
                                         70.39,
                                         54.92916666666666,
                                         55.85611111111112,
                                         56.78305555555556,
                                         57.709999999999994,
                                         65.76166666666667,
                                         66.62333333333333,
                                         67.485,
                                         68.34666666666666,
                                         84.46166666666667,
                                         85.54333333333334,
                                         86.62499999999999,
                                         87.70666666666665,
                                         108.93666666666668,
                                         110.29333333333335,
                                         111.64999999999999,
                                         113.00666666666666,
                                         116.27000000000002,
                                         117.62666666666667,
                                         118.98333333333333,
                                         120.34,
                                         95.09500000000001,
                                         96.17666666666668,
                                         97.25833333333334,
                                         98.33999999999999,
                                         77.27499999999999,
                                         78.13666666666667,
                                         78.99833333333333,
                                         79.86,
                                         98.94361111111112,
                                         99.87055555555555,
                                         100.79749999999999,
                                         101.72444444444444,
                                         126.2602777777778,
                                         127.4238888888889,
                                         128.58749999999998,
                                         129.7511111111111,
                                         161.58944444444447,
                                         163.0488888888889,
                                         164.50833333333335,
                                         165.96777777777774,
                                         169.47833333333332,
                                         170.9377777777778,
                                         172.3972222222222,
                                         173.85666666666663,
                                         137.69916666666668,
                                         138.86277777777775,
                                         140.02638888888887,
                                         141.19000000000003,
                                         111.32916666666667,
                                         112.25611111111111,
                                         113.18305555555555,
                                         114.11000000000001,
                                         90.74694444444445,
                                         91.51722222222223,
                                         92.28749999999998,
                                         93.05777777777779,
                                         115.62361111111113,
                                         116.59055555555555,
                                         117.55749999999998,
                                         118.52444444444446,
                                         147.70277777777778,
                                         148.91555555555556,
                                         150.12833333333333,
                                         151.3411111111111,
                                         154.25833333333335,
                                         155.4711111111111,
                                         156.68388888888887,
                                         157.89666666666668,
                                         125.12916666666668,
                                         126.0961111111111,
                                         127.06305555555555,
                                         128.03000000000003,
                                         101.03916666666667,
                                         101.80944444444444,
                                         102.57972222222222,
                                         103.35,
                                         78.79027777777779,
                                         79.40388888888889,
                                         80.01749999999998,
                                         80.63111111111111,
                                         100.26694444444445,
                                         101.03722222222221,
                                         101.80749999999998,
                                         102.5777777777778,
                                         127.89611111111113,
                                         128.86222222222221,
                                         129.82833333333332,
                                         130.79444444444445,
                                         133.11833333333334,
                                         134.08444444444444,
                                         135.05055555555555,
                                         136.01666666666668,
                                         107.83916666666667,
                                         108.60944444444443,
                                         109.37972222222221,
                                         110.15,
                                         86.98916666666666,
                                         87.60277777777777,
                                         88.21638888888889,
                                         88.82999999999998};
  const std::array<int, 4> in_shape = {{1, 7, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         1.04,
                                         1.12,
                                         1.2,
                                         1.28,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         1.3599999999999999,
                                         1.44,
                                         1.52,
                                         1.6,
                                         0.68,
                                         0.72,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         0.92,
                                         0.96};
  const std::array<int, 4> in_shape = {{1, 7, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      4.686944444444444,  6.2236111111111105, 7.916944444444443,
      8.451666666666666,  10.266944444444443, 8.886944444444444,
      7.350277777777778,  8.26361111111111,   10.800277777777776,
      13.53361111111111,  13.951666666666666, 16.483611111111106,
      14.143611111111111, 11.606944444444446, 12.936944444444444,
      16.75361111111111,  20.806944444444444, 20.991666666666667,
      24.356944444444437, 20.776944444444442, 16.96027777777778,
      19.671666666666667, 25.171666666666663, 30.891666666666662,
      30.249999999999996, 34.19166666666666,  28.91166666666666,
      23.41166666666667,  29.386944444444445, 37.403611111111104,
      45.65694444444444,  44.09166666666666,  49.20694444444444,
      41.426944444444445, 33.41027777777778,  26.906944444444445,
      34.203611111111115, 41.69694444444445,  40.13166666666667,
      44.64694444444444,  37.54694444444445,  30.250277777777775,
      23.33027777777778,  29.626944444444447, 36.08027777777778,
      34.63166666666667,  38.430277777777775, 32.29027777777778,
      25.99361111111111};
  const std::array<int, 4> in_shape = {{1, 7, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.24,
                                         0.24,
                                         0.2,
                                         0.12,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.44000000000000006,
                                         0.96,
                                         1.56,
                                         1.56,
                                         1.56,
                                         1.12,
                                         0.6,
                                         0.28,
                                         0.6000000000000001,
                                         0.9600000000000001,
                                         0.9600000000000001,
                                         0.9600000000000001,
                                         0.6799999999999999,
                                         0.36};
  const std::array<int, 4> in_shape = {{1, 7, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.760277777777778,  9.373888888888889,  11.676944444444445,
      12.447222222222221, 14.906944444444447, 15.833888888888886,
      16.041666666666668, 16.903333333333332, 19.606944444444448,
      20.533888888888885, 17.003611111111113, 17.773888888888887,
      14.086944444444445, 14.700555555555557, 15.756944444444446,
      16.52722222222222,  20.63361111111111,  21.60055555555555,
      25.90361111111111,  27.06722222222222,  26.821666666666665,
      27.903333333333332, 31.803611111111113, 32.96722222222221,
      27.32027777777778,  28.287222222222223, 22.443611111111114,
      23.213888888888892, 24.946944444444448, 25.87388888888889,
      32.343611111111116, 33.50722222222222,  40.21361111111111,
      41.61388888888889,  40.68166666666667,  41.983333333333334,
      47.31361111111112,  48.713888888888874, 40.39027777777778,
      41.553888888888885, 32.993611111111115, 33.92055555555556,
      38.48166666666667,  39.343333333333334, 49.26166666666667,
      50.34333333333333,  60.481666666666676, 61.783333333333324,
      59.29000000000001,  60.49999999999999,  67.08166666666668,
      68.38333333333333,  56.741666666666674, 57.82333333333332,
      45.96166666666667,  46.82333333333334,  57.846944444444446,
      58.77388888888889,  73.64361111111111,  74.80722222222221,
      89.91361111111112,  91.31388888888888,  86.88166666666667,
      88.18333333333332,  97.01361111111112,  98.41388888888888,
      81.69027777777778,  82.85388888888889,  65.8936111111111,
      66.82055555555556,  53.043611111111105, 53.81388888888889,
      67.44027777777778,  68.40722222222223,  82.23027777777779,
      83.3938888888889,   79.18166666666667,  80.26333333333334,
      88.13027777777778,  89.29388888888889,  74.12694444444445,
      75.0938888888889,   59.73027777777778,  60.50055555555555,
      46.04694444444445,  46.66055555555556,  58.4836111111111,
      59.253888888888895, 71.23361111111112,  72.16055555555556,
      68.40166666666667,  69.26333333333334,  75.9336111111111,
      76.86055555555555,  63.810277777777785, 64.58055555555556,
      51.37361111111111,  51.98722222222222};
  const std::array<int, 4> in_shape = {{1, 7, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.32,
                                         0.4,
                                         0.2,
                                         0.24,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         0.8,
                                         0.8800000000000001,
                                         1.7600000000000002,
                                         1.92,
                                         2.8800000000000003,
                                         3.12,
                                         2.8800000000000003,
                                         3.12,
                                         2.8800000000000003,
                                         3.12,
                                         2.08,
                                         2.24,
                                         1.12,
                                         1.2,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.28,
                                         1.3599999999999999,
                                         0.68,
                                         0.72};
  const std::array<int, 4> in_shape = {{1, 7, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.906944444444445,
                                         17.520555555555557,
                                         18.13416666666667,
                                         18.747777777777777,
                                         22.583611111111114,
                                         23.35388888888889,
                                         24.124166666666667,
                                         24.894444444444442,
                                         28.886944444444445,
                                         29.813888888888894,
                                         30.74083333333333,
                                         31.667777777777772,
                                         31.22166666666667,
                                         32.083333333333336,
                                         32.945,
                                         33.806666666666665,
                                         38.286944444444444,
                                         39.213888888888896,
                                         40.14083333333333,
                                         41.06777777777777,
                                         33.23694444444445,
                                         34.007222222222225,
                                         34.777499999999996,
                                         35.547777777777775,
                                         27.560277777777777,
                                         28.17388888888889,
                                         28.7875,
                                         29.401111111111113,
                                         30.74361111111111,
                                         31.513888888888893,
                                         32.28416666666667,
                                         33.05444444444444,
                                         40.30027777777779,
                                         41.26722222222222,
                                         42.23416666666667,
                                         43.2011111111111,
                                         50.64361111111111,
                                         51.80722222222222,
                                         52.970833333333324,
                                         54.13444444444444,
                                         52.561666666666675,
                                         53.64333333333333,
                                         54.724999999999994,
                                         55.806666666666665,
                                         62.44361111111111,
                                         63.60722222222223,
                                         64.77083333333333,
                                         65.93444444444442,
                                         53.673611111111114,
                                         54.64055555555556,
                                         55.607499999999995,
                                         56.574444444444445,
                                         44.11694444444444,
                                         44.88722222222223,
                                         45.6575,
                                         46.427777777777784,
                                         48.96694444444445,
                                         49.893888888888895,
                                         50.82083333333334,
                                         51.74777777777778,
                                         63.52361111111112,
                                         64.68722222222223,
                                         65.85083333333334,
                                         67.01444444444444,
                                         79.02694444444444,
                                         80.42722222222223,
                                         81.82749999999999,
                                         83.22777777777777,
                                         80.06166666666668,
                                         81.36333333333334,
                                         82.66499999999999,
                                         83.96666666666667,
                                         93.22694444444446,
                                         94.62722222222224,
                                         96.02749999999999,
                                         97.42777777777775,
                                         79.61694444444444,
                                         80.78055555555557,
                                         81.94416666666666,
                                         83.10777777777777,
                                         65.06027777777777,
                                         65.98722222222223,
                                         66.91416666666666,
                                         67.84111111111112,
                                         76.10166666666667,
                                         76.96333333333334,
                                         77.825,
                                         78.68666666666667,
                                         97.44166666666668,
                                         98.52333333333334,
                                         99.605,
                                         100.68666666666665,
                                         119.66166666666668,
                                         120.96333333333335,
                                         122.26499999999999,
                                         123.56666666666665,
                                         117.37000000000002,
                                         118.58000000000003,
                                         119.79,
                                         120.99999999999999,
                                         132.86166666666668,
                                         134.16333333333336,
                                         135.46499999999997,
                                         136.76666666666665,
                                         112.40166666666667,
                                         113.48333333333335,
                                         114.56500000000001,
                                         115.64666666666665,
                                         91.06166666666665,
                                         91.92333333333335,
                                         92.785,
                                         93.64666666666668,
                                         114.76694444444445,
                                         115.69388888888889,
                                         116.62083333333334,
                                         117.54777777777778,
                                         146.1236111111111,
                                         147.28722222222223,
                                         148.45083333333332,
                                         149.61444444444442,
                                         178.42694444444444,
                                         179.82722222222225,
                                         181.22750000000002,
                                         182.62777777777777,
                                         172.46166666666667,
                                         173.76333333333335,
                                         175.06499999999997,
                                         176.36666666666665,
                                         192.62694444444446,
                                         194.02722222222224,
                                         195.42749999999998,
                                         196.82777777777775,
                                         162.21694444444444,
                                         163.38055555555556,
                                         164.54416666666668,
                                         165.70777777777778,
                                         130.86027777777778,
                                         131.7872222222222,
                                         132.71416666666667,
                                         133.64111111111112,
                                         105.31694444444445,
                                         106.08722222222221,
                                         106.8575,
                                         107.62777777777778,
                                         133.91361111111112,
                                         134.88055555555556,
                                         135.8475,
                                         136.81444444444446,
                                         163.29694444444445,
                                         164.46055555555557,
                                         165.62416666666667,
                                         166.7877777777778,
                                         157.28166666666667,
                                         158.36333333333334,
                                         159.445,
                                         160.52666666666667,
                                         175.09694444444443,
                                         176.26055555555556,
                                         177.42416666666665,
                                         178.58777777777777,
                                         147.28694444444443,
                                         148.2538888888889,
                                         149.22083333333336,
                                         150.1877777777778,
                                         118.69027777777777,
                                         119.46055555555556,
                                         120.23083333333335,
                                         121.0011111111111,
                                         91.48027777777777,
                                         92.0938888888889,
                                         92.7075,
                                         93.32111111111112,
                                         116.19694444444444,
                                         116.9672222222222,
                                         117.7375,
                                         118.50777777777779,
                                         141.5402777777778,
                                         142.46722222222223,
                                         143.39416666666668,
                                         144.32111111111112,
                                         135.94166666666666,
                                         136.80333333333334,
                                         137.665,
                                         138.52666666666667,
                                         150.9402777777778,
                                         151.8672222222222,
                                         152.79416666666668,
                                         153.7211111111111,
                                         126.85027777777776,
                                         127.62055555555557,
                                         128.39083333333335,
                                         129.16111111111113,
                                         102.13361111111111,
                                         102.74722222222222,
                                         103.36083333333332,
                                         103.97444444444444};
  const std::array<int, 4> in_shape = {{1, 7, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.7600000000000002,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         3.6799999999999997,
                                         3.84,
                                         5.5200000000000005,
                                         5.760000000000001,
                                         6.,
                                         6.24,
                                         5.5200000000000005,
                                         5.760000000000001,
                                         6.,
                                         6.24,
                                         5.5200000000000005,
                                         5.760000000000001,
                                         6.,
                                         6.24,
                                         4.,
                                         4.16,
                                         4.32,
                                         4.48,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.7199999999999998,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44};
  const std::array<int, 4> in_shape = {{1, 7, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      5.196111111111111,  6.862777777777778,
      8.686111111111112,  8.671666666666667,
      9.650833333333333,  11.963055555555556,
      10.296388888888888, 8.473055555555556,
      9.242777777777778,  12.029444444444444,
      15.012777777777778, 14.531666666666666,
      15.760833333333334, 19.12638888888889,
      16.33972222222222,  13.356388888888889,
      14.542777777777777, 18.769444444444442,
      23.232777777777777, 22.071666666666665,
      23.550833333333333, 28.18305555555556,
      23.95638888888889,  19.493055555555557,
      22.256666666666664, 28.416666666666664,
      34.79666666666667,  32.23,
      33.605000000000004, 39.39833333333333,
      33.23833333333334,  26.858333333333334,
      33.34277777777777,  42.36944444444444,
      51.632777777777775, 47.27166666666666,
      48.75083333333334,  56.58305555555556,
      47.5563888888889,   38.293055555555554,
      30.54944444444444,  38.776111111111106,
      47.19944444444444,  43.09166666666666,
      44.32083333333333,  51.31305555555556,
      43.08638888888889,  34.66305555555556,
      26.502777777777773, 33.60944444444444,
      40.87277777777777,  37.23166666666667,
      38.21083333333333,  44.14972222222222,
      37.043055555555554, 29.779722222222222};
  const std::array<int, 4> in_shape = {{1, 7, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.4,
                                         0.4,
                                         0.36,
                                         0.28,
                                         0.16,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         0.56,
                                         1.2000000000000002,
                                         1.92,
                                         2.7199999999999998,
                                         2.7199999999999998,
                                         2.16,
                                         1.52,
                                         0.8,
                                         0.36,
                                         0.76,
                                         1.2,
                                         1.68,
                                         1.68,
                                         1.32,
                                         0.9199999999999999,
                                         0.48};
  const std::array<int, 4> in_shape = {{1, 7, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {9.778611111111111,
                                         10.392222222222221,
                                         12.955277777777779,
                                         13.725555555555555,
                                         16.44527777777778,
                                         17.372222222222224,
                                         16.520833333333336,
                                         17.343333333333334,
                                         18.479166666666668,
                                         19.301666666666666,
                                         22.999166666666667,
                                         23.926111111111112,
                                         19.822499999999998,
                                         20.592777777777776,
                                         16.3325,
                                         16.94611111111111,
                                         17.71527777777778,
                                         18.485555555555557,
                                         23.091944444444447,
                                         24.058888888888887,
                                         28.861944444444447,
                                         30.025555555555556,
                                         28.030833333333337,
                                         29.063333333333333,
                                         30.48916666666667,
                                         31.52166666666667,
                                         37.08916666666667,
                                         38.25277777777778,
                                         31.7125,
                                         32.67944444444444,
                                         25.9425,
                                         26.712777777777777,
                                         28.158611111111114,
                                         29.085555555555555,
                                         36.37527777777778,
                                         37.538888888888884,
                                         45.06527777777778,
                                         46.465555555555554,
                                         42.90083333333334,
                                         44.14333333333333,
                                         45.859166666666674,
                                         47.10166666666667,
                                         54.96583333333334,
                                         56.36611111111112,
                                         46.74916666666667,
                                         47.91277777777778,
                                         38.05916666666666,
                                         38.986111111111114,
                                         43.65166666666667,
                                         44.51333333333333,
                                         55.75166666666667,
                                         56.83333333333333,
                                         68.29166666666667,
                                         69.59333333333333,
                                         63.305000000000014,
                                         64.46,
                                         66.055,
                                         67.21000000000001,
                                         77.495,
                                         78.79666666666667,
                                         65.395,
                                         66.47666666666667,
                                         52.855,
                                         53.71666666666667,
                                         65.75861111111111,
                                         66.68555555555554,
                                         83.57527777777779,
                                         84.73888888888888,
                                         101.86527777777778,
                                         103.26555555555555,
                                         93.30083333333332,
                                         94.54333333333332,
                                         96.25916666666664,
                                         97.50166666666668,
                                         111.76583333333332,
                                         113.16611111111112,
                                         93.94916666666666,
                                         95.1127777777778,
                                         75.65916666666666,
                                         76.58611111111111,
                                         60.32861111111111,
                                         61.09888888888888,
                                         76.58527777777778,
                                         77.55222222222221,
                                         93.23527777777778,
                                         94.39888888888888,
                                         85.15083333333334,
                                         86.18333333333332,
                                         87.60916666666667,
                                         88.64166666666667,
                                         101.46249999999998,
                                         102.62611111111111,
                                         85.20583333333333,
                                         86.17277777777778,
                                         68.55583333333333,
                                         69.32611111111112,
                                         52.39194444444445,
                                         53.005555555555546,
                                         66.4486111111111,
                                         67.21888888888888,
                                         80.81861111111111,
                                         81.74555555555554,
                                         73.64083333333332,
                                         74.46333333333334,
                                         75.59916666666666,
                                         76.42166666666667,
                                         87.37249999999999,
                                         88.29944444444445,
                                         73.31583333333333,
                                         74.08611111111111,
                                         58.945833333333326,
                                         59.559444444444445};
  const std::array<int, 4> in_shape = {{1, 7, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.6000000000000001,
                                         0.72,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         1.04,
                                         1.12,
                                         2.24,
                                         2.4000000000000004,
                                         3.5999999999999996,
                                         3.84,
                                         5.12,
                                         5.4399999999999995,
                                         5.12,
                                         5.4399999999999995,
                                         4.08,
                                         4.32,
                                         2.88,
                                         3.04,
                                         1.52,
                                         1.6,
                                         0.68,
                                         0.72,
                                         1.44,
                                         1.52,
                                         2.28,
                                         2.4,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96};
  const std::array<int, 4> in_shape = {{1, 7, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         55.39027777777778,
                                         56.31722222222223,
                                         57.24416666666667,
                                         58.17111111111111,
                                         71.58694444444446,
                                         72.75055555555556,
                                         73.91416666666666,
                                         75.07777777777777,
                                         88.7302777777778,
                                         90.13055555555556,
                                         91.53083333333333,
                                         92.93111111111111,
                                         84.55916666666666,
                                         85.80166666666668,
                                         87.04416666666665,
                                         88.28666666666666,
                                         90.47583333333334,
                                         91.71833333333335,
                                         92.96083333333333,
                                         94.20333333333333,
                                         108.5313888888889,
                                         109.93166666666669,
                                         111.33194444444445,
                                         112.73222222222223,
                                         92.33472222222224,
                                         93.49833333333333,
                                         94.66194444444444,
                                         95.82555555555555,
                                         75.1913888888889,
                                         76.11833333333333,
                                         77.04527777777777,
                                         77.97222222222223,
                                         86.44166666666668,
                                         87.30333333333334,
                                         88.165,
                                         89.02666666666666,
                                         110.42166666666668,
                                         111.50333333333334,
                                         112.585,
                                         113.66666666666666,
                                         135.2816666666667,
                                         136.58333333333334,
                                         137.885,
                                         139.18666666666667,
                                         125.455,
                                         126.61000000000003,
                                         127.765,
                                         128.92,
                                         130.95499999999998,
                                         132.11,
                                         133.26500000000001,
                                         134.42000000000002,
                                         153.68833333333333,
                                         154.99,
                                         156.29166666666666,
                                         157.59333333333333,
                                         129.70833333333331,
                                         130.79,
                                         131.87166666666667,
                                         132.95333333333335,
                                         104.84833333333333,
                                         105.71,
                                         106.57166666666667,
                                         107.43333333333334,
                                         130.59027777777777,
                                         131.51722222222222,
                                         132.44416666666666,
                                         133.37111111111108,
                                         165.98694444444445,
                                         167.15055555555557,
                                         168.3141666666667,
                                         169.47777777777776,
                                         202.33027777777778,
                                         203.73055555555555,
                                         205.13083333333336,
                                         206.5311111111111,
                                         185.35916666666665,
                                         186.60166666666663,
                                         187.8441666666667,
                                         189.08666666666664,
                                         191.2758333333333,
                                         192.5183333333333,
                                         193.76083333333338,
                                         195.00333333333336,
                                         222.13138888888886,
                                         223.53166666666664,
                                         224.93194444444447,
                                         226.33222222222224,
                                         186.7347222222222,
                                         187.8983333333333,
                                         189.06194444444446,
                                         190.2255555555556,
                                         150.39138888888888,
                                         151.31833333333333,
                                         152.24527777777777,
                                         153.17222222222222,
                                         119.88694444444445,
                                         120.65722222222222,
                                         121.4275,
                                         122.19777777777776,
                                         152.20361111111112,
                                         153.17055555555555,
                                         154.13750000000002,
                                         155.10444444444443,
                                         185.30694444444444,
                                         186.47055555555556,
                                         187.6341666666667,
                                         188.79777777777775,
                                         169.26916666666665,
                                         170.30166666666668,
                                         171.3341666666667,
                                         172.36666666666665,
                                         174.18583333333333,
                                         175.21833333333333,
                                         176.25083333333336,
                                         177.28333333333333,
                                         201.76138888888886,
                                         202.92499999999995,
                                         204.08861111111113,
                                         205.25222222222223,
                                         169.44472222222223,
                                         170.41166666666666,
                                         171.37861111111113,
                                         172.34555555555556,
                                         136.34138888888887,
                                         137.11166666666665,
                                         137.88194444444443,
                                         138.65222222222224,
                                         104.17027777777778,
                                         104.7838888888889,
                                         105.3975,
                                         106.01111111111109,
                                         132.12694444444443,
                                         132.8972222222222,
                                         133.6675,
                                         134.43777777777777,
                                         160.71027777777778,
                                         161.63722222222222,
                                         162.56416666666667,
                                         163.49111111111108,
                                         146.45916666666665,
                                         147.28166666666664,
                                         148.10416666666669,
                                         148.92666666666668,
                                         150.37583333333336,
                                         151.19833333333332,
                                         152.02083333333334,
                                         152.84333333333333,
                                         173.81805555555556,
                                         174.74499999999998,
                                         175.67194444444445,
                                         176.5988888888889,
                                         145.86138888888888,
                                         146.63166666666666,
                                         147.40194444444444,
                                         148.17222222222222,
                                         117.27805555555555,
                                         117.89166666666665,
                                         118.50527777777776,
                                         119.11888888888889};
  const std::array<int, 4> in_shape = {{1, 7, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         4.32,
                                         4.48,
                                         4.640000000000001,
                                         4.800000000000001,
                                         6.960000000000001,
                                         7.199999999999999,
                                         7.44,
                                         7.68,
                                         9.920000000000002,
                                         10.24,
                                         10.560000000000002,
                                         10.879999999999999,
                                         9.920000000000002,
                                         10.24,
                                         10.560000000000002,
                                         10.879999999999999,
                                         7.920000000000001,
                                         8.16,
                                         8.4,
                                         8.64,
                                         5.6000000000000005,
                                         5.76,
                                         5.92,
                                         6.08,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         4.4399999999999995,
                                         4.56,
                                         4.68,
                                         4.8,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92};
  const std::array<int, 4> in_shape = {{1, 7, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.177777777777778,
                                         5.584444444444443,
                                         7.538611111111111,
                                         8.844166666666665,
                                         7.4775,
                                         6.2275,
                                         7.2844444444444445,
                                         9.571111111111112,
                                         12.67527777777778,
                                         14.314166666666665,
                                         11.947500000000002,
                                         9.8575,
                                         11.331111111111111,
                                         14.73777777777778,
                                         19.291944444444447,
                                         21.264166666666668,
                                         17.5975,
                                         14.427499999999998,
                                         15.84,
                                         20.34,
                                         26.227500000000003,
                                         27.977500000000003,
                                         22.877499999999998,
                                         18.5875,
                                         21.715,
                                         27.714999999999996,
                                         35.4775,
                                         37.2275,
                                         30.252499999999998,
                                         24.4625,
                                         30.99277777777778,
                                         39.41944444444444,
                                         50.248611111111096,
                                         52.22083333333333,
                                         42.27916666666667,
                                         34.08916666666667,
                                         27.886111111111113,
                                         35.43277777777777,
                                         45.11194444444444,
                                         46.75083333333333,
                                         37.80916666666667,
                                         30.459166666666665,
                                         23.839444444444446,
                                         30.266111111111112,
                                         38.49527777777778,
                                         39.80083333333334,
                                         32.15916666666667,
                                         25.889166666666668};
  const std::array<int, 4> in_shape = {{1, 8, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.08,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.64,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         0.8,
                                         0.64,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         0.8,
                                         0.6000000000000001,
                                         1.32,
                                         1.32,
                                         1.32,
                                         1.32,
                                         0.72,
                                         0.48000000000000004,
                                         1.04,
                                         1.04,
                                         1.04,
                                         1.04,
                                         0.56,
                                         0.28,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.32};
  const std::array<int, 4> in_shape = {{1, 8, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {7.741944444444444,
                                         8.355555555555556,
                                         10.398611111111112,
                                         11.168888888888887,
                                         14.111111111111112,
                                         15.077222222222222,
                                         16.72222222222222,
                                         17.68833333333333,
                                         14.184722222222224,
                                         14.955,
                                         11.84138888888889,
                                         12.455,
                                         13.79861111111111,
                                         14.568888888888889,
                                         18.17527777777778,
                                         19.142222222222223,
                                         24.137777777777778,
                                         25.35055555555556,
                                         27.415555555555553,
                                         28.62833333333333,
                                         22.928055555555556,
                                         23.895000000000003,
                                         18.944722222222225,
                                         19.715,
                                         21.735277777777778,
                                         22.662222222222223,
                                         28.311944444444446,
                                         29.47555555555556,
                                         37.12444444444445,
                                         38.58388888888889,
                                         41.068888888888885,
                                         42.528333333333336,
                                         34.03138888888889,
                                         35.195,
                                         27.92805555555556,
                                         28.854999999999997,
                                         30.8575,
                                         31.68,
                                         39.6475,
                                         40.68,
                                         51.160000000000004,
                                         52.455000000000005,
                                         54.660000000000004,
                                         55.955000000000005,
                                         44.722500000000004,
                                         45.754999999999995,
                                         36.3525,
                                         37.175,
                                         42.60750000000001,
                                         43.43,
                                         54.39750000000001,
                                         55.42999999999999,
                                         69.66000000000001,
                                         70.955,
                                         73.16000000000001,
                                         74.455,
                                         59.472500000000004,
                                         60.504999999999995,
                                         48.1025,
                                         48.925,
                                         61.058611111111105,
                                         61.98555555555556,
                                         77.67527777777778,
                                         78.83888888888887,
                                         99.03777777777779,
                                         100.49722222222219,
                                         102.98222222222223,
                                         104.44166666666666,
                                         83.39472222222221,
                                         84.55833333333334,
                                         67.25138888888888,
                                         68.17833333333334,
                                         55.00194444444445,
                                         55.772222222222226,
                                         69.89861111111111,
                                         70.86555555555555,
                                         89.01111111111112,
                                         90.22388888888888,
                                         92.28888888888889,
                                         93.50166666666667,
                                         74.65138888888889,
                                         75.61833333333334,
                                         60.14805555555556,
                                         60.91833333333333,
                                         47.06527777777778,
                                         47.67888888888889,
                                         59.76194444444444,
                                         60.532222222222224,
                                         76.02444444444444,
                                         76.99055555555556,
                                         78.63555555555556,
                                         79.60166666666667,
                                         63.54805555555555,
                                         64.31833333333334,
                                         51.164722222222224,
                                         51.778333333333336};
  const std::array<int, 4> in_shape = {{1, 8, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         2.4,
                                         2.64,
                                         2.4,
                                         2.64,
                                         2.4,
                                         2.64,
                                         2.4,
                                         2.64,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         0.6,
                                         0.64};
  const std::array<int, 4> in_shape = {{1, 8, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {14.870277777777776,
                                         15.483888888888888,
                                         16.0975,
                                         16.711111111111112,
                                         20.026944444444446,
                                         20.797222222222224,
                                         21.5675,
                                         22.337777777777774,
                                         27.256111111111114,
                                         28.222222222222225,
                                         29.188333333333333,
                                         30.154444444444444,
                                         32.47833333333333,
                                         33.44444444444444,
                                         34.410555555555554,
                                         35.37666666666666,
                                         27.59916666666667,
                                         28.369444444444447,
                                         29.139722222222225,
                                         29.91,
                                         23.069166666666668,
                                         23.68277777777778,
                                         24.29638888888889,
                                         24.91,
                                         26.826944444444443,
                                         27.59722222222222,
                                         28.3675,
                                         29.137777777777778,
                                         35.383611111111115,
                                         36.35055555555556,
                                         37.317499999999995,
                                         38.284444444444446,
                                         47.06277777777778,
                                         48.275555555555556,
                                         49.48833333333333,
                                         50.70111111111112,
                                         53.61833333333334,
                                         54.831111111111106,
                                         56.04388888888889,
                                         57.25666666666666,
                                         44.889166666666675,
                                         45.85611111111111,
                                         46.823055555555555,
                                         47.790000000000006,
                                         37.119166666666665,
                                         37.88944444444445,
                                         38.65972222222223,
                                         39.43,
                                         42.54361111111112,
                                         43.470555555555556,
                                         44.3975,
                                         45.324444444444445,
                                         55.46027777777779,
                                         56.62388888888889,
                                         57.787499999999994,
                                         58.95111111111112,
                                         72.78944444444446,
                                         74.2488888888889,
                                         75.70833333333333,
                                         77.16777777777779,
                                         80.67833333333334,
                                         82.13777777777777,
                                         83.59722222222221,
                                         85.05666666666667,
                                         66.89916666666667,
                                         68.06277777777778,
                                         69.22638888888889,
                                         70.39,
                                         54.92916666666666,
                                         55.85611111111112,
                                         56.78305555555556,
                                         57.709999999999994,
                                         60.8925,
                                         61.715,
                                         62.537499999999994,
                                         63.36,
                                         78.26249999999999,
                                         79.295,
                                         80.32749999999999,
                                         81.36,
                                         101.025,
                                         102.32000000000001,
                                         103.615,
                                         104.91000000000001,
                                         108.025,
                                         109.32000000000001,
                                         110.615,
                                         111.91000000000001,
                                         88.4125,
                                         89.44500000000001,
                                         90.4775,
                                         91.50999999999999,
                                         71.8825,
                                         72.705,
                                         73.5275,
                                         74.35,
                                         84.3925,
                                         85.21500000000002,
                                         86.03750000000001,
                                         86.86,
                                         107.7625,
                                         108.79500000000002,
                                         109.82750000000001,
                                         110.85999999999999,
                                         138.02499999999998,
                                         139.32000000000002,
                                         140.61499999999998,
                                         141.91,
                                         145.02499999999998,
                                         146.32000000000002,
                                         147.61499999999998,
                                         148.91,
                                         117.91250000000001,
                                         118.94500000000001,
                                         119.9775,
                                         121.00999999999999,
                                         95.3825,
                                         96.205,
                                         97.02750000000002,
                                         97.85,
                                         121.19027777777777,
                                         122.11722222222221,
                                         123.04416666666667,
                                         123.97111111111111,
                                         154.18694444444444,
                                         155.35055555555556,
                                         156.51416666666665,
                                         157.67777777777775,
                                         196.61611111111108,
                                         198.07555555555558,
                                         199.53500000000003,
                                         200.99444444444438,
                                         204.505,
                                         205.96444444444447,
                                         207.4238888888889,
                                         208.88333333333333,
                                         165.62583333333333,
                                         166.78944444444443,
                                         167.95305555555558,
                                         169.11666666666667,
                                         133.57583333333332,
                                         134.50277777777777,
                                         135.4297222222222,
                                         136.35666666666668,
                                         109.23361111111112,
                                         110.0038888888889,
                                         110.77416666666666,
                                         111.54444444444445,
                                         138.83027777777778,
                                         139.79722222222222,
                                         140.76416666666665,
                                         141.7311111111111,
                                         176.80944444444444,
                                         178.02222222222224,
                                         179.235,
                                         180.44777777777776,
                                         183.36499999999998,
                                         184.57777777777778,
                                         185.79055555555556,
                                         187.00333333333333,
                                         148.3358333333333,
                                         149.30277777777778,
                                         150.26972222222224,
                                         151.23666666666668,
                                         119.52583333333334,
                                         120.29611111111112,
                                         121.0663888888889,
                                         121.83666666666666,
                                         93.51694444444445,
                                         94.13055555555556,
                                         94.74416666666666,
                                         95.35777777777778,
                                         118.7536111111111,
                                         119.52388888888888,
                                         120.29416666666667,
                                         121.06444444444445,
                                         151.08277777777778,
                                         152.04888888888888,
                                         153.01500000000001,
                                         153.98111111111112,
                                         156.305,
                                         157.2711111111111,
                                         158.23722222222224,
                                         159.20333333333335,
                                         126.32583333333334,
                                         127.0961111111111,
                                         127.8663888888889,
                                         128.63666666666668,
                                         101.71583333333334,
                                         102.32944444444445,
                                         102.94305555555553,
                                         103.55666666666667};
  const std::array<int, 4> in_shape = {{1, 8, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         2.08,
                                         2.24,
                                         2.4000000000000004,
                                         2.56,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         2.7199999999999998,
                                         2.88,
                                         3.04,
                                         3.2,
                                         2.08,
                                         2.24,
                                         2.4000000000000004,
                                         2.56,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         2.7199999999999998,
                                         2.88,
                                         3.04,
                                         3.2,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4000000000000004,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         2.5199999999999996,
                                         2.6399999999999997,
                                         2.76,
                                         2.88,
                                         1.6800000000000002,
                                         1.76,
                                         1.84,
                                         1.9200000000000002,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         1.24,
                                         1.28};
  const std::array<int, 4> in_shape = {{1, 8, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.686944444444444,
                                         6.2236111111111105,
                                         7.916944444444443,
                                         8.451666666666666,
                                         10.266944444444443,
                                         8.886944444444444,
                                         7.350277777777778,
                                         8.26361111111111,
                                         10.800277777777776,
                                         13.53361111111111,
                                         13.951666666666666,
                                         16.483611111111106,
                                         14.143611111111111,
                                         11.606944444444446,
                                         12.936944444444444,
                                         16.75361111111111,
                                         20.806944444444444,
                                         20.991666666666667,
                                         24.356944444444437,
                                         20.776944444444442,
                                         16.96027777777778,
                                         18.229166666666668,
                                         23.339166666666664,
                                         28.659166666666664,
                                         28.105,
                                         31.809166666666666,
                                         26.909166666666664,
                                         21.799166666666668,
                                         25.083333333333332,
                                         31.94333333333333,
                                         39.01333333333333,
                                         37.730000000000004,
                                         42.163333333333334,
                                         35.51333333333334,
                                         28.653333333333336,
                                         35.87555555555556,
                                         45.54888888888889,
                                         55.45888888888889,
                                         53.20333333333334,
                                         59.008888888888904,
                                         49.57222222222223,
                                         39.89888888888889,
                                         32.29888888888889,
                                         40.97222222222222,
                                         49.842222222222226,
                                         47.70333333333334,
                                         52.79222222222222,
                                         44.31555555555556,
                                         35.64222222222222,
                                         27.625555555555557,
                                         35.01888888888889,
                                         42.56888888888889,
                                         40.663333333333334,
                                         44.918888888888894,
                                         37.68222222222222,
                                         30.288888888888888};
  const std::array<int, 4> in_shape = {{1, 8, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.24,
                                         0.24,
                                         0.2,
                                         0.12,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.8800000000000001,
                                         1.92,
                                         3.12,
                                         3.12,
                                         3.12,
                                         2.2399999999999998,
                                         1.2,
                                         0.8800000000000001,
                                         1.92,
                                         3.12,
                                         3.12,
                                         3.12,
                                         2.2399999999999998,
                                         1.2,
                                         0.8400000000000001,
                                         1.7999999999999998,
                                         2.88,
                                         2.88,
                                         2.88,
                                         2.04,
                                         1.08,
                                         0.68,
                                         1.44,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.5999999999999999,
                                         0.84,
                                         0.4,
                                         0.8400000000000001,
                                         1.32,
                                         1.32,
                                         1.32,
                                         0.9199999999999999,
                                         0.48};
  const std::array<int, 4> in_shape = {{1, 8, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {8.760277777777778,
                                         9.373888888888889,
                                         11.676944444444445,
                                         12.447222222222221,
                                         14.906944444444447,
                                         15.833888888888886,
                                         16.041666666666668,
                                         16.903333333333332,
                                         19.606944444444448,
                                         20.533888888888885,
                                         17.003611111111113,
                                         17.773888888888887,
                                         14.086944444444445,
                                         14.700555555555557,
                                         15.756944444444446,
                                         16.52722222222222,
                                         20.63361111111111,
                                         21.60055555555555,
                                         25.90361111111111,
                                         27.06722222222222,
                                         26.821666666666665,
                                         27.903333333333332,
                                         31.803611111111113,
                                         32.96722222222221,
                                         27.32027777777778,
                                         28.287222222222223,
                                         22.443611111111114,
                                         23.213888888888892,
                                         24.946944444444448,
                                         25.87388888888889,
                                         32.343611111111116,
                                         33.50722222222222,
                                         40.21361111111111,
                                         41.61388888888889,
                                         40.68166666666667,
                                         41.983333333333334,
                                         47.31361111111112,
                                         48.713888888888874,
                                         40.39027777777778,
                                         41.553888888888885,
                                         32.993611111111115,
                                         33.92055555555556,
                                         35.63583333333334,
                                         36.458333333333336,
                                         45.64583333333333,
                                         46.67833333333333,
                                         56.075833333333335,
                                         57.31833333333333,
                                         55.05500000000001,
                                         56.21,
                                         62.37583333333333,
                                         63.61833333333333,
                                         52.78583333333333,
                                         53.81833333333333,
                                         42.77583333333334,
                                         43.598333333333336,
                                         49.34416666666667,
                                         50.166666666666664,
                                         62.85416666666667,
                                         63.88666666666666,
                                         76.78416666666666,
                                         78.02666666666666,
                                         74.30499999999999,
                                         75.46000000000001,
                                         83.08416666666666,
                                         84.32666666666667,
                                         69.99416666666666,
                                         71.02666666666669,
                                         56.48416666666667,
                                         57.30666666666667,
                                         70.82416666666667,
                                         71.75111111111111,
                                         89.93416666666667,
                                         91.09777777777778,
                                         109.51750000000001,
                                         110.91777777777779,
                                         105.10499999999998,
                                         106.40666666666668,
                                         116.61749999999998,
                                         118.01777777777781,
                                         97.98083333333332,
                                         99.14444444444446,
                                         78.87083333333332,
                                         79.79777777777778,
                                         63.8275,
                                         64.59777777777778,
                                         80.97749999999999,
                                         81.94444444444444,
                                         98.52083333333331,
                                         99.68444444444445,
                                         94.32499999999997,
                                         95.40666666666668,
                                         104.42083333333332,
                                         105.58444444444444,
                                         87.66416666666666,
                                         88.63111111111112,
                                         70.51416666666667,
                                         71.28444444444445,
                                         54.637499999999996,
                                         55.251111111111115,
                                         69.2675,
                                         70.03777777777778,
                                         84.21083333333331,
                                         85.13777777777779,
                                         80.46499999999999,
                                         81.32666666666667,
                                         88.91083333333331,
                                         89.83777777777779,
                                         74.59416666666667,
                                         75.36444444444444,
                                         59.96416666666666,
                                         60.577777777777776};
  const std::array<int, 4> in_shape = {{1, 8, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.32,
                                         0.4,
                                         0.2,
                                         0.24,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         1.6,
                                         1.7600000000000002,
                                         3.5199999999999996,
                                         3.84,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.16,
                                         4.4799999999999995,
                                         2.24,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         3.5199999999999996,
                                         3.84,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.16,
                                         4.4799999999999995,
                                         2.24,
                                         2.4,
                                         1.56,
                                         1.6800000000000002,
                                         3.3600000000000003,
                                         3.5999999999999996,
                                         5.4,
                                         5.76,
                                         5.4,
                                         5.76,
                                         5.4,
                                         5.76,
                                         3.84,
                                         4.08,
                                         2.04,
                                         2.16,
                                         1.28,
                                         1.36,
                                         2.72,
                                         2.88,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         3.04,
                                         3.1999999999999997,
                                         1.6,
                                         1.68,
                                         0.76,
                                         0.8,
                                         1.6,
                                         1.6800000000000002,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96};
  const std::array<int, 4> in_shape = {{1, 8, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.906944444444445,
                                         17.520555555555557,
                                         18.13416666666667,
                                         18.747777777777777,
                                         22.583611111111114,
                                         23.35388888888889,
                                         24.124166666666667,
                                         24.894444444444442,
                                         28.886944444444445,
                                         29.813888888888894,
                                         30.74083333333333,
                                         31.667777777777772,
                                         31.22166666666667,
                                         32.083333333333336,
                                         32.945,
                                         33.806666666666665,
                                         38.286944444444444,
                                         39.213888888888896,
                                         40.14083333333333,
                                         41.06777777777777,
                                         33.23694444444445,
                                         34.007222222222225,
                                         34.777499999999996,
                                         35.547777777777775,
                                         27.560277777777777,
                                         28.17388888888889,
                                         28.7875,
                                         29.401111111111113,
                                         30.74361111111111,
                                         31.513888888888893,
                                         32.28416666666667,
                                         33.05444444444444,
                                         40.30027777777779,
                                         41.26722222222222,
                                         42.23416666666667,
                                         43.2011111111111,
                                         50.64361111111111,
                                         51.80722222222222,
                                         52.970833333333324,
                                         54.13444444444444,
                                         52.561666666666675,
                                         53.64333333333333,
                                         54.724999999999994,
                                         55.806666666666665,
                                         62.44361111111111,
                                         63.60722222222223,
                                         64.77083333333333,
                                         65.93444444444442,
                                         53.673611111111114,
                                         54.64055555555556,
                                         55.607499999999995,
                                         56.574444444444445,
                                         44.11694444444444,
                                         44.88722222222223,
                                         45.6575,
                                         46.427777777777784,
                                         48.96694444444445,
                                         49.893888888888895,
                                         50.82083333333334,
                                         51.74777777777778,
                                         63.52361111111112,
                                         64.68722222222223,
                                         65.85083333333334,
                                         67.01444444444444,
                                         79.02694444444444,
                                         80.42722222222223,
                                         81.82749999999999,
                                         83.22777777777777,
                                         80.06166666666668,
                                         81.36333333333334,
                                         82.66499999999999,
                                         83.96666666666667,
                                         93.22694444444446,
                                         94.62722222222224,
                                         96.02749999999999,
                                         97.42777777777775,
                                         79.61694444444444,
                                         80.78055555555557,
                                         81.94416666666666,
                                         83.10777777777777,
                                         65.06027777777777,
                                         65.98722222222223,
                                         66.91416666666666,
                                         67.84111111111112,
                                         70.44916666666667,
                                         71.27166666666668,
                                         72.09416666666668,
                                         72.91666666666667,
                                         90.25916666666667,
                                         91.29166666666666,
                                         92.32416666666667,
                                         93.35666666666665,
                                         110.90916666666668,
                                         112.15166666666667,
                                         113.39416666666665,
                                         114.63666666666666,
                                         108.95500000000001,
                                         110.11000000000001,
                                         111.26500000000001,
                                         112.42,
                                         123.50916666666666,
                                         124.75166666666667,
                                         125.99416666666667,
                                         127.23666666666666,
                                         104.53916666666667,
                                         105.57166666666666,
                                         106.60416666666669,
                                         107.63666666666666,
                                         84.72916666666666,
                                         85.55166666666668,
                                         86.37416666666667,
                                         87.19666666666667,
                                         97.86583333333333,
                                         98.68833333333335,
                                         99.51083333333334,
                                         100.33333333333333,
                                         124.6758333333333,
                                         125.70833333333334,
                                         126.74083333333336,
                                         127.77333333333333,
                                         152.32583333333335,
                                         153.56833333333333,
                                         154.81083333333333,
                                         156.0533333333333,
                                         147.45499999999998,
                                         148.60999999999999,
                                         149.76500000000001,
                                         150.92000000000002,
                                         164.92583333333332,
                                         166.16833333333332,
                                         167.41083333333333,
                                         168.65333333333334,
                                         138.95583333333335,
                                         139.98833333333332,
                                         141.02083333333334,
                                         142.05333333333337,
                                         112.14583333333333,
                                         112.96833333333333,
                                         113.79083333333332,
                                         114.61333333333334,
                                         140.72138888888887,
                                         141.64833333333334,
                                         142.57527777777779,
                                         143.50222222222223,
                                         178.70472222222222,
                                         179.86833333333334,
                                         181.03194444444446,
                                         182.19555555555556,
                                         217.6347222222222,
                                         219.03500000000003,
                                         220.4352777777778,
                                         221.83555555555557,
                                         208.9083333333333,
                                         210.20999999999995,
                                         211.51166666666668,
                                         212.81333333333336,
                                         231.8347222222222,
                                         233.23499999999996,
                                         234.63527777777782,
                                         236.03555555555562,
                                         194.79805555555552,
                                         195.96166666666664,
                                         197.12527777777777,
                                         198.28888888888892,
                                         156.8147222222222,
                                         157.74166666666665,
                                         158.6686111111111,
                                         159.59555555555556,
                                         126.88472222222222,
                                         127.655,
                                         128.4252777777778,
                                         129.19555555555556,
                                         160.98805555555552,
                                         161.95499999999998,
                                         162.92194444444448,
                                         163.88888888888889,
                                         195.87805555555553,
                                         197.04166666666663,
                                         198.20527777777778,
                                         199.3688888888889,
                                         187.56833333333333,
                                         188.64999999999995,
                                         189.73166666666668,
                                         190.81333333333336,
                                         207.67805555555552,
                                         208.84166666666664,
                                         210.0052777777778,
                                         211.1688888888889,
                                         174.36138888888888,
                                         175.32833333333332,
                                         176.29527777777776,
                                         177.26222222222225,
                                         140.25805555555556,
                                         141.02833333333334,
                                         141.79861111111111,
                                         142.5688888888889,
                                         108.6613888888889,
                                         109.27499999999999,
                                         109.8886111111111,
                                         110.50222222222223,
                                         137.76472222222222,
                                         138.535,
                                         139.3052777777778,
                                         140.07555555555555,
                                         167.4947222222222,
                                         168.42166666666662,
                                         169.34861111111113,
                                         170.27555555555557,
                                         160.06833333333336,
                                         160.92999999999998,
                                         161.79166666666669,
                                         162.65333333333334,
                                         176.8947222222222,
                                         177.82166666666663,
                                         178.7486111111111,
                                         179.67555555555558,
                                         148.41805555555555,
                                         149.18833333333333,
                                         149.9586111111111,
                                         150.7288888888889,
                                         119.31472222222222,
                                         119.92833333333331,
                                         120.54194444444444,
                                         121.15555555555555};
  const std::array<int, 4> in_shape = {{1, 8, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         6.720000000000001,
                                         7.039999999999999,
                                         7.36,
                                         7.68,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         8.000000000000002,
                                         8.32,
                                         8.64,
                                         8.959999999999999,
                                         4.32,
                                         4.48,
                                         4.640000000000001,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         6.720000000000001,
                                         7.039999999999999,
                                         7.36,
                                         7.68,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         8.000000000000002,
                                         8.32,
                                         8.64,
                                         8.959999999999999,
                                         4.32,
                                         4.48,
                                         4.640000000000001,
                                         4.8,
                                         3.,
                                         3.12,
                                         3.24,
                                         3.3600000000000003,
                                         6.48,
                                         6.720000000000001,
                                         6.96,
                                         7.199999999999999,
                                         10.440000000000001,
                                         10.8,
                                         11.160000000000002,
                                         11.52,
                                         10.440000000000001,
                                         10.8,
                                         11.160000000000002,
                                         11.52,
                                         10.440000000000001,
                                         10.8,
                                         11.160000000000002,
                                         11.52,
                                         7.44,
                                         7.68,
                                         7.92,
                                         8.16,
                                         3.96,
                                         4.08,
                                         4.2,
                                         4.32,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.72,
                                         5.28,
                                         5.44,
                                         5.6000000000000005,
                                         5.76,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.3999999999999995,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.36,
                                         1.48,
                                         1.52,
                                         1.56,
                                         1.6,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92};
  const std::array<int, 4> in_shape = {{1, 8, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      5.196111111111111,  6.862777777777778,
      8.686111111111112,  8.671666666666667,
      9.650833333333333,  11.963055555555556,
      10.296388888888888, 8.473055555555556,
      9.242777777777778,  12.029444444444444,
      15.012777777777778, 14.531666666666666,
      15.760833333333334, 19.12638888888889,
      16.33972222222222,  13.356388888888889,
      14.542777777777777, 18.769444444444442,
      23.232777777777777, 22.071666666666665,
      23.550833333333333, 28.18305555555556,
      23.95638888888889,  19.493055555555557,
      20.618333333333332, 26.338333333333335,
      32.26833333333334,  29.925,
      31.237500000000004, 36.660833333333336,
      30.940833333333337, 25.010833333333334,
      28.451666666666664, 36.17166666666667,
      44.10166666666667,  40.425000000000004,
      41.737500000000004, 48.49416666666667,
      40.77416666666667,  32.844166666666666,
      40.75833333333333,  51.678333333333335,
      62.83500000000001,  57.211666666666666,
      58.69083333333334,  67.78527777777778,
      56.86527777777778,  45.70861111111111,
      36.711666666666666, 46.51166666666667,
      56.50833333333334,  51.35166666666667,
      52.58083333333334,  60.62194444444444,
      50.82194444444444,  40.82527777777777,
      31.411666666666665, 39.77166666666667,
      48.28833333333333,  43.81166666666666,
      44.79083333333333,  51.565277777777766,
      43.20527777777778,  34.688611111111115};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.4,
                                         0.4,
                                         0.36,
                                         0.28,
                                         0.16,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         1.12,
                                         2.4000000000000004,
                                         3.84,
                                         5.4399999999999995,
                                         5.4399999999999995,
                                         4.32,
                                         3.04,
                                         1.6,
                                         1.12,
                                         2.4000000000000004,
                                         3.84,
                                         5.4399999999999995,
                                         5.4399999999999995,
                                         4.32,
                                         3.04,
                                         1.6,
                                         1.08,
                                         2.2800000000000002,
                                         3.6,
                                         5.039999999999999,
                                         5.039999999999999,
                                         3.9600000000000004,
                                         2.7600000000000002,
                                         1.44,
                                         0.88,
                                         1.84,
                                         2.8800000000000003,
                                         4.,
                                         4.,
                                         3.12,
                                         2.16,
                                         1.12,
                                         0.52,
                                         1.08,
                                         1.6800000000000002,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         1.8000000000000003,
                                         1.24,
                                         0.64};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {9.778611111111111,
                                         10.392222222222221,
                                         12.955277777777779,
                                         13.725555555555555,
                                         16.44527777777778,
                                         17.372222222222224,
                                         16.520833333333336,
                                         17.343333333333334,
                                         18.479166666666668,
                                         19.301666666666666,
                                         22.999166666666667,
                                         23.926111111111112,
                                         19.822499999999998,
                                         20.592777777777776,
                                         16.3325,
                                         16.94611111111111,
                                         17.71527777777778,
                                         18.485555555555557,
                                         23.091944444444447,
                                         24.058888888888887,
                                         28.861944444444447,
                                         30.025555555555556,
                                         28.030833333333337,
                                         29.063333333333333,
                                         30.48916666666667,
                                         31.52166666666667,
                                         37.08916666666667,
                                         38.25277777777778,
                                         31.7125,
                                         32.67944444444444,
                                         25.9425,
                                         26.712777777777777,
                                         28.158611111111114,
                                         29.085555555555555,
                                         36.37527777777778,
                                         37.538888888888884,
                                         45.06527777777778,
                                         46.465555555555554,
                                         42.90083333333334,
                                         44.14333333333333,
                                         45.859166666666674,
                                         47.10166666666667,
                                         54.96583333333334,
                                         56.36611111111112,
                                         46.74916666666667,
                                         47.91277777777778,
                                         38.05916666666666,
                                         38.986111111111114,
                                         40.41416666666667,
                                         41.236666666666665,
                                         51.64416666666666,
                                         52.67666666666667,
                                         63.29416666666667,
                                         64.53666666666668,
                                         58.74750000000001,
                                         59.85,
                                         61.3725,
                                         62.47500000000001,
                                         72.07916666666667,
                                         73.32166666666667,
                                         60.84916666666667,
                                         61.881666666666675,
                                         49.19916666666667,
                                         50.02166666666667,
                                         56.08083333333333,
                                         56.90333333333333,
                                         71.31083333333333,
                                         72.34333333333333,
                                         86.96083333333334,
                                         88.20333333333333,
                                         79.7475,
                                         80.85000000000001,
                                         82.3725,
                                         83.47500000000001,
                                         95.74583333333334,
                                         96.98833333333334,
                                         80.51583333333333,
                                         81.54833333333335,
                                         64.86583333333334,
                                         65.68833333333333,
                                         80.5897222222222,
                                         81.51666666666667,
                                         102.19305555555555,
                                         103.35666666666667,
                                         124.26972222222221,
                                         125.67000000000002,
                                         113.18083333333333,
                                         114.42333333333333,
                                         116.13916666666667,
                                         117.38166666666667,
                                         134.17027777777778,
                                         135.57055555555556,
                                         112.56694444444446,
                                         113.73055555555555,
                                         90.49027777777779,
                                         91.41722222222222,
                                         72.65305555555554,
                                         73.42333333333333,
                                         92.05638888888888,
                                         93.02333333333334,
                                         111.85305555555554,
                                         113.01666666666668,
                                         101.67083333333332,
                                         102.70333333333333,
                                         104.12916666666668,
                                         105.16166666666668,
                                         120.08027777777778,
                                         121.24388888888888,
                                         100.67694444444446,
                                         101.64388888888888,
                                         80.88027777777778,
                                         81.65055555555554,
                                         62.20972222222221,
                                         62.82333333333333,
                                         78.77305555555556,
                                         79.54333333333334,
                                         95.64972222222222,
                                         96.57666666666665,
                                         86.80083333333333,
                                         87.62333333333332,
                                         88.75916666666667,
                                         89.58166666666666,
                                         102.20361111111112,
                                         103.13055555555553,
                                         85.64027777777778,
                                         86.41055555555556,
                                         68.7636111111111,
                                         69.37722222222223};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.6000000000000001,
                                         0.72,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         2.08,
                                         2.24,
                                         4.48,
                                         4.800000000000001,
                                         7.2,
                                         7.68,
                                         10.24,
                                         10.879999999999999,
                                         10.24,
                                         10.879999999999999,
                                         8.16,
                                         8.64,
                                         5.76,
                                         6.08,
                                         3.04,
                                         3.2,
                                         2.08,
                                         2.24,
                                         4.48,
                                         4.800000000000001,
                                         7.2,
                                         7.68,
                                         10.24,
                                         10.879999999999999,
                                         10.24,
                                         10.879999999999999,
                                         8.16,
                                         8.64,
                                         5.76,
                                         6.08,
                                         3.04,
                                         3.2,
                                         2.04,
                                         2.16,
                                         4.32,
                                         4.5600000000000005,
                                         6.84,
                                         7.2,
                                         9.6,
                                         10.079999999999998,
                                         9.6,
                                         10.079999999999998,
                                         7.5600000000000005,
                                         7.920000000000001,
                                         5.28,
                                         5.5200000000000005,
                                         2.76,
                                         2.88,
                                         1.6800000000000002,
                                         1.76,
                                         3.52,
                                         3.68,
                                         5.52,
                                         5.760000000000001,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         6.,
                                         6.24,
                                         4.16,
                                         4.32,
                                         2.16,
                                         2.24,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         3.24,
                                         3.3600000000000003,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         2.4,
                                         2.48,
                                         1.24,
                                         1.28};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         55.39027777777778,
                                         56.31722222222223,
                                         57.24416666666667,
                                         58.17111111111111,
                                         71.58694444444446,
                                         72.75055555555556,
                                         73.91416666666666,
                                         75.07777777777777,
                                         88.7302777777778,
                                         90.13055555555556,
                                         91.53083333333333,
                                         92.93111111111111,
                                         84.55916666666666,
                                         85.80166666666668,
                                         87.04416666666665,
                                         88.28666666666666,
                                         90.47583333333334,
                                         91.71833333333335,
                                         92.96083333333333,
                                         94.20333333333333,
                                         108.5313888888889,
                                         109.93166666666669,
                                         111.33194444444445,
                                         112.73222222222223,
                                         92.33472222222224,
                                         93.49833333333333,
                                         94.66194444444444,
                                         95.82555555555555,
                                         75.1913888888889,
                                         76.11833333333333,
                                         77.04527777777777,
                                         77.97222222222223,
                                         80.00583333333334,
                                         80.82833333333333,
                                         81.65083333333334,
                                         82.47333333333333,
                                         102.25583333333334,
                                         103.28833333333333,
                                         104.32083333333333,
                                         105.35333333333334,
                                         125.34583333333336,
                                         126.58833333333334,
                                         127.83083333333332,
                                         129.07333333333335,
                                         116.3925,
                                         117.49500000000002,
                                         118.5975,
                                         119.7,
                                         121.6425,
                                         122.745,
                                         123.8475,
                                         124.95000000000002,
                                         142.91583333333332,
                                         144.15833333333333,
                                         145.4008333333333,
                                         146.64333333333335,
                                         120.66583333333332,
                                         121.69833333333334,
                                         122.73083333333334,
                                         123.76333333333335,
                                         97.57583333333332,
                                         98.39833333333334,
                                         99.22083333333332,
                                         100.04333333333334,
                                         111.33916666666667,
                                         112.16166666666666,
                                         112.98416666666668,
                                         113.80666666666666,
                                         141.58916666666667,
                                         142.62166666666667,
                                         143.65416666666667,
                                         144.68666666666667,
                                         172.67916666666667,
                                         173.92166666666668,
                                         175.1641666666667,
                                         176.40666666666667,
                                         158.39249999999998,
                                         159.495,
                                         160.59750000000003,
                                         161.70000000000002,
                                         163.64249999999998,
                                         164.745,
                                         165.84750000000003,
                                         166.95000000000002,
                                         190.24916666666667,
                                         191.49166666666667,
                                         192.73416666666665,
                                         193.9766666666667,
                                         159.99916666666664,
                                         161.03166666666667,
                                         162.06416666666667,
                                         163.0966666666667,
                                         128.90916666666666,
                                         129.73166666666668,
                                         130.55416666666667,
                                         131.37666666666667,
                                         160.2525,
                                         161.1794444444444,
                                         162.1063888888889,
                                         163.03333333333333,
                                         203.22250000000003,
                                         204.3861111111111,
                                         205.54972222222224,
                                         206.71333333333334,
                                         247.13916666666668,
                                         248.53944444444443,
                                         249.93972222222223,
                                         251.34000000000003,
                                         225.11916666666667,
                                         226.36166666666665,
                                         227.60416666666666,
                                         228.84666666666666,
                                         231.03583333333333,
                                         232.27833333333334,
                                         233.5208333333333,
                                         234.76333333333335,
                                         266.94027777777774,
                                         268.34055555555557,
                                         269.74083333333334,
                                         271.1411111111111,
                                         223.9702777777778,
                                         225.13388888888892,
                                         226.29749999999999,
                                         227.4611111111111,
                                         180.05361111111114,
                                         180.98055555555558,
                                         181.9075,
                                         182.83444444444444,
                                         144.53583333333333,
                                         145.30611111111108,
                                         146.07638888888889,
                                         146.84666666666666,
                                         183.14583333333334,
                                         184.11277777777775,
                                         185.07972222222222,
                                         186.04666666666668,
                                         222.5425,
                                         223.70611111111108,
                                         224.86972222222224,
                                         226.03333333333336,
                                         202.3091666666667,
                                         203.34166666666664,
                                         204.37416666666667,
                                         205.40666666666667,
                                         207.22583333333336,
                                         208.25833333333335,
                                         209.29083333333332,
                                         210.32333333333335,
                                         238.99694444444447,
                                         240.16055555555556,
                                         241.32416666666666,
                                         242.48777777777775,
                                         200.38694444444445,
                                         201.35388888888892,
                                         202.32083333333333,
                                         203.28777777777776,
                                         160.99027777777778,
                                         161.76055555555556,
                                         162.53083333333333,
                                         163.30111111111108,
                                         123.80583333333333,
                                         124.41944444444442,
                                         125.03305555555558,
                                         125.64666666666666,
                                         156.77583333333334,
                                         157.54611111111112,
                                         158.3163888888889,
                                         159.08666666666667,
                                         190.3725,
                                         191.29944444444445,
                                         192.22638888888886,
                                         193.1533333333333,
                                         172.77916666666667,
                                         173.60166666666666,
                                         174.42416666666665,
                                         175.24666666666664,
                                         176.69583333333335,
                                         177.51833333333335,
                                         178.34083333333334,
                                         179.16333333333333,
                                         203.48027777777781,
                                         204.40722222222223,
                                         205.33416666666668,
                                         206.26111111111106,
                                         170.51027777777776,
                                         171.28055555555557,
                                         172.05083333333334,
                                         172.82111111111112,
                                         136.9136111111111,
                                         137.5272222222222,
                                         138.14083333333335,
                                         138.75444444444446};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         4.,
                                         4.16,
                                         4.32,
                                         4.48,
                                         8.64,
                                         8.96,
                                         9.280000000000001,
                                         9.600000000000001,
                                         13.920000000000002,
                                         14.4,
                                         14.879999999999999,
                                         15.36,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         15.840000000000002,
                                         16.32,
                                         16.799999999999997,
                                         17.28,
                                         11.2,
                                         11.52,
                                         11.84,
                                         12.16,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         4.,
                                         4.16,
                                         4.32,
                                         4.48,
                                         8.64,
                                         8.96,
                                         9.280000000000001,
                                         9.600000000000001,
                                         13.920000000000002,
                                         14.4,
                                         14.879999999999999,
                                         15.36,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         15.840000000000002,
                                         16.32,
                                         16.799999999999997,
                                         17.28,
                                         11.2,
                                         11.52,
                                         11.84,
                                         12.16,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         3.96,
                                         4.08,
                                         4.2,
                                         4.32,
                                         8.4,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         13.320000000000004,
                                         13.68,
                                         14.04,
                                         14.4,
                                         18.720000000000006,
                                         19.2,
                                         19.68,
                                         20.159999999999997,
                                         18.720000000000006,
                                         19.2,
                                         19.68,
                                         20.159999999999997,
                                         14.76,
                                         15.120000000000001,
                                         15.48,
                                         15.840000000000002,
                                         10.32,
                                         10.56,
                                         10.799999999999999,
                                         11.040000000000001,
                                         5.4,
                                         5.52,
                                         5.640000000000001,
                                         5.76,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         6.88,
                                         7.04,
                                         7.2,
                                         7.36,
                                         10.8,
                                         11.04,
                                         11.28,
                                         11.520000000000001,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         11.76,
                                         12.,
                                         12.24,
                                         12.48,
                                         8.16,
                                         8.32,
                                         8.48,
                                         8.64,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.177777777777778,
                                         5.584444444444443,
                                         7.538611111111111,
                                         8.844166666666665,
                                         7.4775,
                                         6.2275,
                                         7.2844444444444445,
                                         9.571111111111112,
                                         12.67527777777778,
                                         14.314166666666665,
                                         11.947500000000002,
                                         9.8575,
                                         12.342777777777778,
                                         16.029444444444444,
                                         20.94611111111111,
                                         23.001666666666665,
                                         19.01,
                                         15.57,
                                         20.176111111111112,
                                         25.862777777777776,
                                         33.279444444444444,
                                         35.335,
                                         28.843333333333334,
                                         23.403333333333336,
                                         18.642777777777777,
                                         23.829444444444444,
                                         30.55861111111111,
                                         32.197500000000005,
                                         26.205833333333334,
                                         21.215833333333336,
                                         16.47611111111111,
                                         21.022777777777776,
                                         26.901944444444442,
                                         28.2075,
                                         22.915833333333335,
                                         18.52583333333333,
                                         26.267777777777773,
                                         33.31444444444444,
                                         42.3186111111111,
                                         43.62416666666666,
                                         35.207499999999996,
                                         28.317500000000003,
                                         35.01444444444444,
                                         44.3811111111111,
                                         56.33527777777777,
                                         57.97416666666666,
                                         46.7575,
                                         37.587500000000006,
                                         47.12277777777778,
                                         59.68944444444444,
                                         75.70611111111111,
                                         77.76166666666667,
                                         62.67,
                                         50.35000000000001,
                                         54.956111111111106,
                                         69.52277777777778,
                                         88.03944444444446,
                                         90.09500000000001,
                                         72.50333333333333,
                                         58.18333333333333,
                                         46.37277777777778,
                                         58.63944444444444,
                                         74.21861111111112,
                                         75.8575,
                                         61.015833333333326,
                                         48.94583333333333,
                                         38.566111111111105,
                                         48.75277777777777,
                                         61.68194444444444,
                                         62.9875,
                                         50.64583333333333,
                                         40.615833333333335,
                                         48.35777777777777,
                                         61.04444444444444,
                                         77.09861111111111,
                                         78.40416666666665,
                                         62.9375,
                                         50.407500000000006,
                                         62.74444444444443,
                                         79.1911111111111,
                                         99.99527777777777,
                                         101.63416666666666,
                                         81.56750000000001,
                                         65.31750000000001,
                                         81.90277777777777,
                                         103.34944444444443,
                                         130.4661111111111,
                                         132.52166666666665,
                                         106.33000000000001,
                                         85.13000000000001,
                                         89.73611111111111,
                                         113.18277777777777,
                                         142.79944444444445,
                                         144.85500000000002,
                                         116.16333333333333,
                                         92.96333333333332,
                                         74.10277777777779,
                                         93.44944444444445,
                                         117.87861111111111,
                                         119.51750000000001,
                                         95.82583333333334,
                                         76.67583333333334,
                                         60.65611111111111,
                                         76.48277777777778,
                                         96.46194444444446,
                                         97.7675,
                                         78.37583333333333,
                                         62.705833333333324};
  const std::array<int, 4> in_shape = {{3, 6, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.08,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.12,
                                         0.28,
                                         0.28,
                                         0.28,
                                         0.28,
                                         0.16,
                                         0.2,
                                         0.44,
                                         0.44,
                                         0.44,
                                         0.44,
                                         0.24,
                                         0.48000000000000004,
                                         1.04,
                                         1.04,
                                         1.04,
                                         1.04,
                                         0.56,
                                         0.48000000000000004,
                                         1.04,
                                         1.04,
                                         1.04,
                                         1.04,
                                         0.56,
                                         0.48000000000000004,
                                         1.04,
                                         1.04,
                                         1.04,
                                         1.04,
                                         0.56,
                                         0.48000000000000004,
                                         1.04,
                                         1.04,
                                         1.04,
                                         1.04,
                                         0.56,
                                         0.28,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.32,
                                         0.36,
                                         0.76,
                                         0.76,
                                         0.76,
                                         0.76,
                                         0.4,
                                         0.8,
                                         1.68,
                                         1.68,
                                         1.68,
                                         1.68,
                                         0.88,
                                         0.8,
                                         1.68,
                                         1.68,
                                         1.68,
                                         1.68,
                                         0.88,
                                         0.8,
                                         1.68,
                                         1.68,
                                         1.68,
                                         1.68,
                                         0.88,
                                         0.8,
                                         1.68,
                                         1.68,
                                         1.68,
                                         1.68,
                                         0.88,
                                         0.44,
                                         0.9199999999999999,
                                         0.9199999999999999,
                                         0.9199999999999999,
                                         0.9199999999999999,
                                         0.48};
  const std::array<int, 4> in_shape = {{3, 6, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.741944444444444,  8.355555555555556,
      10.398611111111112, 11.168888888888887,
      14.111111111111112, 15.077222222222222,
      16.72222222222222,  17.68833333333333,
      14.184722222222224, 14.955,
      11.84138888888889,  12.455,
      13.79861111111111,  14.568888888888889,
      18.17527777777778,  19.142222222222223,
      24.137777777777778, 25.35055555555556,
      27.415555555555553, 28.62833333333333,
      22.928055555555556, 23.895000000000003,
      18.944722222222225, 19.715,
      23.71944444444444,  24.685555555555556,
      30.846111111111114, 32.05888888888889,
      40.37111111111111,  41.89222222222222,
      44.48222222222222,  46.00333333333333,
      36.80722222222222,  38.02,
      30.17388888888889,  31.14,
      39.38611111111111,  40.352222222222224,
      50.512777777777785, 51.72555555555555,
      65.03777777777779,  66.55888888888889,
      69.14888888888889,  70.67,
      56.47388888888889,  57.68666666666667,
      45.840555555555554, 46.80666666666667,
      36.51527777777778,  37.285555555555554,
      46.69194444444445,  47.65888888888889,
      59.90444444444445,  61.11722222222222,
      63.18222222222222,  64.39500000000001,
      51.444722222222225, 52.41166666666667,
      41.66138888888889,  42.43166666666667,
      32.33861111111111,  32.95222222222222,
      41.27527777777778,  42.04555555555555,
      52.83777777777778,  53.803888888888885,
      55.44888888888889,  56.415,
      45.061388888888885, 45.83166666666667,
      36.43805555555555,  37.05166666666666,
      51.92194444444445,  52.53555555555555,
      65.85861111111112,  66.62888888888888,
      83.67111111111112,  84.6372222222222,
      86.28222222222223,  87.24833333333332,
      69.64472222222221,  70.41499999999999,
      56.021388888888886, 56.635000000000005,
      69.25861111111111,  70.02888888888889,
      87.79527777777777,  88.7622222222222,
      111.45777777777776, 112.67055555555554,
      114.73555555555555, 115.94833333333332,
      92.54805555555554,  93.515,
      74.40472222222222,  75.17500000000001,
      93.27944444444444,  94.24555555555555,
      118.16611111111109, 119.37888888888888,
      149.8911111111111,  151.41222222222223,
      154.0022222222222,  155.52333333333334,
      124.1272222222222,  125.34,
      99.73388888888888,  100.70000000000002,
      108.94611111111112, 109.91222222222221,
      137.83277777777778, 139.04555555555555,
      174.55777777777774, 176.0788888888889,
      178.66888888888886, 180.19000000000003,
      143.79388888888892, 145.00666666666666,
      115.40055555555557, 116.36666666666666,
      91.97527777777776,  92.74555555555555,
      116.31194444444442, 117.27888888888889,
      147.22444444444443, 148.43722222222223,
      150.50222222222223, 151.715,
      121.06472222222224, 122.03166666666665,
      97.12138888888889,  97.89166666666667,
      76.51861111111111,  77.13222222222221,
      96.73527777777777,  97.50555555555555,
      122.39777777777776, 123.36388888888888,
      125.00888888888888, 125.975,
      100.52138888888888, 101.29166666666666,
      80.61805555555554,  81.23166666666667,
      96.10194444444444,  96.71555555555554,
      121.31861111111111, 122.08888888888887,
      153.2311111111111,  154.19722222222222,
      155.84222222222223, 156.8083333333333,
      125.10472222222224, 125.875,
      100.20138888888889, 100.81500000000001,
      124.71861111111112, 125.48888888888887,
      157.4152777777778,  158.3822222222222,
      198.77777777777774, 199.99055555555555,
      202.05555555555554, 203.26833333333332,
      162.16805555555553, 163.13500000000002,
      129.8647222222222,  130.63500000000002,
      162.83944444444444, 163.80555555555554,
      205.48611111111111, 206.69888888888886,
      259.41111111111104, 260.9322222222222,
      263.5222222222222,  265.0433333333333,
      211.44722222222217, 212.66000000000003,
      169.29388888888886, 170.26000000000002,
      178.50611111111112, 179.47222222222223,
      225.15277777777774, 226.36555555555555,
      284.0777777777778,  285.5988888888889,
      288.18888888888887, 289.71000000000004,
      231.11388888888888, 232.32666666666665,
      184.96055555555554, 185.92666666666665,
      147.43527777777777, 148.20555555555558,
      185.93194444444444, 186.8988888888889,
      234.54444444444442, 235.75722222222223,
      237.8222222222222,  239.03500000000003,
      190.68472222222223, 191.65166666666667,
      152.58138888888888, 153.3516666666667,
      120.69861111111112, 121.31222222222222,
      152.19527777777776, 152.96555555555557,
      191.95777777777778, 192.9238888888889,
      194.5688888888889,  195.535,
      155.9813888888889,  156.75166666666667,
      124.79805555555555, 125.41166666666665};
  const std::array<int, 4> in_shape = {{3, 6, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.48000000000000004,
                                         0.56,
                                         0.48000000000000004,
                                         0.56,
                                         0.48000000000000004,
                                         0.56,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.36,
                                         0.4,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.44,
                                         0.48,
                                         0.88,
                                         0.9600000000000001,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         0.6,
                                         0.64,
                                         0.68,
                                         0.72,
                                         1.44,
                                         1.52,
                                         1.44,
                                         1.52,
                                         1.44,
                                         1.52,
                                         1.44,
                                         1.52,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         1.76,
                                         1.8399999999999999,
                                         1.76,
                                         1.8399999999999999,
                                         1.76,
                                         1.8399999999999999,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96};
  const std::array<int, 4> in_shape = {{3, 6, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {14.870277777777776,
                                         15.483888888888888,
                                         16.0975,
                                         16.711111111111112,
                                         20.026944444444446,
                                         20.797222222222224,
                                         21.5675,
                                         22.337777777777774,
                                         27.256111111111114,
                                         28.222222222222225,
                                         29.188333333333333,
                                         30.154444444444444,
                                         32.47833333333333,
                                         33.44444444444444,
                                         34.410555555555554,
                                         35.37666666666666,
                                         27.59916666666667,
                                         28.369444444444447,
                                         29.139722222222225,
                                         29.91,
                                         23.069166666666668,
                                         23.68277777777778,
                                         24.29638888888889,
                                         24.91,
                                         26.826944444444443,
                                         27.59722222222222,
                                         28.3675,
                                         29.137777777777778,
                                         35.383611111111115,
                                         36.35055555555556,
                                         37.317499999999995,
                                         38.284444444444446,
                                         47.06277777777778,
                                         48.275555555555556,
                                         49.48833333333333,
                                         50.70111111111112,
                                         53.61833333333334,
                                         54.831111111111106,
                                         56.04388888888889,
                                         57.25666666666666,
                                         44.889166666666675,
                                         45.85611111111111,
                                         46.823055555555555,
                                         47.790000000000006,
                                         37.119166666666665,
                                         37.88944444444445,
                                         38.65972222222223,
                                         39.43,
                                         46.47277777777778,
                                         47.43888888888888,
                                         48.405,
                                         49.37111111111111,
                                         60.479444444444454,
                                         61.69222222222223,
                                         62.905,
                                         64.11777777777777,
                                         79.22111111111111,
                                         80.74222222222222,
                                         82.26333333333332,
                                         83.78444444444445,
                                         87.44333333333334,
                                         88.96444444444444,
                                         90.48555555555555,
                                         92.00666666666666,
                                         72.40166666666667,
                                         73.61444444444444,
                                         74.82722222222223,
                                         76.04,
                                         59.38166666666667,
                                         60.34777777777778,
                                         61.31388888888889,
                                         62.28,
                                         77.80611111111111,
                                         78.77222222222223,
                                         79.73833333333333,
                                         80.70444444444445,
                                         99.81277777777777,
                                         101.02555555555557,
                                         102.23833333333333,
                                         103.4511111111111,
                                         128.55444444444444,
                                         130.07555555555558,
                                         131.59666666666666,
                                         133.11777777777777,
                                         136.77666666666667,
                                         138.29777777777778,
                                         139.8188888888889,
                                         141.34,
                                         111.73500000000001,
                                         112.94777777777777,
                                         114.16055555555556,
                                         115.37333333333333,
                                         90.715,
                                         91.68111111111111,
                                         92.64722222222223,
                                         93.61333333333334,
                                         72.26027777777777,
                                         73.03055555555557,
                                         73.80083333333333,
                                         74.57111111111111,
                                         92.41694444444445,
                                         93.3838888888889,
                                         94.35083333333334,
                                         95.31777777777778,
                                         118.59611111111111,
                                         119.8088888888889,
                                         121.02166666666666,
                                         122.23444444444443,
                                         125.15166666666667,
                                         126.36444444444444,
                                         127.57722222222222,
                                         128.79000000000002,
                                         101.92250000000001,
                                         102.88944444444445,
                                         103.85638888888887,
                                         104.82333333333334,
                                         82.55250000000001,
                                         83.32277777777777,
                                         84.09305555555555,
                                         84.86333333333334,
                                         64.0636111111111,
                                         64.67722222222223,
                                         65.29083333333332,
                                         65.90444444444444,
                                         81.78027777777777,
                                         82.55055555555556,
                                         83.32083333333334,
                                         84.0911111111111,
                                         104.70944444444446,
                                         105.67555555555556,
                                         106.64166666666667,
                                         107.60777777777777,
                                         109.93166666666667,
                                         110.89777777777778,
                                         111.86388888888888,
                                         112.83,
                                         89.3525,
                                         90.12277777777777,
                                         90.89305555555555,
                                         91.66333333333334,
                                         72.2625,
                                         72.8761111111111,
                                         73.48972222222221,
                                         74.10333333333332,
                                         103.23027777777777,
                                         103.8438888888889,
                                         104.45750000000001,
                                         105.0711111111111,
                                         130.94694444444443,
                                         131.71722222222223,
                                         132.4875,
                                         133.25777777777776,
                                         166.37611111111107,
                                         167.34222222222223,
                                         168.30833333333337,
                                         169.2744444444444,
                                         171.59833333333327,
                                         172.56444444444446,
                                         173.5305555555556,
                                         174.49666666666664,
                                         138.51916666666668,
                                         139.28944444444443,
                                         140.05972222222223,
                                         140.82999999999998,
                                         111.42916666666667,
                                         112.04277777777777,
                                         112.65638888888887,
                                         113.27000000000001,
                                         137.74694444444444,
                                         138.51722222222222,
                                         139.28750000000002,
                                         140.05777777777777,
                                         174.6236111111111,
                                         175.59055555555554,
                                         176.55750000000003,
                                         177.5244444444444,
                                         221.70277777777775,
                                         222.91555555555553,
                                         224.1283333333334,
                                         225.34111111111108,
                                         228.2583333333333,
                                         229.4711111111111,
                                         230.68388888888896,
                                         231.89666666666665,
                                         184.1291666666667,
                                         185.09611111111107,
                                         186.0630555555556,
                                         187.03,
                                         148.0391666666667,
                                         148.80944444444444,
                                         149.5797222222222,
                                         150.35000000000002,
                                         185.59277777777777,
                                         186.55888888888887,
                                         187.52500000000003,
                                         188.4911111111111,
                                         235.11944444444444,
                                         236.33222222222219,
                                         237.54500000000004,
                                         238.75777777777776,
                                         298.26111111111106,
                                         299.7822222222222,
                                         301.3033333333334,
                                         302.82444444444445,
                                         306.4833333333333,
                                         308.0044444444444,
                                         309.5255555555556,
                                         311.0466666666667,
                                         247.04166666666669,
                                         248.2544444444444,
                                         249.46722222222226,
                                         250.68,
                                         198.5016666666667,
                                         199.46777777777777,
                                         200.43388888888884,
                                         201.40000000000003,
                                         216.92611111111106,
                                         217.89222222222224,
                                         218.85833333333338,
                                         219.82444444444442,
                                         274.4527777777778,
                                         275.66555555555556,
                                         276.87833333333333,
                                         278.0911111111111,
                                         347.59444444444443,
                                         349.1155555555555,
                                         350.63666666666666,
                                         352.1577777777778,
                                         355.8166666666667,
                                         357.3377777777777,
                                         358.85888888888894,
                                         360.38000000000005,
                                         286.375,
                                         287.58777777777783,
                                         288.80055555555555,
                                         290.0133333333333,
                                         229.835,
                                         230.80111111111114,
                                         231.7672222222222,
                                         232.73333333333332,
                                         183.18027777777777,
                                         183.95055555555552,
                                         184.72083333333336,
                                         185.4911111111111,
                                         231.65694444444443,
                                         232.62388888888884,
                                         233.59083333333334,
                                         234.55777777777777,
                                         293.2361111111111,
                                         294.44888888888886,
                                         295.6616666666667,
                                         296.87444444444446,
                                         299.7916666666667,
                                         301.00444444444446,
                                         302.2172222222222,
                                         303.43,
                                         241.1625,
                                         242.1294444444445,
                                         243.09638888888887,
                                         244.0633333333333,
                                         193.47249999999997,
                                         194.24277777777777,
                                         195.01305555555555,
                                         195.78333333333333,
                                         152.4236111111111,
                                         153.03722222222223,
                                         153.65083333333334,
                                         154.26444444444442,
                                         192.70027777777776,
                                         193.47055555555553,
                                         194.24083333333334,
                                         195.0111111111111,
                                         243.82944444444442,
                                         244.79555555555552,
                                         245.76166666666668,
                                         246.72777777777776,
                                         249.05166666666662,
                                         250.01777777777775,
                                         250.9838888888889,
                                         251.95,
                                         200.27249999999998,
                                         201.04277777777776,
                                         201.81305555555556,
                                         202.58333333333331,
                                         160.62249999999997,
                                         161.2361111111111,
                                         161.84972222222223,
                                         162.46333333333334,
                                         191.5902777777778,
                                         192.20388888888888,
                                         192.8175,
                                         193.43111111111108,
                                         241.86694444444447,
                                         242.63722222222222,
                                         243.4075,
                                         244.17777777777775,
                                         305.4961111111111,
                                         306.4622222222222,
                                         307.42833333333334,
                                         308.39444444444445,
                                         310.7183333333333,
                                         311.68444444444447,
                                         312.65055555555557,
                                         313.6166666666666,
                                         249.4391666666667,
                                         250.20944444444447,
                                         250.97972222222222,
                                         251.75,
                                         199.7891666666667,
                                         200.40277777777777,
                                         201.01638888888888,
                                         201.63000000000002,
                                         248.66694444444445,
                                         249.43722222222223,
                                         250.20749999999998,
                                         250.97777777777773,
                                         313.86361111111114,
                                         314.8305555555556,
                                         315.7975,
                                         316.7644444444444,
                                         396.34277777777777,
                                         397.5555555555555,
                                         398.7683333333333,
                                         399.9811111111111,
                                         402.8983333333333,
                                         404.1111111111111,
                                         405.32388888888886,
                                         406.53666666666663,
                                         323.36916666666673,
                                         324.33611111111105,
                                         325.3030555555555,
                                         326.27000000000004,
                                         258.95916666666665,
                                         259.7294444444444,
                                         260.4997222222222,
                                         261.27000000000004,
                                         324.7127777777778,
                                         325.6788888888889,
                                         326.645,
                                         327.6111111111111,
                                         409.75944444444445,
                                         410.97222222222223,
                                         412.185,
                                         413.3977777777777,
                                         517.3011111111111,
                                         518.8222222222221,
                                         520.3433333333332,
                                         521.8644444444444,
                                         525.5233333333333,
                                         527.0444444444444,
                                         528.5655555555555,
                                         530.0866666666666,
                                         421.68166666666673,
                                         422.89444444444433,
                                         424.10722222222216,
                                         425.32000000000005,
                                         337.62166666666667,
                                         338.5877777777777,
                                         339.5538888888889,
                                         340.52000000000004,
                                         356.0461111111111,
                                         357.01222222222225,
                                         357.9783333333333,
                                         358.94444444444446,
                                         449.09277777777777,
                                         450.3055555555555,
                                         451.51833333333326,
                                         452.7311111111111,
                                         566.6344444444445,
                                         568.1555555555556,
                                         569.6766666666666,
                                         571.1977777777778,
                                         574.8566666666667,
                                         576.3777777777777,
                                         577.8988888888889,
                                         579.4200000000001,
                                         461.01500000000004,
                                         462.22777777777776,
                                         463.44055555555553,
                                         464.6533333333333,
                                         368.95500000000004,
                                         369.9211111111111,
                                         370.88722222222225,
                                         371.8533333333333,
                                         294.1002777777778,
                                         294.87055555555554,
                                         295.6408333333333,
                                         296.41111111111115,
                                         370.8969444444445,
                                         371.8638888888889,
                                         372.8308333333333,
                                         373.7977777777778,
                                         467.87611111111113,
                                         469.08888888888885,
                                         470.3016666666666,
                                         471.51444444444445,
                                         474.43166666666673,
                                         475.6444444444444,
                                         476.85722222222216,
                                         478.07000000000005,
                                         380.40250000000003,
                                         381.36944444444447,
                                         382.3363888888888,
                                         383.30333333333334,
                                         304.39250000000004,
                                         305.16277777777776,
                                         305.9330555555555,
                                         306.7033333333334,
                                         240.78361111111113,
                                         241.39722222222224,
                                         242.01083333333332,
                                         242.62444444444444,
                                         303.62027777777774,
                                         304.3905555555555,
                                         305.1608333333333,
                                         305.93111111111114,
                                         382.9494444444445,
                                         383.91555555555556,
                                         384.88166666666666,
                                         385.8477777777778,
                                         388.1716666666667,
                                         389.1377777777778,
                                         390.10388888888883,
                                         391.07,
                                         311.19250000000005,
                                         311.9627777777778,
                                         312.73305555555555,
                                         313.50333333333333,
                                         248.9825,
                                         249.5961111111111,
                                         250.2097222222222,
                                         250.8233333333333};
  const std::array<int, 4> in_shape = {{3, 6, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.68,
                                         0.72,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         0.92,
                                         0.96,
                                         1.6800000000000002,
                                         1.76,
                                         1.84,
                                         1.9200000000000002,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         1.6800000000000002,
                                         1.76,
                                         1.84,
                                         1.9200000000000002,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         1.6800000000000002,
                                         1.76,
                                         1.84,
                                         1.9200000000000002,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         1.6800000000000002,
                                         1.76,
                                         1.84,
                                         1.9200000000000002,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         1.24,
                                         1.28,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         1.48,
                                         1.52,
                                         1.56,
                                         1.6,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         1.6400000000000001,
                                         1.68,
                                         1.72,
                                         1.76,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92};
  const std::array<int, 4> in_shape = {{3, 6, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.686944444444444,
                                         6.2236111111111105,
                                         7.916944444444443,
                                         8.451666666666666,
                                         10.266944444444443,
                                         8.886944444444444,
                                         7.350277777777778,
                                         8.26361111111111,
                                         10.800277777777776,
                                         13.53361111111111,
                                         13.951666666666666,
                                         16.483611111111106,
                                         14.143611111111111,
                                         11.606944444444446,
                                         14.105277777777777,
                                         18.241944444444442,
                                         22.62527777777778,
                                         22.751666666666665,
                                         26.325277777777774,
                                         22.435277777777777,
                                         18.298611111111114,
                                         23.244166666666665,
                                         29.714166666666664,
                                         36.430833333333325,
                                         35.584999999999994,
                                         40.13083333333333,
                                         33.907500000000006,
                                         27.4375,
                                         21.515,
                                         27.435000000000002,
                                         33.55166666666666,
                                         32.56,
                                         36.50166666666667,
                                         30.778333333333336,
                                         24.858333333333334,
                                         19.034999999999997,
                                         24.235,
                                         29.591666666666672,
                                         28.6,
                                         31.94166666666667,
                                         26.898333333333333,
                                         21.69833333333333,
                                         30.45861111111111,
                                         38.57527777777778,
                                         46.848611111111104,
                                         44.641666666666666,
                                         49.19861111111111,
                                         41.23861111111111,
                                         33.121944444444445,
                                         40.61527777777778,
                                         51.411944444444444,
                                         62.40527777777777,
                                         59.38166666666667,
                                         65.35527777777779,
                                         54.75527777777778,
                                         43.95861111111111,
                                         54.68194444444444,
                                         69.17861111111111,
                                         83.92194444444445,
                                         79.73166666666667,
                                         87.62194444444447,
                                         73.37194444444445,
                                         58.875277777777775,
                                         63.82083333333333,
                                         80.65083333333332,
                                         97.7275,
                                         92.56500000000001,
                                         101.42750000000001,
                                         84.84416666666667,
                                         68.01416666666665,
                                         53.86666666666667,
                                         68.04666666666667,
                                         82.42333333333333,
                                         77.99000000000001,
                                         85.37333333333333,
                                         71.39,
                                         57.209999999999994,
                                         44.806666666666665,
                                         56.586666666666666,
                                         68.52333333333334,
                                         64.79,
                                         70.87333333333333,
                                         59.25,
                                         47.47,
                                         56.23027777777778,
                                         70.92694444444444,
                                         85.78027777777778,
                                         80.83166666666668,
                                         88.13027777777778,
                                         73.59027777777777,
                                         58.89361111111111,
                                         72.96694444444444,
                                         92.0236111111111,
                                         111.27694444444445,
                                         104.81166666666667,
                                         114.22694444444446,
                                         95.36694444444444,
                                         76.31027777777778,
                                         95.25861111111111,
                                         120.11527777777776,
                                         145.21861111111113,
                                         136.71166666666667,
                                         148.91861111111112,
                                         124.3086111111111,
                                         99.45194444444445,
                                         104.39749999999998,
                                         131.58749999999998,
                                         159.02416666666664,
                                         149.545,
                                         162.72416666666666,
                                         135.78083333333333,
                                         108.59083333333335,
                                         86.21833333333333,
                                         108.65833333333332,
                                         131.295,
                                         123.42,
                                         134.245,
                                         112.00166666666667,
                                         89.56166666666667,
                                         70.57833333333332,
                                         88.93833333333332,
                                         107.45500000000001,
                                         100.98,
                                         109.80500000000002,
                                         91.60166666666667,
                                         73.24166666666667};
  const std::array<int, 4> in_shape = {{3, 6, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.24,
                                         0.24,
                                         0.2,
                                         0.12,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.16,
                                         0.36,
                                         0.6,
                                         0.6,
                                         0.6,
                                         0.44,
                                         0.24,
                                         0.28,
                                         0.6000000000000001,
                                         0.9600000000000001,
                                         0.9600000000000001,
                                         0.9600000000000001,
                                         0.6799999999999999,
                                         0.36,
                                         0.68,
                                         1.44,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.5999999999999999,
                                         0.84,
                                         0.68,
                                         1.44,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.5999999999999999,
                                         0.84,
                                         0.68,
                                         1.44,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.5999999999999999,
                                         0.84,
                                         0.68,
                                         1.44,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.5999999999999999,
                                         0.84,
                                         0.4,
                                         0.8400000000000001,
                                         1.32,
                                         1.32,
                                         1.32,
                                         0.9199999999999999,
                                         0.48,
                                         0.52,
                                         1.08,
                                         1.6800000000000002,
                                         1.6800000000000002,
                                         1.6800000000000002,
                                         1.1600000000000001,
                                         0.6,
                                         1.1600000000000001,
                                         2.4000000000000004,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         2.5600000000000005,
                                         1.3199999999999998,
                                         1.1600000000000001,
                                         2.4000000000000004,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         2.5600000000000005,
                                         1.3199999999999998,
                                         1.1600000000000001,
                                         2.4000000000000004,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         2.5600000000000005,
                                         1.3199999999999998,
                                         1.1600000000000001,
                                         2.4000000000000004,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         2.5600000000000005,
                                         1.3199999999999998,
                                         0.64,
                                         1.32,
                                         2.04,
                                         2.04,
                                         2.04,
                                         1.4,
                                         0.72};
  const std::array<int, 4> in_shape = {{3, 6, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      8.760277777777778,  9.373888888888889,
      11.676944444444445, 12.447222222222221,
      14.906944444444447, 15.833888888888886,
      16.041666666666668, 16.903333333333332,
      19.606944444444448, 20.533888888888885,
      17.003611111111113, 17.773888888888887,
      14.086944444444445, 14.700555555555557,
      15.756944444444446, 16.52722222222222,
      20.63361111111111,  21.60055555555555,
      25.90361111111111,  27.06722222222222,
      26.821666666666665, 27.903333333333332,
      31.803611111111113, 32.96722222222221,
      27.32027777777778,  28.287222222222223,
      22.443611111111114, 23.213888888888892,
      27.244444444444447, 28.210555555555555,
      35.27111111111111,  36.483888888888885,
      43.79111111111111,  45.25055555555556,
      44.14666666666666,  45.50333333333333,
      51.19111111111111,  52.65055555555555,
      43.65777777777778,  44.870555555555555,
      35.63111111111111,  36.59722222222223,
      45.522222222222226, 46.48833333333333,
      58.215555555555554, 59.42833333333333,
      71.40222222222222,  72.86166666666665,
      69.81333333333333,  71.16999999999999,
      78.80222222222221,  80.26166666666666,
      66.60222222222222,  67.81500000000001,
      53.90888888888889,  54.875,
      42.25972222222222,  43.03,
      53.903055555555554, 54.870000000000005,
      65.93972222222223,  67.10333333333332,
      64.03833333333333,  65.12,
      71.83972222222222,  73.00333333333334,
      60.58972222222222,  61.55666666666667,
      48.94638888888889,  49.71666666666667,
      37.45638888888889,  38.06999999999999,
      47.69972222222222,  48.47,
      58.256388888888885, 59.183333333333344,
      56.33833333333333,  57.2,
      62.95638888888889,  63.88333333333334,
      53.02638888888889,  53.79666666666667,
      42.783055555555556, 43.39666666666666,
      60.30361111111111,  60.91722222222222,
      76.38027777777778,  77.15055555555556,
      92.77027777777779,  93.69722222222221,
      88.4216666666667,   89.28333333333333,
      97.4702777777778,   98.39722222222223,
      81.70694444444445,  82.47722222222222,
      65.63027777777778,  66.24388888888889,
      80.46027777777778,  81.23055555555555,
      101.85694444444445, 102.82388888888889,
      123.64694444444447, 124.81055555555554,
      117.6816666666667,  118.76333333333334,
      129.54694444444448, 130.71055555555557,
      108.5436111111111,  109.51055555555556,
      87.14694444444444,  87.91722222222222,
      108.39777777777778, 109.36388888888888,
      137.14444444444445, 138.35722222222222,
      166.38444444444445, 167.8438888888889,
      158.10666666666668, 159.46333333333334,
      173.78444444444446, 175.24388888888893,
      145.5311111111111,  146.7438888888889,
      116.78444444444445, 117.75055555555555,
      126.67555555555556, 127.64166666666667,
      160.08888888888887, 161.30166666666665,
      193.99555555555554, 195.455,
      183.7733333333333,  185.13000000000002,
      201.39555555555552, 202.85500000000002,
      168.47555555555553, 169.68833333333333,
      135.0622222222222,  136.0283333333333,
      106.96305555555556, 107.73333333333333,
      135.12638888888887, 136.09333333333333,
      163.68305555555554, 164.84666666666666,
      154.8983333333333,  155.98000000000002,
      169.58305555555555, 170.74666666666667,
      141.81305555555554, 142.78,
      113.64972222222222, 114.41999999999999,
      88.99972222222222,  89.61333333333333,
      112.40305555555554, 113.17333333333333,
      136.1197222222222,  137.04666666666668,
      128.71833333333333, 129.58,
      140.8197222222222,  141.74666666666667,
      117.72972222222224, 118.5,
      94.3263888888889,   94.94,
      111.84694444444443, 112.46055555555556,
      141.0836111111111,  141.8538888888889,
      170.63361111111107, 171.56055555555557,
      160.80166666666665, 161.66333333333336,
      175.33361111111108, 176.26055555555556,
      146.4102777777778,  147.18055555555554,
      117.17361111111111, 117.78722222222223,
      145.1636111111111,  145.93388888888887,
      183.08027777777778, 184.0472222222222,
      221.39027777777773, 222.5538888888889,
      208.54166666666666, 209.62333333333333,
      227.29027777777776, 228.4538888888889,
      189.76694444444448, 190.73388888888888,
      151.8502777777778,  152.62055555555557,
      189.55111111111108, 190.51722222222222,
      239.01777777777778, 240.23055555555553,
      288.9777777777777,  290.43722222222226,
      272.06666666666666, 273.42333333333335,
      296.37777777777774, 297.83722222222224,
      247.4044444444445,  248.6172222222222,
      197.9377777777778,  198.9038888888889,
      207.82888888888888, 208.79499999999996,
      261.96222222222224, 263.17499999999995,
      316.58888888888885, 318.0483333333333,
      297.73333333333335, 299.09,
      323.9888888888888,  325.4483333333333,
      270.34888888888895, 271.56166666666667,
      216.21555555555557, 217.1816666666667,
      171.6663888888889,  172.43666666666667,
      216.34972222222223, 217.31666666666663,
      261.4263888888889,  262.59,
      245.75833333333335, 246.84,
      267.3263888888889,  268.49,
      223.03638888888892, 224.00333333333333,
      178.35305555555556, 179.12333333333333,
      140.54305555555555, 141.15666666666664,
      177.1063888888889,  177.87666666666664,
      213.98305555555555, 214.91000000000003,
      201.09833333333333, 201.96,
      218.68305555555557, 219.61000000000004,
      182.43305555555554, 183.20333333333335,
      145.8697222222222,  146.48333333333335};
  const std::array<int, 4> in_shape = {{3, 6, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.32,
                                         0.4,
                                         0.2,
                                         0.24,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.28,
                                         0.32,
                                         0.64,
                                         0.72,
                                         1.08,
                                         1.2,
                                         1.08,
                                         1.2,
                                         1.08,
                                         1.2,
                                         0.8,
                                         0.88,
                                         0.44,
                                         0.48,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.28,
                                         1.3599999999999999,
                                         0.68,
                                         0.72,
                                         1.28,
                                         1.36,
                                         2.72,
                                         2.88,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         3.04,
                                         3.1999999999999997,
                                         1.6,
                                         1.68,
                                         1.28,
                                         1.36,
                                         2.72,
                                         2.88,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         3.04,
                                         3.1999999999999997,
                                         1.6,
                                         1.68,
                                         1.28,
                                         1.36,
                                         2.72,
                                         2.88,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         3.04,
                                         3.1999999999999997,
                                         1.6,
                                         1.68,
                                         1.28,
                                         1.36,
                                         2.72,
                                         2.88,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         3.04,
                                         3.1999999999999997,
                                         1.6,
                                         1.68,
                                         0.76,
                                         0.8,
                                         1.6,
                                         1.6800000000000002,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         3.24,
                                         3.3600000000000003,
                                         3.24,
                                         3.3600000000000003,
                                         3.24,
                                         3.3600000000000003,
                                         2.24,
                                         2.3200000000000003,
                                         1.16,
                                         1.2,
                                         2.24,
                                         2.3200000000000003,
                                         4.640000000000001,
                                         4.800000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         4.960000000000001,
                                         5.120000000000001,
                                         2.56,
                                         2.6399999999999997,
                                         2.24,
                                         2.3200000000000003,
                                         4.640000000000001,
                                         4.800000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         4.960000000000001,
                                         5.120000000000001,
                                         2.56,
                                         2.6399999999999997,
                                         2.24,
                                         2.3200000000000003,
                                         4.640000000000001,
                                         4.800000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         4.960000000000001,
                                         5.120000000000001,
                                         2.56,
                                         2.6399999999999997,
                                         2.24,
                                         2.3200000000000003,
                                         4.640000000000001,
                                         4.800000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         4.960000000000001,
                                         5.120000000000001,
                                         2.56,
                                         2.6399999999999997,
                                         1.24,
                                         1.28,
                                         2.56,
                                         2.64,
                                         3.96,
                                         4.08,
                                         3.96,
                                         4.08,
                                         3.96,
                                         4.08,
                                         2.72,
                                         2.8,
                                         1.4000000000000001,
                                         1.44};
  const std::array<int, 4> in_shape = {{3, 6, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.906944444444445,
                                         17.520555555555557,
                                         18.13416666666667,
                                         18.747777777777777,
                                         22.583611111111114,
                                         23.35388888888889,
                                         24.124166666666667,
                                         24.894444444444442,
                                         28.886944444444445,
                                         29.813888888888894,
                                         30.74083333333333,
                                         31.667777777777772,
                                         31.22166666666667,
                                         32.083333333333336,
                                         32.945,
                                         33.806666666666665,
                                         38.286944444444444,
                                         39.213888888888896,
                                         40.14083333333333,
                                         41.06777777777777,
                                         33.23694444444445,
                                         34.007222222222225,
                                         34.777499999999996,
                                         35.547777777777775,
                                         27.560277777777777,
                                         28.17388888888889,
                                         28.7875,
                                         29.401111111111113,
                                         30.74361111111111,
                                         31.513888888888893,
                                         32.28416666666667,
                                         33.05444444444444,
                                         40.30027777777779,
                                         41.26722222222222,
                                         42.23416666666667,
                                         43.2011111111111,
                                         50.64361111111111,
                                         51.80722222222222,
                                         52.970833333333324,
                                         54.13444444444444,
                                         52.561666666666675,
                                         53.64333333333333,
                                         54.724999999999994,
                                         55.806666666666665,
                                         62.44361111111111,
                                         63.60722222222223,
                                         64.77083333333333,
                                         65.93444444444442,
                                         53.673611111111114,
                                         54.64055555555556,
                                         55.607499999999995,
                                         56.574444444444445,
                                         44.11694444444444,
                                         44.88722222222223,
                                         45.6575,
                                         46.427777777777784,
                                         53.522777777777776,
                                         54.488888888888894,
                                         55.455000000000005,
                                         56.42111111111111,
                                         69.32944444444445,
                                         70.54222222222222,
                                         71.755,
                                         72.96777777777777,
                                         86.12277777777777,
                                         87.58222222222221,
                                         89.04166666666666,
                                         90.50111111111111,
                                         86.93666666666668,
                                         88.29333333333332,
                                         89.64999999999999,
                                         91.00666666666666,
                                         100.92277777777778,
                                         102.38222222222223,
                                         103.84166666666665,
                                         105.3011111111111,
                                         86.10277777777779,
                                         87.31555555555556,
                                         88.52833333333332,
                                         89.74111111111111,
                                         70.29611111111112,
                                         71.26222222222222,
                                         72.22833333333332,
                                         73.19444444444446,
                                         90.07833333333333,
                                         91.04444444444445,
                                         92.01055555555556,
                                         92.97666666666666,
                                         115.21833333333335,
                                         116.43111111111111,
                                         117.64388888888888,
                                         118.85666666666665,
                                         141.345,
                                         142.80444444444444,
                                         144.26388888888886,
                                         145.7233333333333,
                                         138.27,
                                         139.62666666666667,
                                         140.98333333333332,
                                         142.33999999999997,
                                         156.14500000000004,
                                         157.60444444444443,
                                         159.06388888888884,
                                         160.5233333333333,
                                         131.99166666666667,
                                         133.20444444444445,
                                         134.4172222222222,
                                         135.63000000000002,
                                         106.85166666666667,
                                         107.81777777777778,
                                         108.78388888888887,
                                         109.75,
                                         83.74916666666667,
                                         84.51944444444445,
                                         85.28972222222222,
                                         86.06,
                                         106.83916666666667,
                                         107.80611111111111,
                                         108.77305555555554,
                                         109.74000000000001,
                                         130.71583333333334,
                                         131.87944444444446,
                                         133.04305555555553,
                                         134.20666666666665,
                                         126.995,
                                         128.07666666666665,
                                         129.15833333333333,
                                         130.24,
                                         142.51583333333335,
                                         143.67944444444444,
                                         144.84305555555554,
                                         146.0066666666667,
                                         120.2125,
                                         121.17944444444444,
                                         122.14638888888888,
                                         123.11333333333334,
                                         97.1225,
                                         97.89277777777778,
                                         98.66305555555554,
                                         99.43333333333334,
                                         74.29916666666666,
                                         74.91277777777778,
                                         75.52638888888887,
                                         76.13999999999999,
                                         94.62916666666668,
                                         95.39944444444444,
                                         96.1697222222222,
                                         96.94,
                                         115.58583333333334,
                                         116.51277777777777,
                                         117.4397222222222,
                                         118.36666666666669,
                                         111.81500000000001,
                                         112.67666666666666,
                                         113.53833333333331,
                                         114.4,
                                         124.98583333333333,
                                         125.91277777777778,
                                         126.8397222222222,
                                         127.76666666666668,
                                         105.2825,
                                         106.05277777777778,
                                         106.82305555555554,
                                         107.59333333333333,
                                         84.9525,
                                         85.56611111111111,
                                         86.17972222222222,
                                         86.79333333333332,
                                         119.99361111111111,
                                         120.60722222222222,
                                         121.22083333333332,
                                         121.83444444444444,
                                         151.99027777777775,
                                         152.76055555555556,
                                         153.53083333333336,
                                         154.3011111111111,
                                         184.61361111111108,
                                         185.54055555555558,
                                         186.46750000000003,
                                         187.39444444444442,
                                         175.98166666666668,
                                         176.8433333333334,
                                         177.705,
                                         178.56666666666666,
                                         194.0136111111111,
                                         194.9405555555556,
                                         195.8675,
                                         196.79444444444445,
                                         162.6436111111111,
                                         163.4138888888889,
                                         164.18416666666667,
                                         164.95444444444445,
                                         130.64694444444444,
                                         131.26055555555556,
                                         131.87416666666667,
                                         132.48777777777778,
                                         160.15027777777777,
                                         160.92055555555555,
                                         161.6908333333333,
                                         162.4611111111111,
                                         202.7469444444444,
                                         203.7138888888889,
                                         204.68083333333337,
                                         205.64777777777778,
                                         246.13027777777774,
                                         247.29388888888894,
                                         248.45750000000004,
                                         249.62111111111108,
                                         234.28166666666667,
                                         235.3633333333334,
                                         236.44500000000002,
                                         237.52666666666667,
                                         257.93027777777775,
                                         259.09388888888896,
                                         260.25750000000005,
                                         261.42111111111114,
                                         216.12027777777777,
                                         217.0872222222222,
                                         218.05416666666667,
                                         219.0211111111111,
                                         173.5236111111111,
                                         174.2938888888889,
                                         175.06416666666667,
                                         175.83444444444444,
                                         215.82944444444442,
                                         216.79555555555555,
                                         217.76166666666666,
                                         218.72777777777776,
                                         273.07611111111106,
                                         274.2888888888889,
                                         275.5016666666667,
                                         276.71444444444444,
                                         331.3094444444444,
                                         332.7688888888889,
                                         334.22833333333335,
                                         335.6877777777778,
                                         314.8566666666667,
                                         316.21333333333337,
                                         317.57,
                                         318.9266666666667,
                                         346.1094444444444,
                                         347.5688888888889,
                                         349.02833333333336,
                                         350.48777777777786,
                                         289.8494444444445,
                                         291.0622222222222,
                                         292.275,
                                         293.4877777777778,
                                         232.60277777777776,
                                         233.5688888888889,
                                         234.535,
                                         235.5011111111111,
                                         252.38499999999996,
                                         253.35111111111112,
                                         254.31722222222226,
                                         255.28333333333333,
                                         318.9649999999999,
                                         320.17777777777775,
                                         321.3905555555556,
                                         322.6033333333333,
                                         386.5316666666666,
                                         387.9911111111111,
                                         389.4505555555556,
                                         390.91,
                                         366.19,
                                         367.5466666666666,
                                         368.9033333333333,
                                         370.26000000000005,
                                         401.33166666666665,
                                         402.79111111111104,
                                         404.25055555555554,
                                         405.71000000000004,
                                         335.73833333333334,
                                         336.95111111111106,
                                         338.16388888888883,
                                         339.37666666666667,
                                         269.1583333333333,
                                         270.1244444444444,
                                         271.09055555555557,
                                         272.0566666666666,
                                         213.15583333333333,
                                         213.9261111111111,
                                         214.69638888888886,
                                         215.46666666666667,
                                         269.2858333333333,
                                         270.25277777777774,
                                         271.21972222222223,
                                         272.18666666666667,
                                         326.20249999999993,
                                         327.3661111111111,
                                         328.52972222222223,
                                         329.6933333333333,
                                         308.71500000000003,
                                         309.7966666666666,
                                         310.87833333333333,
                                         311.96000000000004,
                                         338.0025,
                                         339.1661111111111,
                                         340.3297222222222,
                                         341.49333333333334,
                                         282.6591666666667,
                                         283.6261111111111,
                                         284.59305555555557,
                                         285.56,
                                         226.52916666666664,
                                         227.29944444444445,
                                         228.06972222222225,
                                         228.83999999999997,
                                         177.38583333333332,
                                         177.99944444444444,
                                         178.61305555555555,
                                         179.22666666666666,
                                         224.03583333333336,
                                         224.80611111111108,
                                         225.57638888888889,
                                         226.34666666666666,
                                         271.3125,
                                         272.2394444444444,
                                         273.16638888888883,
                                         274.09333333333336,
                                         256.575,
                                         257.43666666666667,
                                         258.29833333333335,
                                         259.16,
                                         280.7125,
                                         281.6394444444444,
                                         282.5663888888889,
                                         283.49333333333334,
                                         234.68916666666664,
                                         235.45944444444447,
                                         236.22972222222225,
                                         237.,
                                         188.03916666666666,
                                         188.6527777777778,
                                         189.26638888888888,
                                         189.88,
                                         223.08027777777775,
                                         223.69388888888886,
                                         224.3075,
                                         224.92111111111112,
                                         281.39694444444444,
                                         282.1672222222222,
                                         282.9375,
                                         283.7077777777778,
                                         340.3402777777778,
                                         341.26722222222213,
                                         342.1941666666666,
                                         343.12111111111113,
                                         320.7416666666667,
                                         321.6033333333333,
                                         322.465,
                                         323.3266666666667,
                                         349.74027777777775,
                                         350.66722222222216,
                                         351.59416666666664,
                                         352.5211111111111,
                                         292.05027777777775,
                                         292.8205555555556,
                                         293.59083333333336,
                                         294.3611111111111,
                                         233.73361111111112,
                                         234.34722222222223,
                                         234.9608333333333,
                                         235.57444444444445,
                                         289.55694444444447,
                                         290.3272222222222,
                                         291.0975,
                                         291.86777777777775,
                                         365.1936111111111,
                                         366.16055555555556,
                                         367.1275,
                                         368.0944444444444,
                                         441.6169444444445,
                                         442.78055555555545,
                                         443.9441666666666,
                                         445.1077777777778,
                                         416.0016666666667,
                                         417.0833333333333,
                                         418.16499999999996,
                                         419.24666666666667,
                                         453.4169444444445,
                                         454.5805555555555,
                                         455.7441666666666,
                                         456.9077777777778,
                                         378.56694444444446,
                                         379.53388888888895,
                                         380.50083333333333,
                                         381.46777777777777,
                                         302.9302777777778,
                                         303.7005555555556,
                                         304.4708333333333,
                                         305.24111111111114,
                                         378.1361111111112,
                                         379.10222222222217,
                                         380.0683333333333,
                                         381.03444444444443,
                                         476.82277777777784,
                                         478.03555555555556,
                                         479.2483333333333,
                                         480.46111111111105,
                                         576.4961111111112,
                                         577.9555555555554,
                                         579.415,
                                         580.8744444444445,
                                         542.7766666666668,
                                         544.1333333333333,
                                         545.4899999999999,
                                         546.8466666666667,
                                         591.2961111111111,
                                         592.7555555555555,
                                         594.2149999999999,
                                         595.6744444444445,
                                         493.59611111111116,
                                         494.808888888889,
                                         496.02166666666665,
                                         497.2344444444444,
                                         394.9094444444445,
                                         395.8755555555556,
                                         396.84166666666664,
                                         397.8077777777778,
                                         414.6916666666666,
                                         415.65777777777777,
                                         416.6238888888888,
                                         417.5899999999999,
                                         522.7116666666666,
                                         523.9244444444445,
                                         525.1372222222222,
                                         526.3499999999999,
                                         631.7183333333335,
                                         633.1777777777777,
                                         634.6372222222222,
                                         636.0966666666666,
                                         594.11,
                                         595.4666666666667,
                                         596.8233333333334,
                                         598.18,
                                         646.5183333333333,
                                         647.9777777777776,
                                         649.4372222222223,
                                         650.8966666666666,
                                         539.4850000000001,
                                         540.6977777777779,
                                         541.9105555555556,
                                         543.1233333333333,
                                         431.4650000000001,
                                         432.43111111111114,
                                         433.39722222222224,
                                         434.3633333333334,
                                         342.56249999999994,
                                         343.3327777777778,
                                         344.10305555555556,
                                         344.87333333333333,
                                         431.73249999999996,
                                         432.69944444444445,
                                         433.66638888888895,
                                         434.63333333333327,
                                         521.6891666666666,
                                         522.8527777777778,
                                         524.016388888889,
                                         525.18,
                                         490.435,
                                         491.5166666666667,
                                         492.5983333333334,
                                         493.68,
                                         533.4891666666667,
                                         534.6527777777778,
                                         535.8163888888889,
                                         536.98,
                                         445.1058333333334,
                                         446.07277777777784,
                                         447.0397222222223,
                                         448.00666666666666,
                                         355.93583333333333,
                                         356.7061111111111,
                                         357.4763888888889,
                                         358.24666666666667,
                                         280.47249999999997,
                                         281.0861111111111,
                                         281.69972222222225,
                                         282.3133333333333,
                                         353.4425,
                                         354.2127777777778,
                                         354.98305555555555,
                                         355.7533333333333,
                                         427.0391666666667,
                                         427.9661111111111,
                                         428.8930555555555,
                                         429.82000000000005,
                                         401.33500000000004,
                                         402.19666666666666,
                                         403.05833333333334,
                                         403.92,
                                         436.4391666666667,
                                         437.36611111111114,
                                         438.2930555555555,
                                         439.2200000000001,
                                         364.09583333333336,
                                         364.8661111111111,
                                         365.63638888888886,
                                         366.4066666666667,
                                         291.12583333333333,
                                         291.7394444444444,
                                         292.35305555555556,
                                         292.9666666666667};
  const std::array<int, 4> in_shape = {{3, 6, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         1.2000000000000002,
                                         1.28,
                                         1.3599999999999999,
                                         1.44,
                                         2.04,
                                         2.16,
                                         2.28,
                                         2.4,
                                         2.04,
                                         2.16,
                                         2.28,
                                         2.4,
                                         2.04,
                                         2.16,
                                         2.28,
                                         2.4,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         0.92,
                                         0.96,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.7199999999999998,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.72,
                                         5.28,
                                         5.44,
                                         5.6000000000000005,
                                         5.76,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.3999999999999995,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.36,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.72,
                                         5.28,
                                         5.44,
                                         5.6000000000000005,
                                         5.76,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.3999999999999995,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.36,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.72,
                                         5.28,
                                         5.44,
                                         5.6000000000000005,
                                         5.76,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.3999999999999995,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.36,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.72,
                                         5.28,
                                         5.44,
                                         5.6000000000000005,
                                         5.76,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.3999999999999995,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.36,
                                         1.48,
                                         1.52,
                                         1.56,
                                         1.6,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         2.2800000000000002,
                                         2.32,
                                         2.36,
                                         2.4,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         9.12,
                                         9.280000000000001,
                                         9.44,
                                         9.600000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         9.76,
                                         9.920000000000002,
                                         10.08,
                                         10.240000000000002,
                                         5.040000000000001,
                                         5.12,
                                         5.199999999999999,
                                         5.279999999999999,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         9.12,
                                         9.280000000000001,
                                         9.44,
                                         9.600000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         9.76,
                                         9.920000000000002,
                                         10.08,
                                         10.240000000000002,
                                         5.040000000000001,
                                         5.12,
                                         5.199999999999999,
                                         5.279999999999999,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         9.12,
                                         9.280000000000001,
                                         9.44,
                                         9.600000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         9.76,
                                         9.920000000000002,
                                         10.08,
                                         10.240000000000002,
                                         5.040000000000001,
                                         5.12,
                                         5.199999999999999,
                                         5.279999999999999,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         9.12,
                                         9.280000000000001,
                                         9.44,
                                         9.600000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         9.76,
                                         9.920000000000002,
                                         10.08,
                                         10.240000000000002,
                                         5.040000000000001,
                                         5.12,
                                         5.199999999999999,
                                         5.279999999999999,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56,
                                         5.04,
                                         5.12,
                                         5.2,
                                         5.28,
                                         7.800000000000001,
                                         7.92,
                                         8.04,
                                         8.16,
                                         7.800000000000001,
                                         7.92,
                                         8.04,
                                         8.16,
                                         7.800000000000001,
                                         7.92,
                                         8.04,
                                         8.16,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         2.7600000000000002,
                                         2.8000000000000003,
                                         2.84,
                                         2.88};
  const std::array<int, 4> in_shape = {{3, 6, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {5.196111111111111,  6.862777777777778,
                                         8.686111111111112,  8.671666666666667,
                                         9.650833333333333,  11.963055555555556,
                                         10.296388888888888, 8.473055555555556,
                                         9.242777777777778,  12.029444444444444,
                                         15.012777777777778, 14.531666666666666,
                                         15.760833333333334, 19.12638888888889,
                                         16.33972222222222,  13.356388888888889,
                                         15.867777777777778, 20.454444444444444,
                                         25.28777777777778,  23.956666666666667,
                                         25.498333333333335, 30.447222222222223,
                                         25.860555555555553, 21.02722222222222,
                                         26.312222222222225, 33.565555555555555,
                                         41.065555555555555, 37.95666666666666,
                                         39.49833333333333,  46.224999999999994,
                                         38.971666666666664, 31.471666666666668,
                                         24.38722222222222,  31.040555555555553,
                                         37.89055555555556,  34.83166666666666,
                                         36.06083333333333,  42.00416666666666,
                                         35.350833333333334, 28.500833333333333,
                                         21.59388888888889,  27.447222222222226,
                                         33.45722222222223,  30.651666666666667,
                                         31.630833333333335, 36.73416666666667,
                                         30.88083333333333,  24.870833333333334,
                                         34.64944444444445,  43.83611111111111,
                                         53.179444444444435, 48.15166666666666,
                                         49.13083333333333,  56.45638888888888,
                                         47.269722222222214, 37.92638888888889,
                                         46.21611111111112,  58.44277777777778,
                                         70.86611111111111,  64.09166666666665,
                                         65.32083333333333,  74.97972222222221,
                                         62.75305555555555,  50.32972222222222,
                                         62.24111111111112,  78.66777777777779,
                                         95.34111111111112,  86.11666666666666,
                                         87.65833333333333,  100.50055555555554,
                                         84.07388888888887,  67.40055555555556,
                                         72.68555555555554,  91.77888888888887,
                                         111.11888888888889, 100.11666666666667,
                                         101.65833333333332, 116.27833333333334,
                                         97.18500000000002,  77.84500000000001,
                                         61.36055555555555,  77.45388888888888,
                                         93.74388888888889,  84.39166666666668,
                                         85.62083333333335,  97.85750000000002,
                                         81.76416666666667,  65.47416666666666,
                                         51.04722222222222,  64.42055555555555,
                                         77.95055555555557,  70.13166666666667,
                                         71.11083333333333,  81.2275,
                                         67.85416666666667,  54.32416666666666,
                                         64.10277777777777,  80.80944444444444,
                                         97.67277777777778,  87.63166666666666,
                                         88.61083333333333,  100.94972222222223,
                                         84.24305555555556,  67.37972222222223,
                                         83.18944444444443,  104.85611111111109,
                                         126.71944444444443, 113.65166666666666,
                                         114.88083333333333, 130.83305555555557,
                                         109.16638888888889, 87.30305555555556,
                                         108.61444444444443, 136.8811111111111,
                                         165.39444444444445, 148.27666666666664,
                                         149.81833333333333, 170.5538888888889,
                                         142.28722222222225, 113.77388888888889,
                                         119.05888888888889, 149.99222222222224,
                                         181.17222222222222, 162.27666666666667,
                                         163.81833333333333, 186.33166666666668,
                                         155.39833333333334, 124.21833333333333,
                                         98.3338888888889,   123.86722222222221,
                                         149.59722222222223, 133.95166666666665,
                                         135.18083333333334, 153.71083333333334,
                                         128.1775,           102.4475,
                                         80.50055555555555,  101.39388888888888,
                                         122.44388888888889, 109.61166666666666,
                                         110.59083333333334, 125.72083333333335,
                                         104.82750000000001, 83.7775};
  const std::array<int, 4> in_shape = {{3, 6, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.4,
                                         0.4,
                                         0.36,
                                         0.28,
                                         0.16,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.2,
                                         0.44,
                                         0.72,
                                         1.04,
                                         1.04,
                                         0.8400000000000001,
                                         0.6000000000000001,
                                         0.32,
                                         0.36,
                                         0.76,
                                         1.2,
                                         1.68,
                                         1.68,
                                         1.32,
                                         0.9199999999999999,
                                         0.48,
                                         0.88,
                                         1.84,
                                         2.8800000000000003,
                                         4.,
                                         4.,
                                         3.12,
                                         2.16,
                                         1.12,
                                         0.88,
                                         1.84,
                                         2.8800000000000003,
                                         4.,
                                         4.,
                                         3.12,
                                         2.16,
                                         1.12,
                                         0.88,
                                         1.84,
                                         2.8800000000000003,
                                         4.,
                                         4.,
                                         3.12,
                                         2.16,
                                         1.12,
                                         0.88,
                                         1.84,
                                         2.8800000000000003,
                                         4.,
                                         4.,
                                         3.12,
                                         2.16,
                                         1.12,
                                         0.52,
                                         1.08,
                                         1.6800000000000002,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         1.8000000000000003,
                                         1.24,
                                         0.64,
                                         0.68,
                                         1.4,
                                         2.16,
                                         2.96,
                                         2.96,
                                         2.2800000000000002,
                                         1.56,
                                         0.8,
                                         1.52,
                                         3.1199999999999997,
                                         4.8,
                                         6.56,
                                         6.56,
                                         5.04,
                                         3.44,
                                         1.76,
                                         1.52,
                                         3.1199999999999997,
                                         4.8,
                                         6.56,
                                         6.56,
                                         5.04,
                                         3.44,
                                         1.76,
                                         1.52,
                                         3.1199999999999997,
                                         4.8,
                                         6.56,
                                         6.56,
                                         5.04,
                                         3.44,
                                         1.76,
                                         1.52,
                                         3.1199999999999997,
                                         4.8,
                                         6.56,
                                         6.56,
                                         5.04,
                                         3.44,
                                         1.76,
                                         0.84,
                                         1.72,
                                         2.64,
                                         3.6,
                                         3.6,
                                         2.76,
                                         1.88,
                                         0.96};
  const std::array<int, 4> in_shape = {{3, 6, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {9.778611111111111,
                                         10.392222222222221,
                                         12.955277777777779,
                                         13.725555555555555,
                                         16.44527777777778,
                                         17.372222222222224,
                                         16.520833333333336,
                                         17.343333333333334,
                                         18.479166666666668,
                                         19.301666666666666,
                                         22.999166666666667,
                                         23.926111111111112,
                                         19.822499999999998,
                                         20.592777777777776,
                                         16.3325,
                                         16.94611111111111,
                                         17.71527777777778,
                                         18.485555555555557,
                                         23.091944444444447,
                                         24.058888888888887,
                                         28.861944444444447,
                                         30.025555555555556,
                                         28.030833333333337,
                                         29.063333333333333,
                                         30.48916666666667,
                                         31.52166666666667,
                                         37.08916666666667,
                                         38.25277777777778,
                                         31.7125,
                                         32.67944444444444,
                                         25.9425,
                                         26.712777777777777,
                                         30.769444444444442,
                                         31.735555555555557,
                                         39.696111111111115,
                                         40.90888888888889,
                                         49.11611111111111,
                                         50.57555555555556,
                                         46.61833333333333,
                                         47.913333333333334,
                                         49.70166666666667,
                                         50.99666666666667,
                                         59.435,
                                         60.894444444444446,
                                         50.50833333333333,
                                         51.72111111111111,
                                         41.08833333333333,
                                         42.05444444444444,
                                         51.65833333333333,
                                         52.62444444444445,
                                         65.91833333333334,
                                         67.13111111111111,
                                         80.67166666666667,
                                         82.13111111111111,
                                         74.61833333333333,
                                         75.91333333333333,
                                         77.70166666666665,
                                         78.99666666666666,
                                         90.99055555555555,
                                         92.44999999999999,
                                         76.73055555555555,
                                         77.94333333333333,
                                         61.977222222222224,
                                         62.943333333333335,
                                         48.00416666666666,
                                         48.77444444444444,
                                         61.11416666666666,
                                         62.081111111111106,
                                         74.6175,
                                         75.78111111111112,
                                         68.63083333333333,
                                         69.66333333333333,
                                         71.08916666666666,
                                         72.12166666666666,
                                         82.84472222222222,
                                         84.00833333333333,
                                         69.73472222222222,
                                         70.70166666666667,
                                         56.23138888888889,
                                         57.001666666666665,
                                         42.57416666666666,
                                         43.18777777777778,
                                         54.12416666666666,
                                         54.89444444444445,
                                         65.9875,
                                         66.91444444444446,
                                         60.48083333333332,
                                         61.303333333333335,
                                         62.439166666666665,
                                         63.26166666666667,
                                         72.54138888888889,
                                         73.46833333333333,
                                         60.99138888888889,
                                         61.76166666666666,
                                         49.128055555555555,
                                         49.74166666666667,
                                         68.68527777777777,
                                         69.2988888888889,
                                         86.90194444444444,
                                         87.67222222222222,
                                         105.43194444444445,
                                         106.35888888888887,
                                         95.48083333333336,
                                         96.30333333333331,
                                         97.43916666666667,
                                         98.26166666666666,
                                         111.98583333333333,
                                         112.91277777777776,
                                         93.76916666666666,
                                         94.53944444444443,
                                         75.23916666666666,
                                         75.85277777777777,
                                         91.66194444444443,
                                         92.43222222222224,
                                         115.9186111111111,
                                         116.88555555555556,
                                         140.56861111111112,
                                         141.73222222222222,
                                         127.15083333333337,
                                         128.1833333333333,
                                         129.60916666666668,
                                         130.64166666666665,
                                         148.79583333333332,
                                         149.95944444444442,
                                         124.53916666666666,
                                         125.5061111111111,
                                         99.88916666666665,
                                         100.65944444444445,
                                         123.5161111111111,
                                         124.48222222222223,
                                         156.12277777777777,
                                         157.33555555555557,
                                         189.22277777777776,
                                         190.68222222222224,
                                         170.93833333333336,
                                         172.23333333333332,
                                         174.02166666666668,
                                         175.31666666666666,
                                         199.54166666666666,
                                         201.00111111111107,
                                         166.935,
                                         168.14777777777775,
                                         133.83499999999998,
                                         134.8011111111111,
                                         144.405,
                                         145.37111111111108,
                                         182.34499999999997,
                                         183.55777777777774,
                                         220.7783333333333,
                                         222.23777777777778,
                                         198.93833333333333,
                                         200.23333333333335,
                                         202.02166666666665,
                                         203.31666666666663,
                                         231.09722222222223,
                                         232.55666666666667,
                                         193.15722222222223,
                                         194.37000000000003,
                                         154.7238888888889,
                                         155.69000000000003,
                                         121.95083333333334,
                                         122.7211111111111,
                                         153.9408333333333,
                                         154.90777777777777,
                                         186.32416666666666,
                                         187.48777777777778,
                                         167.75083333333333,
                                         168.78333333333336,
                                         170.20916666666668,
                                         171.2416666666667,
                                         194.55138888888888,
                                         195.71500000000003,
                                         162.56138888888887,
                                         163.52833333333334,
                                         130.17805555555555,
                                         130.94833333333332,
                                         101.48083333333334,
                                         102.09444444444443,
                                         128.07083333333333,
                                         128.8411111111111,
                                         154.97416666666666,
                                         155.90111111111113,
                                         139.44083333333333,
                                         140.26333333333335,
                                         141.39916666666667,
                                         142.22166666666666,
                                         161.52805555555557,
                                         162.455,
                                         134.93805555555556,
                                         135.70833333333334,
                                         108.03472222222223,
                                         108.64833333333333,
                                         127.59194444444444,
                                         128.20555555555555,
                                         160.8486111111111,
                                         161.61888888888888,
                                         194.4186111111111,
                                         195.34555555555556,
                                         174.44083333333336,
                                         175.26333333333332,
                                         176.39916666666667,
                                         177.22166666666666,
                                         200.9725,
                                         201.89944444444447,
                                         167.71583333333334,
                                         168.48611111111111,
                                         134.14583333333334,
                                         134.75944444444445,
                                         165.60861111111112,
                                         166.37888888888887,
                                         208.74527777777777,
                                         209.71222222222218,
                                         252.27527777777777,
                                         253.43888888888887,
                                         226.27083333333337,
                                         227.3033333333333,
                                         228.72916666666669,
                                         229.76166666666666,
                                         260.5025,
                                         261.66611111111115,
                                         217.36583333333334,
                                         218.33277777777778,
                                         173.83583333333334,
                                         174.60611111111112,
                                         216.26277777777779,
                                         217.22888888888886,
                                         272.5494444444444,
                                         273.7622222222222,
                                         329.32944444444445,
                                         330.7888888888889,
                                         295.2583333333334,
                                         296.5533333333333,
                                         298.3416666666667,
                                         299.63666666666666,
                                         339.6483333333333,
                                         341.1077777777778,
                                         283.3616666666666,
                                         284.5744444444445,
                                         226.58166666666668,
                                         227.54777777777778,
                                         237.15166666666667,
                                         238.11777777777777,
                                         298.77166666666665,
                                         299.9844444444445,
                                         360.88500000000005,
                                         362.34444444444443,
                                         323.2583333333334,
                                         324.55333333333334,
                                         326.3416666666667,
                                         327.63666666666666,
                                         371.20388888888897,
                                         372.66333333333336,
                                         309.58388888888896,
                                         310.7966666666667,
                                         247.4705555555556,
                                         248.43666666666667,
                                         195.89749999999998,
                                         196.6677777777778,
                                         246.7675,
                                         247.73444444444442,
                                         298.03083333333336,
                                         299.19444444444446,
                                         266.87083333333334,
                                         267.9033333333333,
                                         269.32916666666665,
                                         270.3616666666667,
                                         306.25805555555553,
                                         307.4216666666667,
                                         255.38805555555555,
                                         256.355,
                                         204.12472222222223,
                                         204.895,
                                         160.3875,
                                         161.0011111111111,
                                         202.01749999999998,
                                         202.78777777777776,
                                         243.96083333333337,
                                         244.88777777777779,
                                         218.40083333333337,
                                         219.22333333333333,
                                         220.35916666666668,
                                         221.18166666666667,
                                         250.51472222222222,
                                         251.4416666666667,
                                         208.88472222222222,
                                         209.65500000000003,
                                         166.94138888888887,
                                         167.555};
  const std::array<int, 4> in_shape = {{3, 6, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.6000000000000001,
                                         0.72,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         0.36,
                                         0.4,
                                         0.8,
                                         0.88,
                                         1.32,
                                         1.44,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.56,
                                         1.6800000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         0.6,
                                         0.64,
                                         0.68,
                                         0.72,
                                         1.44,
                                         1.52,
                                         2.28,
                                         2.4,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96,
                                         1.6800000000000002,
                                         1.76,
                                         3.52,
                                         3.68,
                                         5.52,
                                         5.760000000000001,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         6.,
                                         6.24,
                                         4.16,
                                         4.32,
                                         2.16,
                                         2.24,
                                         1.6800000000000002,
                                         1.76,
                                         3.52,
                                         3.68,
                                         5.52,
                                         5.760000000000001,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         6.,
                                         6.24,
                                         4.16,
                                         4.32,
                                         2.16,
                                         2.24,
                                         1.6800000000000002,
                                         1.76,
                                         3.52,
                                         3.68,
                                         5.52,
                                         5.760000000000001,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         6.,
                                         6.24,
                                         4.16,
                                         4.32,
                                         2.16,
                                         2.24,
                                         1.6800000000000002,
                                         1.76,
                                         3.52,
                                         3.68,
                                         5.52,
                                         5.760000000000001,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         6.,
                                         6.24,
                                         4.16,
                                         4.32,
                                         2.16,
                                         2.24,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         3.24,
                                         3.3600000000000003,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         2.4,
                                         2.48,
                                         1.24,
                                         1.28,
                                         1.32,
                                         1.36,
                                         2.72,
                                         2.8,
                                         4.2,
                                         4.32,
                                         5.76,
                                         5.92,
                                         5.76,
                                         5.92,
                                         4.4399999999999995,
                                         4.5600000000000005,
                                         3.04,
                                         3.12,
                                         1.56,
                                         1.6,
                                         2.96,
                                         3.04,
                                         6.08,
                                         6.239999999999999,
                                         9.36,
                                         9.6,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         9.84,
                                         10.08,
                                         6.72,
                                         6.88,
                                         3.4400000000000004,
                                         3.52,
                                         2.96,
                                         3.04,
                                         6.08,
                                         6.239999999999999,
                                         9.36,
                                         9.6,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         9.84,
                                         10.08,
                                         6.72,
                                         6.88,
                                         3.4400000000000004,
                                         3.52,
                                         2.96,
                                         3.04,
                                         6.08,
                                         6.239999999999999,
                                         9.36,
                                         9.6,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         9.84,
                                         10.08,
                                         6.72,
                                         6.88,
                                         3.4400000000000004,
                                         3.52,
                                         2.96,
                                         3.04,
                                         6.08,
                                         6.239999999999999,
                                         9.36,
                                         9.6,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         9.84,
                                         10.08,
                                         6.72,
                                         6.88,
                                         3.4400000000000004,
                                         3.52,
                                         1.6400000000000001,
                                         1.68,
                                         3.3600000000000003,
                                         3.44,
                                         5.16,
                                         5.28,
                                         7.04,
                                         7.2,
                                         7.04,
                                         7.2,
                                         5.4,
                                         5.52,
                                         3.68,
                                         3.76,
                                         1.8800000000000001,
                                         1.92};
  const std::array<int, 4> in_shape = {{3, 6, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         60.57277777777778,
                                         61.538888888888884,
                                         62.505,
                                         63.471111111111114,
                                         78.17944444444444,
                                         79.39222222222223,
                                         80.605,
                                         81.81777777777778,
                                         96.77277777777779,
                                         98.23222222222222,
                                         99.69166666666668,
                                         101.15111111111112,
                                         91.94166666666666,
                                         93.23666666666666,
                                         94.53166666666667,
                                         95.82666666666667,
                                         98.10833333333333,
                                         99.40333333333334,
                                         100.69833333333332,
                                         101.99333333333334,
                                         117.41055555555556,
                                         118.87,
                                         120.32944444444445,
                                         121.78888888888889,
                                         99.8038888888889,
                                         101.01666666666667,
                                         102.22944444444444,
                                         103.44222222222221,
                                         81.21055555555556,
                                         82.17666666666666,
                                         83.14277777777778,
                                         84.10888888888888,
                                         102.35055555555556,
                                         103.31666666666666,
                                         104.2827777777778,
                                         105.2488888888889,
                                         130.62388888888887,
                                         131.83666666666667,
                                         133.04944444444445,
                                         134.26222222222222,
                                         159.8838888888889,
                                         161.34333333333333,
                                         162.80277777777778,
                                         164.26222222222222,
                                         147.94166666666666,
                                         149.23666666666665,
                                         150.53166666666667,
                                         151.82666666666665,
                                         154.10833333333332,
                                         155.4033333333333,
                                         156.69833333333332,
                                         157.9933333333333,
                                         180.52166666666665,
                                         181.9811111111111,
                                         183.44055555555556,
                                         184.89999999999998,
                                         152.2483333333333,
                                         153.4611111111111,
                                         154.6738888888889,
                                         155.88666666666666,
                                         122.98833333333334,
                                         123.95444444444445,
                                         124.92055555555555,
                                         125.88666666666667,
                                         95.23805555555556,
                                         96.00833333333333,
                                         96.77861111111112,
                                         97.54888888888888,
                                         121.26138888888889,
                                         122.22833333333332,
                                         123.1952777777778,
                                         124.16222222222221,
                                         148.0713888888889,
                                         149.235,
                                         150.39861111111114,
                                         151.56222222222223,
                                         136.22916666666666,
                                         137.26166666666666,
                                         138.29416666666668,
                                         139.32666666666665,
                                         141.14583333333331,
                                         142.1783333333333,
                                         143.21083333333337,
                                         144.2433333333333,
                                         164.52583333333334,
                                         165.68944444444443,
                                         166.85305555555558,
                                         168.01666666666665,
                                         138.5025,
                                         139.46944444444443,
                                         140.4363888888889,
                                         141.40333333333334,
                                         111.69250000000001,
                                         112.46277777777777,
                                         113.23305555555555,
                                         114.00333333333333,
                                         84.53472222222223,
                                         85.14833333333333,
                                         85.76194444444445,
                                         86.37555555555556,
                                         107.47805555555556,
                                         108.24833333333332,
                                         109.01861111111113,
                                         109.7888888888889,
                                         131.04805555555555,
                                         131.975,
                                         132.90194444444447,
                                         133.8288888888889,
                                         120.13916666666665,
                                         120.96166666666664,
                                         121.78416666666669,
                                         122.60666666666667,
                                         124.05583333333334,
                                         124.87833333333333,
                                         125.70083333333335,
                                         126.52333333333334,
                                         144.15583333333333,
                                         145.08277777777778,
                                         146.00972222222222,
                                         146.93666666666667,
                                         121.2125,
                                         121.98277777777778,
                                         122.75305555555556,
                                         123.52333333333333,
                                         97.6425,
                                         98.25611111111111,
                                         98.86972222222221,
                                         99.48333333333333,
                                         136.75694444444446,
                                         137.37055555555554,
                                         137.98416666666665,
                                         138.5977777777778,
                                         173.0336111111111,
                                         173.80388888888888,
                                         174.57416666666668,
                                         175.34444444444443,
                                         209.93694444444444,
                                         210.8638888888889,
                                         211.79083333333335,
                                         212.71777777777774,
                                         190.13916666666668,
                                         190.96166666666673,
                                         191.7841666666667,
                                         192.60666666666663,
                                         194.0558333333333,
                                         194.87833333333333,
                                         195.70083333333335,
                                         196.5233333333333,
                                         223.04472222222225,
                                         223.97166666666666,
                                         224.8986111111111,
                                         225.82555555555552,
                                         186.76805555555558,
                                         187.53833333333333,
                                         188.3086111111111,
                                         189.07888888888886,
                                         149.8647222222222,
                                         150.47833333333332,
                                         151.09194444444444,
                                         151.70555555555555,
                                         182.5536111111111,
                                         183.32388888888886,
                                         184.09416666666667,
                                         184.86444444444447,
                                         230.87027777777774,
                                         231.8372222222222,
                                         232.8041666666667,
                                         233.7711111111111,
                                         279.9736111111111,
                                         281.13722222222225,
                                         282.30083333333334,
                                         283.46444444444444,
                                         253.26916666666665,
                                         254.30166666666673,
                                         255.3341666666667,
                                         256.3666666666666,
                                         258.1858333333333,
                                         259.21833333333336,
                                         260.2508333333334,
                                         261.2833333333333,
                                         296.42805555555555,
                                         297.59166666666664,
                                         298.7552777777778,
                                         299.91888888888883,
                                         248.1113888888889,
                                         249.07833333333332,
                                         250.04527777777776,
                                         251.0122222222222,
                                         199.00805555555556,
                                         199.7783333333333,
                                         200.5486111111111,
                                         201.3188888888889,
                                         246.0661111111111,
                                         247.0322222222222,
                                         247.99833333333333,
                                         248.96444444444447,
                                         311.0327777777777,
                                         312.24555555555554,
                                         313.45833333333337,
                                         314.67111111111114,
                                         376.9861111111111,
                                         378.44555555555553,
                                         379.90500000000003,
                                         381.3644444444445,
                                         340.58166666666665,
                                         341.8766666666667,
                                         343.1716666666667,
                                         344.46666666666664,
                                         346.7483333333333,
                                         348.04333333333335,
                                         349.33833333333337,
                                         350.6333333333333,
                                         397.62388888888887,
                                         399.0833333333333,
                                         400.54277777777776,
                                         402.00222222222214,
                                         332.65722222222223,
                                         333.87,
                                         335.0827777777777,
                                         336.2955555555555,
                                         266.7038888888889,
                                         267.66999999999996,
                                         268.63611111111106,
                                         269.6022222222222,
                                         287.8438888888889,
                                         288.81,
                                         289.7761111111111,
                                         290.74222222222215,
                                         363.47722222222217,
                                         364.68999999999994,
                                         365.90277777777777,
                                         367.1155555555555,
                                         440.0972222222222,
                                         441.5566666666666,
                                         443.0161111111111,
                                         444.47555555555556,
                                         396.58166666666665,
                                         397.87666666666667,
                                         399.1716666666667,
                                         400.4666666666667,
                                         402.7483333333334,
                                         404.0433333333333,
                                         405.3383333333333,
                                         406.63333333333327,
                                         460.73499999999996,
                                         462.19444444444446,
                                         463.65388888888884,
                                         465.11333333333334,
                                         385.1016666666667,
                                         386.31444444444446,
                                         387.5272222222222,
                                         388.74000000000007,
                                         308.4816666666667,
                                         309.4477777777778,
                                         310.4138888888889,
                                         311.38000000000005,
                                         243.13138888888886,
                                         243.90166666666667,
                                         244.67194444444445,
                                         245.4422222222222,
                                         306.91472222222217,
                                         307.8816666666666,
                                         308.8486111111111,
                                         309.81555555555553,
                                         371.4847222222222,
                                         372.6483333333333,
                                         373.81194444444446,
                                         374.97555555555556,
                                         334.4691666666667,
                                         335.50166666666667,
                                         336.53416666666664,
                                         337.5666666666667,
                                         339.3858333333334,
                                         340.41833333333335,
                                         341.4508333333333,
                                         342.4833333333334,
                                         387.9391666666667,
                                         389.10277777777776,
                                         390.26638888888886,
                                         391.43000000000006,
                                         324.15583333333336,
                                         325.12277777777774,
                                         326.0897222222222,
                                         327.0566666666667,
                                         259.5858333333333,
                                         260.3561111111111,
                                         261.1263888888889,
                                         261.89666666666665,
                                         202.34805555555556,
                                         202.96166666666667,
                                         203.57527777777776,
                                         204.18888888888887,
                                         255.3713888888889,
                                         256.14166666666665,
                                         256.91194444444443,
                                         257.6822222222222,
                                         309.0213888888889,
                                         309.9483333333333,
                                         310.8752777777778,
                                         311.80222222222227,
                                         278.05916666666667,
                                         278.88166666666666,
                                         279.70416666666665,
                                         280.5266666666667,
                                         281.97583333333336,
                                         282.79833333333335,
                                         283.6208333333333,
                                         284.4433333333333,
                                         322.12916666666666,
                                         323.05611111111114,
                                         323.98305555555555,
                                         324.91,
                                         269.1058333333333,
                                         269.87611111111113,
                                         270.6463888888889,
                                         271.4166666666667,
                                         215.45583333333332,
                                         216.06944444444446,
                                         216.68305555555557,
                                         217.29666666666665,
                                         254.5702777777778,
                                         255.18388888888887,
                                         255.79749999999996,
                                         256.4111111111111,
                                         320.9269444444445,
                                         321.6972222222222,
                                         322.4675,
                                         323.23777777777775,
                                         387.9102777777777,
                                         388.8372222222222,
                                         389.76416666666665,
                                         390.6911111111111,
                                         348.0591666666666,
                                         348.8816666666667,
                                         349.70416666666665,
                                         350.52666666666664,
                                         351.97583333333336,
                                         352.79833333333335,
                                         353.62083333333334,
                                         354.4433333333333,
                                         401.0180555555555,
                                         401.945,
                                         402.8719444444444,
                                         403.79888888888894,
                                         334.6613888888889,
                                         335.4316666666667,
                                         336.20194444444445,
                                         336.97222222222223,
                                         267.67805555555555,
                                         268.2916666666667,
                                         268.90527777777777,
                                         269.5188888888889,
                                         330.44694444444445,
                                         331.21722222222223,
                                         331.98749999999995,
                                         332.75777777777773,
                                         416.5236111111111,
                                         417.49055555555555,
                                         418.4575,
                                         419.42444444444436,
                                         503.38694444444434,
                                         504.55055555555555,
                                         505.71416666666664,
                                         506.87777777777774,
                                         451.50916666666666,
                                         452.54166666666674,
                                         453.57416666666666,
                                         454.6066666666666,
                                         456.4258333333334,
                                         457.45833333333337,
                                         458.49083333333334,
                                         459.5233333333333,
                                         519.8413888888889,
                                         521.005,
                                         522.1686111111111,
                                         523.3322222222223,
                                         433.76472222222225,
                                         434.7316666666667,
                                         435.6986111111111,
                                         436.66555555555556,
                                         346.9013888888889,
                                         347.6716666666667,
                                         348.44194444444446,
                                         349.21222222222224,
                                         331.29277777777776,
                                         332.2588888888889,
                                         333.22499999999997,
                                         334.19111111111107,
                                         418.0194444444444,
                                         419.2322222222222,
                                         420.445,
                                         421.6577777777777,
                                         505.73277777777764,
                                         507.1922222222222,
                                         508.65166666666664,
                                         510.1111111111111,
                                         454.82166666666666,
                                         456.11666666666673,
                                         457.41166666666663,
                                         458.70666666666665,
                                         460.9883333333334,
                                         462.28333333333336,
                                         463.5783333333333,
                                         464.87333333333333,
                                         526.3705555555555,
                                         527.83,
                                         529.2894444444445,
                                         530.7488888888889,
                                         439.64388888888897,
                                         440.8566666666667,
                                         442.0694444444444,
                                         443.28222222222223,
                                         351.9305555555556,
                                         352.8966666666667,
                                         353.86277777777775,
                                         354.8288888888889,
                                         239.38166666666666,
                                         240.34777777777774,
                                         241.3138888888889,
                                         242.28000000000003,
                                         302.64166666666665,
                                         303.8544444444444,
                                         305.0672222222223,
                                         306.28,
                                         366.8883333333333,
                                         368.34777777777776,
                                         369.80722222222226,
                                         371.2666666666666,
                                         331.6216666666667,
                                         332.91666666666674,
                                         334.2116666666667,
                                         335.50666666666666,
                                         337.7883333333334,
                                         339.08333333333326,
                                         340.3783333333334,
                                         341.67333333333335,
                                         387.52611111111116,
                                         388.98555555555555,
                                         390.445,
                                         391.90444444444444,
                                         324.2661111111112,
                                         325.47888888888895,
                                         326.69166666666666,
                                         327.9044444444444,
                                         260.01944444444445,
                                         260.9855555555556,
                                         261.9516666666667,
                                         262.9177777777777,
                                         157.06916666666666,
                                         157.83944444444444,
                                         158.60972222222225,
                                         159.38000000000002,
                                         198.87916666666666,
                                         199.8461111111111,
                                         200.81305555555556,
                                         201.78000000000003,
                                         241.47583333333333,
                                         242.63944444444445,
                                         243.80305555555557,
                                         244.9666666666667,
                                         219.10916666666665,
                                         220.14166666666665,
                                         221.17416666666668,
                                         222.20666666666665,
                                         224.0258333333333,
                                         225.05833333333334,
                                         226.09083333333334,
                                         227.1233333333333,
                                         257.9302777777778,
                                         259.09388888888896,
                                         260.2575,
                                         261.42111111111103,
                                         216.12027777777777,
                                         217.08722222222224,
                                         218.05416666666665,
                                         219.02111111111108,
                                         173.5236111111111,
                                         174.2938888888889,
                                         175.06416666666667,
                                         175.83444444444442,
                                         86.20583333333333,
                                         86.81944444444444,
                                         87.43305555555554,
                                         88.04666666666665,
                                         109.57583333333334,
                                         110.34611111111111,
                                         111.11638888888888,
                                         111.88666666666666,
                                         133.57250000000002,
                                         134.49944444444446,
                                         135.42638888888888,
                                         136.3533333333333,
                                         122.37916666666665,
                                         123.20166666666667,
                                         124.02416666666669,
                                         124.84666666666666,
                                         126.29583333333332,
                                         127.11833333333331,
                                         127.94083333333336,
                                         128.76333333333332,
                                         146.68027777777777,
                                         147.60722222222225,
                                         148.53416666666666,
                                         149.4611111111111,
                                         123.31027777777776,
                                         124.08055555555553,
                                         124.85083333333336,
                                         125.62111111111112,
                                         99.3136111111111,
                                         99.9272222222222,
                                         100.54083333333334,
                                         101.15444444444445};
  const std::array<int, 4> in_shape = {{3, 6, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         0.68,
                                         0.72,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.,
                                         3.12,
                                         3.24,
                                         3.3600000000000003,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         1.24,
                                         1.28,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         4.4399999999999995,
                                         4.56,
                                         4.68,
                                         4.8,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         6.88,
                                         7.04,
                                         7.2,
                                         7.36,
                                         10.8,
                                         11.04,
                                         11.28,
                                         11.520000000000001,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         11.76,
                                         12.,
                                         12.24,
                                         12.48,
                                         8.16,
                                         8.32,
                                         8.48,
                                         8.64,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         6.88,
                                         7.04,
                                         7.2,
                                         7.36,
                                         10.8,
                                         11.04,
                                         11.28,
                                         11.520000000000001,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         11.76,
                                         12.,
                                         12.24,
                                         12.48,
                                         8.16,
                                         8.32,
                                         8.48,
                                         8.64,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         6.88,
                                         7.04,
                                         7.2,
                                         7.36,
                                         10.8,
                                         11.04,
                                         11.28,
                                         11.520000000000001,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         11.76,
                                         12.,
                                         12.24,
                                         12.48,
                                         8.16,
                                         8.32,
                                         8.48,
                                         8.64,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         6.88,
                                         7.04,
                                         7.2,
                                         7.36,
                                         10.8,
                                         11.04,
                                         11.28,
                                         11.520000000000001,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         11.76,
                                         12.,
                                         12.24,
                                         12.48,
                                         8.16,
                                         8.32,
                                         8.48,
                                         8.64,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56,
                                         2.6,
                                         2.64,
                                         2.68,
                                         2.72,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         8.280000000000001,
                                         8.4,
                                         8.52,
                                         8.64,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         8.76,
                                         8.879999999999999,
                                         9.,
                                         9.120000000000001,
                                         6.,
                                         6.08,
                                         6.16,
                                         6.24,
                                         3.08,
                                         3.12,
                                         3.16,
                                         3.2,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         18.48,
                                         18.72,
                                         18.96,
                                         19.2,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         19.44,
                                         19.68,
                                         19.92,
                                         20.16,
                                         13.280000000000001,
                                         13.44,
                                         13.600000000000001,
                                         13.76,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         18.48,
                                         18.72,
                                         18.96,
                                         19.2,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         19.44,
                                         19.68,
                                         19.92,
                                         20.16,
                                         13.280000000000001,
                                         13.44,
                                         13.600000000000001,
                                         13.76,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         18.48,
                                         18.72,
                                         18.96,
                                         19.2,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         19.44,
                                         19.68,
                                         19.92,
                                         20.16,
                                         13.280000000000001,
                                         13.44,
                                         13.600000000000001,
                                         13.76,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         18.48,
                                         18.72,
                                         18.96,
                                         19.2,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         19.44,
                                         19.68,
                                         19.92,
                                         20.16,
                                         13.280000000000001,
                                         13.44,
                                         13.600000000000001,
                                         13.76,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         3.24,
                                         3.2800000000000002,
                                         3.3200000000000003,
                                         3.36,
                                         6.640000000000001,
                                         6.720000000000001,
                                         6.800000000000001,
                                         6.88,
                                         10.200000000000001,
                                         10.32,
                                         10.440000000000001,
                                         10.56,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         10.68,
                                         10.8,
                                         10.92,
                                         11.04,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         3.72,
                                         3.7600000000000002,
                                         3.8000000000000003,
                                         3.84};
  const std::array<int, 4> in_shape = {{3, 6, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.177777777777778,
                                         5.584444444444443,
                                         7.538611111111111,
                                         8.844166666666665,
                                         7.4775,
                                         6.2275,
                                         7.2844444444444445,
                                         9.571111111111112,
                                         12.67527777777778,
                                         14.314166666666665,
                                         11.947500000000002,
                                         9.8575,
                                         11.331111111111111,
                                         14.73777777777778,
                                         19.291944444444447,
                                         21.264166666666668,
                                         17.5975,
                                         14.427499999999998,
                                         17.086666666666666,
                                         21.926666666666662,
                                         28.251666666666665,
                                         30.085,
                                         24.584999999999997,
                                         19.965,
                                         25.43111111111111,
                                         32.437777777777775,
                                         41.491944444444435,
                                         43.46416666666666,
                                         35.29750000000001,
                                         28.527500000000003,
                                         23.264444444444447,
                                         29.631111111111114,
                                         37.835277777777776,
                                         39.47416666666667,
                                         32.00750000000001,
                                         25.8375,
                                         20.157777777777778,
                                         25.64444444444445,
                                         32.69861111111111,
                                         34.00416666666667,
                                         27.5375,
                                         22.207499999999996,
                                         29.94944444444445,
                                         37.93611111111112,
                                         48.11527777777778,
                                         49.420833333333334,
                                         39.82916666666667,
                                         31.999166666666664,
                                         39.63611111111112,
                                         50.18277777777779,
                                         63.61194444444445,
                                         65.25083333333335,
                                         52.55916666666668,
                                         42.20916666666666,
                                         50.262777777777785,
                                         63.60944444444445,
                                         80.58861111111112,
                                         82.56083333333335,
                                         66.46916666666667,
                                         53.35916666666665,
                                         53.276666666666664,
                                         67.35666666666667,
                                         85.23166666666665,
                                         87.06499999999998,
                                         70.01499999999999,
                                         56.15499999999999,
                                         64.36277777777778,
                                         81.30944444444445,
                                         102.78861111111111,
                                         104.76083333333334,
                                         84.16916666666665,
                                         67.45916666666666,
                                         55.61611111111111,
                                         70.24277777777777,
                                         88.77194444444446,
                                         90.41083333333333,
                                         72.61916666666666,
                                         58.189166666666665,
                                         45.92944444444444,
                                         57.99611111111111,
                                         73.27527777777777,
                                         74.58083333333333,
                                         59.88916666666667,
                                         47.97916666666667,
                                         55.72111111111111,
                                         70.28777777777778,
                                         88.69194444444445,
                                         89.99749999999999,
                                         72.18083333333334,
                                         57.77083333333333,
                                         71.98777777777778,
                                         90.79444444444444,
                                         114.5486111111111,
                                         116.18749999999999,
                                         93.17083333333333,
                                         74.56083333333333,
                                         89.19444444444444,
                                         112.4811111111111,
                                         141.88527777777776,
                                         143.8575,
                                         115.34083333333334,
                                         92.29083333333334,
                                         89.46666666666667,
                                         112.78666666666668,
                                         142.21166666666667,
                                         144.04500000000002,
                                         115.44500000000001,
                                         92.34500000000001,
                                         103.29444444444444,
                                         130.1811111111111,
                                         164.08527777777775,
                                         166.05749999999998,
                                         133.04083333333335,
                                         106.39083333333335,
                                         87.96777777777777,
                                         110.85444444444444,
                                         139.7086111111111,
                                         141.34750000000003,
                                         113.23083333333334,
                                         90.54083333333334,
                                         71.7011111111111,
                                         90.34777777777778,
                                         113.85194444444446,
                                         115.15750000000001,
                                         92.24083333333334,
                                         73.75083333333333};
  const std::array<int, 4> in_shape = {{3, 7, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.08,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.32,
                                         0.72,
                                         0.72,
                                         0.72,
                                         0.72,
                                         0.4,
                                         0.2,
                                         0.44,
                                         0.44,
                                         0.44,
                                         0.44,
                                         0.24,
                                         0.28,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.32,
                                         0.64,
                                         1.36,
                                         1.36,
                                         1.36,
                                         1.36,
                                         0.72,
                                         1.08,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.2,
                                         1.08,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.2,
                                         1.08,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.2,
                                         0.8,
                                         1.68,
                                         1.68,
                                         1.68,
                                         1.68,
                                         0.88,
                                         0.44,
                                         0.9199999999999999,
                                         0.9199999999999999,
                                         0.9199999999999999,
                                         0.9199999999999999,
                                         0.48,
                                         0.52,
                                         1.08,
                                         1.08,
                                         1.08,
                                         1.08,
                                         0.56,
                                         1.12,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         1.2000000000000002,
                                         1.8000000000000003,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         1.9200000000000002,
                                         1.28,
                                         2.6399999999999997,
                                         2.6399999999999997,
                                         2.6399999999999997,
                                         2.6399999999999997,
                                         1.3599999999999999,
                                         0.68,
                                         1.4,
                                         1.4,
                                         1.4,
                                         1.4,
                                         0.72};
  const std::array<int, 4> in_shape = {{3, 7, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      7.741944444444444,  8.355555555555556,
      10.398611111111112, 11.168888888888887,
      14.111111111111112, 15.077222222222222,
      16.72222222222222,  17.68833333333333,
      14.184722222222224, 14.955,
      11.84138888888889,  12.455,
      13.79861111111111,  14.568888888888889,
      18.17527777777778,  19.142222222222223,
      24.137777777777778, 25.35055555555556,
      27.415555555555553, 28.62833333333333,
      22.928055555555556, 23.895000000000003,
      18.944722222222225, 19.715,
      21.735277777777778, 22.662222222222223,
      28.311944444444446, 29.47555555555556,
      37.12444444444445,  38.58388888888889,
      41.068888888888885, 42.528333333333336,
      34.03138888888889,  35.195,
      27.92805555555556,  28.854999999999997,
      33.31166666666667,  34.17333333333333,
      42.77166666666667,  43.853333333333325,
      55.146666666666675, 56.50333333333333,
      58.81333333333333,  60.17,
      48.08833333333334,  49.169999999999995,
      39.068333333333335, 39.93,
      49.93527777777778,  50.86222222222222,
      63.71194444444445,  64.87555555555555,
      81.52444444444446,  82.98388888888887,
      85.4688888888889,   86.92833333333331,
      69.43138888888888,  70.59500000000001,
      56.128055555555555, 57.05500000000001,
      45.758611111111115, 46.52888888888889,
      58.29527777777778,  59.26222222222223,
      74.45777777777778,  75.67055555555555,
      77.73555555555555,  78.94833333333334,
      63.04805555555555,  64.01500000000001,
      50.90472222222222,  51.675,
      39.70194444444444,  40.315555555555555,
      50.518611111111106, 51.2888888888889,
      64.43111111111111,  65.39722222222223,
      67.04222222222222,  68.00833333333334,
      54.30472222222222,  55.075,
      43.80138888888889,  44.41499999999999,
      59.28527777777777,  59.8988888888889,
      75.10194444444443,  75.87222222222223,
      95.26444444444441,  96.23055555555555,
      97.87555555555554,  98.84166666666667,
      78.88805555555555,  79.65833333333335,
      63.38472222222222,  63.99833333333333,
      78.50194444444445,  79.27222222222224,
      99.3986111111111,   100.36555555555557,
      126.01111111111108, 127.2238888888889,
      129.28888888888886, 130.5016666666667,
      104.15138888888889, 105.11833333333335,
      83.64805555555556,  84.41833333333332,
      99.59861111111111,  100.52555555555557,
      126.05527777777776, 127.2188888888889,
      159.71777777777774, 161.17722222222224,
      163.6622222222222,  165.1216666666667,
      131.77472222222224, 132.93833333333333,
      105.79138888888889, 106.7183333333333,
      105.69166666666668, 106.55333333333333,
      133.63166666666666, 134.71333333333334,
      169.10666666666668, 170.4633333333333,
      172.77333333333334, 174.12999999999997,
      138.94833333333332, 140.02999999999997,
      111.44833333333334, 112.30999999999997,
      127.79861111111111, 128.72555555555556,
      161.45527777777775, 162.6188888888889,
      204.11777777777777, 205.57722222222222,
      208.0622222222222,  209.52166666666668,
      167.17472222222221, 168.3383333333333,
      133.99138888888888, 134.91833333333332,
      110.46194444444444, 111.23222222222222,
      139.5186111111111,  140.48555555555555,
      176.33111111111108, 177.54388888888892,
      179.60888888888888, 180.82166666666666,
      144.27138888888888, 145.23833333333332,
      115.60805555555557, 116.37833333333333,
      91.24527777777779,  91.85888888888888,
      115.22194444444443, 115.99222222222222,
      145.58444444444444, 146.55055555555555,
      148.19555555555556, 149.16166666666666,
      119.00805555555557, 119.77833333333334,
      95.34472222222222,  95.95833333333334,
      110.82861111111109, 111.44222222222221,
      139.80527777777777, 140.57555555555555,
      176.41777777777776, 177.3838888888889,
      179.0288888888889,  179.99499999999998,
      143.59138888888887, 144.36166666666668,
      114.92805555555556, 115.54166666666666,
      143.20527777777778, 143.97555555555556,
      180.6219444444444,  181.58888888888887,
      227.88444444444443, 229.0972222222222,
      231.16222222222223, 232.37499999999997,
      185.3747222222222,  186.34166666666667,
      148.3513888888889,  149.12166666666667,
      177.46194444444444, 178.38888888888889,
      223.79861111111106, 224.9622222222222,
      282.3111111111111,  283.7705555555555,
      286.25555555555553, 287.715,
      229.51805555555552, 230.68166666666667,
      183.6547222222222,  184.58166666666668,
      178.0716666666667,  178.93333333333334,
      224.49166666666665, 225.57333333333335,
      283.06666666666666, 284.42333333333335,
      286.73333333333335, 288.09000000000003,
      229.8083333333333,  230.89000000000001,
      183.82833333333332, 184.69000000000003,
      205.66194444444446, 206.58888888888887,
      259.1986111111111,  260.3622222222222,
      326.71111111111105, 328.1705555555555,
      330.65555555555545, 332.11499999999995,
      264.91805555555555, 266.0816666666667,
      211.85472222222222, 212.7816666666667,
      175.1652777777778,  175.93555555555554,
      220.74194444444444, 221.70888888888888,
      278.20444444444445, 279.4172222222222,
      281.4822222222222,  282.69500000000005,
      225.49472222222224, 226.46166666666667,
      180.31138888888887, 181.08166666666668,
      142.78861111111112, 143.4022222222222,
      179.9252777777778,  180.69555555555556,
      226.7377777777778,  227.7038888888889,
      229.3488888888889,  230.31500000000003,
      183.71138888888885, 184.48166666666668,
      146.88805555555555, 147.50166666666667};
  const std::array<int, 4> in_shape = {{3, 7, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         1.28,
                                         1.44,
                                         1.28,
                                         1.44,
                                         1.28,
                                         1.44,
                                         1.28,
                                         1.44,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.8,
                                         0.88,
                                         0.44,
                                         0.48,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         0.6,
                                         0.64,
                                         1.2000000000000002,
                                         1.28,
                                         2.5600000000000005,
                                         2.72,
                                         2.5600000000000005,
                                         2.72,
                                         2.5600000000000005,
                                         2.72,
                                         2.5600000000000005,
                                         2.72,
                                         1.3599999999999999,
                                         1.44,
                                         2.04,
                                         2.16,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         2.28,
                                         2.4,
                                         2.04,
                                         2.16,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         2.28,
                                         2.4,
                                         2.04,
                                         2.16,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         2.28,
                                         2.4,
                                         1.52,
                                         1.6,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         1.76,
                                         1.8399999999999999,
                                         1.76,
                                         1.8399999999999999,
                                         1.76,
                                         1.8399999999999999,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         2.08,
                                         2.16,
                                         2.08,
                                         2.16,
                                         2.08,
                                         2.16,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         2.48,
                                         2.56,
                                         5.12,
                                         5.279999999999999,
                                         5.12,
                                         5.279999999999999,
                                         5.12,
                                         5.279999999999999,
                                         5.12,
                                         5.279999999999999,
                                         2.64,
                                         2.7199999999999998,
                                         1.32,
                                         1.36,
                                         2.72,
                                         2.8,
                                         2.72,
                                         2.8,
                                         2.72,
                                         2.8,
                                         2.72,
                                         2.8,
                                         1.4000000000000001,
                                         1.44};
  const std::array<int, 4> in_shape = {{3, 7, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {14.870277777777776,
                                         15.483888888888888,
                                         16.0975,
                                         16.711111111111112,
                                         20.026944444444446,
                                         20.797222222222224,
                                         21.5675,
                                         22.337777777777774,
                                         27.256111111111114,
                                         28.222222222222225,
                                         29.188333333333333,
                                         30.154444444444444,
                                         32.47833333333333,
                                         33.44444444444444,
                                         34.410555555555554,
                                         35.37666666666666,
                                         27.59916666666667,
                                         28.369444444444447,
                                         29.139722222222225,
                                         29.91,
                                         23.069166666666668,
                                         23.68277777777778,
                                         24.29638888888889,
                                         24.91,
                                         26.826944444444443,
                                         27.59722222222222,
                                         28.3675,
                                         29.137777777777778,
                                         35.383611111111115,
                                         36.35055555555556,
                                         37.317499999999995,
                                         38.284444444444446,
                                         47.06277777777778,
                                         48.275555555555556,
                                         49.48833333333333,
                                         50.70111111111112,
                                         53.61833333333334,
                                         54.831111111111106,
                                         56.04388888888889,
                                         57.25666666666666,
                                         44.889166666666675,
                                         45.85611111111111,
                                         46.823055555555555,
                                         47.790000000000006,
                                         37.119166666666665,
                                         37.88944444444445,
                                         38.65972222222223,
                                         39.43,
                                         42.54361111111112,
                                         43.470555555555556,
                                         44.3975,
                                         45.324444444444445,
                                         55.46027777777779,
                                         56.62388888888889,
                                         57.787499999999994,
                                         58.95111111111112,
                                         72.78944444444446,
                                         74.2488888888889,
                                         75.70833333333333,
                                         77.16777777777779,
                                         80.67833333333334,
                                         82.13777777777777,
                                         83.59722222222221,
                                         85.05666666666667,
                                         66.89916666666667,
                                         68.06277777777778,
                                         69.22638888888889,
                                         70.39,
                                         54.92916666666666,
                                         55.85611111111112,
                                         56.78305555555556,
                                         57.709999999999994,
                                         65.76166666666667,
                                         66.62333333333333,
                                         67.485,
                                         68.34666666666666,
                                         84.46166666666667,
                                         85.54333333333334,
                                         86.62499999999999,
                                         87.70666666666665,
                                         108.93666666666668,
                                         110.29333333333335,
                                         111.64999999999999,
                                         113.00666666666666,
                                         116.27000000000002,
                                         117.62666666666667,
                                         118.98333333333333,
                                         120.34,
                                         95.09500000000001,
                                         96.17666666666668,
                                         97.25833333333334,
                                         98.33999999999999,
                                         77.27499999999999,
                                         78.13666666666667,
                                         78.99833333333333,
                                         79.86,
                                         98.94361111111112,
                                         99.87055555555555,
                                         100.79749999999999,
                                         101.72444444444444,
                                         126.2602777777778,
                                         127.4238888888889,
                                         128.58749999999998,
                                         129.7511111111111,
                                         161.58944444444447,
                                         163.0488888888889,
                                         164.50833333333335,
                                         165.96777777777774,
                                         169.47833333333332,
                                         170.9377777777778,
                                         172.3972222222222,
                                         173.85666666666663,
                                         137.69916666666668,
                                         138.86277777777775,
                                         140.02638888888887,
                                         141.19000000000003,
                                         111.32916666666667,
                                         112.25611111111111,
                                         113.18305555555555,
                                         114.11000000000001,
                                         90.74694444444445,
                                         91.51722222222223,
                                         92.28749999999998,
                                         93.05777777777779,
                                         115.62361111111113,
                                         116.59055555555555,
                                         117.55749999999998,
                                         118.52444444444446,
                                         147.70277777777778,
                                         148.91555555555556,
                                         150.12833333333333,
                                         151.3411111111111,
                                         154.25833333333335,
                                         155.4711111111111,
                                         156.68388888888887,
                                         157.89666666666668,
                                         125.12916666666668,
                                         126.0961111111111,
                                         127.06305555555555,
                                         128.03000000000003,
                                         101.03916666666667,
                                         101.80944444444444,
                                         102.57972222222222,
                                         103.35,
                                         78.79027777777779,
                                         79.40388888888889,
                                         80.01749999999998,
                                         80.63111111111111,
                                         100.26694444444445,
                                         101.03722222222221,
                                         101.80749999999998,
                                         102.5777777777778,
                                         127.89611111111113,
                                         128.86222222222221,
                                         129.82833333333332,
                                         130.79444444444445,
                                         133.11833333333334,
                                         134.08444444444444,
                                         135.05055555555555,
                                         136.01666666666668,
                                         107.83916666666667,
                                         108.60944444444443,
                                         109.37972222222221,
                                         110.15,
                                         86.98916666666666,
                                         87.60277777777777,
                                         88.21638888888889,
                                         88.82999999999998,
                                         117.95694444444443,
                                         118.57055555555554,
                                         119.18416666666667,
                                         119.7977777777778,
                                         149.4336111111111,
                                         150.20388888888886,
                                         150.9741666666667,
                                         151.74444444444447,
                                         189.56277777777777,
                                         190.52888888888882,
                                         191.49500000000003,
                                         192.4611111111111,
                                         194.78500000000003,
                                         195.75111111111107,
                                         196.71722222222223,
                                         197.68333333333334,
                                         157.00583333333336,
                                         157.7761111111111,
                                         158.54638888888888,
                                         159.3166666666667,
                                         126.15583333333333,
                                         126.76944444444445,
                                         127.38305555555554,
                                         127.99666666666666,
                                         156.23361111111112,
                                         157.0038888888889,
                                         157.77416666666664,
                                         158.54444444444448,
                                         197.83027777777778,
                                         198.7972222222222,
                                         199.76416666666665,
                                         200.73111111111115,
                                         250.80944444444444,
                                         252.02222222222215,
                                         253.23499999999999,
                                         254.4477777777778,
                                         257.365,
                                         258.5777777777777,
                                         259.79055555555556,
                                         261.0033333333334,
                                         207.33583333333337,
                                         208.30277777777778,
                                         209.26972222222219,
                                         210.2366666666667,
                                         166.52583333333334,
                                         167.29611111111112,
                                         168.06638888888887,
                                         168.83666666666664,
                                         198.27027777777775,
                                         199.19722222222222,
                                         200.12416666666667,
                                         201.05111111111114,
                                         250.94694444444443,
                                         252.11055555555552,
                                         253.27416666666667,
                                         254.4377777777778,
                                         317.9761111111111,
                                         319.4355555555555,
                                         320.895,
                                         322.3544444444445,
                                         325.865,
                                         327.3244444444444,
                                         328.7838888888889,
                                         330.2433333333334,
                                         262.3858333333334,
                                         263.5494444444445,
                                         264.7130555555555,
                                         265.87666666666667,
                                         210.65583333333336,
                                         211.58277777777778,
                                         212.5097222222222,
                                         213.4366666666666,
                                         210.52166666666665,
                                         211.38333333333335,
                                         212.245,
                                         213.10666666666665,
                                         266.1816666666667,
                                         267.2633333333333,
                                         268.34499999999997,
                                         269.4266666666667,
                                         336.8566666666667,
                                         338.21333333333337,
                                         339.56999999999994,
                                         340.9266666666666,
                                         344.19,
                                         345.5466666666667,
                                         346.9033333333333,
                                         348.25999999999993,
                                         276.81500000000005,
                                         277.89666666666665,
                                         278.97833333333335,
                                         280.05999999999995,
                                         222.03500000000005,
                                         222.89666666666668,
                                         223.75833333333333,
                                         224.61999999999995,
                                         254.67027777777776,
                                         255.59722222222223,
                                         256.52416666666664,
                                         257.4511111111111,
                                         321.74694444444447,
                                         322.9105555555555,
                                         324.0741666666667,
                                         325.2377777777778,
                                         406.7761111111111,
                                         408.23555555555555,
                                         409.69499999999994,
                                         411.15444444444444,
                                         414.665,
                                         416.1244444444444,
                                         417.5838888888889,
                                         419.04333333333335,
                                         333.1858333333334,
                                         334.34944444444443,
                                         335.5130555555555,
                                         336.6766666666666,
                                         267.05583333333334,
                                         267.98277777777776,
                                         268.90972222222223,
                                         269.83666666666664,
                                         220.1536111111111,
                                         220.92388888888888,
                                         221.69416666666666,
                                         222.46444444444444,
                                         278.0702777777778,
                                         279.0372222222222,
                                         280.00416666666666,
                                         280.9711111111111,
                                         351.4494444444445,
                                         352.66222222222217,
                                         353.875,
                                         355.08777777777783,
                                         358.005,
                                         359.21777777777777,
                                         360.43055555555554,
                                         361.6433333333333,
                                         287.5758333333333,
                                         288.54277777777776,
                                         289.50972222222225,
                                         290.47666666666663,
                                         230.44583333333333,
                                         231.21611111111113,
                                         231.9863888888889,
                                         232.75666666666666,
                                         181.87694444444443,
                                         182.49055555555557,
                                         183.10416666666669,
                                         183.71777777777777,
                                         229.67361111111111,
                                         230.44388888888886,
                                         231.2141666666667,
                                         231.98444444444445,
                                         290.2027777777778,
                                         291.1688888888889,
                                         292.135,
                                         293.1011111111111,
                                         295.42499999999995,
                                         296.3911111111111,
                                         297.3572222222223,
                                         298.3233333333333,
                                         237.2458333333333,
                                         238.01611111111114,
                                         238.78638888888892,
                                         239.55666666666667,
                                         190.07583333333335,
                                         190.68944444444443,
                                         191.30305555555555,
                                         191.91666666666669,
                                         221.04361111111112,
                                         221.65722222222217,
                                         222.27083333333337,
                                         222.88444444444443,
                                         278.84027777777777,
                                         279.61055555555555,
                                         280.3808333333333,
                                         281.1511111111111,
                                         351.86944444444447,
                                         352.8355555555555,
                                         353.8016666666667,
                                         354.7677777777778,
                                         357.0916666666667,
                                         358.0577777777778,
                                         359.0238888888889,
                                         359.98999999999995,
                                         286.41249999999997,
                                         287.18277777777774,
                                         287.9530555555555,
                                         288.72333333333336,
                                         229.2425,
                                         229.85611111111112,
                                         230.4697222222222,
                                         231.08333333333331,
                                         285.6402777777778,
                                         286.41055555555556,
                                         287.18083333333334,
                                         287.9511111111111,
                                         360.2769444444444,
                                         361.2438888888888,
                                         362.2108333333333,
                                         363.17777777777775,
                                         454.5561111111111,
                                         455.76888888888885,
                                         456.9816666666667,
                                         458.1944444444444,
                                         461.1116666666667,
                                         462.32444444444445,
                                         463.5372222222223,
                                         464.74999999999994,
                                         369.78249999999997,
                                         370.7494444444444,
                                         371.7163888888889,
                                         372.68333333333334,
                                         295.9325,
                                         296.7027777777778,
                                         297.47305555555556,
                                         298.24333333333334,
                                         353.99694444444447,
                                         354.9238888888889,
                                         355.8508333333333,
                                         356.77777777777777,
                                         446.4336111111111,
                                         447.5972222222221,
                                         448.76083333333327,
                                         449.9244444444444,
                                         563.1627777777778,
                                         564.6222222222221,
                                         566.0816666666666,
                                         567.541111111111,
                                         571.0516666666667,
                                         572.5111111111111,
                                         573.9705555555556,
                                         575.43,
                                         457.87249999999995,
                                         459.03611111111104,
                                         460.19972222222225,
                                         461.36333333333334,
                                         366.3825,
                                         367.3094444444444,
                                         368.2363888888889,
                                         369.16333333333336,
                                         355.28166666666664,
                                         356.1433333333334,
                                         357.005,
                                         357.8666666666667,
                                         447.9016666666667,
                                         448.9833333333333,
                                         450.065,
                                         451.1466666666667,
                                         564.7766666666666,
                                         566.1333333333333,
                                         567.49,
                                         568.8466666666667,
                                         572.11,
                                         573.4666666666667,
                                         574.8233333333334,
                                         576.1800000000001,
                                         458.53499999999997,
                                         459.6166666666666,
                                         460.6983333333334,
                                         461.78000000000003,
                                         366.79499999999996,
                                         367.65666666666664,
                                         368.5183333333333,
                                         369.38000000000005,
                                         410.3969444444445,
                                         411.3238888888889,
                                         412.2508333333334,
                                         413.17777777777775,
                                         517.2336111111111,
                                         518.3972222222222,
                                         519.5608333333334,
                                         520.7244444444444,
                                         651.9627777777778,
                                         653.4222222222221,
                                         654.8816666666668,
                                         656.341111111111,
                                         659.8516666666666,
                                         661.3111111111109,
                                         662.7705555555556,
                                         664.2299999999999,
                                         528.6725,
                                         529.8361111111111,
                                         530.9997222222223,
                                         532.1633333333334,
                                         422.7825,
                                         423.70944444444444,
                                         424.63638888888886,
                                         425.5633333333334,
                                         349.5602777777778,
                                         350.3305555555556,
                                         351.1008333333333,
                                         351.8711111111111,
                                         440.5169444444445,
                                         441.4838888888889,
                                         442.4508333333334,
                                         443.41777777777776,
                                         555.1961111111111,
                                         556.4088888888889,
                                         557.6216666666668,
                                         558.8344444444444,
                                         561.7516666666667,
                                         562.9644444444444,
                                         564.1772222222222,
                                         565.3900000000001,
                                         450.02250000000004,
                                         450.9894444444445,
                                         451.9563888888889,
                                         452.92333333333335,
                                         359.8525,
                                         360.62277777777774,
                                         361.3930555555555,
                                         362.16333333333336,
                                         284.9636111111111,
                                         285.57722222222225,
                                         286.19083333333333,
                                         286.8044444444444,
                                         359.08027777777784,
                                         359.8505555555556,
                                         360.62083333333334,
                                         361.3911111111111,
                                         452.5094444444445,
                                         453.4755555555556,
                                         454.44166666666666,
                                         455.4077777777778,
                                         457.73166666666674,
                                         458.6977777777778,
                                         459.6638888888889,
                                         460.63000000000005,
                                         366.65250000000003,
                                         367.4227777777777,
                                         368.1930555555555,
                                         368.96333333333337,
                                         293.1625,
                                         293.7761111111111,
                                         294.3897222222222,
                                         295.00333333333333};
  const std::array<int, 4> in_shape = {{3, 7, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         1.04,
                                         1.12,
                                         1.2,
                                         1.28,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         2.4,
                                         2.56,
                                         2.72,
                                         2.88,
                                         1.3599999999999999,
                                         1.44,
                                         1.52,
                                         1.6,
                                         0.68,
                                         0.72,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.76,
                                         0.84,
                                         0.88,
                                         0.92,
                                         0.96,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         1.24,
                                         1.28,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.4800000000000004,
                                         2.56,
                                         4.960000000000001,
                                         5.120000000000001,
                                         5.280000000000001,
                                         5.44,
                                         4.960000000000001,
                                         5.120000000000001,
                                         5.280000000000001,
                                         5.44,
                                         4.960000000000001,
                                         5.120000000000001,
                                         5.280000000000001,
                                         5.44,
                                         4.960000000000001,
                                         5.120000000000001,
                                         5.280000000000001,
                                         5.44,
                                         2.6399999999999997,
                                         2.7199999999999998,
                                         2.8,
                                         2.88,
                                         3.9600000000000004,
                                         4.08,
                                         4.2,
                                         4.32,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         4.4399999999999995,
                                         4.56,
                                         4.68,
                                         4.8,
                                         3.9600000000000004,
                                         4.08,
                                         4.2,
                                         4.32,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         4.4399999999999995,
                                         4.56,
                                         4.68,
                                         4.8,
                                         3.9600000000000004,
                                         4.08,
                                         4.2,
                                         4.32,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         4.4399999999999995,
                                         4.56,
                                         4.68,
                                         4.8,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         1.6400000000000001,
                                         1.68,
                                         1.72,
                                         1.76,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         2.12,
                                         2.16,
                                         2.2,
                                         2.24,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         4.720000000000001,
                                         4.800000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         7.32,
                                         7.440000000000001,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         7.32,
                                         7.440000000000001,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         7.32,
                                         7.440000000000001,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         4.880000000000001,
                                         4.96,
                                         5.04,
                                         5.12,
                                         10.08,
                                         10.24,
                                         10.4,
                                         10.559999999999999,
                                         10.08,
                                         10.24,
                                         10.4,
                                         10.559999999999999,
                                         10.08,
                                         10.24,
                                         10.4,
                                         10.559999999999999,
                                         10.08,
                                         10.24,
                                         10.4,
                                         10.559999999999999,
                                         5.2,
                                         5.28,
                                         5.359999999999999,
                                         5.4399999999999995,
                                         2.6,
                                         2.64,
                                         2.68,
                                         2.72,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         2.7600000000000002,
                                         2.8000000000000003,
                                         2.84,
                                         2.88};
  const std::array<int, 4> in_shape = {{3, 7, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.686944444444444,
                                         6.2236111111111105,
                                         7.916944444444443,
                                         8.451666666666666,
                                         10.266944444444443,
                                         8.886944444444444,
                                         7.350277777777778,
                                         8.26361111111111,
                                         10.800277777777776,
                                         13.53361111111111,
                                         13.951666666666666,
                                         16.483611111111106,
                                         14.143611111111111,
                                         11.606944444444446,
                                         12.936944444444444,
                                         16.75361111111111,
                                         20.806944444444444,
                                         20.991666666666667,
                                         24.356944444444437,
                                         20.776944444444442,
                                         16.96027777777778,
                                         19.671666666666667,
                                         25.171666666666663,
                                         30.891666666666662,
                                         30.249999999999996,
                                         34.19166666666666,
                                         28.91166666666666,
                                         23.41166666666667,
                                         29.386944444444445,
                                         37.403611111111104,
                                         45.65694444444444,
                                         44.09166666666666,
                                         49.20694444444444,
                                         41.426944444444445,
                                         33.41027777777778,
                                         26.906944444444445,
                                         34.203611111111115,
                                         41.69694444444445,
                                         40.13166666666667,
                                         44.64694444444444,
                                         37.54694444444445,
                                         30.250277777777775,
                                         23.33027777777778,
                                         29.626944444444447,
                                         36.08027777777778,
                                         34.63166666666667,
                                         38.430277777777775,
                                         32.29027777777778,
                                         25.99361111111111,
                                         34.75388888888889,
                                         43.967222222222226,
                                         53.337222222222216,
                                         50.67333333333333,
                                         55.68722222222222,
                                         46.63055555555555,
                                         37.41722222222222,
                                         46.007222222222225,
                                         58.180555555555564,
                                         70.55055555555555,
                                         66.95333333333333,
                                         73.50055555555556,
                                         61.523888888888884,
                                         49.35055555555555,
                                         58.357222222222234,
                                         73.77055555555556,
                                         89.42055555555555,
                                         84.77333333333334,
                                         92.97055555555556,
                                         77.79388888888889,
                                         62.38055555555555,
                                         61.893333333333345,
                                         78.17333333333335,
                                         94.67333333333335,
                                         89.54,
                                         97.97333333333333,
                                         81.91333333333334,
                                         65.63333333333334,
                                         74.80722222222222,
                                         94.42055555555557,
                                         114.27055555555557,
                                         107.87333333333333,
                                         117.82055555555554,
                                         98.44388888888889,
                                         78.83055555555556,
                                         64.65055555555556,
                                         81.58388888888888,
                                         98.7138888888889,
                                         93.13333333333334,
                                         101.66388888888889,
                                         84.92722222222223,
                                         67.99388888888889,
                                         53.397222222222226,
                                         67.37055555555555,
                                         81.50055555555556,
                                         76.85333333333334,
                                         83.85055555555556,
                                         70.03388888888888,
                                         56.06055555555555,
                                         64.82083333333333,
                                         81.71083333333334,
                                         98.7575,
                                         92.89500000000001,
                                         101.10749999999999,
                                         84.37416666666667,
                                         67.48416666666667,
                                         83.75083333333332,
                                         105.56083333333333,
                                         127.56749999999998,
                                         119.955,
                                         130.51749999999998,
                                         108.90416666666667,
                                         87.09416666666667,
                                         103.77749999999999,
                                         130.7875,
                                         158.03416666666664,
                                         148.555,
                                         161.58416666666665,
                                         134.81083333333333,
                                         107.80083333333332,
                                         104.11500000000001,
                                         131.175,
                                         158.455,
                                         148.82999999999998,
                                         161.755,
                                         134.915,
                                         107.855,
                                         120.2275,
                                         151.4375,
                                         182.88416666666666,
                                         171.65499999999997,
                                         186.43416666666664,
                                         155.46083333333334,
                                         124.25083333333335,
                                         102.39416666666666,
                                         128.96416666666667,
                                         155.73083333333332,
                                         146.135,
                                         158.68083333333334,
                                         132.3075,
                                         105.73750000000001,
                                         83.46416666666667,
                                         105.11416666666665,
                                         126.92083333333333,
                                         119.075,
                                         129.27083333333334,
                                         107.7775,
                                         86.1275};
  const std::array<int, 4> in_shape = {{3, 7, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.24,
                                         0.24,
                                         0.2,
                                         0.12,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.44000000000000006,
                                         0.96,
                                         1.56,
                                         1.56,
                                         1.56,
                                         1.12,
                                         0.6,
                                         0.28,
                                         0.6000000000000001,
                                         0.9600000000000001,
                                         0.9600000000000001,
                                         0.9600000000000001,
                                         0.6799999999999999,
                                         0.36,
                                         0.4,
                                         0.8400000000000001,
                                         1.32,
                                         1.32,
                                         1.32,
                                         0.9199999999999999,
                                         0.48,
                                         0.92,
                                         1.9200000000000002,
                                         3.0000000000000004,
                                         3.0000000000000004,
                                         3.0000000000000004,
                                         2.08,
                                         1.08,
                                         1.56,
                                         3.24,
                                         5.04,
                                         5.04,
                                         5.04,
                                         3.4800000000000004,
                                         1.8,
                                         1.56,
                                         3.24,
                                         5.04,
                                         5.04,
                                         5.04,
                                         3.4800000000000004,
                                         1.8,
                                         1.56,
                                         3.24,
                                         5.04,
                                         5.04,
                                         5.04,
                                         3.4800000000000004,
                                         1.8,
                                         1.1600000000000001,
                                         2.4000000000000004,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         2.5600000000000005,
                                         1.3199999999999998,
                                         0.64,
                                         1.32,
                                         2.04,
                                         2.04,
                                         2.04,
                                         1.4,
                                         0.72,
                                         0.76,
                                         1.56,
                                         2.4,
                                         2.4,
                                         2.4,
                                         1.6400000000000001,
                                         0.84,
                                         1.6400000000000001,
                                         3.36,
                                         5.16,
                                         5.16,
                                         5.16,
                                         3.52,
                                         1.7999999999999998,
                                         2.64,
                                         5.3999999999999995,
                                         8.280000000000001,
                                         8.280000000000001,
                                         8.280000000000001,
                                         5.640000000000001,
                                         2.88,
                                         2.64,
                                         5.3999999999999995,
                                         8.280000000000001,
                                         8.280000000000001,
                                         8.280000000000001,
                                         5.640000000000001,
                                         2.88,
                                         2.64,
                                         5.3999999999999995,
                                         8.280000000000001,
                                         8.280000000000001,
                                         8.280000000000001,
                                         5.640000000000001,
                                         2.88,
                                         1.88,
                                         3.84,
                                         5.88,
                                         5.88,
                                         5.88,
                                         4.,
                                         2.04,
                                         1.,
                                         2.04,
                                         3.12,
                                         3.12,
                                         3.12,
                                         2.12,
                                         1.08};
  const std::array<int, 4> in_shape = {{3, 7, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {8.760277777777778,
                                         9.373888888888889,
                                         11.676944444444445,
                                         12.447222222222221,
                                         14.906944444444447,
                                         15.833888888888886,
                                         16.041666666666668,
                                         16.903333333333332,
                                         19.606944444444448,
                                         20.533888888888885,
                                         17.003611111111113,
                                         17.773888888888887,
                                         14.086944444444445,
                                         14.700555555555557,
                                         15.756944444444446,
                                         16.52722222222222,
                                         20.63361111111111,
                                         21.60055555555555,
                                         25.90361111111111,
                                         27.06722222222222,
                                         26.821666666666665,
                                         27.903333333333332,
                                         31.803611111111113,
                                         32.96722222222221,
                                         27.32027777777778,
                                         28.287222222222223,
                                         22.443611111111114,
                                         23.213888888888892,
                                         24.946944444444448,
                                         25.87388888888889,
                                         32.343611111111116,
                                         33.50722222222222,
                                         40.21361111111111,
                                         41.61388888888889,
                                         40.68166666666667,
                                         41.983333333333334,
                                         47.31361111111112,
                                         48.713888888888874,
                                         40.39027777777778,
                                         41.553888888888885,
                                         32.993611111111115,
                                         33.92055555555556,
                                         38.48166666666667,
                                         39.343333333333334,
                                         49.26166666666667,
                                         50.34333333333333,
                                         60.481666666666676,
                                         61.783333333333324,
                                         59.29000000000001,
                                         60.49999999999999,
                                         67.08166666666668,
                                         68.38333333333333,
                                         56.741666666666674,
                                         57.82333333333332,
                                         45.96166666666667,
                                         46.82333333333334,
                                         57.846944444444446,
                                         58.77388888888889,
                                         73.64361111111111,
                                         74.80722222222221,
                                         89.91361111111112,
                                         91.31388888888888,
                                         86.88166666666667,
                                         88.18333333333332,
                                         97.01361111111112,
                                         98.41388888888888,
                                         81.69027777777778,
                                         82.85388888888889,
                                         65.8936111111111,
                                         66.82055555555556,
                                         53.043611111111105,
                                         53.81388888888889,
                                         67.44027777777778,
                                         68.40722222222223,
                                         82.23027777777779,
                                         83.3938888888889,
                                         79.18166666666667,
                                         80.26333333333334,
                                         88.13027777777778,
                                         89.29388888888889,
                                         74.12694444444445,
                                         75.0938888888889,
                                         59.73027777777778,
                                         60.50055555555555,
                                         46.04694444444445,
                                         46.66055555555556,
                                         58.4836111111111,
                                         59.253888888888895,
                                         71.23361111111112,
                                         72.16055555555556,
                                         68.40166666666667,
                                         69.26333333333334,
                                         75.9336111111111,
                                         76.86055555555555,
                                         63.810277777777785,
                                         64.58055555555556,
                                         51.37361111111111,
                                         51.98722222222222,
                                         68.89416666666666,
                                         69.50777777777778,
                                         87.16416666666666,
                                         87.93444444444445,
                                         105.7475,
                                         106.67444444444443,
                                         100.48500000000001,
                                         101.34666666666666,
                                         110.4475,
                                         111.37444444444444,
                                         92.49083333333333,
                                         93.2611111111111,
                                         74.22083333333332,
                                         74.83444444444444,
                                         91.24416666666667,
                                         92.01444444444445,
                                         115.39416666666666,
                                         116.36111111111113,
                                         139.93750000000003,
                                         141.1011111111111,
                                         132.82500000000002,
                                         133.90666666666667,
                                         145.8375,
                                         147.00111111111113,
                                         122.08083333333332,
                                         123.04777777777777,
                                         97.93083333333331,
                                         98.7011111111111,
                                         115.7875,
                                         116.71444444444447,
                                         146.3775,
                                         147.54111111111112,
                                         177.4408333333334,
                                         178.8411111111111,
                                         168.24500000000003,
                                         169.54666666666668,
                                         184.54083333333335,
                                         185.94111111111113,
                                         154.42416666666665,
                                         155.58777777777777,
                                         123.83416666666665,
                                         124.7611111111111,
                                         122.925,
                                         123.78666666666669,
                                         155.265,
                                         156.3466666666667,
                                         188.04500000000002,
                                         189.3466666666667,
                                         177.86999999999998,
                                         179.08,
                                         194.64499999999998,
                                         195.94666666666666,
                                         162.745,
                                         163.82666666666668,
                                         130.405,
                                         131.26666666666668,
                                         148.6875,
                                         149.61444444444444,
                                         187.67749999999998,
                                         188.84111111111113,
                                         227.1408333333333,
                                         228.54111111111115,
                                         214.445,
                                         215.74666666666667,
                                         234.2408333333333,
                                         235.6411111111111,
                                         195.72416666666666,
                                         196.88777777777779,
                                         156.73416666666665,
                                         157.66111111111113,
                                         128.53083333333333,
                                         129.3011111111111,
                                         162.20083333333332,
                                         163.16777777777776,
                                         196.26416666666663,
                                         197.4277777777778,
                                         185.185,
                                         186.26666666666668,
                                         202.16416666666663,
                                         203.32777777777778,
                                         168.8875,
                                         169.85444444444445,
                                         135.2175,
                                         135.98777777777778,
                                         106.18083333333334,
                                         106.79444444444445,
                                         133.97083333333333,
                                         134.7411111111111,
                                         162.07416666666666,
                                         163.00111111111113,
                                         152.845,
                                         153.70666666666668,
                                         166.77416666666664,
                                         167.70111111111112,
                                         139.29749999999999,
                                         140.06777777777776,
                                         111.5075,
                                         112.1211111111111,
                                         129.02805555555554,
                                         129.64166666666665,
                                         162.65138888888887,
                                         163.42166666666668,
                                         196.58805555555554,
                                         197.515,
                                         184.92833333333334,
                                         185.79000000000002,
                                         201.28805555555556,
                                         202.21499999999997,
                                         167.97805555555556,
                                         168.74833333333333,
                                         134.35472222222222,
                                         134.96833333333333,
                                         166.7313888888889,
                                         167.50166666666664,
                                         210.15472222222223,
                                         211.12166666666667,
                                         253.9713888888889,
                                         255.13499999999996,
                                         238.82833333333335,
                                         239.91,
                                         259.8713888888889,
                                         261.03499999999997,
                                         216.8413888888889,
                                         217.80833333333334,
                                         173.41805555555555,
                                         174.18833333333333,
                                         206.62805555555556,
                                         207.55499999999998,
                                         260.4113888888889,
                                         261.575,
                                         314.66805555555555,
                                         316.06833333333327,
                                         295.80833333333334,
                                         297.11,
                                         321.7680555555555,
                                         323.1683333333333,
                                         268.4580555555556,
                                         269.62166666666667,
                                         214.67472222222221,
                                         215.60166666666663,
                                         207.36833333333334,
                                         208.23000000000002,
                                         261.2683333333333,
                                         262.35,
                                         315.60833333333335,
                                         316.91,
                                         296.45000000000005,
                                         297.65999999999997,
                                         322.2083333333333,
                                         323.51,
                                         268.74833333333333,
                                         269.83,
                                         214.84833333333333,
                                         215.71,
                                         239.5280555555556,
                                         240.455,
                                         301.7113888888889,
                                         302.875,
                                         364.3680555555555,
                                         365.7683333333333,
                                         342.0083333333333,
                                         343.30999999999995,
                                         371.46805555555557,
                                         372.8683333333333,
                                         309.75805555555553,
                                         310.9216666666667,
                                         247.5747222222222,
                                         248.5016666666667,
                                         204.01805555555558,
                                         204.78833333333333,
                                         256.9613888888889,
                                         257.92833333333334,
                                         310.29805555555555,
                                         311.46166666666664,
                                         291.18833333333333,
                                         292.27,
                                         316.1980555555556,
                                         317.3616666666667,
                                         263.6480555555556,
                                         264.615,
                                         210.7047222222222,
                                         211.47500000000002,
                                         166.31472222222223,
                                         166.92833333333334,
                                         209.45805555555555,
                                         210.2283333333333,
                                         252.91472222222222,
                                         253.84166666666667,
                                         237.28833333333336,
                                         238.15,
                                         257.6147222222222,
                                         258.5416666666667,
                                         214.78472222222223,
                                         215.555,
                                         171.64138888888886,
                                         172.255};
  const std::array<int, 4> in_shape = {{3, 7, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.32,
                                         0.4,
                                         0.2,
                                         0.24,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         0.8,
                                         0.8800000000000001,
                                         1.7600000000000002,
                                         1.92,
                                         2.8800000000000003,
                                         3.12,
                                         2.8800000000000003,
                                         3.12,
                                         2.8800000000000003,
                                         3.12,
                                         2.08,
                                         2.24,
                                         1.12,
                                         1.2,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.8000000000000003,
                                         1.9200000000000002,
                                         1.28,
                                         1.3599999999999999,
                                         0.68,
                                         0.72,
                                         0.76,
                                         0.8,
                                         1.6,
                                         1.6800000000000002,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96,
                                         1.76,
                                         1.84,
                                         3.68,
                                         3.8400000000000003,
                                         5.76,
                                         6.000000000000001,
                                         5.76,
                                         6.000000000000001,
                                         5.76,
                                         6.000000000000001,
                                         4.,
                                         4.16,
                                         2.08,
                                         2.16,
                                         3.,
                                         3.12,
                                         6.24,
                                         6.48,
                                         9.72,
                                         10.08,
                                         9.72,
                                         10.08,
                                         9.72,
                                         10.08,
                                         6.720000000000001,
                                         6.960000000000001,
                                         3.4800000000000004,
                                         3.6,
                                         3.,
                                         3.12,
                                         6.24,
                                         6.48,
                                         9.72,
                                         10.08,
                                         9.72,
                                         10.08,
                                         9.72,
                                         10.08,
                                         6.720000000000001,
                                         6.960000000000001,
                                         3.4800000000000004,
                                         3.6,
                                         3.,
                                         3.12,
                                         6.24,
                                         6.48,
                                         9.72,
                                         10.08,
                                         9.72,
                                         10.08,
                                         9.72,
                                         10.08,
                                         6.720000000000001,
                                         6.960000000000001,
                                         3.4800000000000004,
                                         3.6,
                                         2.24,
                                         2.3200000000000003,
                                         4.640000000000001,
                                         4.800000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         4.960000000000001,
                                         5.120000000000001,
                                         2.56,
                                         2.6399999999999997,
                                         1.24,
                                         1.28,
                                         2.56,
                                         2.64,
                                         3.96,
                                         4.08,
                                         3.96,
                                         4.08,
                                         3.96,
                                         4.08,
                                         2.72,
                                         2.8,
                                         1.4000000000000001,
                                         1.44,
                                         1.48,
                                         1.52,
                                         3.04,
                                         3.12,
                                         4.68,
                                         4.8,
                                         4.68,
                                         4.8,
                                         4.68,
                                         4.8,
                                         3.2,
                                         3.2800000000000002,
                                         1.6400000000000001,
                                         1.68,
                                         3.2,
                                         3.2800000000000002,
                                         6.56,
                                         6.72,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         6.88,
                                         7.04,
                                         3.5200000000000005,
                                         3.5999999999999996,
                                         5.16,
                                         5.28,
                                         10.559999999999999,
                                         10.799999999999999,
                                         16.2,
                                         16.560000000000002,
                                         16.2,
                                         16.560000000000002,
                                         16.2,
                                         16.560000000000002,
                                         11.04,
                                         11.280000000000001,
                                         5.640000000000001,
                                         5.76,
                                         5.16,
                                         5.28,
                                         10.559999999999999,
                                         10.799999999999999,
                                         16.2,
                                         16.560000000000002,
                                         16.2,
                                         16.560000000000002,
                                         16.2,
                                         16.560000000000002,
                                         11.04,
                                         11.280000000000001,
                                         5.640000000000001,
                                         5.76,
                                         5.16,
                                         5.28,
                                         10.559999999999999,
                                         10.799999999999999,
                                         16.2,
                                         16.560000000000002,
                                         16.2,
                                         16.560000000000002,
                                         16.2,
                                         16.560000000000002,
                                         11.04,
                                         11.280000000000001,
                                         5.640000000000001,
                                         5.76,
                                         3.6799999999999997,
                                         3.76,
                                         7.5200000000000005,
                                         7.68,
                                         11.52,
                                         11.76,
                                         11.52,
                                         11.76,
                                         11.52,
                                         11.76,
                                         7.840000000000001,
                                         8.,
                                         4.,
                                         4.08,
                                         1.96,
                                         2.,
                                         4.,
                                         4.08,
                                         6.12,
                                         6.24,
                                         6.12,
                                         6.24,
                                         6.12,
                                         6.24,
                                         4.16,
                                         4.24,
                                         2.12,
                                         2.16};
  const std::array<int, 4> in_shape = {{3, 7, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.906944444444445,
                                         17.520555555555557,
                                         18.13416666666667,
                                         18.747777777777777,
                                         22.583611111111114,
                                         23.35388888888889,
                                         24.124166666666667,
                                         24.894444444444442,
                                         28.886944444444445,
                                         29.813888888888894,
                                         30.74083333333333,
                                         31.667777777777772,
                                         31.22166666666667,
                                         32.083333333333336,
                                         32.945,
                                         33.806666666666665,
                                         38.286944444444444,
                                         39.213888888888896,
                                         40.14083333333333,
                                         41.06777777777777,
                                         33.23694444444445,
                                         34.007222222222225,
                                         34.777499999999996,
                                         35.547777777777775,
                                         27.560277777777777,
                                         28.17388888888889,
                                         28.7875,
                                         29.401111111111113,
                                         30.74361111111111,
                                         31.513888888888893,
                                         32.28416666666667,
                                         33.05444444444444,
                                         40.30027777777779,
                                         41.26722222222222,
                                         42.23416666666667,
                                         43.2011111111111,
                                         50.64361111111111,
                                         51.80722222222222,
                                         52.970833333333324,
                                         54.13444444444444,
                                         52.561666666666675,
                                         53.64333333333333,
                                         54.724999999999994,
                                         55.806666666666665,
                                         62.44361111111111,
                                         63.60722222222223,
                                         64.77083333333333,
                                         65.93444444444442,
                                         53.673611111111114,
                                         54.64055555555556,
                                         55.607499999999995,
                                         56.574444444444445,
                                         44.11694444444444,
                                         44.88722222222223,
                                         45.6575,
                                         46.427777777777784,
                                         48.96694444444445,
                                         49.893888888888895,
                                         50.82083333333334,
                                         51.74777777777778,
                                         63.52361111111112,
                                         64.68722222222223,
                                         65.85083333333334,
                                         67.01444444444444,
                                         79.02694444444444,
                                         80.42722222222223,
                                         81.82749999999999,
                                         83.22777777777777,
                                         80.06166666666668,
                                         81.36333333333334,
                                         82.66499999999999,
                                         83.96666666666667,
                                         93.22694444444446,
                                         94.62722222222224,
                                         96.02749999999999,
                                         97.42777777777775,
                                         79.61694444444444,
                                         80.78055555555557,
                                         81.94416666666666,
                                         83.10777777777777,
                                         65.06027777777777,
                                         65.98722222222223,
                                         66.91416666666666,
                                         67.84111111111112,
                                         76.10166666666667,
                                         76.96333333333334,
                                         77.825,
                                         78.68666666666667,
                                         97.44166666666668,
                                         98.52333333333334,
                                         99.605,
                                         100.68666666666665,
                                         119.66166666666668,
                                         120.96333333333335,
                                         122.26499999999999,
                                         123.56666666666665,
                                         117.37000000000002,
                                         118.58000000000003,
                                         119.79,
                                         120.99999999999999,
                                         132.86166666666668,
                                         134.16333333333336,
                                         135.46499999999997,
                                         136.76666666666665,
                                         112.40166666666667,
                                         113.48333333333335,
                                         114.56500000000001,
                                         115.64666666666665,
                                         91.06166666666665,
                                         91.92333333333335,
                                         92.785,
                                         93.64666666666668,
                                         114.76694444444445,
                                         115.69388888888889,
                                         116.62083333333334,
                                         117.54777777777778,
                                         146.1236111111111,
                                         147.28722222222223,
                                         148.45083333333332,
                                         149.61444444444442,
                                         178.42694444444444,
                                         179.82722222222225,
                                         181.22750000000002,
                                         182.62777777777777,
                                         172.46166666666667,
                                         173.76333333333335,
                                         175.06499999999997,
                                         176.36666666666665,
                                         192.62694444444446,
                                         194.02722222222224,
                                         195.42749999999998,
                                         196.82777777777775,
                                         162.21694444444444,
                                         163.38055555555556,
                                         164.54416666666668,
                                         165.70777777777778,
                                         130.86027777777778,
                                         131.7872222222222,
                                         132.71416666666667,
                                         133.64111111111112,
                                         105.31694444444445,
                                         106.08722222222221,
                                         106.8575,
                                         107.62777777777778,
                                         133.91361111111112,
                                         134.88055555555556,
                                         135.8475,
                                         136.81444444444446,
                                         163.29694444444445,
                                         164.46055555555557,
                                         165.62416666666667,
                                         166.7877777777778,
                                         157.28166666666667,
                                         158.36333333333334,
                                         159.445,
                                         160.52666666666667,
                                         175.09694444444443,
                                         176.26055555555556,
                                         177.42416666666665,
                                         178.58777777777777,
                                         147.28694444444443,
                                         148.2538888888889,
                                         149.22083333333336,
                                         150.1877777777778,
                                         118.69027777777777,
                                         119.46055555555556,
                                         120.23083333333335,
                                         121.0011111111111,
                                         91.48027777777777,
                                         92.0938888888889,
                                         92.7075,
                                         93.32111111111112,
                                         116.19694444444444,
                                         116.9672222222222,
                                         117.7375,
                                         118.50777777777779,
                                         141.5402777777778,
                                         142.46722222222223,
                                         143.39416666666668,
                                         144.32111111111112,
                                         135.94166666666666,
                                         136.80333333333334,
                                         137.665,
                                         138.52666666666667,
                                         150.9402777777778,
                                         151.8672222222222,
                                         152.79416666666668,
                                         153.7211111111111,
                                         126.85027777777776,
                                         127.62055555555557,
                                         128.39083333333335,
                                         129.16111111111113,
                                         102.13361111111111,
                                         102.74722222222222,
                                         103.36083333333332,
                                         103.97444444444444,
                                         137.17472222222221,
                                         137.78833333333333,
                                         138.40194444444444,
                                         139.01555555555555,
                                         173.55805555555554,
                                         174.32833333333332,
                                         175.09861111111113,
                                         175.8688888888889,
                                         210.56805555555556,
                                         211.495,
                                         212.42194444444442,
                                         213.34888888888887,
                                         200.10833333333332,
                                         200.97000000000003,
                                         201.8316666666667,
                                         202.69333333333333,
                                         219.96805555555554,
                                         220.895,
                                         221.82194444444445,
                                         222.74888888888887,
                                         184.21138888888888,
                                         184.98166666666665,
                                         185.75194444444446,
                                         186.5222222222222,
                                         147.82805555555555,
                                         148.44166666666663,
                                         149.05527777777777,
                                         149.6688888888889,
                                         181.71805555555557,
                                         182.48833333333334,
                                         183.25861111111112,
                                         184.0288888888889,
                                         229.8213888888889,
                                         230.78833333333333,
                                         231.7552777777778,
                                         232.72222222222226,
                                         278.7113888888889,
                                         279.87500000000006,
                                         281.0386111111111,
                                         282.2022222222222,
                                         264.5683333333333,
                                         265.65000000000003,
                                         266.73166666666674,
                                         267.81333333333333,
                                         290.51138888888886,
                                         291.675,
                                         292.83861111111105,
                                         294.00222222222226,
                                         243.19472222222223,
                                         244.16166666666663,
                                         245.12861111111116,
                                         246.09555555555553,
                                         195.0913888888889,
                                         195.86166666666662,
                                         196.63194444444446,
                                         197.4022222222222,
                                         230.64805555555557,
                                         231.575,
                                         232.50194444444446,
                                         233.42888888888893,
                                         291.59138888888884,
                                         292.755,
                                         293.91861111111115,
                                         295.08222222222224,
                                         353.4813888888889,
                                         354.8816666666668,
                                         356.28194444444443,
                                         357.6822222222222,
                                         335.1883333333333,
                                         336.49000000000007,
                                         337.79166666666674,
                                         339.09333333333336,
                                         367.6813888888888,
                                         369.0816666666667,
                                         370.48194444444437,
                                         371.88222222222225,
                                         307.6847222222222,
                                         308.8483333333333,
                                         310.01194444444445,
                                         311.17555555555555,
                                         246.74138888888888,
                                         247.6683333333333,
                                         248.59527777777782,
                                         249.5222222222222,
                                         244.98833333333334,
                                         245.85,
                                         246.71166666666667,
                                         247.57333333333338,
                                         309.4483333333333,
                                         310.53,
                                         311.61166666666674,
                                         312.6933333333334,
                                         374.78833333333324,
                                         376.09000000000003,
                                         377.3916666666667,
                                         378.6933333333334,
                                         354.53000000000003,
                                         355.73999999999995,
                                         356.95000000000005,
                                         358.16,
                                         387.9883333333333,
                                         389.28999999999996,
                                         390.5916666666667,
                                         391.8933333333333,
                                         324.4083333333333,
                                         325.49,
                                         326.57166666666666,
                                         327.65333333333336,
                                         259.9483333333333,
                                         260.81,
                                         261.67166666666674,
                                         262.53333333333336,
                                         296.4480555555556,
                                         297.375,
                                         298.3019444444444,
                                         299.2288888888889,
                                         374.1913888888889,
                                         375.35499999999996,
                                         376.5186111111111,
                                         377.68222222222226,
                                         452.8813888888888,
                                         454.2816666666666,
                                         455.6819444444444,
                                         457.0822222222223,
                                         427.58833333333325,
                                         428.89,
                                         430.1916666666667,
                                         431.49333333333334,
                                         467.0813888888888,
                                         468.4816666666666,
                                         469.88194444444446,
                                         471.2822222222222,
                                         390.2847222222221,
                                         391.4483333333333,
                                         392.6119444444445,
                                         393.77555555555557,
                                         312.5413888888889,
                                         313.4683333333333,
                                         314.3952777777778,
                                         315.32222222222225,
                                         256.2913888888889,
                                         257.06166666666667,
                                         257.83194444444445,
                                         258.6022222222222,
                                         323.43472222222226,
                                         324.40166666666664,
                                         325.3686111111111,
                                         326.3355555555555,
                                         391.3647222222222,
                                         392.52833333333325,
                                         393.6919444444445,
                                         394.8555555555556,
                                         369.2883333333333,
                                         370.37,
                                         371.4516666666667,
                                         372.53333333333336,
                                         403.16472222222217,
                                         404.32833333333326,
                                         405.49194444444447,
                                         406.65555555555557,
                                         336.80805555555554,
                                         337.775,
                                         338.74194444444447,
                                         339.7088888888889,
                                         269.6647222222222,
                                         270.435,
                                         271.2052777777778,
                                         271.97555555555556,
                                         211.74805555555557,
                                         212.36166666666668,
                                         212.97527777777776,
                                         213.5888888888889,
                                         267.1713888888889,
                                         267.94166666666666,
                                         268.71194444444444,
                                         269.4822222222222,
                                         323.22138888888884,
                                         324.1483333333333,
                                         325.0752777777777,
                                         326.00222222222226,
                                         304.8283333333333,
                                         305.69,
                                         306.5516666666666,
                                         307.41333333333336,
                                         332.6213888888889,
                                         333.5483333333333,
                                         334.4752777777778,
                                         335.40222222222224,
                                         277.82472222222225,
                                         278.59499999999997,
                                         279.36527777777775,
                                         280.1355555555555,
                                         222.4013888888889,
                                         223.015,
                                         223.62861111111113,
                                         224.2422222222222,
                                         257.4425,
                                         258.0561111111111,
                                         258.6697222222222,
                                         259.2833333333333,
                                         324.53249999999997,
                                         325.30277777777775,
                                         326.0730555555556,
                                         326.84333333333336,
                                         392.24916666666667,
                                         393.1761111111111,
                                         394.10305555555556,
                                         395.03,
                                         368.995,
                                         369.8566666666667,
                                         370.71833333333336,
                                         371.58000000000004,
                                         401.6491666666666,
                                         402.5761111111111,
                                         403.5030555555556,
                                         404.42999999999995,
                                         335.18583333333333,
                                         335.9561111111111,
                                         336.7263888888889,
                                         337.49666666666667,
                                         268.0958333333333,
                                         268.70944444444444,
                                         269.3230555555556,
                                         269.93666666666667,
                                         332.6925,
                                         333.4627777777778,
                                         334.23305555555555,
                                         335.0033333333333,
                                         419.3425,
                                         420.30944444444447,
                                         421.2763888888889,
                                         422.24333333333334,
                                         506.7791666666667,
                                         507.9427777777778,
                                         509.1063888888889,
                                         510.2699999999999,
                                         476.57500000000005,
                                         477.6566666666667,
                                         478.73833333333334,
                                         479.82,
                                         518.5791666666665,
                                         519.7427777777777,
                                         520.906388888889,
                                         522.0699999999999,
                                         432.7158333333333,
                                         433.6827777777778,
                                         434.6497222222222,
                                         435.6166666666667,
                                         346.06583333333333,
                                         346.8361111111111,
                                         347.6063888888889,
                                         348.37666666666667,
                                         391.8491666666667,
                                         392.7761111111111,
                                         393.7030555555556,
                                         394.63,
                                         478.69916666666666,
                                         479.8627777777778,
                                         481.0263888888889,
                                         482.19000000000005,
                                         566.4958333333334,
                                         567.8961111111112,
                                         569.2963888888888,
                                         570.6966666666666,
                                         503.27500000000003,
                                         504.57666666666665,
                                         505.87833333333333,
                                         507.18000000000006,
                                         520.9624999999999,
                                         522.3627777777779,
                                         523.7630555555556,
                                         525.1633333333333,
                                         435.0591666666666,
                                         436.22277777777776,
                                         437.3863888888888,
                                         438.55,
                                         348.20916666666665,
                                         349.13611111111106,
                                         350.06305555555554,
                                         350.99,
                                         293.1283333333334,
                                         293.98999999999995,
                                         294.85166666666674,
                                         295.7133333333334,
                                         354.62833333333333,
                                         355.71,
                                         356.79166666666674,
                                         357.87333333333345,
                                         417.0083333333334,
                                         418.30999999999995,
                                         419.6116666666667,
                                         420.9133333333334,
                                         363.85,
                                         365.05999999999995,
                                         366.27000000000004,
                                         367.4800000000001,
                                         370.47499999999997,
                                         371.7766666666666,
                                         373.0783333333334,
                                         374.38000000000005,
                                         309.85499999999996,
                                         310.9366666666666,
                                         312.01833333333326,
                                         313.1,
                                         248.35500000000002,
                                         249.21666666666664,
                                         250.07833333333335,
                                         250.94,
                                         223.69361111111112,
                                         224.6205555555556,
                                         225.54750000000004,
                                         226.47444444444443,
                                         267.6102777777778,
                                         268.7738888888889,
                                         269.9375,
                                         271.10111111111115,
                                         312.47361111111115,
                                         313.87388888888876,
                                         315.27416666666664,
                                         316.6744444444446,
                                         267.14166666666665,
                                         268.4433333333333,
                                         269.745,
                                         271.0466666666667,
                                         266.94027777777774,
                                         268.34055555555557,
                                         269.7408333333333,
                                         271.1411111111112,
                                         223.9702777777778,
                                         225.1338888888889,
                                         226.29749999999999,
                                         227.46111111111117,
                                         180.05361111111114,
                                         180.98055555555558,
                                         181.9075,
                                         182.83444444444447,
                                         152.83027777777778,
                                         153.60055555555556,
                                         154.37083333333334,
                                         155.1411111111111,
                                         178.30694444444444,
                                         179.2738888888889,
                                         180.24083333333334,
                                         181.20777777777778,
                                         204.57027777777776,
                                         205.7338888888889,
                                         206.8975,
                                         208.0611111111111,
                                         165.7216666666667,
                                         166.80333333333337,
                                         167.88500000000002,
                                         168.96666666666667,
                                         156.6369444444445,
                                         157.8005555555556,
                                         158.96416666666664,
                                         160.1277777777778,
                                         131.94694444444445,
                                         132.9138888888889,
                                         133.88083333333336,
                                         134.84777777777776,
                                         106.47027777777778,
                                         107.24055555555557,
                                         108.01083333333334,
                                         108.7811111111111,
                                         77.58027777777778,
                                         78.19388888888889,
                                         78.80749999999999,
                                         79.4211111111111,
                                         83.49694444444445,
                                         84.26722222222222,
                                         85.0375,
                                         85.80777777777777,
                                         90.04027777777777,
                                         90.96722222222223,
                                         91.89416666666666,
                                         92.8211111111111,
                                         58.14166666666666,
                                         59.00333333333333,
                                         59.86500000000001,
                                         60.72666666666667,
                                         39.706944444444446,
                                         40.63388888888889,
                                         41.56083333333332,
                                         42.48777777777777,
                                         34.41694444444444,
                                         35.18722222222222,
                                         35.957499999999996,
                                         36.727777777777774,
                                         28.50027777777778,
                                         29.113888888888887,
                                         29.727499999999996,
                                         30.34111111111111};
  const std::array<int, 4> in_shape = {{3, 7, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         1.52,
                                         1.6,
                                         1.6800000000000002,
                                         1.7600000000000002,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         3.6799999999999997,
                                         3.84,
                                         5.5200000000000005,
                                         5.760000000000001,
                                         6.,
                                         6.24,
                                         5.5200000000000005,
                                         5.760000000000001,
                                         6.,
                                         6.24,
                                         5.5200000000000005,
                                         5.760000000000001,
                                         6.,
                                         6.24,
                                         4.,
                                         4.16,
                                         4.32,
                                         4.48,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         3.7200000000000006,
                                         3.8400000000000003,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.7199999999999998,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         1.48,
                                         1.52,
                                         1.56,
                                         1.6,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92,
                                         3.44,
                                         3.52,
                                         3.6,
                                         3.68,
                                         7.2,
                                         7.36,
                                         7.5200000000000005,
                                         7.680000000000001,
                                         11.280000000000001,
                                         11.52,
                                         11.76,
                                         12.000000000000002,
                                         11.280000000000001,
                                         11.52,
                                         11.76,
                                         12.000000000000002,
                                         11.280000000000001,
                                         11.52,
                                         11.76,
                                         12.000000000000002,
                                         7.840000000000001,
                                         8.,
                                         8.16,
                                         8.32,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         5.88,
                                         6.,
                                         6.12,
                                         6.24,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         13.200000000000001,
                                         13.440000000000001,
                                         13.68,
                                         13.920000000000002,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.2,
                                         5.88,
                                         6.,
                                         6.12,
                                         6.24,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         13.200000000000001,
                                         13.440000000000001,
                                         13.68,
                                         13.920000000000002,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.2,
                                         5.88,
                                         6.,
                                         6.12,
                                         6.24,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         19.080000000000002,
                                         19.44,
                                         19.8,
                                         20.16,
                                         13.200000000000001,
                                         13.440000000000001,
                                         13.68,
                                         13.920000000000002,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.2,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         9.12,
                                         9.280000000000001,
                                         9.44,
                                         9.600000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         9.76,
                                         9.920000000000002,
                                         10.08,
                                         10.240000000000002,
                                         5.040000000000001,
                                         5.12,
                                         5.199999999999999,
                                         5.279999999999999,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56,
                                         5.04,
                                         5.12,
                                         5.2,
                                         5.28,
                                         7.800000000000001,
                                         7.92,
                                         8.04,
                                         8.16,
                                         7.800000000000001,
                                         7.92,
                                         8.04,
                                         8.16,
                                         7.800000000000001,
                                         7.92,
                                         8.04,
                                         8.16,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         2.7600000000000002,
                                         2.8000000000000003,
                                         2.84,
                                         2.88,
                                         2.92,
                                         2.96,
                                         3.,
                                         3.04,
                                         6.,
                                         6.08,
                                         6.16,
                                         6.24,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         6.32,
                                         6.4,
                                         6.48,
                                         6.5600000000000005,
                                         3.24,
                                         3.2800000000000002,
                                         3.3200000000000003,
                                         3.36,
                                         6.32,
                                         6.4,
                                         6.48,
                                         6.5600000000000005,
                                         12.96,
                                         13.12,
                                         13.280000000000001,
                                         13.44,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         13.600000000000001,
                                         13.76,
                                         13.920000000000002,
                                         14.08,
                                         6.960000000000001,
                                         7.040000000000001,
                                         7.120000000000001,
                                         7.199999999999999,
                                         10.2,
                                         10.32,
                                         10.440000000000001,
                                         10.56,
                                         20.88,
                                         21.119999999999997,
                                         21.360000000000003,
                                         21.599999999999998,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         21.84,
                                         22.08,
                                         22.320000000000004,
                                         22.560000000000002,
                                         11.16,
                                         11.280000000000001,
                                         11.400000000000002,
                                         11.52,
                                         10.2,
                                         10.32,
                                         10.440000000000001,
                                         10.56,
                                         20.88,
                                         21.119999999999997,
                                         21.360000000000003,
                                         21.599999999999998,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         21.84,
                                         22.08,
                                         22.320000000000004,
                                         22.560000000000002,
                                         11.16,
                                         11.280000000000001,
                                         11.400000000000002,
                                         11.52,
                                         10.2,
                                         10.32,
                                         10.440000000000001,
                                         10.56,
                                         20.88,
                                         21.119999999999997,
                                         21.360000000000003,
                                         21.599999999999998,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         21.84,
                                         22.08,
                                         22.320000000000004,
                                         22.560000000000002,
                                         11.16,
                                         11.280000000000001,
                                         11.400000000000002,
                                         11.52,
                                         7.279999999999999,
                                         7.359999999999999,
                                         7.4399999999999995,
                                         7.52,
                                         14.879999999999999,
                                         15.040000000000001,
                                         15.2,
                                         15.36,
                                         22.799999999999997,
                                         23.04,
                                         23.28,
                                         23.52,
                                         22.799999999999997,
                                         23.04,
                                         23.28,
                                         23.52,
                                         22.799999999999997,
                                         23.04,
                                         23.28,
                                         23.52,
                                         15.52,
                                         15.680000000000001,
                                         15.84,
                                         16.,
                                         7.92,
                                         8.,
                                         8.08,
                                         8.16,
                                         3.88,
                                         3.92,
                                         3.96,
                                         4.,
                                         7.92,
                                         8.,
                                         8.08,
                                         8.16,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         8.24,
                                         8.32,
                                         8.4,
                                         8.48,
                                         4.2,
                                         4.24,
                                         4.28,
                                         4.32};
  const std::array<int, 4> in_shape = {{3, 7, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {5.196111111111111,
                                         6.862777777777778,
                                         8.686111111111112,
                                         8.671666666666667,
                                         9.650833333333333,
                                         11.963055555555556,
                                         10.296388888888888,
                                         8.473055555555556,
                                         9.242777777777778,
                                         12.029444444444444,
                                         15.012777777777778,
                                         14.531666666666666,
                                         15.760833333333334,
                                         19.12638888888889,
                                         16.33972222222222,
                                         13.356388888888889,
                                         14.542777777777777,
                                         18.769444444444442,
                                         23.232777777777777,
                                         22.071666666666665,
                                         23.550833333333333,
                                         28.18305555555556,
                                         23.95638888888889,
                                         19.493055555555557,
                                         22.256666666666664,
                                         28.416666666666664,
                                         34.79666666666667,
                                         32.23,
                                         33.605000000000004,
                                         39.39833333333333,
                                         33.23833333333334,
                                         26.858333333333334,
                                         33.34277777777777,
                                         42.36944444444444,
                                         51.632777777777775,
                                         47.27166666666666,
                                         48.75083333333334,
                                         56.58305555555556,
                                         47.5563888888889,
                                         38.293055555555554,
                                         30.54944444444444,
                                         38.776111111111106,
                                         47.19944444444444,
                                         43.09166666666666,
                                         44.32083333333333,
                                         51.31305555555556,
                                         43.08638888888889,
                                         34.66305555555556,
                                         26.502777777777773,
                                         33.60944444444444,
                                         40.87277777777777,
                                         37.23166666666667,
                                         38.21083333333333,
                                         44.14972222222222,
                                         37.043055555555554,
                                         29.779722222222222,
                                         39.55833333333334,
                                         49.998333333333335,
                                         60.595000000000006,
                                         54.73166666666667,
                                         55.710833333333326,
                                         63.871944444444445,
                                         53.43194444444444,
                                         42.83527777777778,
                                         52.37833333333334,
                                         66.17833333333334,
                                         80.175,
                                         72.35166666666667,
                                         73.58083333333332,
                                         84.28861111111111,
                                         70.4886111111111,
                                         56.49194444444445,
                                         66.45166666666667,
                                         83.93166666666669,
                                         101.64833333333334,
                                         91.65166666666669,
                                         93.13083333333333,
                                         106.59861111111113,
                                         89.11861111111111,
                                         71.40194444444445,
                                         70.51,
                                         88.99000000000001,
                                         107.69,
                                         96.91,
                                         98.285,
                                         112.29166666666667,
                                         93.81166666666667,
                                         75.11166666666666,
                                         85.25166666666667,
                                         107.53166666666668,
                                         130.04833333333335,
                                         116.85166666666665,
                                         118.33083333333333,
                                         134.9986111111111,
                                         112.7186111111111,
                                         90.20194444444444,
                                         73.685,
                                         92.925,
                                         112.36166666666665,
                                         100.91166666666668,
                                         102.14083333333333,
                                         116.47527777777778,
                                         97.23527777777777,
                                         77.79861111111111,
                                         60.865,
                                         76.74499999999999,
                                         92.78166666666667,
                                         83.29166666666666,
                                         84.27083333333333,
                                         96.0586111111111,
                                         80.17861111111111,
                                         64.14194444444445,
                                         73.92055555555555,
                                         93.13388888888888,
                                         112.5038888888889,
                                         100.79166666666667,
                                         101.77083333333333,
                                         115.78083333333332,
                                         96.56750000000001,
                                         77.19749999999999,
                                         95.51388888888889,
                                         120.32722222222222,
                                         145.3372222222222,
                                         130.17166666666668,
                                         131.40083333333334,
                                         149.45083333333332,
                                         124.63750000000002,
                                         99.6275,
                                         118.36055555555555,
                                         149.09388888888887,
                                         180.06388888888887,
                                         161.23166666666668,
                                         162.71083333333334,
                                         185.01416666666665,
                                         154.28083333333336,
                                         123.31083333333333,
                                         118.76333333333334,
                                         149.56333333333333,
                                         180.58333333333334,
                                         161.59000000000003,
                                         162.96500000000003,
                                         185.185,
                                         154.385,
                                         123.365,
                                         137.16055555555556,
                                         172.6938888888889,
                                         208.4638888888889,
                                         186.43166666666667,
                                         187.91083333333333,
                                         213.41416666666666,
                                         177.88083333333333,
                                         142.11083333333332,
                                         116.82055555555556,
                                         147.0738888888889,
                                         177.5238888888889,
                                         158.73166666666668,
                                         159.96083333333334,
                                         181.6375,
                                         151.38416666666666,
                                         120.93416666666667,
                                         95.22722222222222,
                                         119.88055555555556,
                                         144.69055555555553,
                                         129.35166666666666,
                                         130.33083333333332,
                                         147.96749999999997,
                                         123.31416666666667,
                                         98.50416666666666};
  const std::array<int, 4> in_shape = {{3, 7, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.4,
                                         0.4,
                                         0.36,
                                         0.28,
                                         0.16,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         0.56,
                                         1.2000000000000002,
                                         1.92,
                                         2.7199999999999998,
                                         2.7199999999999998,
                                         2.16,
                                         1.52,
                                         0.8,
                                         0.36,
                                         0.76,
                                         1.2,
                                         1.68,
                                         1.68,
                                         1.32,
                                         0.9199999999999999,
                                         0.48,
                                         0.52,
                                         1.08,
                                         1.6800000000000002,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         1.8000000000000003,
                                         1.24,
                                         0.64,
                                         1.2000000000000002,
                                         2.4800000000000004,
                                         3.84,
                                         5.28,
                                         5.28,
                                         4.08,
                                         2.8,
                                         1.44,
                                         2.04,
                                         4.2,
                                         6.4799999999999995,
                                         8.879999999999999,
                                         8.879999999999999,
                                         6.84,
                                         4.68,
                                         2.4,
                                         2.04,
                                         4.2,
                                         6.4799999999999995,
                                         8.879999999999999,
                                         8.879999999999999,
                                         6.84,
                                         4.68,
                                         2.4,
                                         2.04,
                                         4.2,
                                         6.4799999999999995,
                                         8.879999999999999,
                                         8.879999999999999,
                                         6.84,
                                         4.68,
                                         2.4,
                                         1.52,
                                         3.1199999999999997,
                                         4.8,
                                         6.56,
                                         6.56,
                                         5.04,
                                         3.44,
                                         1.76,
                                         0.84,
                                         1.72,
                                         2.64,
                                         3.6,
                                         3.6,
                                         2.76,
                                         1.88,
                                         0.96,
                                         1.,
                                         2.04,
                                         3.12,
                                         4.24,
                                         4.24,
                                         3.24,
                                         2.2,
                                         1.12,
                                         2.16,
                                         4.4,
                                         6.720000000000001,
                                         9.120000000000001,
                                         9.120000000000001,
                                         6.960000000000001,
                                         4.720000000000001,
                                         2.4000000000000004,
                                         3.4800000000000004,
                                         7.080000000000001,
                                         10.8,
                                         14.64,
                                         14.64,
                                         11.16,
                                         7.5600000000000005,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         7.080000000000001,
                                         10.8,
                                         14.64,
                                         14.64,
                                         11.16,
                                         7.5600000000000005,
                                         3.8400000000000003,
                                         3.4800000000000004,
                                         7.080000000000001,
                                         10.8,
                                         14.64,
                                         14.64,
                                         11.16,
                                         7.5600000000000005,
                                         3.8400000000000003,
                                         2.48,
                                         5.04,
                                         7.680000000000001,
                                         10.4,
                                         10.4,
                                         7.92,
                                         5.359999999999999,
                                         2.7199999999999998,
                                         1.32,
                                         2.68,
                                         4.08,
                                         5.52,
                                         5.52,
                                         4.2,
                                         2.84,
                                         1.44};
  const std::array<int, 4> in_shape = {{3, 7, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {9.778611111111111,
                                         10.392222222222221,
                                         12.955277777777779,
                                         13.725555555555555,
                                         16.44527777777778,
                                         17.372222222222224,
                                         16.520833333333336,
                                         17.343333333333334,
                                         18.479166666666668,
                                         19.301666666666666,
                                         22.999166666666667,
                                         23.926111111111112,
                                         19.822499999999998,
                                         20.592777777777776,
                                         16.3325,
                                         16.94611111111111,
                                         17.71527777777778,
                                         18.485555555555557,
                                         23.091944444444447,
                                         24.058888888888887,
                                         28.861944444444447,
                                         30.025555555555556,
                                         28.030833333333337,
                                         29.063333333333333,
                                         30.48916666666667,
                                         31.52166666666667,
                                         37.08916666666667,
                                         38.25277777777778,
                                         31.7125,
                                         32.67944444444444,
                                         25.9425,
                                         26.712777777777777,
                                         28.158611111111114,
                                         29.085555555555555,
                                         36.37527777777778,
                                         37.538888888888884,
                                         45.06527777777778,
                                         46.465555555555554,
                                         42.90083333333334,
                                         44.14333333333333,
                                         45.859166666666674,
                                         47.10166666666667,
                                         54.96583333333334,
                                         56.36611111111112,
                                         46.74916666666667,
                                         47.91277777777778,
                                         38.05916666666666,
                                         38.986111111111114,
                                         43.65166666666667,
                                         44.51333333333333,
                                         55.75166666666667,
                                         56.83333333333333,
                                         68.29166666666667,
                                         69.59333333333333,
                                         63.305000000000014,
                                         64.46,
                                         66.055,
                                         67.21000000000001,
                                         77.495,
                                         78.79666666666667,
                                         65.395,
                                         66.47666666666667,
                                         52.855,
                                         53.71666666666667,
                                         65.75861111111111,
                                         66.68555555555554,
                                         83.57527777777779,
                                         84.73888888888888,
                                         101.86527777777778,
                                         103.26555555555555,
                                         93.30083333333332,
                                         94.54333333333332,
                                         96.25916666666664,
                                         97.50166666666668,
                                         111.76583333333332,
                                         113.16611111111112,
                                         93.94916666666666,
                                         95.1127777777778,
                                         75.65916666666666,
                                         76.58611111111111,
                                         60.32861111111111,
                                         61.09888888888888,
                                         76.58527777777778,
                                         77.55222222222221,
                                         93.23527777777778,
                                         94.39888888888888,
                                         85.15083333333334,
                                         86.18333333333332,
                                         87.60916666666667,
                                         88.64166666666667,
                                         101.46249999999998,
                                         102.62611111111111,
                                         85.20583333333333,
                                         86.17277777777778,
                                         68.55583333333333,
                                         69.32611111111112,
                                         52.39194444444445,
                                         53.005555555555546,
                                         66.4486111111111,
                                         67.21888888888888,
                                         80.81861111111111,
                                         81.74555555555554,
                                         73.64083333333332,
                                         74.46333333333334,
                                         75.59916666666666,
                                         76.42166666666667,
                                         87.37249999999999,
                                         88.29944444444445,
                                         73.31583333333333,
                                         74.08611111111111,
                                         58.945833333333326,
                                         59.559444444444445,
                                         78.50305555555553,
                                         79.11666666666667,
                                         99.22638888888888,
                                         99.99666666666667,
                                         120.26305555555555,
                                         121.19000000000001,
                                         108.64083333333333,
                                         109.46333333333334,
                                         110.59916666666666,
                                         111.42166666666665,
                                         126.81694444444445,
                                         127.74388888888889,
                                         106.0936111111111,
                                         106.86388888888888,
                                         85.05694444444443,
                                         85.67055555555557,
                                         103.98638888888887,
                                         104.75666666666667,
                                         131.38972222222222,
                                         132.35666666666668,
                                         159.18638888888887,
                                         160.35,
                                         143.67083333333332,
                                         144.70333333333335,
                                         146.12916666666666,
                                         147.16166666666663,
                                         167.4136111111111,
                                         168.57722222222222,
                                         140.01027777777776,
                                         140.9772222222222,
                                         112.2136111111111,
                                         112.9838888888889,
                                         131.97638888888886,
                                         132.90333333333334,
                                         166.69972222222222,
                                         167.86333333333337,
                                         201.89638888888888,
                                         203.29666666666668,
                                         182.0608333333333,
                                         183.30333333333337,
                                         185.01916666666665,
                                         186.26166666666666,
                                         211.7969444444444,
                                         213.19722222222225,
                                         177.07361111111106,
                                         178.23722222222221,
                                         141.87694444444443,
                                         142.8038888888889,
                                         140.15833333333333,
                                         141.02,
                                         176.8983333333333,
                                         177.98000000000002,
                                         214.07833333333335,
                                         215.38,
                                         192.66500000000002,
                                         193.82,
                                         195.415,
                                         196.57,
                                         223.28166666666664,
                                         224.58333333333334,
                                         186.5416666666667,
                                         187.62333333333333,
                                         149.36166666666668,
                                         150.22333333333333,
                                         169.57638888888889,
                                         170.50333333333333,
                                         213.89972222222224,
                                         215.06333333333336,
                                         258.6963888888889,
                                         260.0966666666667,
                                         232.46083333333337,
                                         233.7033333333333,
                                         235.41916666666665,
                                         236.66166666666666,
                                         268.5969444444445,
                                         269.9972222222222,
                                         224.2736111111111,
                                         225.4372222222222,
                                         179.47694444444443,
                                         180.40388888888887,
                                         146.59972222222223,
                                         147.37,
                                         184.88305555555556,
                                         185.85,
                                         223.55972222222223,
                                         224.7233333333333,
                                         200.79083333333335,
                                         201.82333333333335,
                                         203.24916666666667,
                                         204.28166666666667,
                                         231.78694444444443,
                                         232.95055555555555,
                                         193.5036111111111,
                                         194.47055555555553,
                                         154.82694444444445,
                                         155.59722222222223,
                                         121.1163888888889,
                                         121.73,
                                         152.71972222222223,
                                         153.48999999999998,
                                         184.63638888888892,
                                         185.56333333333333,
                                         165.76083333333332,
                                         166.58333333333331,
                                         167.71916666666667,
                                         168.54166666666666,
                                         191.19027777777777,
                                         192.1172222222222,
                                         159.5869444444444,
                                         160.35722222222222,
                                         127.67027777777776,
                                         128.2838888888889,
                                         147.2275,
                                         147.8411111111111,
                                         185.49749999999997,
                                         186.26777777777775,
                                         224.0808333333333,
                                         225.0077777777778,
                                         200.76083333333332,
                                         201.58333333333334,
                                         202.71916666666667,
                                         203.54166666666666,
                                         230.63472222222222,
                                         231.56166666666664,
                                         192.3647222222222,
                                         193.13500000000002,
                                         153.78138888888887,
                                         154.39499999999998,
                                         190.2575,
                                         191.02777777777777,
                                         239.68749999999997,
                                         240.65444444444444,
                                         289.51083333333327,
                                         290.6744444444444,
                                         259.31083333333333,
                                         260.34333333333336,
                                         261.7691666666667,
                                         262.8016666666667,
                                         297.73805555555555,
                                         298.90166666666664,
                                         248.30805555555554,
                                         249.27500000000003,
                                         198.4847222222222,
                                         199.255,
                                         235.79416666666665,
                                         236.7211111111111,
                                         297.0241666666667,
                                         298.18777777777774,
                                         358.72749999999996,
                                         360.12777777777774,
                                         321.22083333333336,
                                         322.46333333333337,
                                         324.17916666666673,
                                         325.4216666666667,
                                         368.62805555555553,
                                         370.0283333333333,
                                         307.3980555555555,
                                         308.5616666666667,
                                         245.6947222222222,
                                         246.62166666666667,
                                         236.66500000000002,
                                         237.52666666666667,
                                         298.045,
                                         299.12666666666667,
                                         359.86499999999995,
                                         361.1666666666667,
                                         322.025,
                                         323.18000000000006,
                                         324.77500000000003,
                                         325.93000000000006,
                                         369.0683333333333,
                                         370.37,
                                         307.68833333333333,
                                         308.77,
                                         245.86833333333334,
                                         246.73,
                                         273.39416666666665,
                                         274.3211111111111,
                                         344.22416666666675,
                                         345.3877777777778,
                                         415.52750000000003,
                                         416.9277777777778,
                                         371.6208333333334,
                                         372.86333333333334,
                                         374.57916666666677,
                                         375.82166666666666,
                                         425.42805555555555,
                                         426.8283333333333,
                                         354.59805555555556,
                                         355.76166666666666,
                                         283.2947222222222,
                                         284.22166666666664,
                                         232.87083333333328,
                                         233.64111111111112,
                                         293.18083333333334,
                                         294.1477777777778,
                                         353.8841666666667,
                                         355.0477777777778,
                                         316.4308333333333,
                                         317.46333333333337,
                                         318.88916666666665,
                                         319.9216666666667,
                                         362.1113888888889,
                                         363.275,
                                         301.8013888888889,
                                         302.7683333333333,
                                         241.09805555555556,
                                         241.86833333333334,
                                         189.8408333333333,
                                         190.45444444444445,
                                         238.9908333333333,
                                         239.76111111111112,
                                         288.45416666666665,
                                         289.38111111111107,
                                         257.8808333333333,
                                         258.7033333333333,
                                         259.83916666666664,
                                         260.66166666666663,
                                         295.0080555555556,
                                         295.93499999999995,
                                         245.85805555555558,
                                         246.62833333333333,
                                         196.39472222222224,
                                         197.00833333333333};
  const std::array<int, 4> in_shape = {{3, 7, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.6000000000000001,
                                         0.72,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         1.04,
                                         1.12,
                                         2.24,
                                         2.4000000000000004,
                                         3.5999999999999996,
                                         3.84,
                                         5.12,
                                         5.4399999999999995,
                                         5.12,
                                         5.4399999999999995,
                                         4.08,
                                         4.32,
                                         2.88,
                                         3.04,
                                         1.52,
                                         1.6,
                                         0.68,
                                         0.72,
                                         1.44,
                                         1.52,
                                         2.28,
                                         2.4,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         3.24,
                                         3.3600000000000003,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         2.4,
                                         2.48,
                                         1.24,
                                         1.28,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         4.800000000000001,
                                         4.960000000000001,
                                         7.440000000000001,
                                         7.68,
                                         10.240000000000002,
                                         10.56,
                                         10.240000000000002,
                                         10.56,
                                         7.920000000000002,
                                         8.16,
                                         5.4399999999999995,
                                         5.6,
                                         2.8,
                                         2.88,
                                         3.9600000000000004,
                                         4.08,
                                         8.160000000000002,
                                         8.4,
                                         12.600000000000003,
                                         12.959999999999999,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         13.320000000000004,
                                         13.68,
                                         9.12,
                                         9.36,
                                         4.68,
                                         4.8,
                                         3.9600000000000004,
                                         4.08,
                                         8.160000000000002,
                                         8.4,
                                         12.600000000000003,
                                         12.959999999999999,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         13.320000000000004,
                                         13.68,
                                         9.12,
                                         9.36,
                                         4.68,
                                         4.8,
                                         3.9600000000000004,
                                         4.08,
                                         8.160000000000002,
                                         8.4,
                                         12.600000000000003,
                                         12.959999999999999,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         13.320000000000004,
                                         13.68,
                                         9.12,
                                         9.36,
                                         4.68,
                                         4.8,
                                         2.96,
                                         3.04,
                                         6.08,
                                         6.239999999999999,
                                         9.36,
                                         9.6,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         9.84,
                                         10.08,
                                         6.72,
                                         6.88,
                                         3.4400000000000004,
                                         3.52,
                                         1.6400000000000001,
                                         1.68,
                                         3.3600000000000003,
                                         3.44,
                                         5.16,
                                         5.28,
                                         7.04,
                                         7.2,
                                         7.04,
                                         7.2,
                                         5.4,
                                         5.52,
                                         3.68,
                                         3.76,
                                         1.8800000000000001,
                                         1.92,
                                         1.96,
                                         2.,
                                         4.,
                                         4.08,
                                         6.12,
                                         6.24,
                                         8.32,
                                         8.48,
                                         8.32,
                                         8.48,
                                         6.36,
                                         6.48,
                                         4.32,
                                         4.4,
                                         2.2,
                                         2.24,
                                         4.24,
                                         4.32,
                                         8.64,
                                         8.8,
                                         13.2,
                                         13.440000000000001,
                                         17.92,
                                         18.240000000000002,
                                         17.92,
                                         18.240000000000002,
                                         13.68,
                                         13.920000000000002,
                                         9.28,
                                         9.440000000000001,
                                         4.720000000000001,
                                         4.800000000000001,
                                         6.84,
                                         6.960000000000001,
                                         13.92,
                                         14.160000000000002,
                                         21.240000000000002,
                                         21.6,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         21.96,
                                         22.32,
                                         14.879999999999999,
                                         15.120000000000001,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         6.84,
                                         6.960000000000001,
                                         13.92,
                                         14.160000000000002,
                                         21.240000000000002,
                                         21.6,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         21.96,
                                         22.32,
                                         14.879999999999999,
                                         15.120000000000001,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         6.84,
                                         6.960000000000001,
                                         13.92,
                                         14.160000000000002,
                                         21.240000000000002,
                                         21.6,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         21.96,
                                         22.32,
                                         14.879999999999999,
                                         15.120000000000001,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         4.880000000000001,
                                         4.96,
                                         9.92,
                                         10.08,
                                         15.12,
                                         15.360000000000001,
                                         20.48,
                                         20.8,
                                         20.48,
                                         20.8,
                                         15.6,
                                         15.84,
                                         10.56,
                                         10.719999999999999,
                                         5.359999999999999,
                                         5.4399999999999995,
                                         2.6,
                                         2.64,
                                         5.28,
                                         5.36,
                                         8.040000000000001,
                                         8.16,
                                         10.88,
                                         11.04,
                                         10.88,
                                         11.04,
                                         8.280000000000001,
                                         8.4,
                                         5.6,
                                         5.68,
                                         2.84,
                                         2.88};
  const std::array<int, 4> in_shape = {{3, 7, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         55.39027777777778,
                                         56.31722222222223,
                                         57.24416666666667,
                                         58.17111111111111,
                                         71.58694444444446,
                                         72.75055555555556,
                                         73.91416666666666,
                                         75.07777777777777,
                                         88.7302777777778,
                                         90.13055555555556,
                                         91.53083333333333,
                                         92.93111111111111,
                                         84.55916666666666,
                                         85.80166666666668,
                                         87.04416666666665,
                                         88.28666666666666,
                                         90.47583333333334,
                                         91.71833333333335,
                                         92.96083333333333,
                                         94.20333333333333,
                                         108.5313888888889,
                                         109.93166666666669,
                                         111.33194444444445,
                                         112.73222222222223,
                                         92.33472222222224,
                                         93.49833333333333,
                                         94.66194444444444,
                                         95.82555555555555,
                                         75.1913888888889,
                                         76.11833333333333,
                                         77.04527777777777,
                                         77.97222222222223,
                                         86.44166666666668,
                                         87.30333333333334,
                                         88.165,
                                         89.02666666666666,
                                         110.42166666666668,
                                         111.50333333333334,
                                         112.585,
                                         113.66666666666666,
                                         135.2816666666667,
                                         136.58333333333334,
                                         137.885,
                                         139.18666666666667,
                                         125.455,
                                         126.61000000000003,
                                         127.765,
                                         128.92,
                                         130.95499999999998,
                                         132.11,
                                         133.26500000000001,
                                         134.42000000000002,
                                         153.68833333333333,
                                         154.99,
                                         156.29166666666666,
                                         157.59333333333333,
                                         129.70833333333331,
                                         130.79,
                                         131.87166666666667,
                                         132.95333333333335,
                                         104.84833333333333,
                                         105.71,
                                         106.57166666666667,
                                         107.43333333333334,
                                         130.59027777777777,
                                         131.51722222222222,
                                         132.44416666666666,
                                         133.37111111111108,
                                         165.98694444444445,
                                         167.15055555555557,
                                         168.3141666666667,
                                         169.47777777777776,
                                         202.33027777777778,
                                         203.73055555555555,
                                         205.13083333333336,
                                         206.5311111111111,
                                         185.35916666666665,
                                         186.60166666666663,
                                         187.8441666666667,
                                         189.08666666666664,
                                         191.2758333333333,
                                         192.5183333333333,
                                         193.76083333333338,
                                         195.00333333333336,
                                         222.13138888888886,
                                         223.53166666666664,
                                         224.93194444444447,
                                         226.33222222222224,
                                         186.7347222222222,
                                         187.8983333333333,
                                         189.06194444444446,
                                         190.2255555555556,
                                         150.39138888888888,
                                         151.31833333333333,
                                         152.24527777777777,
                                         153.17222222222222,
                                         119.88694444444445,
                                         120.65722222222222,
                                         121.4275,
                                         122.19777777777776,
                                         152.20361111111112,
                                         153.17055555555555,
                                         154.13750000000002,
                                         155.10444444444443,
                                         185.30694444444444,
                                         186.47055555555556,
                                         187.6341666666667,
                                         188.79777777777775,
                                         169.26916666666665,
                                         170.30166666666668,
                                         171.3341666666667,
                                         172.36666666666665,
                                         174.18583333333333,
                                         175.21833333333333,
                                         176.25083333333336,
                                         177.28333333333333,
                                         201.76138888888886,
                                         202.92499999999995,
                                         204.08861111111113,
                                         205.25222222222223,
                                         169.44472222222223,
                                         170.41166666666666,
                                         171.37861111111113,
                                         172.34555555555556,
                                         136.34138888888887,
                                         137.11166666666665,
                                         137.88194444444443,
                                         138.65222222222224,
                                         104.17027777777778,
                                         104.7838888888889,
                                         105.3975,
                                         106.01111111111109,
                                         132.12694444444443,
                                         132.8972222222222,
                                         133.6675,
                                         134.43777777777777,
                                         160.71027777777778,
                                         161.63722222222222,
                                         162.56416666666667,
                                         163.49111111111108,
                                         146.45916666666665,
                                         147.28166666666664,
                                         148.10416666666669,
                                         148.92666666666668,
                                         150.37583333333336,
                                         151.19833333333332,
                                         152.02083333333334,
                                         152.84333333333333,
                                         173.81805555555556,
                                         174.74499999999998,
                                         175.67194444444445,
                                         176.5988888888889,
                                         145.86138888888888,
                                         146.63166666666666,
                                         147.40194444444444,
                                         148.17222222222222,
                                         117.27805555555555,
                                         117.89166666666665,
                                         118.50527777777776,
                                         119.11888888888889,
                                         156.3925,
                                         157.00611111111107,
                                         157.61972222222224,
                                         158.23333333333335,
                                         197.68249999999995,
                                         198.45277777777775,
                                         199.2230555555556,
                                         199.99333333333334,
                                         239.59916666666663,
                                         240.5261111111111,
                                         241.45305555555558,
                                         242.38000000000002,
                                         216.45916666666665,
                                         217.28166666666667,
                                         218.10416666666669,
                                         218.92666666666668,
                                         220.3758333333333,
                                         221.19833333333332,
                                         222.02083333333334,
                                         222.8433333333333,
                                         252.70694444444442,
                                         253.6338888888889,
                                         254.56083333333328,
                                         255.48777777777778,
                                         211.41694444444445,
                                         212.1872222222222,
                                         212.95749999999998,
                                         213.72777777777776,
                                         169.50027777777777,
                                         170.11388888888885,
                                         170.72749999999996,
                                         171.34111111111113,
                                         207.20250000000001,
                                         207.97277777777774,
                                         208.74305555555557,
                                         209.51333333333335,
                                         261.81249999999994,
                                         262.77944444444444,
                                         263.74638888888893,
                                         264.71333333333337,
                                         317.20916666666665,
                                         318.37277777777774,
                                         319.5363888888889,
                                         320.7,
                                         286.30916666666667,
                                         287.34166666666664,
                                         288.3741666666667,
                                         289.4066666666667,
                                         291.2258333333333,
                                         292.2583333333333,
                                         293.2908333333334,
                                         294.32333333333327,
                                         333.6636111111111,
                                         334.8272222222222,
                                         335.9908333333333,
                                         337.15444444444444,
                                         279.0536111111111,
                                         280.0205555555555,
                                         280.98749999999995,
                                         281.9544444444444,
                                         223.65694444444443,
                                         224.4272222222222,
                                         225.19749999999996,
                                         225.9677777777778,
                                         263.02583333333337,
                                         263.9527777777777,
                                         264.8797222222222,
                                         265.8066666666667,
                                         332.23583333333335,
                                         333.39944444444444,
                                         334.5630555555556,
                                         335.72666666666674,
                                         402.3925,
                                         403.79277777777776,
                                         405.19305555555553,
                                         406.59333333333336,
                                         362.8791666666667,
                                         364.1216666666666,
                                         365.3641666666667,
                                         366.60666666666674,
                                         368.79583333333335,
                                         370.0383333333333,
                                         371.28083333333336,
                                         372.5233333333333,
                                         422.1936111111111,
                                         423.5938888888888,
                                         424.9941666666666,
                                         426.3944444444445,
                                         352.9836111111111,
                                         354.1472222222221,
                                         355.3108333333332,
                                         356.47444444444443,
                                         282.8269444444444,
                                         283.75388888888887,
                                         284.68083333333334,
                                         285.6077777777778,
                                         279.455,
                                         280.31666666666666,
                                         281.1783333333333,
                                         282.04,
                                         352.715,
                                         353.7966666666666,
                                         354.87833333333333,
                                         355.96000000000004,
                                         426.85499999999996,
                                         428.1566666666667,
                                         429.45833333333326,
                                         430.76,
                                         384.175,
                                         385.33000000000004,
                                         386.485,
                                         387.64,
                                         389.675,
                                         390.83,
                                         391.985,
                                         393.14,
                                         445.2616666666667,
                                         446.5633333333333,
                                         447.8649999999999,
                                         449.1666666666667,
                                         372.0016666666666,
                                         373.0833333333334,
                                         374.165,
                                         375.24666666666667,
                                         297.8616666666666,
                                         298.72333333333336,
                                         299.585,
                                         300.44666666666666,
                                         338.2258333333333,
                                         339.15277777777777,
                                         340.0797222222222,
                                         341.00666666666666,
                                         426.63583333333327,
                                         427.7994444444445,
                                         428.96305555555557,
                                         430.1266666666667,
                                         515.9925,
                                         517.3927777777778,
                                         518.7930555555555,
                                         520.1933333333334,
                                         463.6791666666666,
                                         464.92166666666674,
                                         466.1641666666667,
                                         467.4066666666666,
                                         469.5958333333333,
                                         470.8383333333333,
                                         472.0808333333333,
                                         473.3233333333333,
                                         535.7936111111111,
                                         537.193888888889,
                                         538.5941666666666,
                                         539.9944444444444,
                                         447.3836111111112,
                                         448.5472222222222,
                                         449.71083333333337,
                                         450.8744444444444,
                                         358.02694444444444,
                                         358.95388888888886,
                                         359.8808333333333,
                                         360.80777777777774,
                                         292.4291666666666,
                                         293.19944444444445,
                                         293.9697222222222,
                                         294.74,
                                         368.7991666666666,
                                         369.7661111111111,
                                         370.73305555555555,
                                         371.7,
                                         445.9558333333333,
                                         447.11944444444447,
                                         448.28305555555556,
                                         449.4466666666666,
                                         400.5491666666667,
                                         401.5816666666667,
                                         402.6141666666667,
                                         403.6466666666667,
                                         405.46583333333336,
                                         406.49833333333333,
                                         407.5308333333333,
                                         408.56333333333333,
                                         462.4102777777778,
                                         463.57388888888886,
                                         464.7375,
                                         465.9011111111111,
                                         386.0402777777778,
                                         387.0072222222222,
                                         387.9741666666667,
                                         388.94111111111107,
                                         308.8836111111111,
                                         309.6538888888889,
                                         310.4241666666667,
                                         311.19444444444446,
                                         241.61916666666664,
                                         242.2327777777778,
                                         242.84638888888887,
                                         243.46,
                                         304.6691666666666,
                                         305.43944444444446,
                                         306.2097222222222,
                                         306.97999999999996,
                                         368.3458333333333,
                                         369.27277777777783,
                                         370.1997222222222,
                                         371.12666666666667,
                                         330.69916666666666,
                                         331.52166666666665,
                                         332.34416666666664,
                                         333.16666666666663,
                                         334.61583333333334,
                                         335.43833333333333,
                                         336.2608333333333,
                                         337.0833333333333,
                                         381.4536111111111,
                                         382.38055555555553,
                                         383.3075,
                                         384.2344444444444,
                                         318.4036111111111,
                                         319.1738888888888,
                                         319.94416666666666,
                                         320.71444444444444,
                                         254.72694444444443,
                                         255.3405555555555,
                                         255.95416666666665,
                                         256.5677777777778,
                                         213.62805555555553,
                                         214.24166666666667,
                                         214.85527777777776,
                                         215.4688888888889,
                                         269.53138888888884,
                                         270.3016666666666,
                                         271.0719444444445,
                                         271.8422222222222,
                                         326.06138888888887,
                                         326.9883333333333,
                                         327.91527777777776,
                                         328.84222222222223,
                                         293.1791666666666,
                                         294.00166666666667,
                                         294.8241666666667,
                                         295.64666666666665,
                                         297.0958333333333,
                                         297.91833333333335,
                                         298.74083333333334,
                                         299.56333333333333,
                                         339.1691666666666,
                                         340.09611111111116,
                                         341.0230555555556,
                                         341.94999999999993,
                                         283.2658333333333,
                                         284.03611111111115,
                                         284.80638888888893,
                                         285.57666666666665,
                                         226.73583333333335,
                                         227.34944444444443,
                                         227.9630555555555,
                                         228.57666666666665,
                                         219.3180555555555,
                                         220.08833333333337,
                                         220.8586111111111,
                                         221.6288888888889,
                                         277.02138888888885,
                                         277.98833333333323,
                                         278.95527777777784,
                                         279.92222222222216,
                                         335.51138888888886,
                                         336.6749999999999,
                                         337.8386111111111,
                                         339.0022222222222,
                                         302.5491666666666,
                                         303.58166666666665,
                                         304.61416666666673,
                                         305.64666666666665,
                                         307.4658333333333,
                                         308.49833333333333,
                                         309.53083333333336,
                                         310.56333333333333,
                                         351.9658333333333,
                                         353.12944444444446,
                                         354.29305555555555,
                                         355.4566666666666,
                                         294.2625,
                                         295.2294444444445,
                                         296.1963888888889,
                                         297.1633333333333,
                                         235.7725,
                                         236.54277777777776,
                                         237.31305555555548,
                                         238.08333333333334,
                                         230.02138888888882,
                                         230.94833333333338,
                                         231.87527777777777,
                                         232.8022222222222,
                                         290.80472222222215,
                                         291.9683333333332,
                                         293.1319444444445,
                                         294.29555555555555,
                                         352.5347222222222,
                                         353.93499999999983,
                                         355.3352777777778,
                                         356.7355555555556,
                                         318.6391666666666,
                                         319.8816666666666,
                                         321.1241666666668,
                                         322.3666666666667,
                                         324.5558333333333,
                                         325.7983333333333,
                                         327.0408333333334,
                                         328.28333333333336,
                                         372.33583333333326,
                                         373.7361111111111,
                                         375.1363888888889,
                                         376.5366666666666,
                                         311.55249999999995,
                                         312.7161111111111,
                                         313.87972222222226,
                                         315.0433333333333,
                                         249.8225,
                                         250.74944444444444,
                                         251.67638888888882,
                                         252.60333333333335,
                                         131.56166666666667,
                                         132.42333333333335,
                                         133.285,
                                         134.14666666666668,
                                         167.06166666666667,
                                         168.14333333333337,
                                         169.225,
                                         170.30666666666664,
                                         203.4416666666667,
                                         204.74333333333337,
                                         206.04499999999996,
                                         207.3466666666667,
                                         185.93500000000006,
                                         187.09000000000006,
                                         188.24499999999992,
                                         189.40000000000003,
                                         191.43500000000003,
                                         192.59000000000006,
                                         193.74499999999992,
                                         194.90000000000003,
                                         221.84833333333336,
                                         223.15000000000003,
                                         224.4516666666666,
                                         225.75333333333336,
                                         186.34833333333333,
                                         187.42999999999998,
                                         188.51166666666663,
                                         189.5933333333334,
                                         149.96833333333333,
                                         150.82999999999998,
                                         151.69166666666666,
                                         152.5533333333333,
                                         71.26583333333332,
                                         72.19277777777776,
                                         73.11972222222224,
                                         74.04666666666665,
                                         91.51583333333332,
                                         92.67944444444446,
                                         93.84305555555555,
                                         95.00666666666665,
                                         112.71250000000002,
                                         114.1127777777778,
                                         115.51305555555555,
                                         116.91333333333333,
                                         105.83916666666669,
                                         107.08166666666668,
                                         108.32416666666667,
                                         109.56666666666663,
                                         111.75583333333334,
                                         112.99833333333333,
                                         114.24083333333333,
                                         115.48333333333332,
                                         132.51361111111112,
                                         133.9138888888889,
                                         135.31416666666667,
                                         136.71444444444444,
                                         112.2636111111111,
                                         113.42722222222223,
                                         114.59083333333334,
                                         115.75444444444443,
                                         91.06694444444445,
                                         91.99388888888889,
                                         92.92083333333332,
                                         93.84777777777776,
                                         70.58916666666664,
                                         71.35944444444443,
                                         72.12972222222223,
                                         72.89999999999999,
                                         90.31916666666666,
                                         91.28611111111113,
                                         92.25305555555556,
                                         93.21999999999998,
                                         110.83583333333335,
                                         111.99944444444446,
                                         113.16305555555556,
                                         114.32666666666665,
                                         103.18916666666668,
                                         104.22166666666668,
                                         105.25416666666666,
                                         106.28666666666663,
                                         108.10583333333334,
                                         109.13833333333334,
                                         110.17083333333333,
                                         111.20333333333332,
                                         127.29027777777779,
                                         128.45388888888888,
                                         129.6175,
                                         130.7811111111111,
                                         107.56027777777778,
                                         108.52722222222222,
                                         109.49416666666667,
                                         110.46111111111111,
                                         87.0436111111111,
                                         87.81388888888888,
                                         88.58416666666668,
                                         89.35444444444445,
                                         64.89916666666667,
                                         65.51277777777777,
                                         66.1263888888889,
                                         66.74,
                                         82.82916666666668,
                                         83.59944444444446,
                                         84.36972222222222,
                                         85.13999999999999,
                                         101.38583333333334,
                                         102.3127777777778,
                                         103.23972222222223,
                                         104.16666666666666,
                                         93.81916666666667,
                                         94.64166666666667,
                                         95.46416666666666,
                                         96.28666666666663,
                                         97.73583333333335,
                                         98.55833333333332,
                                         99.38083333333334,
                                         100.20333333333332,
                                         114.49361111111112,
                                         115.42055555555555,
                                         116.3475,
                                         117.27444444444444,
                                         96.5636111111111,
                                         97.33388888888888,
                                         98.10416666666666,
                                         98.87444444444444,
                                         78.00694444444444,
                                         78.62055555555555,
                                         79.23416666666665,
                                         79.84777777777778};
  const std::array<int, 4> in_shape = {{3, 7, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x7x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         4.32,
                                         4.48,
                                         4.640000000000001,
                                         4.800000000000001,
                                         6.960000000000001,
                                         7.199999999999999,
                                         7.44,
                                         7.68,
                                         9.920000000000002,
                                         10.24,
                                         10.560000000000002,
                                         10.879999999999999,
                                         9.920000000000002,
                                         10.24,
                                         10.560000000000002,
                                         10.879999999999999,
                                         7.920000000000001,
                                         8.16,
                                         8.4,
                                         8.64,
                                         5.6000000000000005,
                                         5.76,
                                         5.92,
                                         6.08,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         4.4399999999999995,
                                         4.56,
                                         4.68,
                                         4.8,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         4.720000000000001,
                                         4.800000000000001,
                                         9.44,
                                         9.600000000000001,
                                         9.76,
                                         9.920000000000002,
                                         14.64,
                                         14.880000000000003,
                                         15.12,
                                         15.36,
                                         20.159999999999997,
                                         20.480000000000004,
                                         20.8,
                                         21.12,
                                         20.159999999999997,
                                         20.480000000000004,
                                         20.8,
                                         21.12,
                                         15.6,
                                         15.840000000000003,
                                         16.08,
                                         16.32,
                                         10.72,
                                         10.879999999999999,
                                         11.04,
                                         11.2,
                                         5.52,
                                         5.6,
                                         5.68,
                                         5.76,
                                         7.800000000000001,
                                         7.920000000000001,
                                         8.040000000000001,
                                         8.16,
                                         16.08,
                                         16.320000000000004,
                                         16.56,
                                         16.8,
                                         24.84,
                                         25.200000000000006,
                                         25.56,
                                         25.919999999999998,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         26.279999999999998,
                                         26.640000000000008,
                                         27.,
                                         27.36,
                                         18.,
                                         18.24,
                                         18.48,
                                         18.72,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         7.800000000000001,
                                         7.920000000000001,
                                         8.040000000000001,
                                         8.16,
                                         16.08,
                                         16.320000000000004,
                                         16.56,
                                         16.8,
                                         24.84,
                                         25.200000000000006,
                                         25.56,
                                         25.919999999999998,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         26.279999999999998,
                                         26.640000000000008,
                                         27.,
                                         27.36,
                                         18.,
                                         18.24,
                                         18.48,
                                         18.72,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         7.800000000000001,
                                         7.920000000000001,
                                         8.040000000000001,
                                         8.16,
                                         16.08,
                                         16.320000000000004,
                                         16.56,
                                         16.8,
                                         24.84,
                                         25.200000000000006,
                                         25.56,
                                         25.919999999999998,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         26.279999999999998,
                                         26.640000000000008,
                                         27.,
                                         27.36,
                                         18.,
                                         18.24,
                                         18.48,
                                         18.72,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         18.48,
                                         18.72,
                                         18.96,
                                         19.2,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         19.44,
                                         19.68,
                                         19.92,
                                         20.16,
                                         13.280000000000001,
                                         13.44,
                                         13.600000000000001,
                                         13.76,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         3.24,
                                         3.2800000000000002,
                                         3.3200000000000003,
                                         3.36,
                                         6.640000000000001,
                                         6.720000000000001,
                                         6.800000000000001,
                                         6.88,
                                         10.200000000000001,
                                         10.32,
                                         10.440000000000001,
                                         10.56,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         10.68,
                                         10.8,
                                         10.92,
                                         11.04,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         3.72,
                                         3.7600000000000002,
                                         3.8000000000000003,
                                         3.84,
                                         3.88,
                                         3.92,
                                         3.96,
                                         4.,
                                         7.92,
                                         8.,
                                         8.08,
                                         8.16,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         16.48,
                                         16.64,
                                         16.8,
                                         16.96,
                                         16.48,
                                         16.64,
                                         16.8,
                                         16.96,
                                         12.600000000000001,
                                         12.72,
                                         12.84,
                                         12.96,
                                         8.56,
                                         8.64,
                                         8.72,
                                         8.8,
                                         4.36,
                                         4.4,
                                         4.44,
                                         4.48,
                                         8.4,
                                         8.48,
                                         8.56,
                                         8.64,
                                         17.12,
                                         17.28,
                                         17.439999999999998,
                                         17.6,
                                         26.16,
                                         26.4,
                                         26.64,
                                         26.880000000000003,
                                         35.519999999999996,
                                         35.84,
                                         36.160000000000004,
                                         36.480000000000004,
                                         35.519999999999996,
                                         35.84,
                                         36.160000000000004,
                                         36.480000000000004,
                                         27.12,
                                         27.36,
                                         27.6,
                                         27.840000000000003,
                                         18.4,
                                         18.56,
                                         18.72,
                                         18.880000000000003,
                                         9.36,
                                         9.440000000000001,
                                         9.52,
                                         9.600000000000001,
                                         13.56,
                                         13.68,
                                         13.8,
                                         13.920000000000002,
                                         27.6,
                                         27.84,
                                         28.08,
                                         28.320000000000004,
                                         42.120000000000005,
                                         42.480000000000004,
                                         42.84,
                                         43.2,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         43.56,
                                         43.92,
                                         44.28,
                                         44.64,
                                         29.52,
                                         29.759999999999998,
                                         30.,
                                         30.240000000000002,
                                         15.,
                                         15.120000000000001,
                                         15.239999999999998,
                                         15.360000000000001,
                                         13.56,
                                         13.68,
                                         13.8,
                                         13.920000000000002,
                                         27.6,
                                         27.84,
                                         28.08,
                                         28.320000000000004,
                                         42.120000000000005,
                                         42.480000000000004,
                                         42.84,
                                         43.2,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         43.56,
                                         43.92,
                                         44.28,
                                         44.64,
                                         29.52,
                                         29.759999999999998,
                                         30.,
                                         30.240000000000002,
                                         15.,
                                         15.120000000000001,
                                         15.239999999999998,
                                         15.360000000000001,
                                         13.56,
                                         13.68,
                                         13.8,
                                         13.920000000000002,
                                         27.6,
                                         27.84,
                                         28.08,
                                         28.320000000000004,
                                         42.120000000000005,
                                         42.480000000000004,
                                         42.84,
                                         43.2,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         43.56,
                                         43.92,
                                         44.28,
                                         44.64,
                                         29.52,
                                         29.759999999999998,
                                         30.,
                                         30.240000000000002,
                                         15.,
                                         15.120000000000001,
                                         15.239999999999998,
                                         15.360000000000001,
                                         9.68,
                                         9.760000000000002,
                                         9.84,
                                         9.92,
                                         19.68,
                                         19.84,
                                         20.,
                                         20.16,
                                         30.,
                                         30.24,
                                         30.480000000000004,
                                         30.720000000000002,
                                         40.64,
                                         40.96,
                                         41.28,
                                         41.6,
                                         40.64,
                                         40.96,
                                         41.28,
                                         41.6,
                                         30.96,
                                         31.2,
                                         31.439999999999998,
                                         31.68,
                                         20.96,
                                         21.12,
                                         21.28,
                                         21.439999999999998,
                                         10.64,
                                         10.719999999999999,
                                         10.8,
                                         10.879999999999999,
                                         5.16,
                                         5.2,
                                         5.24,
                                         5.28,
                                         10.48,
                                         10.56,
                                         10.64,
                                         10.72,
                                         15.96,
                                         16.080000000000002,
                                         16.200000000000003,
                                         16.32,
                                         21.6,
                                         21.76,
                                         21.92,
                                         22.08,
                                         21.6,
                                         21.76,
                                         21.92,
                                         22.08,
                                         16.44,
                                         16.560000000000002,
                                         16.68,
                                         16.8,
                                         11.120000000000001,
                                         11.2,
                                         11.280000000000001,
                                         11.36,
                                         5.64,
                                         5.68,
                                         5.72,
                                         5.76};
  const std::array<int, 4> in_shape = {{3, 7, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.177777777777778,
                                         5.584444444444443,
                                         7.538611111111111,
                                         8.844166666666665,
                                         7.4775,
                                         6.2275,
                                         7.2844444444444445,
                                         9.571111111111112,
                                         12.67527777777778,
                                         14.314166666666665,
                                         11.947500000000002,
                                         9.8575,
                                         11.331111111111111,
                                         14.73777777777778,
                                         19.291944444444447,
                                         21.264166666666668,
                                         17.5975,
                                         14.427499999999998,
                                         15.84,
                                         20.34,
                                         26.227500000000003,
                                         27.977500000000003,
                                         22.877499999999998,
                                         18.5875,
                                         21.715,
                                         27.714999999999996,
                                         35.4775,
                                         37.2275,
                                         30.252499999999998,
                                         24.4625,
                                         30.99277777777778,
                                         39.41944444444444,
                                         50.248611111111096,
                                         52.22083333333333,
                                         42.27916666666667,
                                         34.08916666666667,
                                         27.886111111111113,
                                         35.43277777777777,
                                         45.11194444444444,
                                         46.75083333333333,
                                         37.80916666666667,
                                         30.459166666666665,
                                         23.839444444444446,
                                         30.266111111111112,
                                         38.49527777777778,
                                         39.80083333333334,
                                         32.15916666666667,
                                         25.889166666666668,
                                         33.63111111111112,
                                         42.55777777777779,
                                         53.91194444444446,
                                         55.21750000000001,
                                         44.450833333333335,
                                         35.68083333333333,
                                         44.25777777777778,
                                         55.98444444444445,
                                         70.88861111111112,
                                         72.5275,
                                         58.360833333333325,
                                         46.830833333333324,
                                         55.82444444444445,
                                         70.59111111111112,
                                         89.34527777777778,
                                         91.31750000000001,
                                         73.45083333333332,
                                         58.92083333333333,
                                         55.32,
                                         69.89999999999999,
                                         88.38749999999999,
                                         90.13749999999999,
                                         72.4375,
                                         58.0675,
                                         61.19500000000001,
                                         77.275,
                                         97.6375,
                                         99.3875,
                                         79.81250000000001,
                                         63.9425,
                                         75.48611111111111,
                                         95.27277777777779,
                                         120.30194444444446,
                                         122.27416666666669,
                                         98.13250000000002,
                                         78.58250000000001,
                                         64.85944444444443,
                                         81.84611111111111,
                                         103.32527777777779,
                                         104.96416666666669,
                                         84.22250000000001,
                                         67.4325,
                                         53.29277777777778,
                                         67.23944444444444,
                                         84.86861111111112,
                                         86.17416666666668,
                                         69.13250000000001,
                                         55.342499999999994,
                                         63.08444444444444,
                                         79.5311111111111,
                                         100.28527777777778,
                                         101.59083333333334,
                                         81.42416666666666,
                                         65.13416666666667,
                                         81.23111111111112,
                                         102.39777777777778,
                                         129.10194444444443,
                                         130.74083333333334,
                                         104.77416666666666,
                                         83.80416666666667,
                                         100.31777777777778,
                                         126.44444444444443,
                                         159.39861111111108,
                                         161.37083333333334,
                                         129.30416666666665,
                                         103.41416666666667,
                                         94.8,
                                         119.46,
                                         150.54749999999996,
                                         152.2975,
                                         121.99749999999999,
                                         97.5475,
                                         100.675,
                                         126.83500000000001,
                                         159.7975,
                                         161.5475,
                                         129.3725,
                                         103.4225,
                                         119.97944444444445,
                                         151.1261111111111,
                                         190.35527777777776,
                                         192.3275,
                                         153.98583333333332,
                                         123.07583333333334,
                                         101.83277777777778,
                                         128.25944444444445,
                                         161.5386111111111,
                                         163.17749999999998,
                                         130.63583333333332,
                                         104.40583333333333,
                                         82.74611111111112,
                                         104.21277777777779,
                                         131.24194444444444,
                                         132.5475,
                                         106.10583333333335,
                                         84.79583333333333};
  const std::array<int, 4> in_shape = {{3, 8, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.12,
                                         0.08,
                                         0.16,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.4,
                                         0.24,
                                         0.36,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.48,
                                         0.64,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         0.8,
                                         0.64,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         0.8,
                                         0.6000000000000001,
                                         1.32,
                                         1.32,
                                         1.32,
                                         1.32,
                                         0.72,
                                         0.48000000000000004,
                                         1.04,
                                         1.04,
                                         1.04,
                                         1.04,
                                         0.56,
                                         0.28,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.6000000000000001,
                                         0.32,
                                         0.36,
                                         0.76,
                                         0.76,
                                         0.76,
                                         0.76,
                                         0.4,
                                         0.8,
                                         1.68,
                                         1.68,
                                         1.68,
                                         1.68,
                                         0.88,
                                         1.32,
                                         2.7600000000000002,
                                         2.7600000000000002,
                                         2.7600000000000002,
                                         2.7600000000000002,
                                         1.44,
                                         1.92,
                                         4.,
                                         4.,
                                         4.,
                                         4.,
                                         2.08,
                                         1.92,
                                         4.,
                                         4.,
                                         4.,
                                         4.,
                                         2.08,
                                         1.56,
                                         3.24,
                                         3.24,
                                         3.24,
                                         3.24,
                                         1.6800000000000002,
                                         1.12,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         1.2000000000000002,
                                         0.6,
                                         1.24,
                                         1.24,
                                         1.24,
                                         1.24,
                                         0.64,
                                         0.68,
                                         1.4,
                                         1.4,
                                         1.4,
                                         1.4,
                                         0.72,
                                         1.44,
                                         2.96,
                                         2.96,
                                         2.96,
                                         2.96,
                                         1.52,
                                         2.28,
                                         4.68,
                                         4.68,
                                         4.68,
                                         4.68,
                                         2.4,
                                         3.1999999999999997,
                                         6.56,
                                         6.56,
                                         6.56,
                                         6.56,
                                         3.36,
                                         3.1999999999999997,
                                         6.56,
                                         6.56,
                                         6.56,
                                         6.56,
                                         3.36,
                                         2.52,
                                         5.16,
                                         5.16,
                                         5.16,
                                         5.16,
                                         2.64,
                                         1.76,
                                         3.6,
                                         3.6,
                                         3.6,
                                         3.6,
                                         1.8399999999999999,
                                         0.92,
                                         1.88,
                                         1.88,
                                         1.88,
                                         1.88,
                                         0.96};
  const std::array<int, 4> in_shape = {{3, 8, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {7.741944444444444,
                                         8.355555555555556,
                                         10.398611111111112,
                                         11.168888888888887,
                                         14.111111111111112,
                                         15.077222222222222,
                                         16.72222222222222,
                                         17.68833333333333,
                                         14.184722222222224,
                                         14.955,
                                         11.84138888888889,
                                         12.455,
                                         13.79861111111111,
                                         14.568888888888889,
                                         18.17527777777778,
                                         19.142222222222223,
                                         24.137777777777778,
                                         25.35055555555556,
                                         27.415555555555553,
                                         28.62833333333333,
                                         22.928055555555556,
                                         23.895000000000003,
                                         18.944722222222225,
                                         19.715,
                                         21.735277777777778,
                                         22.662222222222223,
                                         28.311944444444446,
                                         29.47555555555556,
                                         37.12444444444445,
                                         38.58388888888889,
                                         41.068888888888885,
                                         42.528333333333336,
                                         34.03138888888889,
                                         35.195,
                                         27.92805555555556,
                                         28.854999999999997,
                                         30.8575,
                                         31.68,
                                         39.6475,
                                         40.68,
                                         51.160000000000004,
                                         52.455000000000005,
                                         54.660000000000004,
                                         55.955000000000005,
                                         44.722500000000004,
                                         45.754999999999995,
                                         36.3525,
                                         37.175,
                                         42.60750000000001,
                                         43.43,
                                         54.39750000000001,
                                         55.42999999999999,
                                         69.66000000000001,
                                         70.955,
                                         73.16000000000001,
                                         74.455,
                                         59.472500000000004,
                                         60.504999999999995,
                                         48.1025,
                                         48.925,
                                         61.058611111111105,
                                         61.98555555555556,
                                         77.67527777777778,
                                         78.83888888888887,
                                         99.03777777777779,
                                         100.49722222222219,
                                         102.98222222222223,
                                         104.44166666666666,
                                         83.39472222222221,
                                         84.55833333333334,
                                         67.25138888888888,
                                         68.17833333333334,
                                         55.00194444444445,
                                         55.772222222222226,
                                         69.89861111111111,
                                         70.86555555555555,
                                         89.01111111111112,
                                         90.22388888888888,
                                         92.28888888888889,
                                         93.50166666666667,
                                         74.65138888888889,
                                         75.61833333333334,
                                         60.14805555555556,
                                         60.91833333333333,
                                         47.06527777777778,
                                         47.67888888888889,
                                         59.76194444444444,
                                         60.532222222222224,
                                         76.02444444444444,
                                         76.99055555555556,
                                         78.63555555555556,
                                         79.60166666666667,
                                         63.54805555555555,
                                         64.31833333333334,
                                         51.164722222222224,
                                         51.778333333333336,
                                         66.64861111111111,
                                         67.26222222222223,
                                         84.34527777777778,
                                         85.11555555555557,
                                         106.85777777777778,
                                         107.82388888888892,
                                         109.4688888888889,
                                         110.43500000000002,
                                         88.13138888888888,
                                         88.90166666666667,
                                         70.74805555555555,
                                         71.36166666666666,
                                         87.74527777777779,
                                         88.51555555555557,
                                         111.00194444444445,
                                         111.9688888888889,
                                         140.56444444444446,
                                         141.77722222222224,
                                         143.84222222222223,
                                         145.055,
                                         115.75472222222221,
                                         116.72166666666665,
                                         92.89138888888888,
                                         93.66166666666665,
                                         110.72194444444445,
                                         111.6488888888889,
                                         140.0186111111111,
                                         141.18222222222224,
                                         177.23111111111112,
                                         178.69055555555556,
                                         181.17555555555558,
                                         182.63500000000002,
                                         145.73805555555555,
                                         146.90166666666664,
                                         116.91472222222222,
                                         117.84166666666665,
                                         109.8175,
                                         110.64,
                                         138.7675,
                                         139.79999999999998,
                                         175.48,
                                         176.77499999999998,
                                         178.98,
                                         180.27499999999998,
                                         143.84249999999997,
                                         144.875,
                                         115.3125,
                                         116.135,
                                         121.5675,
                                         122.39000000000001,
                                         153.5175,
                                         154.55,
                                         193.98000000000002,
                                         195.275,
                                         197.47999999999996,
                                         198.775,
                                         158.5925,
                                         159.62500000000003,
                                         127.06249999999999,
                                         127.885,
                                         150.04527777777778,
                                         150.97222222222223,
                                         189.38194444444446,
                                         190.54555555555558,
                                         239.14444444444445,
                                         240.60388888888892,
                                         243.0888888888889,
                                         244.54833333333337,
                                         195.1013888888889,
                                         196.26500000000004,
                                         156.23805555555558,
                                         157.16500000000002,
                                         128.94861111111112,
                                         129.71888888888887,
                                         162.72527777777782,
                                         163.69222222222223,
                                         205.4377777777778,
                                         206.65055555555557,
                                         208.71555555555557,
                                         209.92833333333337,
                                         167.47805555555556,
                                         168.44500000000002,
                                         134.09472222222223,
                                         134.865,
                                         105.97194444444443,
                                         106.58555555555556,
                                         133.7086111111111,
                                         134.4788888888889,
                                         168.7711111111111,
                                         169.73722222222224,
                                         171.38222222222223,
                                         172.34833333333336,
                                         137.4947222222222,
                                         138.26500000000001,
                                         110.07138888888889,
                                         110.68499999999999,
                                         125.55527777777779,
                                         126.16888888888889,
                                         158.2919444444444,
                                         159.0622222222222,
                                         199.60444444444443,
                                         200.57055555555556,
                                         202.2155555555555,
                                         203.18166666666667,
                                         162.07805555555552,
                                         162.84833333333333,
                                         129.65472222222223,
                                         130.26833333333335,
                                         161.69194444444446,
                                         162.46222222222224,
                                         203.8286111111111,
                                         204.79555555555555,
                                         256.9911111111111,
                                         258.20388888888886,
                                         260.26888888888885,
                                         261.4816666666667,
                                         208.58138888888885,
                                         209.54833333333332,
                                         166.83805555555557,
                                         167.60833333333335,
                                         199.70861111111114,
                                         200.63555555555556,
                                         251.72527777777776,
                                         252.88888888888886,
                                         317.3377777777777,
                                         318.79722222222216,
                                         321.2822222222222,
                                         322.7416666666667,
                                         257.4447222222222,
                                         258.6083333333333,
                                         205.9013888888889,
                                         206.82833333333335,
                                         188.77750000000003,
                                         189.6,
                                         237.88750000000005,
                                         238.92,
                                         299.8,
                                         301.0949999999999,
                                         303.29999999999995,
                                         304.595,
                                         242.9625,
                                         243.99499999999998,
                                         194.2725,
                                         195.095,
                                         200.5275,
                                         201.35,
                                         252.63750000000002,
                                         253.67000000000002,
                                         318.3,
                                         319.595,
                                         321.80000000000007,
                                         323.095,
                                         257.7125,
                                         258.745,
                                         206.0225,
                                         206.845,
                                         239.03194444444443,
                                         239.9588888888889,
                                         301.08861111111116,
                                         302.2522222222222,
                                         379.25111111111113,
                                         380.7105555555555,
                                         383.19555555555553,
                                         384.655,
                                         306.8080555555556,
                                         307.97166666666664,
                                         245.22472222222223,
                                         246.15166666666667,
                                         202.89527777777778,
                                         203.66555555555556,
                                         255.55194444444447,
                                         256.5188888888889,
                                         321.8644444444445,
                                         323.0772222222222,
                                         325.14222222222224,
                                         326.35499999999996,
                                         260.30472222222215,
                                         261.27166666666665,
                                         208.0413888888889,
                                         208.81166666666667,
                                         164.87861111111113,
                                         165.49222222222224,
                                         207.65527777777777,
                                         208.42555555555558,
                                         261.5177777777778,
                                         262.4838888888889,
                                         264.1288888888889,
                                         265.095,
                                         211.4413888888889,
                                         212.2116666666667,
                                         168.97805555555556,
                                         169.59166666666667};
  const std::array<int, 4> in_shape = {{3, 8, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.16,
                                         0.24,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         2.4,
                                         2.64,
                                         2.4,
                                         2.64,
                                         2.4,
                                         2.64,
                                         2.4,
                                         2.64,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.92,
                                         2.08,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         1.12,
                                         1.2000000000000002,
                                         0.6,
                                         0.64,
                                         0.68,
                                         0.72,
                                         1.44,
                                         1.52,
                                         1.44,
                                         1.52,
                                         1.44,
                                         1.52,
                                         1.44,
                                         1.52,
                                         0.76,
                                         0.8,
                                         1.52,
                                         1.6,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         3.1999999999999997,
                                         3.36,
                                         1.6800000000000002,
                                         1.76,
                                         2.52,
                                         2.64,
                                         5.279999999999999,
                                         5.5200000000000005,
                                         5.279999999999999,
                                         5.5200000000000005,
                                         5.279999999999999,
                                         5.5200000000000005,
                                         5.279999999999999,
                                         5.5200000000000005,
                                         2.7600000000000002,
                                         2.88,
                                         3.6799999999999997,
                                         3.84,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         4.,
                                         4.16,
                                         3.,
                                         3.12,
                                         6.24,
                                         6.48,
                                         6.24,
                                         6.48,
                                         6.24,
                                         6.48,
                                         6.24,
                                         6.48,
                                         3.24,
                                         3.3600000000000003,
                                         2.16,
                                         2.24,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         2.4,
                                         2.48,
                                         2.4,
                                         2.48,
                                         2.4,
                                         2.48,
                                         2.4,
                                         2.48,
                                         1.24,
                                         1.28,
                                         1.32,
                                         1.36,
                                         2.72,
                                         2.8,
                                         2.72,
                                         2.8,
                                         2.72,
                                         2.8,
                                         2.72,
                                         2.8,
                                         1.4000000000000001,
                                         1.44,
                                         2.8,
                                         2.88,
                                         5.76,
                                         5.92,
                                         5.76,
                                         5.92,
                                         5.76,
                                         5.92,
                                         5.76,
                                         5.92,
                                         2.96,
                                         3.04,
                                         4.4399999999999995,
                                         4.56,
                                         9.120000000000001,
                                         9.36,
                                         9.120000000000001,
                                         9.36,
                                         9.120000000000001,
                                         9.36,
                                         9.120000000000001,
                                         9.36,
                                         4.68,
                                         4.8,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         6.56,
                                         6.72,
                                         4.92,
                                         5.04,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         7.04,
                                         7.2,
                                         7.04,
                                         7.2,
                                         7.04,
                                         7.2,
                                         7.04,
                                         7.2,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         3.68,
                                         3.76,
                                         3.68,
                                         3.76,
                                         3.68,
                                         3.76,
                                         3.68,
                                         3.76,
                                         1.8800000000000001,
                                         1.92};
  const std::array<int, 4> in_shape = {{3, 8, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {14.870277777777776,
                                         15.483888888888888,
                                         16.0975,
                                         16.711111111111112,
                                         20.026944444444446,
                                         20.797222222222224,
                                         21.5675,
                                         22.337777777777774,
                                         27.256111111111114,
                                         28.222222222222225,
                                         29.188333333333333,
                                         30.154444444444444,
                                         32.47833333333333,
                                         33.44444444444444,
                                         34.410555555555554,
                                         35.37666666666666,
                                         27.59916666666667,
                                         28.369444444444447,
                                         29.139722222222225,
                                         29.91,
                                         23.069166666666668,
                                         23.68277777777778,
                                         24.29638888888889,
                                         24.91,
                                         26.826944444444443,
                                         27.59722222222222,
                                         28.3675,
                                         29.137777777777778,
                                         35.383611111111115,
                                         36.35055555555556,
                                         37.317499999999995,
                                         38.284444444444446,
                                         47.06277777777778,
                                         48.275555555555556,
                                         49.48833333333333,
                                         50.70111111111112,
                                         53.61833333333334,
                                         54.831111111111106,
                                         56.04388888888889,
                                         57.25666666666666,
                                         44.889166666666675,
                                         45.85611111111111,
                                         46.823055555555555,
                                         47.790000000000006,
                                         37.119166666666665,
                                         37.88944444444445,
                                         38.65972222222223,
                                         39.43,
                                         42.54361111111112,
                                         43.470555555555556,
                                         44.3975,
                                         45.324444444444445,
                                         55.46027777777779,
                                         56.62388888888889,
                                         57.787499999999994,
                                         58.95111111111112,
                                         72.78944444444446,
                                         74.2488888888889,
                                         75.70833333333333,
                                         77.16777777777779,
                                         80.67833333333334,
                                         82.13777777777777,
                                         83.59722222222221,
                                         85.05666666666667,
                                         66.89916666666667,
                                         68.06277777777778,
                                         69.22638888888889,
                                         70.39,
                                         54.92916666666666,
                                         55.85611111111112,
                                         56.78305555555556,
                                         57.709999999999994,
                                         60.8925,
                                         61.715,
                                         62.537499999999994,
                                         63.36,
                                         78.26249999999999,
                                         79.295,
                                         80.32749999999999,
                                         81.36,
                                         101.025,
                                         102.32000000000001,
                                         103.615,
                                         104.91000000000001,
                                         108.025,
                                         109.32000000000001,
                                         110.615,
                                         111.91000000000001,
                                         88.4125,
                                         89.44500000000001,
                                         90.4775,
                                         91.50999999999999,
                                         71.8825,
                                         72.705,
                                         73.5275,
                                         74.35,
                                         84.3925,
                                         85.21500000000002,
                                         86.03750000000001,
                                         86.86,
                                         107.7625,
                                         108.79500000000002,
                                         109.82750000000001,
                                         110.85999999999999,
                                         138.02499999999998,
                                         139.32000000000002,
                                         140.61499999999998,
                                         141.91,
                                         145.02499999999998,
                                         146.32000000000002,
                                         147.61499999999998,
                                         148.91,
                                         117.91250000000001,
                                         118.94500000000001,
                                         119.9775,
                                         121.00999999999999,
                                         95.3825,
                                         96.205,
                                         97.02750000000002,
                                         97.85,
                                         121.19027777777777,
                                         122.11722222222221,
                                         123.04416666666667,
                                         123.97111111111111,
                                         154.18694444444444,
                                         155.35055555555556,
                                         156.51416666666665,
                                         157.67777777777775,
                                         196.61611111111108,
                                         198.07555555555558,
                                         199.53500000000003,
                                         200.99444444444438,
                                         204.505,
                                         205.96444444444447,
                                         207.4238888888889,
                                         208.88333333333333,
                                         165.62583333333333,
                                         166.78944444444443,
                                         167.95305555555558,
                                         169.11666666666667,
                                         133.57583333333332,
                                         134.50277777777777,
                                         135.4297222222222,
                                         136.35666666666668,
                                         109.23361111111112,
                                         110.0038888888889,
                                         110.77416666666666,
                                         111.54444444444445,
                                         138.83027777777778,
                                         139.79722222222222,
                                         140.76416666666665,
                                         141.7311111111111,
                                         176.80944444444444,
                                         178.02222222222224,
                                         179.235,
                                         180.44777777777776,
                                         183.36499999999998,
                                         184.57777777777778,
                                         185.79055555555556,
                                         187.00333333333333,
                                         148.3358333333333,
                                         149.30277777777778,
                                         150.26972222222224,
                                         151.23666666666668,
                                         119.52583333333334,
                                         120.29611111111112,
                                         121.0663888888889,
                                         121.83666666666666,
                                         93.51694444444445,
                                         94.13055555555556,
                                         94.74416666666666,
                                         95.35777777777778,
                                         118.7536111111111,
                                         119.52388888888888,
                                         120.29416666666667,
                                         121.06444444444445,
                                         151.08277777777778,
                                         152.04888888888888,
                                         153.01500000000001,
                                         153.98111111111112,
                                         156.305,
                                         157.2711111111111,
                                         158.23722222222224,
                                         159.20333333333335,
                                         126.32583333333334,
                                         127.0961111111111,
                                         127.8663888888889,
                                         128.63666666666668,
                                         101.71583333333334,
                                         102.32944444444445,
                                         102.94305555555553,
                                         103.55666666666667,
                                         132.6836111111111,
                                         133.29722222222222,
                                         133.91083333333333,
                                         134.52444444444447,
                                         167.92027777777778,
                                         168.69055555555556,
                                         169.4608333333333,
                                         170.23111111111115,
                                         212.74944444444444,
                                         213.71555555555557,
                                         214.68166666666662,
                                         215.64777777777783,
                                         217.97166666666666,
                                         218.9377777777778,
                                         219.90388888888884,
                                         220.87000000000003,
                                         175.4925,
                                         176.26277777777776,
                                         177.03305555555553,
                                         177.80333333333334,
                                         140.8825,
                                         141.4961111111111,
                                         142.10972222222222,
                                         142.72333333333333,
                                         174.72027777777774,
                                         175.49055555555557,
                                         176.26083333333335,
                                         177.03111111111113,
                                         221.03694444444443,
                                         222.0038888888889,
                                         222.97083333333333,
                                         223.9377777777778,
                                         279.9161111111111,
                                         281.1288888888889,
                                         282.34166666666664,
                                         283.55444444444447,
                                         286.47166666666664,
                                         287.68444444444447,
                                         288.8972222222222,
                                         290.11,
                                         230.54250000000002,
                                         231.50944444444443,
                                         232.47638888888886,
                                         233.4433333333333,
                                         185.01250000000002,
                                         185.78277777777777,
                                         186.55305555555555,
                                         187.3233333333333,
                                         220.51694444444442,
                                         221.4438888888889,
                                         222.37083333333337,
                                         223.2977777777778,
                                         278.87361111111113,
                                         280.0372222222222,
                                         281.2008333333333,
                                         282.3644444444445,
                                         353.00277777777774,
                                         354.46222222222224,
                                         355.9216666666666,
                                         357.3811111111111,
                                         360.89166666666665,
                                         362.35111111111115,
                                         363.81055555555554,
                                         365.27000000000004,
                                         290.3125,
                                         291.4761111111111,
                                         292.63972222222225,
                                         293.8033333333333,
                                         232.9025,
                                         233.82944444444445,
                                         234.75638888888886,
                                         235.6833333333333,
                                         218.8125,
                                         219.635,
                                         220.45749999999998,
                                         221.28,
                                         276.5025,
                                         277.535,
                                         278.5675,
                                         279.59999999999997,
                                         349.66499999999996,
                                         350.96,
                                         352.25500000000005,
                                         353.54999999999995,
                                         356.66499999999996,
                                         357.96,
                                         359.255,
                                         360.54999999999995,
                                         286.6525,
                                         287.68499999999995,
                                         288.71750000000003,
                                         289.75,
                                         229.80249999999998,
                                         230.625,
                                         231.44750000000005,
                                         232.27,
                                         242.31250000000003,
                                         243.135,
                                         243.95749999999998,
                                         244.78000000000003,
                                         306.0025,
                                         307.035,
                                         308.06750000000005,
                                         309.1,
                                         386.66499999999996,
                                         387.96000000000004,
                                         389.25500000000005,
                                         390.55,
                                         393.66499999999996,
                                         394.9599999999999,
                                         396.25500000000005,
                                         397.55,
                                         316.1525,
                                         317.185,
                                         318.2175000000001,
                                         319.25000000000006,
                                         253.30249999999998,
                                         254.12499999999997,
                                         254.94750000000002,
                                         255.77,
                                         299.16361111111115,
                                         300.09055555555557,
                                         301.0175,
                                         301.94444444444446,
                                         377.6002777777778,
                                         378.7638888888889,
                                         379.92749999999995,
                                         381.09111111111116,
                                         476.8294444444445,
                                         478.2888888888889,
                                         479.74833333333333,
                                         481.20777777777784,
                                         484.71833333333336,
                                         486.1777777777778,
                                         487.63722222222225,
                                         489.09666666666675,
                                         389.0391666666667,
                                         390.2027777777778,
                                         391.36638888888893,
                                         392.5300000000001,
                                         311.5491666666667,
                                         312.47611111111115,
                                         313.4030555555555,
                                         314.33000000000004,
                                         257.12694444444446,
                                         257.89722222222224,
                                         258.6675,
                                         259.43777777777774,
                                         324.48361111111114,
                                         325.45055555555564,
                                         326.4175,
                                         327.38444444444445,
                                         409.6627777777778,
                                         410.8755555555556,
                                         412.0883333333333,
                                         413.30111111111114,
                                         416.21833333333336,
                                         417.43111111111114,
                                         418.64388888888885,
                                         419.85666666666674,
                                         333.9891666666666,
                                         334.9561111111111,
                                         335.92305555555555,
                                         336.89000000000004,
                                         267.4191666666667,
                                         268.18944444444446,
                                         268.9597222222222,
                                         269.73,
                                         211.33027777777775,
                                         211.94388888888886,
                                         212.5575,
                                         213.17111111111112,
                                         266.6469444444444,
                                         267.4172222222222,
                                         268.1875,
                                         268.9577777777778,
                                         336.5761111111111,
                                         337.5422222222222,
                                         338.5083333333333,
                                         339.4744444444445,
                                         341.7983333333333,
                                         342.76444444444445,
                                         343.73055555555555,
                                         344.6966666666667,
                                         274.21916666666664,
                                         274.9894444444444,
                                         275.75972222222225,
                                         276.53000000000003,
                                         219.52916666666664,
                                         220.14277777777778,
                                         220.7563888888889,
                                         221.36999999999998,
                                         250.4969444444444,
                                         251.11055555555558,
                                         251.72416666666666,
                                         252.33777777777777,
                                         315.81361111111113,
                                         316.5838888888888,
                                         317.35416666666663,
                                         318.1244444444444,
                                         398.24277777777775,
                                         399.20888888888885,
                                         400.1749999999999,
                                         401.1411111111111,
                                         403.465,
                                         404.431111111111,
                                         405.39722222222224,
                                         406.36333333333334,
                                         323.3858333333333,
                                         324.15611111111104,
                                         324.9263888888889,
                                         325.69666666666666,
                                         258.6958333333333,
                                         259.30944444444447,
                                         259.92305555555555,
                                         260.5366666666667,
                                         322.6136111111111,
                                         323.3838888888889,
                                         324.15416666666664,
                                         324.9244444444445,
                                         406.6902777777778,
                                         407.6572222222222,
                                         408.6241666666666,
                                         409.5911111111111,
                                         512.7694444444444,
                                         513.9822222222222,
                                         515.1949999999999,
                                         516.4077777777777,
                                         519.3249999999999,
                                         520.5377777777777,
                                         521.7505555555555,
                                         522.9633333333334,
                                         416.1958333333333,
                                         417.1627777777777,
                                         418.1297222222222,
                                         419.09666666666664,
                                         332.9058333333333,
                                         333.67611111111114,
                                         334.44638888888886,
                                         335.2166666666667,
                                         398.49027777777775,
                                         399.4172222222223,
                                         400.34416666666664,
                                         401.2711111111111,
                                         502.28694444444443,
                                         503.4505555555555,
                                         504.6141666666666,
                                         505.7777777777777,
                                         633.216111111111,
                                         634.6755555555554,
                                         636.135,
                                         637.5944444444443,
                                         641.1049999999999,
                                         642.5644444444443,
                                         644.0238888888888,
                                         645.4833333333333,
                                         513.7258333333333,
                                         514.8894444444444,
                                         516.0530555555555,
                                         517.2166666666666,
                                         410.8758333333333,
                                         411.8027777777778,
                                         412.7297222222222,
                                         413.6566666666667,
                                         356.25250000000005,
                                         357.07500000000005,
                                         357.89750000000004,
                                         358.72,
                                         433.7825,
                                         434.81500000000005,
                                         435.84749999999997,
                                         436.88,
                                         531.7450000000001,
                                         533.0400000000001,
                                         534.3349999999999,
                                         535.6299999999999,
                                         504.6116666666667,
                                         505.90666666666664,
                                         507.2016666666667,
                                         508.49666666666667,
                                         384.1991666666667,
                                         385.2316666666667,
                                         386.26416666666665,
                                         387.2966666666667,
                                         307.50916666666666,
                                         308.33166666666665,
                                         309.15416666666664,
                                         309.9766666666667,
                                         279.48583333333335,
                                         280.30833333333334,
                                         281.1308333333334,
                                         281.9533333333334,
                                         337.41583333333335,
                                         338.4483333333334,
                                         339.48083333333335,
                                         340.51333333333343,
                                         410.8783333333334,
                                         412.17333333333335,
                                         413.46833333333336,
                                         414.7633333333334,
                                         383.745,
                                         385.0400000000001,
                                         386.335,
                                         387.63000000000005,
                                         287.8325,
                                         288.865,
                                         289.89750000000004,
                                         290.93000000000006,
                                         230.7425,
                                         231.565,
                                         232.38750000000005,
                                         233.20999999999998,
                                         222.70138888888889,
                                         223.6283333333334,
                                         224.5552777777778,
                                         225.48222222222222,
                                         266.36472222222216,
                                         267.52833333333336,
                                         268.6919444444446,
                                         269.85555555555555,
                                         322.12722222222226,
                                         323.58666666666664,
                                         325.0461111111112,
                                         326.50555555555565,
                                         295.8827777777778,
                                         297.34222222222223,
                                         298.80166666666673,
                                         300.2611111111111,
                                         218.07027777777776,
                                         219.2338888888889,
                                         220.39750000000004,
                                         221.56111111111107,
                                         175.3536111111111,
                                         176.28055555555557,
                                         177.2075,
                                         178.13444444444443,
                                         150.5847222222222,
                                         151.35500000000002,
                                         152.12527777777777,
                                         152.89555555555555,
                                         175.4880555555555,
                                         176.45500000000004,
                                         177.42194444444445,
                                         178.38888888888886,
                                         207.6005555555555,
                                         208.8133333333334,
                                         210.02611111111113,
                                         211.23888888888885,
                                         180.02277777777778,
                                         181.23555555555564,
                                         182.44833333333335,
                                         183.6611111111111,
                                         125.26027777777777,
                                         126.22722222222221,
                                         127.19416666666667,
                                         128.1611111111111,
                                         101.1436111111111,
                                         101.91388888888888,
                                         102.68416666666667,
                                         103.45444444444442,
                                         74.70805555555555,
                                         75.32166666666666,
                                         75.93527777777778,
                                         76.54888888888888,
                                         79.89138888888888,
                                         80.66166666666665,
                                         81.43194444444444,
                                         82.20222222222222,
                                         87.15388888888889,
                                         88.11999999999999,
                                         89.08611111111111,
                                         90.05222222222221,
                                         58.242777777777775,
                                         59.208888888888886,
                                         60.175,
                                         61.141111111111115,
                                         27.73027777777778,
                                         28.500555555555557,
                                         29.270833333333336,
                                         30.04111111111111,
                                         23.173611111111114,
                                         23.787222222222223,
                                         24.40083333333333,
                                         25.014444444444443};
  const std::array<int, 4> in_shape = {{3, 8, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.2,
                                         0.24,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.56,
                                         0.64,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         0.72,
                                         0.8,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         1.32,
                                         1.44,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.92,
                                         2.08,
                                         2.24,
                                         2.4000000000000004,
                                         2.56,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         2.7199999999999998,
                                         2.88,
                                         3.04,
                                         3.2,
                                         2.08,
                                         2.24,
                                         2.4000000000000004,
                                         2.56,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         2.7199999999999998,
                                         2.88,
                                         3.04,
                                         3.2,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4000000000000004,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         4.56,
                                         4.8,
                                         5.04,
                                         5.28,
                                         2.5199999999999996,
                                         2.6399999999999997,
                                         2.76,
                                         2.88,
                                         1.6800000000000002,
                                         1.76,
                                         1.84,
                                         1.9200000000000002,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         3.6799999999999997,
                                         3.84,
                                         4.,
                                         4.16,
                                         2.,
                                         2.08,
                                         2.16,
                                         2.24,
                                         1.,
                                         1.04,
                                         1.08,
                                         1.12,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         2.16,
                                         2.24,
                                         2.3200000000000003,
                                         2.4000000000000004,
                                         1.16,
                                         1.2,
                                         1.24,
                                         1.28,
                                         1.32,
                                         1.36,
                                         1.4000000000000001,
                                         1.44,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         2.8,
                                         2.88,
                                         2.96,
                                         3.04,
                                         1.48,
                                         1.52,
                                         1.56,
                                         1.6,
                                         2.96,
                                         3.04,
                                         3.12,
                                         3.2,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         6.239999999999999,
                                         6.3999999999999995,
                                         6.56,
                                         6.72,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         10.32,
                                         10.559999999999999,
                                         10.8,
                                         11.040000000000001,
                                         10.32,
                                         10.559999999999999,
                                         10.8,
                                         11.040000000000001,
                                         10.32,
                                         10.559999999999999,
                                         10.8,
                                         11.040000000000001,
                                         10.32,
                                         10.559999999999999,
                                         10.8,
                                         11.040000000000001,
                                         5.4,
                                         5.5200000000000005,
                                         5.640000000000001,
                                         5.76,
                                         7.2,
                                         7.359999999999999,
                                         7.52,
                                         7.68,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         7.84,
                                         8.,
                                         8.16,
                                         8.32,
                                         7.2,
                                         7.359999999999999,
                                         7.52,
                                         7.68,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         7.84,
                                         8.,
                                         8.16,
                                         8.32,
                                         5.880000000000001,
                                         6.,
                                         6.119999999999999,
                                         6.24,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         12.24,
                                         12.48,
                                         12.72,
                                         12.96,
                                         6.359999999999999,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         4.720000000000001,
                                         4.800000000000001,
                                         2.2800000000000002,
                                         2.32,
                                         2.36,
                                         2.4,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56,
                                         2.6,
                                         2.64,
                                         2.68,
                                         2.72,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         2.7600000000000002,
                                         2.8000000000000003,
                                         2.84,
                                         2.88,
                                         5.52,
                                         5.6,
                                         5.68,
                                         5.76,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         8.76,
                                         8.879999999999999,
                                         9.,
                                         9.12,
                                         18.,
                                         18.240000000000002,
                                         18.48,
                                         18.72,
                                         18.,
                                         18.240000000000002,
                                         18.48,
                                         18.72,
                                         18.,
                                         18.240000000000002,
                                         18.48,
                                         18.72,
                                         18.,
                                         18.240000000000002,
                                         18.48,
                                         18.72,
                                         9.24,
                                         9.36,
                                         9.48,
                                         9.6,
                                         12.32,
                                         12.479999999999999,
                                         12.64,
                                         12.799999999999999,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         12.96,
                                         13.12,
                                         13.280000000000001,
                                         13.44,
                                         12.32,
                                         12.479999999999999,
                                         12.64,
                                         12.799999999999999,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         12.96,
                                         13.12,
                                         13.280000000000001,
                                         13.44,
                                         9.72,
                                         9.84,
                                         9.96,
                                         10.08,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         10.200000000000001,
                                         10.32,
                                         10.440000000000001,
                                         10.56,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         13.920000000000002,
                                         14.08,
                                         14.240000000000002,
                                         14.4,
                                         7.12,
                                         7.2,
                                         7.28,
                                         7.359999999999999,
                                         3.56,
                                         3.6,
                                         3.64,
                                         3.68,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         3.72,
                                         3.7600000000000002,
                                         3.8000000000000003,
                                         3.84};
  const std::array<int, 4> in_shape = {{3, 8, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {4.686944444444444,
                                         6.2236111111111105,
                                         7.916944444444443,
                                         8.451666666666666,
                                         10.266944444444443,
                                         8.886944444444444,
                                         7.350277777777778,
                                         8.26361111111111,
                                         10.800277777777776,
                                         13.53361111111111,
                                         13.951666666666666,
                                         16.483611111111106,
                                         14.143611111111111,
                                         11.606944444444446,
                                         12.936944444444444,
                                         16.75361111111111,
                                         20.806944444444444,
                                         20.991666666666667,
                                         24.356944444444437,
                                         20.776944444444442,
                                         16.96027777777778,
                                         18.229166666666668,
                                         23.339166666666664,
                                         28.659166666666664,
                                         28.105,
                                         31.809166666666666,
                                         26.909166666666664,
                                         21.799166666666668,
                                         25.083333333333332,
                                         31.94333333333333,
                                         39.01333333333333,
                                         37.730000000000004,
                                         42.163333333333334,
                                         35.51333333333334,
                                         28.653333333333336,
                                         35.87555555555556,
                                         45.54888888888889,
                                         55.45888888888889,
                                         53.20333333333334,
                                         59.008888888888904,
                                         49.57222222222223,
                                         39.89888888888889,
                                         32.29888888888889,
                                         40.97222222222222,
                                         49.842222222222226,
                                         47.70333333333334,
                                         52.79222222222222,
                                         44.31555555555556,
                                         35.64222222222222,
                                         27.625555555555557,
                                         35.01888888888889,
                                         42.56888888888889,
                                         40.663333333333334,
                                         44.918888888888894,
                                         37.68222222222222,
                                         30.288888888888888,
                                         39.04916666666667,
                                         49.359166666666674,
                                         59.825833333333335,
                                         56.705,
                                         62.17583333333334,
                                         52.0225,
                                         41.7125,
                                         51.39916666666668,
                                         64.94916666666668,
                                         78.69583333333334,
                                         74.525,
                                         81.64583333333333,
                                         68.2925,
                                         54.7425,
                                         64.84583333333335,
                                         81.91583333333335,
                                         99.22250000000001,
                                         93.885,
                                         102.7725,
                                         85.93916666666667,
                                         68.86916666666667,
                                         64.28916666666666,
                                         81.15916666666669,
                                         98.2391666666667,
                                         92.78500000000001,
                                         101.38916666666667,
                                         84.72916666666667,
                                         67.85916666666668,
                                         71.14333333333333,
                                         89.76333333333332,
                                         108.59333333333333,
                                         102.41,
                                         111.74333333333333,
                                         93.33333333333334,
                                         74.71333333333334,
                                         87.78444444444445,
                                         110.71111111111111,
                                         133.87444444444444,
                                         126.09666666666665,
                                         137.42444444444442,
                                         114.73444444444443,
                                         91.80777777777777,
                                         75.43444444444444,
                                         95.12111111111112,
                                         115.00444444444443,
                                         108.27666666666667,
                                         117.95444444444445,
                                         98.46444444444444,
                                         78.77777777777779,
                                         61.98777777777778,
                                         78.15444444444444,
                                         94.47777777777777,
                                         88.91666666666666,
                                         96.82777777777777,
                                         80.81777777777778,
                                         64.6511111111111,
                                         73.4113888888889,
                                         92.49472222222224,
                                         111.73472222222223,
                                         104.95833333333333,
                                         114.08472222222221,
                                         95.15805555555556,
                                         76.07472222222222,
                                         94.53472222222223,
                                         119.09805555555558,
                                         143.85805555555558,
                                         135.09833333333333,
                                         146.80805555555554,
                                         122.4413888888889,
                                         97.87805555555555,
                                         116.75472222222223,
                                         147.07805555555555,
                                         177.63805555555558,
                                         166.77833333333334,
                                         181.18805555555556,
                                         151.10138888888892,
                                         120.77805555555554,
                                         110.34916666666668,
                                         138.97916666666666,
                                         167.8191666666667,
                                         157.465,
                                         170.9691666666667,
                                         142.54916666666668,
                                         113.91916666666667,
                                         117.20333333333333,
                                         147.58333333333337,
                                         178.17333333333335,
                                         167.09,
                                         181.32333333333332,
                                         151.15333333333334,
                                         120.77333333333334,
                                         139.69333333333333,
                                         175.87333333333336,
                                         212.29000000000002,
                                         198.99,
                                         215.83999999999997,
                                         179.89666666666665,
                                         143.71666666666667,
                                         118.57,
                                         149.26999999999998,
                                         180.16666666666669,
                                         168.85,
                                         183.11666666666665,
                                         152.61333333333332,
                                         121.91333333333333,
                                         96.35000000000001,
                                         121.29,
                                         146.38666666666666,
                                         137.17,
                                         148.73666666666665,
                                         123.95333333333335,
                                         99.01333333333332};
  const std::array<int, 4> in_shape = {{3, 8, 7, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x7x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.24,
                                         0.24,
                                         0.2,
                                         0.12,
                                         0.2,
                                         0.48000000000000004,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.8400000000000001,
                                         0.64,
                                         0.36,
                                         0.48000000000000004,
                                         1.08,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.8000000000000003,
                                         1.3199999999999998,
                                         0.72,
                                         0.8800000000000001,
                                         1.92,
                                         3.12,
                                         3.12,
                                         3.12,
                                         2.2399999999999998,
                                         1.2,
                                         0.8800000000000001,
                                         1.92,
                                         3.12,
                                         3.12,
                                         3.12,
                                         2.2399999999999998,
                                         1.2,
                                         0.8400000000000001,
                                         1.7999999999999998,
                                         2.88,
                                         2.88,
                                         2.88,
                                         2.04,
                                         1.08,
                                         0.68,
                                         1.44,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         2.2800000000000002,
                                         1.5999999999999999,
                                         0.84,
                                         0.4,
                                         0.8400000000000001,
                                         1.32,
                                         1.32,
                                         1.32,
                                         0.9199999999999999,
                                         0.48,
                                         0.52,
                                         1.08,
                                         1.6800000000000002,
                                         1.6800000000000002,
                                         1.6800000000000002,
                                         1.1600000000000001,
                                         0.6,
                                         1.1600000000000001,
                                         2.4000000000000004,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         3.7200000000000006,
                                         2.5600000000000005,
                                         1.3199999999999998,
                                         1.9200000000000002,
                                         3.96,
                                         6.12,
                                         6.12,
                                         6.12,
                                         4.2,
                                         2.1599999999999997,
                                         2.8000000000000003,
                                         5.76,
                                         8.879999999999999,
                                         8.879999999999999,
                                         8.879999999999999,
                                         6.08,
                                         3.1199999999999997,
                                         2.8000000000000003,
                                         5.76,
                                         8.879999999999999,
                                         8.879999999999999,
                                         8.879999999999999,
                                         6.08,
                                         3.1199999999999997,
                                         2.28,
                                         4.68,
                                         7.199999999999999,
                                         7.199999999999999,
                                         7.199999999999999,
                                         4.92,
                                         2.52,
                                         1.6400000000000001,
                                         3.36,
                                         5.16,
                                         5.16,
                                         5.16,
                                         3.52,
                                         1.7999999999999998,
                                         0.88,
                                         1.8,
                                         2.76,
                                         2.76,
                                         2.76,
                                         1.88,
                                         0.96,
                                         1.,
                                         2.04,
                                         3.12,
                                         3.12,
                                         3.12,
                                         2.12,
                                         1.08,
                                         2.12,
                                         4.32,
                                         6.6000000000000005,
                                         6.6000000000000005,
                                         6.6000000000000005,
                                         4.48,
                                         2.2800000000000002,
                                         3.3600000000000003,
                                         6.840000000000001,
                                         10.440000000000001,
                                         10.440000000000001,
                                         10.440000000000001,
                                         7.080000000000001,
                                         3.6000000000000005,
                                         4.720000000000001,
                                         9.600000000000001,
                                         14.64,
                                         14.64,
                                         14.64,
                                         9.92,
                                         5.040000000000001,
                                         4.720000000000001,
                                         9.600000000000001,
                                         14.64,
                                         14.64,
                                         14.64,
                                         9.92,
                                         5.040000000000001,
                                         3.7200000000000006,
                                         7.560000000000001,
                                         11.520000000000001,
                                         11.520000000000001,
                                         11.520000000000001,
                                         7.800000000000001,
                                         3.96,
                                         2.6,
                                         5.28,
                                         8.040000000000001,
                                         8.040000000000001,
                                         8.040000000000001,
                                         5.4399999999999995,
                                         2.76,
                                         1.36,
                                         2.7600000000000002,
                                         4.2,
                                         4.2,
                                         4.2,
                                         2.84,
                                         1.44};
  const std::array<int, 4> in_shape = {{3, 8, 7, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {8.760277777777778,
                                         9.373888888888889,
                                         11.676944444444445,
                                         12.447222222222221,
                                         14.906944444444447,
                                         15.833888888888886,
                                         16.041666666666668,
                                         16.903333333333332,
                                         19.606944444444448,
                                         20.533888888888885,
                                         17.003611111111113,
                                         17.773888888888887,
                                         14.086944444444445,
                                         14.700555555555557,
                                         15.756944444444446,
                                         16.52722222222222,
                                         20.63361111111111,
                                         21.60055555555555,
                                         25.90361111111111,
                                         27.06722222222222,
                                         26.821666666666665,
                                         27.903333333333332,
                                         31.803611111111113,
                                         32.96722222222221,
                                         27.32027777777778,
                                         28.287222222222223,
                                         22.443611111111114,
                                         23.213888888888892,
                                         24.946944444444448,
                                         25.87388888888889,
                                         32.343611111111116,
                                         33.50722222222222,
                                         40.21361111111111,
                                         41.61388888888889,
                                         40.68166666666667,
                                         41.983333333333334,
                                         47.31361111111112,
                                         48.713888888888874,
                                         40.39027777777778,
                                         41.553888888888885,
                                         32.993611111111115,
                                         33.92055555555556,
                                         35.63583333333334,
                                         36.458333333333336,
                                         45.64583333333333,
                                         46.67833333333333,
                                         56.075833333333335,
                                         57.31833333333333,
                                         55.05500000000001,
                                         56.21,
                                         62.37583333333333,
                                         63.61833333333333,
                                         52.78583333333333,
                                         53.81833333333333,
                                         42.77583333333334,
                                         43.598333333333336,
                                         49.34416666666667,
                                         50.166666666666664,
                                         62.85416666666667,
                                         63.88666666666666,
                                         76.78416666666666,
                                         78.02666666666666,
                                         74.30499999999999,
                                         75.46000000000001,
                                         83.08416666666666,
                                         84.32666666666667,
                                         69.99416666666666,
                                         71.02666666666669,
                                         56.48416666666667,
                                         57.30666666666667,
                                         70.82416666666667,
                                         71.75111111111111,
                                         89.93416666666667,
                                         91.09777777777778,
                                         109.51750000000001,
                                         110.91777777777779,
                                         105.10499999999998,
                                         106.40666666666668,
                                         116.61749999999998,
                                         118.01777777777781,
                                         97.98083333333332,
                                         99.14444444444446,
                                         78.87083333333332,
                                         79.79777777777778,
                                         63.8275,
                                         64.59777777777778,
                                         80.97749999999999,
                                         81.94444444444444,
                                         98.52083333333331,
                                         99.68444444444445,
                                         94.32499999999997,
                                         95.40666666666668,
                                         104.42083333333332,
                                         105.58444444444444,
                                         87.66416666666666,
                                         88.63111111111112,
                                         70.51416666666667,
                                         71.28444444444445,
                                         54.637499999999996,
                                         55.251111111111115,
                                         69.2675,
                                         70.03777777777778,
                                         84.21083333333331,
                                         85.13777777777779,
                                         80.46499999999999,
                                         81.32666666666667,
                                         88.91083333333331,
                                         89.83777777777779,
                                         74.59416666666667,
                                         75.36444444444444,
                                         59.96416666666666,
                                         60.577777777777776,
                                         77.48472222222223,
                                         78.09833333333334,
                                         97.94805555555556,
                                         98.71833333333335,
                                         118.72472222222221,
                                         119.65166666666667,
                                         112.54833333333333,
                                         113.41,
                                         123.4247222222222,
                                         124.35166666666667,
                                         103.27472222222221,
                                         104.045,
                                         82.81138888888889,
                                         83.425,
                                         102.02805555555555,
                                         102.79833333333336,
                                         128.93138888888888,
                                         129.89833333333337,
                                         156.22805555555556,
                                         157.39166666666668,
                                         147.96833333333333,
                                         149.05,
                                         162.12805555555553,
                                         163.29166666666666,
                                         135.61805555555554,
                                         136.585,
                                         108.7147222222222,
                                         109.485,
                                         128.76472222222222,
                                         129.6916666666667,
                                         162.66805555555553,
                                         163.8316666666667,
                                         197.04472222222222,
                                         198.44500000000002,
                                         186.46833333333333,
                                         187.77,
                                         204.14472222222219,
                                         205.545,
                                         170.7147222222222,
                                         171.87833333333333,
                                         136.81138888888887,
                                         137.73833333333334,
                                         127.75583333333333,
                                         128.57833333333332,
                                         161.2858333333333,
                                         162.31833333333338,
                                         195.2358333333333,
                                         196.4783333333334,
                                         184.415,
                                         185.57000000000002,
                                         201.53583333333333,
                                         202.77833333333334,
                                         168.42583333333332,
                                         169.45833333333334,
                                         134.89583333333331,
                                         135.71833333333336,
                                         141.4641666666667,
                                         142.28666666666666,
                                         178.49416666666667,
                                         179.52666666666664,
                                         215.94416666666666,
                                         217.18666666666667,
                                         203.66500000000002,
                                         204.82,
                                         222.2441666666667,
                                         223.48666666666665,
                                         185.63416666666666,
                                         186.66666666666669,
                                         148.60416666666666,
                                         149.42666666666668,
                                         174.64194444444445,
                                         175.5688888888889,
                                         220.25861111111112,
                                         221.42222222222222,
                                         266.34861111111115,
                                         267.74888888888887,
                                         250.89166666666668,
                                         252.1933333333333,
                                         273.4486111111111,
                                         274.84888888888884,
                                         228.30527777777775,
                                         229.46888888888887,
                                         182.6886111111111,
                                         183.61555555555555,
                                         150.09861111111113,
                                         150.86888888888888,
                                         189.2752777777778,
                                         190.24222222222224,
                                         228.8452777777778,
                                         230.00888888888886,
                                         215.4716666666667,
                                         216.55333333333334,
                                         234.74527777777777,
                                         235.9088888888889,
                                         195.9619444444444,
                                         196.92888888888888,
                                         156.78527777777774,
                                         157.55555555555557,
                                         123.36194444444443,
                                         123.97555555555556,
                                         155.53861111111112,
                                         156.30888888888887,
                                         188.02861111111113,
                                         188.95555555555555,
                                         176.97166666666666,
                                         177.83333333333331,
                                         192.72861111111106,
                                         193.65555555555554,
                                         160.86527777777775,
                                         161.63555555555556,
                                         128.6886111111111,
                                         129.3022222222222,
                                         146.20916666666668,
                                         146.8227777777778,
                                         184.2191666666667,
                                         184.98944444444447,
                                         222.54250000000002,
                                         223.46944444444446,
                                         209.05499999999998,
                                         209.91666666666666,
                                         227.2425,
                                         228.16944444444442,
                                         189.5458333333333,
                                         190.31611111111113,
                                         151.53583333333333,
                                         152.14944444444444,
                                         188.29916666666668,
                                         189.06944444444446,
                                         237.22916666666669,
                                         238.19611111111115,
                                         286.5525,
                                         287.71611111111116,
                                         269.11499999999995,
                                         270.19666666666666,
                                         292.45250000000004,
                                         293.6161111111111,
                                         243.91583333333327,
                                         244.8827777777778,
                                         194.98583333333332,
                                         195.7561111111111,
                                         232.58250000000004,
                                         233.50944444444445,
                                         292.9925,
                                         294.1561111111111,
                                         353.87583333333333,
                                         355.27611111111116,
                                         332.25499999999994,
                                         333.5566666666667,
                                         360.9758333333334,
                                         362.37611111111113,
                                         301.0391666666666,
                                         302.20277777777784,
                                         240.62916666666666,
                                         241.55611111111108,
                                         219.87583333333336,
                                         220.69833333333335,
                                         276.92583333333334,
                                         277.9583333333333,
                                         334.39583333333337,
                                         335.6383333333334,
                                         313.77500000000003,
                                         314.93,
                                         340.69583333333327,
                                         341.9383333333334,
                                         284.0658333333333,
                                         285.09833333333336,
                                         227.01583333333335,
                                         227.83833333333334,
                                         233.5841666666667,
                                         234.40666666666667,
                                         294.1341666666666,
                                         295.16666666666674,
                                         355.10416666666663,
                                         356.3466666666667,
                                         333.025,
                                         334.18,
                                         361.40416666666664,
                                         362.64666666666665,
                                         301.27416666666664,
                                         302.3066666666667,
                                         240.7241666666667,
                                         241.54666666666668,
                                         278.45972222222224,
                                         279.38666666666666,
                                         350.5830555555556,
                                         351.7466666666667,
                                         423.17972222222227,
                                         424.58000000000004,
                                         396.67833333333334,
                                         397.98,
                                         430.2797222222223,
                                         431.67999999999995,
                                         358.6297222222222,
                                         359.7933333333333,
                                         286.50638888888886,
                                         287.43333333333334,
                                         236.36972222222226,
                                         237.14,
                                         297.5730555555556,
                                         298.53999999999996,
                                         359.1697222222222,
                                         360.33333333333337,
                                         336.61833333333334,
                                         337.7,
                                         365.06972222222225,
                                         366.2333333333333,
                                         304.25972222222225,
                                         305.22666666666663,
                                         243.0563888888889,
                                         243.82666666666665,
                                         192.0863888888889,
                                         192.70000000000002,
                                         241.80972222222226,
                                         242.58,
                                         291.8463888888889,
                                         292.7733333333333,
                                         273.47833333333335,
                                         274.34,
                                         296.5463888888889,
                                         297.4733333333333,
                                         247.1363888888889,
                                         247.9066666666667,
                                         197.41305555555556,
                                         198.02666666666664};
  const std::array<int, 4> in_shape = {{3, 8, 7, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x7x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.36,
                                         0.48,
                                         0.32,
                                         0.4,
                                         0.2,
                                         0.24,
                                         0.32,
                                         0.4,
                                         0.8,
                                         0.9600000000000001,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.44,
                                         1.6800000000000002,
                                         1.1199999999999999,
                                         1.28,
                                         0.64,
                                         0.72,
                                         0.8400000000000001,
                                         0.9600000000000001,
                                         1.92,
                                         2.16,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         3.24,
                                         3.6000000000000005,
                                         2.4,
                                         2.6399999999999997,
                                         1.32,
                                         1.44,
                                         1.6,
                                         1.7600000000000002,
                                         3.5199999999999996,
                                         3.84,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.16,
                                         4.4799999999999995,
                                         2.24,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         3.5199999999999996,
                                         3.84,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.16,
                                         4.4799999999999995,
                                         2.24,
                                         2.4,
                                         1.56,
                                         1.6800000000000002,
                                         3.3600000000000003,
                                         3.5999999999999996,
                                         5.4,
                                         5.76,
                                         5.4,
                                         5.76,
                                         5.4,
                                         5.76,
                                         3.84,
                                         4.08,
                                         2.04,
                                         2.16,
                                         1.28,
                                         1.36,
                                         2.72,
                                         2.88,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         4.32,
                                         4.5600000000000005,
                                         3.04,
                                         3.1999999999999997,
                                         1.6,
                                         1.68,
                                         0.76,
                                         0.8,
                                         1.6,
                                         1.6800000000000002,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         2.52,
                                         2.64,
                                         1.76,
                                         1.8399999999999999,
                                         0.92,
                                         0.96,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         3.24,
                                         3.3600000000000003,
                                         3.24,
                                         3.3600000000000003,
                                         3.24,
                                         3.3600000000000003,
                                         2.24,
                                         2.3200000000000003,
                                         1.16,
                                         1.2,
                                         2.24,
                                         2.3200000000000003,
                                         4.640000000000001,
                                         4.800000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         7.200000000000001,
                                         7.440000000000001,
                                         4.960000000000001,
                                         5.120000000000001,
                                         2.56,
                                         2.6399999999999997,
                                         3.72,
                                         3.8400000000000003,
                                         7.6800000000000015,
                                         7.92,
                                         11.880000000000003,
                                         12.24,
                                         11.880000000000003,
                                         12.24,
                                         11.880000000000003,
                                         12.24,
                                         8.160000000000002,
                                         8.4,
                                         4.2,
                                         4.319999999999999,
                                         5.44,
                                         5.6000000000000005,
                                         11.200000000000003,
                                         11.52,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         11.840000000000003,
                                         12.16,
                                         6.08,
                                         6.239999999999999,
                                         5.44,
                                         5.6000000000000005,
                                         11.200000000000003,
                                         11.52,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         17.280000000000005,
                                         17.759999999999998,
                                         11.840000000000003,
                                         12.16,
                                         6.08,
                                         6.239999999999999,
                                         4.4399999999999995,
                                         4.56,
                                         9.12,
                                         9.36,
                                         14.040000000000003,
                                         14.399999999999999,
                                         14.040000000000003,
                                         14.399999999999999,
                                         14.040000000000003,
                                         14.399999999999999,
                                         9.6,
                                         9.84,
                                         4.92,
                                         5.04,
                                         3.2,
                                         3.2800000000000002,
                                         6.56,
                                         6.72,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         10.08,
                                         10.32,
                                         6.88,
                                         7.04,
                                         3.5200000000000005,
                                         3.5999999999999996,
                                         1.72,
                                         1.76,
                                         3.52,
                                         3.6,
                                         5.4,
                                         5.52,
                                         5.4,
                                         5.52,
                                         5.4,
                                         5.52,
                                         3.68,
                                         3.76,
                                         1.8800000000000001,
                                         1.92,
                                         1.96,
                                         2.,
                                         4.,
                                         4.08,
                                         6.12,
                                         6.24,
                                         6.12,
                                         6.24,
                                         6.12,
                                         6.24,
                                         4.16,
                                         4.24,
                                         2.12,
                                         2.16,
                                         4.16,
                                         4.24,
                                         8.48,
                                         8.64,
                                         12.96,
                                         13.200000000000001,
                                         12.96,
                                         13.200000000000001,
                                         12.96,
                                         13.200000000000001,
                                         8.8,
                                         8.96,
                                         4.48,
                                         4.5600000000000005,
                                         6.6,
                                         6.720000000000001,
                                         13.44,
                                         13.680000000000001,
                                         20.520000000000003,
                                         20.880000000000003,
                                         20.520000000000003,
                                         20.880000000000003,
                                         20.520000000000003,
                                         20.880000000000003,
                                         13.92,
                                         14.160000000000002,
                                         7.08,
                                         7.200000000000001,
                                         9.28,
                                         9.440000000000001,
                                         18.880000000000003,
                                         19.200000000000003,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         19.52,
                                         19.84,
                                         9.92,
                                         10.080000000000002,
                                         9.28,
                                         9.440000000000001,
                                         18.880000000000003,
                                         19.200000000000003,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         28.800000000000004,
                                         29.28,
                                         19.52,
                                         19.84,
                                         9.92,
                                         10.080000000000002,
                                         7.32,
                                         7.440000000000001,
                                         14.879999999999999,
                                         15.120000000000003,
                                         22.68,
                                         23.040000000000003,
                                         22.68,
                                         23.040000000000003,
                                         22.68,
                                         23.040000000000003,
                                         15.36,
                                         15.600000000000001,
                                         7.8,
                                         7.92,
                                         5.12,
                                         5.2,
                                         10.4,
                                         10.56,
                                         15.84,
                                         16.080000000000002,
                                         15.84,
                                         16.080000000000002,
                                         15.84,
                                         16.080000000000002,
                                         10.72,
                                         10.879999999999999,
                                         5.4399999999999995,
                                         5.52,
                                         2.68,
                                         2.72,
                                         5.44,
                                         5.5200000000000005,
                                         8.280000000000001,
                                         8.4,
                                         8.280000000000001,
                                         8.4,
                                         8.280000000000001,
                                         8.4,
                                         5.6,
                                         5.68,
                                         2.84,
                                         2.88};
  const std::array<int, 4> in_shape = {{3, 8, 7, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {16.906944444444445,
                                         17.520555555555557,
                                         18.13416666666667,
                                         18.747777777777777,
                                         22.583611111111114,
                                         23.35388888888889,
                                         24.124166666666667,
                                         24.894444444444442,
                                         28.886944444444445,
                                         29.813888888888894,
                                         30.74083333333333,
                                         31.667777777777772,
                                         31.22166666666667,
                                         32.083333333333336,
                                         32.945,
                                         33.806666666666665,
                                         38.286944444444444,
                                         39.213888888888896,
                                         40.14083333333333,
                                         41.06777777777777,
                                         33.23694444444445,
                                         34.007222222222225,
                                         34.777499999999996,
                                         35.547777777777775,
                                         27.560277777777777,
                                         28.17388888888889,
                                         28.7875,
                                         29.401111111111113,
                                         30.74361111111111,
                                         31.513888888888893,
                                         32.28416666666667,
                                         33.05444444444444,
                                         40.30027777777779,
                                         41.26722222222222,
                                         42.23416666666667,
                                         43.2011111111111,
                                         50.64361111111111,
                                         51.80722222222222,
                                         52.970833333333324,
                                         54.13444444444444,
                                         52.561666666666675,
                                         53.64333333333333,
                                         54.724999999999994,
                                         55.806666666666665,
                                         62.44361111111111,
                                         63.60722222222223,
                                         64.77083333333333,
                                         65.93444444444442,
                                         53.673611111111114,
                                         54.64055555555556,
                                         55.607499999999995,
                                         56.574444444444445,
                                         44.11694444444444,
                                         44.88722222222223,
                                         45.6575,
                                         46.427777777777784,
                                         48.96694444444445,
                                         49.893888888888895,
                                         50.82083333333334,
                                         51.74777777777778,
                                         63.52361111111112,
                                         64.68722222222223,
                                         65.85083333333334,
                                         67.01444444444444,
                                         79.02694444444444,
                                         80.42722222222223,
                                         81.82749999999999,
                                         83.22777777777777,
                                         80.06166666666668,
                                         81.36333333333334,
                                         82.66499999999999,
                                         83.96666666666667,
                                         93.22694444444446,
                                         94.62722222222224,
                                         96.02749999999999,
                                         97.42777777777775,
                                         79.61694444444444,
                                         80.78055555555557,
                                         81.94416666666666,
                                         83.10777777777777,
                                         65.06027777777777,
                                         65.98722222222223,
                                         66.91416666666666,
                                         67.84111111111112,
                                         70.44916666666667,
                                         71.27166666666668,
                                         72.09416666666668,
                                         72.91666666666667,
                                         90.25916666666667,
                                         91.29166666666666,
                                         92.32416666666667,
                                         93.35666666666665,
                                         110.90916666666668,
                                         112.15166666666667,
                                         113.39416666666665,
                                         114.63666666666666,
                                         108.95500000000001,
                                         110.11000000000001,
                                         111.26500000000001,
                                         112.42,
                                         123.50916666666666,
                                         124.75166666666667,
                                         125.99416666666667,
                                         127.23666666666666,
                                         104.53916666666667,
                                         105.57166666666666,
                                         106.60416666666669,
                                         107.63666666666666,
                                         84.72916666666666,
                                         85.55166666666668,
                                         86.37416666666667,
                                         87.19666666666667,
                                         97.86583333333333,
                                         98.68833333333335,
                                         99.51083333333334,
                                         100.33333333333333,
                                         124.6758333333333,
                                         125.70833333333334,
                                         126.74083333333336,
                                         127.77333333333333,
                                         152.32583333333335,
                                         153.56833333333333,
                                         154.81083333333333,
                                         156.0533333333333,
                                         147.45499999999998,
                                         148.60999999999999,
                                         149.76500000000001,
                                         150.92000000000002,
                                         164.92583333333332,
                                         166.16833333333332,
                                         167.41083333333333,
                                         168.65333333333334,
                                         138.95583333333335,
                                         139.98833333333332,
                                         141.02083333333334,
                                         142.05333333333337,
                                         112.14583333333333,
                                         112.96833333333333,
                                         113.79083333333332,
                                         114.61333333333334,
                                         140.72138888888887,
                                         141.64833333333334,
                                         142.57527777777779,
                                         143.50222222222223,
                                         178.70472222222222,
                                         179.86833333333334,
                                         181.03194444444446,
                                         182.19555555555556,
                                         217.6347222222222,
                                         219.03500000000003,
                                         220.4352777777778,
                                         221.83555555555557,
                                         208.9083333333333,
                                         210.20999999999995,
                                         211.51166666666668,
                                         212.81333333333336,
                                         231.8347222222222,
                                         233.23499999999996,
                                         234.63527777777782,
                                         236.03555555555562,
                                         194.79805555555552,
                                         195.96166666666664,
                                         197.12527777777777,
                                         198.28888888888892,
                                         156.8147222222222,
                                         157.74166666666665,
                                         158.6686111111111,
                                         159.59555555555556,
                                         126.88472222222222,
                                         127.655,
                                         128.4252777777778,
                                         129.19555555555556,
                                         160.98805555555552,
                                         161.95499999999998,
                                         162.92194444444448,
                                         163.88888888888889,
                                         195.87805555555553,
                                         197.04166666666663,
                                         198.20527777777778,
                                         199.3688888888889,
                                         187.56833333333333,
                                         188.64999999999995,
                                         189.73166666666668,
                                         190.81333333333336,
                                         207.67805555555552,
                                         208.84166666666664,
                                         210.0052777777778,
                                         211.1688888888889,
                                         174.36138888888888,
                                         175.32833333333332,
                                         176.29527777777776,
                                         177.26222222222225,
                                         140.25805555555556,
                                         141.02833333333334,
                                         141.79861111111111,
                                         142.5688888888889,
                                         108.6613888888889,
                                         109.27499999999999,
                                         109.8886111111111,
                                         110.50222222222223,
                                         137.76472222222222,
                                         138.535,
                                         139.3052777777778,
                                         140.07555555555555,
                                         167.4947222222222,
                                         168.42166666666662,
                                         169.34861111111113,
                                         170.27555555555557,
                                         160.06833333333336,
                                         160.92999999999998,
                                         161.79166666666669,
                                         162.65333333333334,
                                         176.8947222222222,
                                         177.82166666666663,
                                         178.7486111111111,
                                         179.67555555555558,
                                         148.41805555555555,
                                         149.18833333333333,
                                         149.9586111111111,
                                         150.7288888888889,
                                         119.31472222222222,
                                         119.92833333333331,
                                         120.54194444444444,
                                         121.15555555555555,
                                         154.35583333333332,
                                         154.96944444444446,
                                         155.58305555555557,
                                         156.1966666666667,
                                         195.1258333333333,
                                         195.8961111111111,
                                         196.6663888888889,
                                         197.4366666666667,
                                         236.5225,
                                         237.44944444444442,
                                         238.37638888888895,
                                         239.30333333333334,
                                         224.23499999999999,
                                         225.09666666666666,
                                         225.95833333333337,
                                         226.82,
                                         245.9225,
                                         246.8494444444444,
                                         247.77638888888893,
                                         248.70333333333335,
                                         205.77916666666667,
                                         206.54944444444442,
                                         207.31972222222223,
                                         208.09,
                                         165.0091666666667,
                                         165.62277777777777,
                                         166.23638888888888,
                                         166.85,
                                         203.28583333333333,
                                         204.0561111111111,
                                         204.8263888888889,
                                         205.59666666666672,
                                         256.8958333333333,
                                         257.86277777777775,
                                         258.82972222222224,
                                         259.79666666666674,
                                         311.29249999999996,
                                         312.4561111111111,
                                         313.61972222222226,
                                         314.78333333333336,
                                         294.85499999999996,
                                         295.93666666666667,
                                         297.0183333333334,
                                         298.1,
                                         323.0925,
                                         324.25611111111107,
                                         325.4197222222223,
                                         326.5833333333333,
                                         270.26916666666665,
                                         271.2361111111111,
                                         272.2030555555556,
                                         273.17,
                                         216.65916666666666,
                                         217.4294444444444,
                                         218.19972222222225,
                                         218.97,
                                         256.6025,
                                         257.52944444444444,
                                         258.4563888888889,
                                         259.3833333333334,
                                         324.17249999999996,
                                         325.33611111111105,
                                         326.49972222222226,
                                         327.6633333333334,
                                         392.6891666666666,
                                         394.08944444444444,
                                         395.48972222222227,
                                         396.89000000000004,
                                         371.635,
                                         372.93666666666667,
                                         374.23833333333334,
                                         375.54,
                                         406.88916666666665,
                                         408.28944444444437,
                                         409.68972222222226,
                                         411.09,
                                         340.2658333333333,
                                         341.4294444444444,
                                         342.59305555555557,
                                         343.75666666666666,
                                         272.6958333333333,
                                         273.62277777777774,
                                         274.5497222222222,
                                         275.4766666666667,
                                         254.6891666666667,
                                         255.51166666666666,
                                         256.33416666666665,
                                         257.15666666666664,
                                         321.5391666666667,
                                         322.5716666666666,
                                         323.60416666666663,
                                         324.63666666666677,
                                         389.22916666666663,
                                         390.4716666666666,
                                         391.71416666666664,
                                         392.9566666666668,
                                         367.67500000000007,
                                         368.83,
                                         369.98500000000007,
                                         371.14000000000004,
                                         401.8291666666667,
                                         403.07166666666666,
                                         404.31416666666667,
                                         405.5566666666667,
                                         335.81916666666666,
                                         336.85166666666663,
                                         337.8841666666667,
                                         338.9166666666667,
                                         268.96916666666664,
                                         269.79166666666663,
                                         270.6141666666666,
                                         271.4366666666667,
                                         282.10583333333335,
                                         282.9283333333334,
                                         283.75083333333333,
                                         284.5733333333333,
                                         355.9558333333334,
                                         356.98833333333334,
                                         358.02083333333337,
                                         359.0533333333333,
                                         430.6458333333334,
                                         431.8883333333333,
                                         433.1308333333334,
                                         434.37333333333333,
                                         406.175,
                                         407.33000000000004,
                                         408.485,
                                         409.64,
                                         443.24583333333334,
                                         444.4883333333334,
                                         445.73083333333335,
                                         446.9733333333333,
                                         370.23583333333335,
                                         371.2683333333333,
                                         372.30083333333334,
                                         373.33333333333337,
                                         296.3858333333334,
                                         297.2083333333333,
                                         298.0308333333333,
                                         298.85333333333335,
                                         348.3569444444445,
                                         349.2838888888889,
                                         350.21083333333337,
                                         351.1377777777778,
                                         439.35361111111115,
                                         440.51722222222224,
                                         441.68083333333334,
                                         442.84444444444443,
                                         531.2969444444445,
                                         532.6972222222223,
                                         534.0975,
                                         535.4977777777777,
                                         500.4816666666667,
                                         501.78333333333336,
                                         503.085,
                                         504.3866666666666,
                                         545.4969444444445,
                                         546.8972222222222,
                                         548.2975,
                                         549.6977777777777,
                                         455.44694444444445,
                                         456.6105555555555,
                                         457.7741666666667,
                                         458.93777777777774,
                                         364.4502777777778,
                                         365.3772222222222,
                                         366.30416666666673,
                                         367.2311111111111,
                                         299.4269444444445,
                                         300.19722222222225,
                                         300.96750000000003,
                                         301.73777777777775,
                                         377.58361111111117,
                                         378.5505555555556,
                                         379.5175,
                                         380.4844444444445,
                                         456.5269444444445,
                                         457.6905555555556,
                                         458.85416666666663,
                                         460.0177777777777,
                                         429.86166666666674,
                                         430.9433333333334,
                                         432.025,
                                         433.1066666666667,
                                         468.3269444444445,
                                         469.49055555555555,
                                         470.65416666666675,
                                         471.8177777777778,
                                         390.95694444444445,
                                         391.9238888888888,
                                         392.8908333333334,
                                         393.85777777777776,
                                         312.8002777777778,
                                         313.5705555555555,
                                         314.34083333333336,
                                         315.11111111111114,
                                         246.11027777777775,
                                         246.72388888888887,
                                         247.33750000000003,
                                         247.95111111111112,
                                         310.30694444444447,
                                         311.07722222222225,
                                         311.8475,
                                         312.61777777777775,
                                         375.1302777777778,
                                         376.05722222222226,
                                         376.9841666666667,
                                         377.9111111111111,
                                         353.08166666666665,
                                         353.9433333333333,
                                         354.805,
                                         355.66666666666663,
                                         384.53027777777777,
                                         385.45722222222213,
                                         386.3841666666667,
                                         387.3111111111111,
                                         320.9602777777778,
                                         321.7305555555555,
                                         322.5008333333334,
                                         323.2711111111111,
                                         256.7636111111111,
                                         257.3772222222222,
                                         257.9908333333333,
                                         258.6044444444444,
                                         271.32472222222225,
                                         271.93833333333333,
                                         272.5519444444444,
                                         273.1655555555556,
                                         326.7080555555556,
                                         327.47833333333335,
                                         328.2486111111111,
                                         329.01888888888897,
                                         382.71805555555557,
                                         383.645,
                                         384.57194444444445,
                                         385.498888888889,
                                         330.20833333333326,
                                         331.06999999999994,
                                         331.9316666666666,
                                         332.7933333333334,
                                         332.3847222222222,
                                         333.3116666666666,
                                         334.2386111111111,
                                         335.16555555555556,
                                         277.6280555555555,
                                         278.39833333333326,
                                         279.1686111111111,
                                         279.9388888888889,
                                         222.24472222222224,
                                         222.85833333333332,
                                         223.47194444444443,
                                         224.08555555555557,
                                         275.13472222222225,
                                         275.905,
                                         276.6752777777778,
                                         277.4455555555556,
                                         331.83805555555557,
                                         332.805,
                                         333.77194444444444,
                                         334.73888888888894,
                                         389.3280555555556,
                                         390.4916666666666,
                                         391.6552777777778,
                                         392.818888888889,
                                         337.4683333333333,
                                         338.54999999999995,
                                         339.6316666666666,
                                         340.71333333333337,
                                         341.39472222222224,
                                         342.5583333333333,
                                         343.7219444444444,
                                         344.8855555555555,
                                         285.4780555555555,
                                         286.44499999999994,
                                         287.4119444444444,
                                         288.3788888888889,
                                         228.77472222222224,
                                         229.545,
                                         230.31527777777777,
                                         231.08555555555554,
                                         283.33138888888885,
                                         284.25833333333327,
                                         285.1852777777778,
                                         286.1122222222222,
                                         342.47472222222217,
                                         343.6383333333333,
                                         344.8019444444444,
                                         345.96555555555557,
                                         402.5647222222222,
                                         403.9649999999999,
                                         405.3652777777778,
                                         406.76555555555564,
                                         350.88833333333326,
                                         352.18999999999994,
                                         353.4916666666666,
                                         354.7933333333334,
                                         357.0313888888889,
                                         358.4316666666666,
                                         359.8319444444444,
                                         361.2322222222222,
                                         298.8347222222222,
                                         299.9983333333333,
                                         301.1619444444444,
                                         302.32555555555564,
                                         239.6913888888889,
                                         240.6183333333333,
                                         241.54527777777778,
                                         242.4722222222222,
                                         177.8091666666667,
                                         178.63166666666666,
                                         179.4541666666667,
                                         180.2766666666667,
                                         209.77916666666667,
                                         210.81166666666667,
                                         211.8441666666667,
                                         212.8766666666667,
                                         242.58916666666664,
                                         243.83166666666665,
                                         245.07416666666674,
                                         246.3166666666667,
                                         201.435,
                                         202.58999999999997,
                                         203.74500000000006,
                                         204.9,
                                         195.45583333333332,
                                         196.6983333333333,
                                         197.9408333333334,
                                         199.18333333333334,
                                         164.32583333333332,
                                         165.35833333333332,
                                         166.39083333333335,
                                         167.42333333333332,
                                         132.35583333333332,
                                         133.17833333333334,
                                         134.00083333333333,
                                         134.82333333333332,
                                         104.95916666666669,
                                         105.78166666666665,
                                         106.60416666666667,
                                         107.42666666666666,
                                         118.32916666666667,
                                         119.36166666666666,
                                         120.39416666666668,
                                         121.42666666666666,
                                         132.53916666666666,
                                         133.78166666666667,
                                         135.02416666666667,
                                         136.26666666666665,
                                         99.13499999999999,
                                         100.29,
                                         101.44500000000001,
                                         102.60000000000001,
                                         85.40583333333333,
                                         86.64833333333333,
                                         87.89083333333335,
                                         89.13333333333334,
                                         72.87583333333333,
                                         73.90833333333333,
                                         74.94083333333334,
                                         75.97333333333334,
                                         59.50583333333333,
                                         60.32833333333333,
                                         61.15083333333333,
                                         61.973333333333336,
                                         81.39694444444446,
                                         82.32388888888889,
                                         83.25083333333333,
                                         84.17777777777778,
                                         104.23361111111112,
                                         105.39722222222223,
                                         106.56083333333332,
                                         107.72444444444446,
                                         128.01694444444445,
                                         129.41722222222222,
                                         130.8175,
                                         132.21777777777777,
                                         125.60166666666669,
                                         126.90333333333334,
                                         128.20499999999998,
                                         129.50666666666666,
                                         142.21694444444444,
                                         143.6172222222222,
                                         145.0175,
                                         146.41777777777776,
                                         120.32694444444445,
                                         121.49055555555556,
                                         122.65416666666667,
                                         123.81777777777776,
                                         97.49027777777778,
                                         98.41722222222222,
                                         99.34416666666667,
                                         100.27111111111111,
                                         77.58694444444446,
                                         78.35722222222222,
                                         79.1275,
                                         79.89777777777778,
                                         99.10361111111112,
                                         100.07055555555557,
                                         101.0375,
                                         102.00444444444446,
                                         121.40694444444445,
                                         122.57055555555556,
                                         123.73416666666665,
                                         124.89777777777778,
                                         118.34166666666668,
                                         119.42333333333335,
                                         120.505,
                                         121.58666666666667,
                                         133.20694444444445,
                                         134.37055555555554,
                                         135.53416666666666,
                                         136.69777777777776,
                                         112.47694444444446,
                                         113.44388888888889,
                                         114.41083333333333,
                                         115.37777777777777,
                                         90.96027777777778,
                                         91.73055555555555,
                                         92.50083333333333,
                                         93.27111111111111,
                                         69.39027777777778,
                                         70.00388888888888,
                                         70.61749999999999,
                                         71.23111111111112,
                                         88.46694444444447,
                                         89.23722222222223,
                                         90.0075,
                                         90.77777777777777,
                                         108.17027777777778,
                                         109.09722222222223,
                                         110.02416666666666,
                                         110.95111111111112,
                                         104.92166666666668,
                                         105.78333333333333,
                                         106.645,
                                         107.50666666666666,
                                         117.57027777777779,
                                         118.49722222222222,
                                         119.42416666666665,
                                         120.3511111111111,
                                         99.12027777777777,
                                         99.89055555555555,
                                         100.66083333333333,
                                         101.43111111111111,
                                         80.04361111111112,
                                         80.65722222222222,
                                         81.27083333333333,
                                         81.88444444444443};
  const std::array<int, 4> in_shape = {{3, 8, 7, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x7x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         0.36,
                                         0.4,
                                         0.44,
                                         0.48,
                                         0.56,
                                         0.64,
                                         0.72,
                                         0.8,
                                         1.44,
                                         1.6,
                                         1.76,
                                         1.9200000000000002,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.64,
                                         2.88,
                                         3.12,
                                         3.3600000000000003,
                                         2.08,
                                         2.2399999999999998,
                                         2.4,
                                         2.56,
                                         1.2,
                                         1.28,
                                         1.36,
                                         1.44,
                                         1.56,
                                         1.6800000000000002,
                                         1.8,
                                         1.9200000000000002,
                                         3.5999999999999996,
                                         3.84,
                                         4.08,
                                         4.32,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         6.12,
                                         6.48,
                                         6.840000000000001,
                                         7.200000000000001,
                                         4.5600000000000005,
                                         4.8,
                                         5.04,
                                         5.279999999999999,
                                         2.52,
                                         2.64,
                                         2.7600000000000002,
                                         2.88,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         6.720000000000001,
                                         7.039999999999999,
                                         7.36,
                                         7.68,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         8.000000000000002,
                                         8.32,
                                         8.64,
                                         8.959999999999999,
                                         4.32,
                                         4.48,
                                         4.640000000000001,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         6.720000000000001,
                                         7.039999999999999,
                                         7.36,
                                         7.68,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         8.000000000000002,
                                         8.32,
                                         8.64,
                                         8.959999999999999,
                                         4.32,
                                         4.48,
                                         4.640000000000001,
                                         4.8,
                                         3.,
                                         3.12,
                                         3.24,
                                         3.3600000000000003,
                                         6.48,
                                         6.720000000000001,
                                         6.96,
                                         7.199999999999999,
                                         10.440000000000001,
                                         10.8,
                                         11.160000000000002,
                                         11.52,
                                         10.440000000000001,
                                         10.8,
                                         11.160000000000002,
                                         11.52,
                                         10.440000000000001,
                                         10.8,
                                         11.160000000000002,
                                         11.52,
                                         7.44,
                                         7.68,
                                         7.92,
                                         8.16,
                                         3.96,
                                         4.08,
                                         4.2,
                                         4.32,
                                         2.48,
                                         2.56,
                                         2.64,
                                         2.72,
                                         5.28,
                                         5.44,
                                         5.6000000000000005,
                                         5.76,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         8.400000000000002,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.3999999999999995,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.36,
                                         1.48,
                                         1.52,
                                         1.56,
                                         1.6,
                                         3.12,
                                         3.2,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         4.92,
                                         5.04,
                                         5.16,
                                         5.28,
                                         3.4400000000000004,
                                         3.52,
                                         3.6,
                                         3.6799999999999997,
                                         1.8,
                                         1.84,
                                         1.8800000000000001,
                                         1.92,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         2.2800000000000002,
                                         2.32,
                                         2.36,
                                         2.4,
                                         4.4,
                                         4.48,
                                         4.5600000000000005,
                                         4.640000000000001,
                                         9.12,
                                         9.280000000000001,
                                         9.44,
                                         9.600000000000001,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         14.16,
                                         14.400000000000002,
                                         14.639999999999999,
                                         14.880000000000003,
                                         9.76,
                                         9.920000000000002,
                                         10.08,
                                         10.240000000000002,
                                         5.040000000000001,
                                         5.12,
                                         5.199999999999999,
                                         5.279999999999999,
                                         7.32,
                                         7.44,
                                         7.5600000000000005,
                                         7.680000000000001,
                                         15.12,
                                         15.360000000000003,
                                         15.6,
                                         15.84,
                                         23.4,
                                         23.760000000000005,
                                         24.12,
                                         24.48,
                                         23.4,
                                         23.760000000000005,
                                         24.12,
                                         24.48,
                                         23.4,
                                         23.760000000000005,
                                         24.12,
                                         24.48,
                                         16.08,
                                         16.320000000000004,
                                         16.560000000000002,
                                         16.8,
                                         8.280000000000001,
                                         8.4,
                                         8.52,
                                         8.639999999999999,
                                         10.72,
                                         10.88,
                                         11.040000000000001,
                                         11.200000000000001,
                                         22.08,
                                         22.400000000000006,
                                         22.72,
                                         23.04,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         23.359999999999996,
                                         23.680000000000007,
                                         24.000000000000004,
                                         24.32,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         10.72,
                                         10.88,
                                         11.040000000000001,
                                         11.200000000000001,
                                         22.08,
                                         22.400000000000006,
                                         22.72,
                                         23.04,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         34.08,
                                         34.56000000000001,
                                         35.04,
                                         35.519999999999996,
                                         23.359999999999996,
                                         23.680000000000007,
                                         24.000000000000004,
                                         24.32,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         8.76,
                                         8.879999999999999,
                                         9.,
                                         9.12,
                                         18.,
                                         18.24,
                                         18.48,
                                         18.72,
                                         27.719999999999995,
                                         28.080000000000005,
                                         28.44,
                                         28.799999999999997,
                                         27.719999999999995,
                                         28.080000000000005,
                                         28.44,
                                         28.799999999999997,
                                         27.719999999999995,
                                         28.080000000000005,
                                         28.44,
                                         28.799999999999997,
                                         18.96,
                                         19.2,
                                         19.44,
                                         19.68,
                                         9.72,
                                         9.84,
                                         9.96,
                                         10.08,
                                         6.32,
                                         6.4,
                                         6.48,
                                         6.5600000000000005,
                                         12.96,
                                         13.12,
                                         13.280000000000001,
                                         13.44,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         19.919999999999998,
                                         20.16,
                                         20.400000000000002,
                                         20.64,
                                         13.600000000000001,
                                         13.76,
                                         13.920000000000002,
                                         14.08,
                                         6.960000000000001,
                                         7.040000000000001,
                                         7.120000000000001,
                                         7.199999999999999,
                                         3.4,
                                         3.44,
                                         3.48,
                                         3.52,
                                         6.96,
                                         7.04,
                                         7.12,
                                         7.2,
                                         10.68,
                                         10.8,
                                         10.92,
                                         11.04,
                                         10.68,
                                         10.8,
                                         10.92,
                                         11.04,
                                         10.68,
                                         10.8,
                                         10.92,
                                         11.04,
                                         7.28,
                                         7.36,
                                         7.44,
                                         7.52,
                                         3.72,
                                         3.7600000000000002,
                                         3.8000000000000003,
                                         3.84,
                                         3.88,
                                         3.92,
                                         3.96,
                                         4.,
                                         7.92,
                                         8.,
                                         8.08,
                                         8.16,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         12.120000000000001,
                                         12.24,
                                         12.36,
                                         12.48,
                                         8.24,
                                         8.32,
                                         8.4,
                                         8.48,
                                         4.2,
                                         4.24,
                                         4.28,
                                         4.32,
                                         8.24,
                                         8.32,
                                         8.4,
                                         8.48,
                                         16.8,
                                         16.96,
                                         17.12,
                                         17.28,
                                         25.68,
                                         25.92,
                                         26.160000000000004,
                                         26.400000000000002,
                                         25.68,
                                         25.92,
                                         26.160000000000004,
                                         26.400000000000002,
                                         25.68,
                                         25.92,
                                         26.160000000000004,
                                         26.400000000000002,
                                         17.44,
                                         17.6,
                                         17.759999999999998,
                                         17.92,
                                         8.879999999999999,
                                         8.96,
                                         9.04,
                                         9.120000000000001,
                                         13.08,
                                         13.2,
                                         13.32,
                                         13.440000000000001,
                                         26.64,
                                         26.88,
                                         27.119999999999997,
                                         27.360000000000003,
                                         40.67999999999999,
                                         41.040000000000006,
                                         41.400000000000006,
                                         41.760000000000005,
                                         40.67999999999999,
                                         41.040000000000006,
                                         41.400000000000006,
                                         41.760000000000005,
                                         40.67999999999999,
                                         41.040000000000006,
                                         41.400000000000006,
                                         41.760000000000005,
                                         27.6,
                                         27.84,
                                         28.08,
                                         28.320000000000004,
                                         14.04,
                                         14.16,
                                         14.28,
                                         14.400000000000002,
                                         18.4,
                                         18.56,
                                         18.72,
                                         18.880000000000003,
                                         37.44,
                                         37.760000000000005,
                                         38.08,
                                         38.400000000000006,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         38.72,
                                         39.04,
                                         39.36,
                                         39.68,
                                         19.68,
                                         19.84,
                                         20.,
                                         20.160000000000004,
                                         18.4,
                                         18.56,
                                         18.72,
                                         18.880000000000003,
                                         37.44,
                                         37.760000000000005,
                                         38.08,
                                         38.400000000000006,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         57.11999999999999,
                                         57.60000000000001,
                                         58.080000000000005,
                                         58.56,
                                         38.72,
                                         39.04,
                                         39.36,
                                         39.68,
                                         19.68,
                                         19.84,
                                         20.,
                                         20.160000000000004,
                                         14.52,
                                         14.64,
                                         14.76,
                                         14.880000000000003,
                                         29.52,
                                         29.759999999999998,
                                         30.,
                                         30.240000000000006,
                                         45.,
                                         45.36,
                                         45.72,
                                         46.080000000000005,
                                         45.,
                                         45.36,
                                         45.72,
                                         46.080000000000005,
                                         45.,
                                         45.36,
                                         45.72,
                                         46.080000000000005,
                                         30.48,
                                         30.72,
                                         30.96,
                                         31.200000000000003,
                                         15.48,
                                         15.6,
                                         15.719999999999999,
                                         15.84,
                                         10.16,
                                         10.24,
                                         10.32,
                                         10.4,
                                         20.64,
                                         20.8,
                                         20.96,
                                         21.12,
                                         31.44,
                                         31.68,
                                         31.92,
                                         32.160000000000004,
                                         31.44,
                                         31.68,
                                         31.92,
                                         32.160000000000004,
                                         31.44,
                                         31.68,
                                         31.92,
                                         32.160000000000004,
                                         21.28,
                                         21.44,
                                         21.6,
                                         21.759999999999998,
                                         10.8,
                                         10.879999999999999,
                                         10.96,
                                         11.04,
                                         5.32,
                                         5.36,
                                         5.4,
                                         5.44,
                                         10.8,
                                         10.88,
                                         10.96,
                                         11.040000000000001,
                                         16.44,
                                         16.560000000000002,
                                         16.68,
                                         16.8,
                                         16.44,
                                         16.560000000000002,
                                         16.68,
                                         16.8,
                                         16.44,
                                         16.560000000000002,
                                         16.68,
                                         16.8,
                                         11.120000000000001,
                                         11.2,
                                         11.280000000000001,
                                         11.36,
                                         5.64,
                                         5.68,
                                         5.72,
                                         5.76};
  const std::array<int, 4> in_shape = {{3, 8, 7, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {5.196111111111111,
                                         6.862777777777778,
                                         8.686111111111112,
                                         8.671666666666667,
                                         9.650833333333333,
                                         11.963055555555556,
                                         10.296388888888888,
                                         8.473055555555556,
                                         9.242777777777778,
                                         12.029444444444444,
                                         15.012777777777778,
                                         14.531666666666666,
                                         15.760833333333334,
                                         19.12638888888889,
                                         16.33972222222222,
                                         13.356388888888889,
                                         14.542777777777777,
                                         18.769444444444442,
                                         23.232777777777777,
                                         22.071666666666665,
                                         23.550833333333333,
                                         28.18305555555556,
                                         23.95638888888889,
                                         19.493055555555557,
                                         20.618333333333332,
                                         26.338333333333335,
                                         32.26833333333334,
                                         29.925,
                                         31.237500000000004,
                                         36.660833333333336,
                                         30.940833333333337,
                                         25.010833333333334,
                                         28.451666666666664,
                                         36.17166666666667,
                                         44.10166666666667,
                                         40.425000000000004,
                                         41.737500000000004,
                                         48.49416666666667,
                                         40.77416666666667,
                                         32.844166666666666,
                                         40.75833333333333,
                                         51.678333333333335,
                                         62.83500000000001,
                                         57.211666666666666,
                                         58.69083333333334,
                                         67.78527777777778,
                                         56.86527777777778,
                                         45.70861111111111,
                                         36.711666666666666,
                                         46.51166666666667,
                                         56.50833333333334,
                                         51.35166666666667,
                                         52.58083333333334,
                                         60.62194444444444,
                                         50.82194444444444,
                                         40.82527777777777,
                                         31.411666666666665,
                                         39.77166666666667,
                                         48.28833333333333,
                                         43.81166666666666,
                                         44.79083333333333,
                                         51.565277777777766,
                                         43.20527777777778,
                                         34.688611111111115,
                                         44.467222222222226,
                                         56.160555555555554,
                                         68.01055555555557,
                                         61.31166666666666,
                                         62.290833333333325,
                                         71.28749999999998,
                                         59.59416666666666,
                                         47.744166666666665,
                                         58.54055555555556,
                                         73.91388888888889,
                                         89.48388888888891,
                                         80.61166666666668,
                                         81.84083333333334,
                                         93.5975,
                                         78.22416666666666,
                                         62.65416666666666,
                                         73.86722222222222,
                                         93.24055555555556,
                                         112.85055555555559,
                                         101.59166666666668,
                                         103.07083333333334,
                                         117.80083333333334,
                                         98.42750000000001,
                                         78.81750000000001,
                                         73.25833333333334,
                                         92.41833333333332,
                                         111.78833333333334,
                                         100.485,
                                         101.79750000000001,
                                         116.18083333333334,
                                         97.02083333333333,
                                         77.65083333333334,
                                         81.09166666666667,
                                         102.25166666666667,
                                         123.62166666666666,
                                         110.98500000000001,
                                         112.2975,
                                         128.01416666666665,
                                         106.85416666666667,
                                         85.48416666666668,
                                         100.08277777777779,
                                         126.14944444444444,
                                         152.4527777777778,
                                         136.73166666666668,
                                         138.21083333333334,
                                         157.40305555555557,
                                         131.33638888888888,
                                         105.03305555555556,
                                         86.00944444444445,
                                         108.39611111111111,
                                         130.97944444444445,
                                         117.43166666666667,
                                         118.66083333333333,
                                         135.09305555555554,
                                         112.70638888888888,
                                         90.12305555555554,
                                         70.68277777777777,
                                         89.06944444444446,
                                         107.61277777777778,
                                         96.45166666666667,
                                         97.43083333333333,
                                         110.88972222222222,
                                         92.50305555555556,
                                         73.95972222222221,
                                         83.73833333333333,
                                         105.45833333333333,
                                         127.335,
                                         113.95166666666665,
                                         114.93083333333331,
                                         130.61194444444442,
                                         108.89194444444442,
                                         87.01527777777778,
                                         107.83833333333334,
                                         135.79833333333335,
                                         163.95499999999998,
                                         146.69166666666666,
                                         147.9208333333333,
                                         168.06861111111107,
                                         140.10861111111106,
                                         111.95194444444445,
                                         133.19166666666666,
                                         167.71166666666667,
                                         202.4683333333333,
                                         181.11166666666668,
                                         182.59083333333328,
                                         207.41861111111106,
                                         172.89861111111102,
                                         138.14194444444445,
                                         125.89833333333333,
                                         158.4983333333333,
                                         191.30833333333334,
                                         171.045,
                                         172.35750000000002,
                                         195.70083333333332,
                                         163.10083333333333,
                                         130.29083333333332,
                                         133.73166666666665,
                                         168.33166666666665,
                                         203.14166666666665,
                                         181.545,
                                         182.8575,
                                         207.53416666666666,
                                         172.93416666666667,
                                         138.12416666666667,
                                         159.40722222222223,
                                         200.62055555555554,
                                         242.07055555555553,
                                         216.25166666666667,
                                         217.73083333333332,
                                         247.02083333333331,
                                         205.80749999999998,
                                         164.35750000000002,
                                         135.3072222222222,
                                         170.28055555555554,
                                         205.45055555555555,
                                         183.51166666666666,
                                         184.7408333333333,
                                         209.56416666666664,
                                         174.5908333333333,
                                         139.42083333333335,
                                         109.9538888888889,
                                         138.36722222222224,
                                         166.93722222222223,
                                         149.09166666666667,
                                         150.07083333333333,
                                         170.21416666666664,
                                         141.80083333333334,
                                         113.23083333333334};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.12,
                                         0.24,
                                         0.4,
                                         0.4,
                                         0.36,
                                         0.28,
                                         0.16,
                                         0.24000000000000002,
                                         0.56,
                                         0.96,
                                         1.4400000000000002,
                                         1.4400000000000002,
                                         1.2,
                                         0.8800000000000001,
                                         0.48,
                                         0.6,
                                         1.32,
                                         2.1599999999999997,
                                         3.12,
                                         3.12,
                                         2.52,
                                         1.8,
                                         0.96,
                                         1.12,
                                         2.4000000000000004,
                                         3.84,
                                         5.4399999999999995,
                                         5.4399999999999995,
                                         4.32,
                                         3.04,
                                         1.6,
                                         1.12,
                                         2.4000000000000004,
                                         3.84,
                                         5.4399999999999995,
                                         5.4399999999999995,
                                         4.32,
                                         3.04,
                                         1.6,
                                         1.08,
                                         2.2800000000000002,
                                         3.6,
                                         5.039999999999999,
                                         5.039999999999999,
                                         3.9600000000000004,
                                         2.7600000000000002,
                                         1.44,
                                         0.88,
                                         1.84,
                                         2.8800000000000003,
                                         4.,
                                         4.,
                                         3.12,
                                         2.16,
                                         1.12,
                                         0.52,
                                         1.08,
                                         1.6800000000000002,
                                         2.3200000000000003,
                                         2.3200000000000003,
                                         1.8000000000000003,
                                         1.24,
                                         0.64,
                                         0.68,
                                         1.4,
                                         2.16,
                                         2.96,
                                         2.96,
                                         2.2800000000000002,
                                         1.56,
                                         0.8,
                                         1.52,
                                         3.1199999999999997,
                                         4.8,
                                         6.56,
                                         6.56,
                                         5.04,
                                         3.44,
                                         1.76,
                                         2.52,
                                         5.159999999999999,
                                         7.92,
                                         10.8,
                                         10.8,
                                         8.280000000000001,
                                         5.64,
                                         2.88,
                                         3.6799999999999997,
                                         7.52,
                                         11.52,
                                         15.68,
                                         15.68,
                                         12.,
                                         8.16,
                                         4.16,
                                         3.6799999999999997,
                                         7.52,
                                         11.52,
                                         15.68,
                                         15.68,
                                         12.,
                                         8.16,
                                         4.16,
                                         3.,
                                         6.12,
                                         9.36,
                                         12.719999999999999,
                                         12.719999999999999,
                                         9.719999999999999,
                                         6.6000000000000005,
                                         3.3600000000000003,
                                         2.16,
                                         4.4,
                                         6.720000000000001,
                                         9.120000000000001,
                                         9.120000000000001,
                                         6.960000000000001,
                                         4.720000000000001,
                                         2.4000000000000004,
                                         1.16,
                                         2.36,
                                         3.5999999999999996,
                                         4.88,
                                         4.88,
                                         3.7199999999999998,
                                         2.52,
                                         1.28,
                                         1.32,
                                         2.68,
                                         4.08,
                                         5.52,
                                         5.52,
                                         4.2,
                                         2.84,
                                         1.44,
                                         2.8,
                                         5.68,
                                         8.64,
                                         11.68,
                                         11.68,
                                         8.88,
                                         6.,
                                         3.04,
                                         4.4399999999999995,
                                         9.,
                                         13.680000000000001,
                                         18.48,
                                         18.48,
                                         14.040000000000001,
                                         9.48,
                                         4.8,
                                         6.239999999999999,
                                         12.64,
                                         19.200000000000003,
                                         25.92,
                                         25.92,
                                         19.68,
                                         13.280000000000001,
                                         6.72,
                                         6.239999999999999,
                                         12.64,
                                         19.200000000000003,
                                         25.92,
                                         25.92,
                                         19.68,
                                         13.280000000000001,
                                         6.72,
                                         4.92,
                                         9.96,
                                         15.120000000000003,
                                         20.4,
                                         20.4,
                                         15.48,
                                         10.44,
                                         5.28,
                                         3.4400000000000004,
                                         6.96,
                                         10.56,
                                         14.24,
                                         14.24,
                                         10.8,
                                         7.28,
                                         3.6799999999999997,
                                         1.8,
                                         3.64,
                                         5.5200000000000005,
                                         7.44,
                                         7.44,
                                         5.640000000000001,
                                         3.8,
                                         1.92};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {9.778611111111111,
                                         10.392222222222221,
                                         12.955277777777779,
                                         13.725555555555555,
                                         16.44527777777778,
                                         17.372222222222224,
                                         16.520833333333336,
                                         17.343333333333334,
                                         18.479166666666668,
                                         19.301666666666666,
                                         22.999166666666667,
                                         23.926111111111112,
                                         19.822499999999998,
                                         20.592777777777776,
                                         16.3325,
                                         16.94611111111111,
                                         17.71527777777778,
                                         18.485555555555557,
                                         23.091944444444447,
                                         24.058888888888887,
                                         28.861944444444447,
                                         30.025555555555556,
                                         28.030833333333337,
                                         29.063333333333333,
                                         30.48916666666667,
                                         31.52166666666667,
                                         37.08916666666667,
                                         38.25277777777778,
                                         31.7125,
                                         32.67944444444444,
                                         25.9425,
                                         26.712777777777777,
                                         28.158611111111114,
                                         29.085555555555555,
                                         36.37527777777778,
                                         37.538888888888884,
                                         45.06527777777778,
                                         46.465555555555554,
                                         42.90083333333334,
                                         44.14333333333333,
                                         45.859166666666674,
                                         47.10166666666667,
                                         54.96583333333334,
                                         56.36611111111112,
                                         46.74916666666667,
                                         47.91277777777778,
                                         38.05916666666666,
                                         38.986111111111114,
                                         40.41416666666667,
                                         41.236666666666665,
                                         51.64416666666666,
                                         52.67666666666667,
                                         63.29416666666667,
                                         64.53666666666668,
                                         58.74750000000001,
                                         59.85,
                                         61.3725,
                                         62.47500000000001,
                                         72.07916666666667,
                                         73.32166666666667,
                                         60.84916666666667,
                                         61.881666666666675,
                                         49.19916666666667,
                                         50.02166666666667,
                                         56.08083333333333,
                                         56.90333333333333,
                                         71.31083333333333,
                                         72.34333333333333,
                                         86.96083333333334,
                                         88.20333333333333,
                                         79.7475,
                                         80.85000000000001,
                                         82.3725,
                                         83.47500000000001,
                                         95.74583333333334,
                                         96.98833333333334,
                                         80.51583333333333,
                                         81.54833333333335,
                                         64.86583333333334,
                                         65.68833333333333,
                                         80.5897222222222,
                                         81.51666666666667,
                                         102.19305555555555,
                                         103.35666666666667,
                                         124.26972222222221,
                                         125.67000000000002,
                                         113.18083333333333,
                                         114.42333333333333,
                                         116.13916666666667,
                                         117.38166666666667,
                                         134.17027777777778,
                                         135.57055555555556,
                                         112.56694444444446,
                                         113.73055555555555,
                                         90.49027777777779,
                                         91.41722222222222,
                                         72.65305555555554,
                                         73.42333333333333,
                                         92.05638888888888,
                                         93.02333333333334,
                                         111.85305555555554,
                                         113.01666666666668,
                                         101.67083333333332,
                                         102.70333333333333,
                                         104.12916666666668,
                                         105.16166666666668,
                                         120.08027777777778,
                                         121.24388888888888,
                                         100.67694444444446,
                                         101.64388888888888,
                                         80.88027777777778,
                                         81.65055555555554,
                                         62.20972222222221,
                                         62.82333333333333,
                                         78.77305555555556,
                                         79.54333333333334,
                                         95.64972222222222,
                                         96.57666666666665,
                                         86.80083333333333,
                                         87.62333333333332,
                                         88.75916666666667,
                                         89.58166666666666,
                                         102.20361111111112,
                                         103.13055555555553,
                                         85.64027777777778,
                                         86.41055555555556,
                                         68.7636111111111,
                                         69.37722222222223,
                                         88.32083333333334,
                                         88.93444444444445,
                                         111.55083333333334,
                                         112.32111111111111,
                                         135.09416666666667,
                                         136.02111111111114,
                                         121.80083333333336,
                                         122.62333333333332,
                                         123.75916666666667,
                                         124.58166666666665,
                                         141.64805555555554,
                                         142.57499999999996,
                                         118.41805555555557,
                                         119.18833333333332,
                                         94.87472222222223,
                                         95.48833333333333,
                                         116.31083333333333,
                                         117.08111111111111,
                                         146.86083333333335,
                                         147.82777777777778,
                                         177.80416666666667,
                                         178.96777777777783,
                                         160.19083333333336,
                                         161.22333333333336,
                                         162.64916666666664,
                                         163.68166666666667,
                                         186.03138888888884,
                                         187.195,
                                         155.4813888888889,
                                         156.44833333333332,
                                         124.53805555555557,
                                         125.30833333333332,
                                         146.8075,
                                         147.73444444444445,
                                         185.31750000000002,
                                         186.48111111111112,
                                         224.30083333333334,
                                         225.70111111111117,
                                         201.94083333333336,
                                         203.18333333333337,
                                         204.89916666666664,
                                         206.14166666666668,
                                         234.20138888888886,
                                         235.6016666666667,
                                         195.6913888888889,
                                         196.85500000000002,
                                         156.70805555555557,
                                         157.63500000000002,
                                         145.6941666666667,
                                         146.51666666666668,
                                         183.8041666666667,
                                         184.83666666666664,
                                         222.33416666666668,
                                         223.57666666666668,
                                         199.86750000000004,
                                         200.97,
                                         202.49250000000004,
                                         203.59500000000003,
                                         231.1191666666667,
                                         232.36166666666668,
                                         193.00916666666672,
                                         194.04166666666666,
                                         154.47916666666669,
                                         155.30166666666668,
                                         161.36083333333332,
                                         162.18333333333334,
                                         203.47083333333333,
                                         204.50333333333333,
                                         246.00083333333336,
                                         247.2433333333333,
                                         220.8675,
                                         221.97000000000003,
                                         223.4925,
                                         224.595,
                                         254.78583333333336,
                                         256.0283333333333,
                                         212.67583333333334,
                                         213.70833333333334,
                                         170.14583333333334,
                                         170.96833333333336,
                                         199.2386111111111,
                                         200.16555555555558,
                                         251.1352777777778,
                                         252.29888888888888,
                                         303.5052777777778,
                                         304.9055555555556,
                                         272.22083333333336,
                                         273.46333333333337,
                                         275.1791666666667,
                                         276.4216666666667,
                                         313.4058333333333,
                                         314.80611111111114,
                                         261.50916666666666,
                                         262.67277777777775,
                                         209.13916666666665,
                                         210.06611111111113,
                                         171.24861111111113,
                                         172.0188888888889,
                                         215.82527777777779,
                                         216.79222222222222,
                                         260.79527777777776,
                                         261.9588888888889,
                                         233.83083333333332,
                                         234.86333333333334,
                                         236.28916666666666,
                                         237.32166666666666,
                                         269.0225,
                                         270.1861111111111,
                                         224.44583333333333,
                                         225.41277777777776,
                                         179.47583333333336,
                                         180.24611111111108,
                                         140.75194444444443,
                                         141.36555555555555,
                                         177.3686111111111,
                                         178.1388888888889,
                                         214.29861111111111,
                                         215.22555555555556,
                                         192.08083333333332,
                                         192.90333333333334,
                                         194.03916666666666,
                                         194.86166666666665,
                                         220.85250000000002,
                                         221.77944444444444,
                                         184.23583333333335,
                                         185.00611111111112,
                                         147.30583333333334,
                                         147.91944444444442,
                                         166.86305555555558,
                                         167.47666666666666,
                                         210.14638888888888,
                                         210.91666666666666,
                                         253.74305555555557,
                                         254.67,
                                         227.08083333333337,
                                         227.9033333333333,
                                         229.0391666666667,
                                         229.86166666666662,
                                         260.2969444444445,
                                         261.22388888888884,
                                         217.01361111111112,
                                         217.78388888888884,
                                         173.41694444444445,
                                         174.03055555555557,
                                         214.9063888888889,
                                         215.67666666666668,
                                         270.6297222222222,
                                         271.5966666666667,
                                         326.74638888888893,
                                         327.90999999999997,
                                         292.35083333333336,
                                         293.3833333333333,
                                         294.8091666666667,
                                         295.8416666666666,
                                         334.97361111111115,
                                         336.13722222222214,
                                         279.2502777777778,
                                         280.2172222222221,
                                         223.13361111111112,
                                         223.9038888888889,
                                         265.4563888888889,
                                         266.3833333333333,
                                         334.25972222222214,
                                         335.42333333333335,
                                         403.5363888888889,
                                         404.9366666666666,
                                         360.98083333333335,
                                         362.22333333333336,
                                         363.9391666666667,
                                         365.18166666666656,
                                         413.43694444444446,
                                         414.8372222222221,
                                         344.6336111111111,
                                         345.79722222222205,
                                         275.3569444444445,
                                         276.2838888888889,
                                         250.9741666666667,
                                         251.79666666666665,
                                         315.9641666666667,
                                         316.9966666666666,
                                         381.37416666666667,
                                         382.6166666666667,
                                         340.9875,
                                         342.09,
                                         343.6125,
                                         344.71500000000003,
                                         390.15916666666664,
                                         391.40166666666664,
                                         325.1691666666666,
                                         326.20166666666665,
                                         259.75916666666666,
                                         260.58166666666665,
                                         266.6408333333333,
                                         267.4633333333333,
                                         335.6308333333333,
                                         336.6633333333333,
                                         405.0408333333334,
                                         406.2833333333333,
                                         361.98750000000007,
                                         363.09,
                                         364.61250000000007,
                                         365.715,
                                         413.8258333333333,
                                         415.0683333333333,
                                         344.8358333333333,
                                         345.86833333333334,
                                         275.42583333333334,
                                         276.24833333333333,
                                         317.8875,
                                         318.81444444444446,
                                         400.0775,
                                         401.2411111111111,
                                         482.7408333333334,
                                         484.14111111111106,
                                         431.2608333333333,
                                         432.50333333333333,
                                         434.2191666666666,
                                         435.46166666666664,
                                         492.6413888888888,
                                         494.04166666666663,
                                         410.45138888888886,
                                         411.61499999999995,
                                         327.78805555555556,
                                         328.71500000000003,
                                         269.84416666666664,
                                         270.6144444444444,
                                         339.5941666666667,
                                         340.5611111111111,
                                         409.7375,
                                         410.9011111111111,
                                         365.99083333333334,
                                         367.0233333333333,
                                         368.4491666666666,
                                         369.4816666666666,
                                         417.9647222222222,
                                         419.1283333333333,
                                         348.21472222222224,
                                         349.1816666666666,
                                         278.07138888888886,
                                         278.8416666666667,
                                         219.29416666666665,
                                         219.9077777777778,
                                         275.96416666666664,
                                         276.7344444444445,
                                         332.9475,
                                         333.87444444444446,
                                         297.36083333333335,
                                         298.18333333333334,
                                         299.31916666666666,
                                         300.14166666666665,
                                         339.50138888888887,
                                         340.4283333333333,
                                         282.83138888888885,
                                         283.6016666666667,
                                         225.84805555555553,
                                         226.46166666666667};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.16,
                                         0.24,
                                         0.36,
                                         0.48,
                                         0.64,
                                         0.8,
                                         0.64,
                                         0.8,
                                         0.6000000000000001,
                                         0.72,
                                         0.48000000000000004,
                                         0.56,
                                         0.28,
                                         0.32,
                                         0.39999999999999997,
                                         0.48000000000000004,
                                         0.96,
                                         1.12,
                                         1.68,
                                         1.92,
                                         2.56,
                                         2.8800000000000003,
                                         2.56,
                                         2.8800000000000003,
                                         2.16,
                                         2.4,
                                         1.6,
                                         1.7600000000000002,
                                         0.88,
                                         0.96,
                                         1.08,
                                         1.2,
                                         2.4000000000000004,
                                         2.64,
                                         3.96,
                                         4.319999999999999,
                                         5.76,
                                         6.24,
                                         5.76,
                                         6.24,
                                         4.68,
                                         5.04,
                                         3.36,
                                         3.6,
                                         1.8,
                                         1.92,
                                         2.08,
                                         2.24,
                                         4.48,
                                         4.800000000000001,
                                         7.2,
                                         7.68,
                                         10.24,
                                         10.879999999999999,
                                         10.24,
                                         10.879999999999999,
                                         8.16,
                                         8.64,
                                         5.76,
                                         6.08,
                                         3.04,
                                         3.2,
                                         2.08,
                                         2.24,
                                         4.48,
                                         4.800000000000001,
                                         7.2,
                                         7.68,
                                         10.24,
                                         10.879999999999999,
                                         10.24,
                                         10.879999999999999,
                                         8.16,
                                         8.64,
                                         5.76,
                                         6.08,
                                         3.04,
                                         3.2,
                                         2.04,
                                         2.16,
                                         4.32,
                                         4.5600000000000005,
                                         6.84,
                                         7.2,
                                         9.6,
                                         10.079999999999998,
                                         9.6,
                                         10.079999999999998,
                                         7.5600000000000005,
                                         7.920000000000001,
                                         5.28,
                                         5.5200000000000005,
                                         2.76,
                                         2.88,
                                         1.6800000000000002,
                                         1.76,
                                         3.52,
                                         3.68,
                                         5.52,
                                         5.760000000000001,
                                         7.68,
                                         8.,
                                         7.68,
                                         8.,
                                         6.,
                                         6.24,
                                         4.16,
                                         4.32,
                                         2.16,
                                         2.24,
                                         1.,
                                         1.04,
                                         2.08,
                                         2.16,
                                         3.24,
                                         3.3600000000000003,
                                         4.48,
                                         4.640000000000001,
                                         4.48,
                                         4.640000000000001,
                                         3.4800000000000004,
                                         3.6000000000000005,
                                         2.4,
                                         2.48,
                                         1.24,
                                         1.28,
                                         1.32,
                                         1.36,
                                         2.72,
                                         2.8,
                                         4.2,
                                         4.32,
                                         5.76,
                                         5.92,
                                         5.76,
                                         5.92,
                                         4.4399999999999995,
                                         4.5600000000000005,
                                         3.04,
                                         3.12,
                                         1.56,
                                         1.6,
                                         2.96,
                                         3.04,
                                         6.08,
                                         6.239999999999999,
                                         9.36,
                                         9.6,
                                         12.800000000000002,
                                         13.12,
                                         12.800000000000002,
                                         13.12,
                                         9.84,
                                         10.08,
                                         6.72,
                                         6.88,
                                         3.4400000000000004,
                                         3.52,
                                         4.92,
                                         5.04,
                                         10.079999999999998,
                                         10.319999999999999,
                                         15.48,
                                         15.84,
                                         21.12,
                                         21.6,
                                         21.12,
                                         21.6,
                                         16.2,
                                         16.560000000000002,
                                         11.04,
                                         11.28,
                                         5.640000000000001,
                                         5.76,
                                         7.2,
                                         7.359999999999999,
                                         14.719999999999999,
                                         15.04,
                                         22.560000000000002,
                                         23.04,
                                         30.720000000000002,
                                         31.36,
                                         30.720000000000002,
                                         31.36,
                                         23.52,
                                         24.,
                                         15.999999999999998,
                                         16.32,
                                         8.16,
                                         8.32,
                                         7.2,
                                         7.359999999999999,
                                         14.719999999999999,
                                         15.04,
                                         22.560000000000002,
                                         23.04,
                                         30.720000000000002,
                                         31.36,
                                         30.720000000000002,
                                         31.36,
                                         23.52,
                                         24.,
                                         15.999999999999998,
                                         16.32,
                                         8.16,
                                         8.32,
                                         5.880000000000001,
                                         6.,
                                         12.,
                                         12.24,
                                         18.360000000000003,
                                         18.72,
                                         24.96,
                                         25.439999999999998,
                                         24.96,
                                         25.439999999999998,
                                         19.080000000000002,
                                         19.439999999999998,
                                         12.959999999999999,
                                         13.200000000000001,
                                         6.6,
                                         6.720000000000001,
                                         4.24,
                                         4.32,
                                         8.64,
                                         8.8,
                                         13.2,
                                         13.440000000000001,
                                         17.92,
                                         18.240000000000002,
                                         17.92,
                                         18.240000000000002,
                                         13.68,
                                         13.920000000000002,
                                         9.28,
                                         9.440000000000001,
                                         4.720000000000001,
                                         4.800000000000001,
                                         2.2800000000000002,
                                         2.32,
                                         4.640000000000001,
                                         4.72,
                                         7.08,
                                         7.199999999999999,
                                         9.6,
                                         9.76,
                                         9.6,
                                         9.76,
                                         7.32,
                                         7.4399999999999995,
                                         4.96,
                                         5.04,
                                         2.52,
                                         2.56,
                                         2.6,
                                         2.64,
                                         5.28,
                                         5.36,
                                         8.040000000000001,
                                         8.16,
                                         10.88,
                                         11.04,
                                         10.88,
                                         11.04,
                                         8.280000000000001,
                                         8.4,
                                         5.6,
                                         5.68,
                                         2.84,
                                         2.88,
                                         5.52,
                                         5.6,
                                         11.2,
                                         11.36,
                                         17.04,
                                         17.28,
                                         23.040000000000003,
                                         23.36,
                                         23.040000000000003,
                                         23.36,
                                         17.520000000000003,
                                         17.76,
                                         11.84,
                                         12.,
                                         6.,
                                         6.08,
                                         8.76,
                                         8.879999999999999,
                                         17.759999999999998,
                                         18.,
                                         27.,
                                         27.360000000000003,
                                         36.48,
                                         36.96,
                                         36.48,
                                         36.96,
                                         27.720000000000002,
                                         28.080000000000002,
                                         18.72,
                                         18.96,
                                         9.48,
                                         9.6,
                                         12.32,
                                         12.479999999999999,
                                         24.959999999999997,
                                         25.28,
                                         37.919999999999995,
                                         38.400000000000006,
                                         51.199999999999996,
                                         51.84,
                                         51.199999999999996,
                                         51.84,
                                         38.88,
                                         39.36,
                                         26.24,
                                         26.560000000000002,
                                         13.280000000000001,
                                         13.44,
                                         12.32,
                                         12.479999999999999,
                                         24.959999999999997,
                                         25.28,
                                         37.919999999999995,
                                         38.400000000000006,
                                         51.199999999999996,
                                         51.84,
                                         51.199999999999996,
                                         51.84,
                                         38.88,
                                         39.36,
                                         26.24,
                                         26.560000000000002,
                                         13.280000000000001,
                                         13.44,
                                         9.72,
                                         9.84,
                                         19.68,
                                         19.92,
                                         29.88,
                                         30.240000000000006,
                                         40.31999999999999,
                                         40.8,
                                         40.31999999999999,
                                         40.8,
                                         30.6,
                                         30.96,
                                         20.64,
                                         20.88,
                                         10.440000000000001,
                                         10.56,
                                         6.800000000000001,
                                         6.880000000000001,
                                         13.760000000000002,
                                         13.92,
                                         20.88,
                                         21.12,
                                         28.16,
                                         28.48,
                                         28.16,
                                         28.48,
                                         21.360000000000003,
                                         21.6,
                                         14.4,
                                         14.56,
                                         7.28,
                                         7.359999999999999,
                                         3.56,
                                         3.6,
                                         7.2,
                                         7.28,
                                         10.92,
                                         11.040000000000001,
                                         14.72,
                                         14.88,
                                         14.72,
                                         14.88,
                                         11.16,
                                         11.280000000000001,
                                         7.5200000000000005,
                                         7.6,
                                         3.8000000000000003,
                                         3.84};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         55.39027777777778,
                                         56.31722222222223,
                                         57.24416666666667,
                                         58.17111111111111,
                                         71.58694444444446,
                                         72.75055555555556,
                                         73.91416666666666,
                                         75.07777777777777,
                                         88.7302777777778,
                                         90.13055555555556,
                                         91.53083333333333,
                                         92.93111111111111,
                                         84.55916666666666,
                                         85.80166666666668,
                                         87.04416666666665,
                                         88.28666666666666,
                                         90.47583333333334,
                                         91.71833333333335,
                                         92.96083333333333,
                                         94.20333333333333,
                                         108.5313888888889,
                                         109.93166666666669,
                                         111.33194444444445,
                                         112.73222222222223,
                                         92.33472222222224,
                                         93.49833333333333,
                                         94.66194444444444,
                                         95.82555555555555,
                                         75.1913888888889,
                                         76.11833333333333,
                                         77.04527777777777,
                                         77.97222222222223,
                                         80.00583333333334,
                                         80.82833333333333,
                                         81.65083333333334,
                                         82.47333333333333,
                                         102.25583333333334,
                                         103.28833333333333,
                                         104.32083333333333,
                                         105.35333333333334,
                                         125.34583333333336,
                                         126.58833333333334,
                                         127.83083333333332,
                                         129.07333333333335,
                                         116.3925,
                                         117.49500000000002,
                                         118.5975,
                                         119.7,
                                         121.6425,
                                         122.745,
                                         123.8475,
                                         124.95000000000002,
                                         142.91583333333332,
                                         144.15833333333333,
                                         145.4008333333333,
                                         146.64333333333335,
                                         120.66583333333332,
                                         121.69833333333334,
                                         122.73083333333334,
                                         123.76333333333335,
                                         97.57583333333332,
                                         98.39833333333334,
                                         99.22083333333332,
                                         100.04333333333334,
                                         111.33916666666667,
                                         112.16166666666666,
                                         112.98416666666668,
                                         113.80666666666666,
                                         141.58916666666667,
                                         142.62166666666667,
                                         143.65416666666667,
                                         144.68666666666667,
                                         172.67916666666667,
                                         173.92166666666668,
                                         175.1641666666667,
                                         176.40666666666667,
                                         158.39249999999998,
                                         159.495,
                                         160.59750000000003,
                                         161.70000000000002,
                                         163.64249999999998,
                                         164.745,
                                         165.84750000000003,
                                         166.95000000000002,
                                         190.24916666666667,
                                         191.49166666666667,
                                         192.73416666666665,
                                         193.9766666666667,
                                         159.99916666666664,
                                         161.03166666666667,
                                         162.06416666666667,
                                         163.0966666666667,
                                         128.90916666666666,
                                         129.73166666666668,
                                         130.55416666666667,
                                         131.37666666666667,
                                         160.2525,
                                         161.1794444444444,
                                         162.1063888888889,
                                         163.03333333333333,
                                         203.22250000000003,
                                         204.3861111111111,
                                         205.54972222222224,
                                         206.71333333333334,
                                         247.13916666666668,
                                         248.53944444444443,
                                         249.93972222222223,
                                         251.34000000000003,
                                         225.11916666666667,
                                         226.36166666666665,
                                         227.60416666666666,
                                         228.84666666666666,
                                         231.03583333333333,
                                         232.27833333333334,
                                         233.5208333333333,
                                         234.76333333333335,
                                         266.94027777777774,
                                         268.34055555555557,
                                         269.74083333333334,
                                         271.1411111111111,
                                         223.9702777777778,
                                         225.13388888888892,
                                         226.29749999999999,
                                         227.4611111111111,
                                         180.05361111111114,
                                         180.98055555555558,
                                         181.9075,
                                         182.83444444444444,
                                         144.53583333333333,
                                         145.30611111111108,
                                         146.07638888888889,
                                         146.84666666666666,
                                         183.14583333333334,
                                         184.11277777777775,
                                         185.07972222222222,
                                         186.04666666666668,
                                         222.5425,
                                         223.70611111111108,
                                         224.86972222222224,
                                         226.03333333333336,
                                         202.3091666666667,
                                         203.34166666666664,
                                         204.37416666666667,
                                         205.40666666666667,
                                         207.22583333333336,
                                         208.25833333333335,
                                         209.29083333333332,
                                         210.32333333333335,
                                         238.99694444444447,
                                         240.16055555555556,
                                         241.32416666666666,
                                         242.48777777777775,
                                         200.38694444444445,
                                         201.35388888888892,
                                         202.32083333333333,
                                         203.28777777777776,
                                         160.99027777777778,
                                         161.76055555555556,
                                         162.53083333333333,
                                         163.30111111111108,
                                         123.80583333333333,
                                         124.41944444444442,
                                         125.03305555555558,
                                         125.64666666666666,
                                         156.77583333333334,
                                         157.54611111111112,
                                         158.3163888888889,
                                         159.08666666666667,
                                         190.3725,
                                         191.29944444444445,
                                         192.22638888888886,
                                         193.1533333333333,
                                         172.77916666666667,
                                         173.60166666666666,
                                         174.42416666666665,
                                         175.24666666666664,
                                         176.69583333333335,
                                         177.51833333333335,
                                         178.34083333333334,
                                         179.16333333333333,
                                         203.48027777777781,
                                         204.40722222222223,
                                         205.33416666666668,
                                         206.26111111111106,
                                         170.51027777777776,
                                         171.28055555555557,
                                         172.05083333333334,
                                         172.82111111111112,
                                         136.9136111111111,
                                         137.5272222222222,
                                         138.14083333333335,
                                         138.75444444444446,
                                         176.02805555555557,
                                         176.64166666666668,
                                         177.25527777777776,
                                         177.8688888888889,
                                         222.33138888888888,
                                         223.1016666666667,
                                         223.87194444444444,
                                         224.64222222222222,
                                         269.2613888888889,
                                         270.18833333333333,
                                         271.11527777777775,
                                         272.0422222222223,
                                         242.77916666666664,
                                         243.60166666666672,
                                         244.42416666666668,
                                         245.24666666666664,
                                         246.69583333333327,
                                         247.51833333333335,
                                         248.34083333333336,
                                         249.1633333333333,
                                         282.36916666666656,
                                         283.2961111111111,
                                         284.22305555555556,
                                         285.1499999999999,
                                         236.06583333333327,
                                         236.83611111111114,
                                         237.6063888888889,
                                         238.37666666666664,
                                         189.13583333333332,
                                         189.74944444444446,
                                         190.36305555555555,
                                         190.97666666666666,
                                         231.8513888888889,
                                         232.62166666666667,
                                         233.39194444444442,
                                         234.16222222222223,
                                         292.75472222222226,
                                         293.7216666666667,
                                         294.6886111111111,
                                         295.65555555555557,
                                         354.4447222222223,
                                         355.60833333333335,
                                         356.7719444444444,
                                         357.93555555555565,
                                         319.3491666666667,
                                         320.3816666666667,
                                         321.41416666666663,
                                         322.4466666666667,
                                         324.2658333333333,
                                         325.2983333333333,
                                         326.3308333333333,
                                         327.36333333333334,
                                         370.8991666666666,
                                         372.0627777777777,
                                         373.2263888888889,
                                         374.39,
                                         309.9958333333333,
                                         310.9627777777778,
                                         311.92972222222227,
                                         312.89666666666665,
                                         248.3058333333333,
                                         249.07611111111115,
                                         249.84638888888887,
                                         250.61666666666665,
                                         292.6880555555556,
                                         293.615,
                                         294.5419444444444,
                                         295.4688888888889,
                                         369.47138888888895,
                                         370.63500000000005,
                                         371.7986111111111,
                                         372.96222222222224,
                                         447.201388888889,
                                         448.6016666666667,
                                         450.0019444444444,
                                         451.40222222222235,
                                         402.6391666666667,
                                         403.8816666666667,
                                         405.1241666666666,
                                         406.36666666666673,
                                         408.55583333333334,
                                         409.7983333333333,
                                         411.0408333333333,
                                         412.28333333333336,
                                         467.00249999999994,
                                         468.4027777777777,
                                         469.8030555555556,
                                         471.2033333333334,
                                         390.21916666666664,
                                         391.3827777777778,
                                         392.54638888888894,
                                         393.71000000000004,
                                         312.4891666666666,
                                         313.41611111111115,
                                         314.34305555555557,
                                         315.27000000000004,
                                         290.5658333333333,
                                         291.3883333333334,
                                         292.21083333333337,
                                         293.03333333333336,
                                         366.5758333333334,
                                         367.6083333333334,
                                         368.6408333333333,
                                         369.6733333333333,
                                         443.42583333333334,
                                         444.66833333333335,
                                         445.9108333333333,
                                         447.15333333333336,
                                         398.63250000000005,
                                         399.73500000000007,
                                         400.8375,
                                         401.94,
                                         403.88250000000005,
                                         404.98500000000007,
                                         406.08750000000003,
                                         407.19000000000005,
                                         460.9958333333334,
                                         462.2383333333334,
                                         463.4808333333333,
                                         464.72333333333336,
                                         384.98583333333335,
                                         386.01833333333343,
                                         387.05083333333334,
                                         388.0833333333333,
                                         308.1358333333333,
                                         308.95833333333337,
                                         309.7808333333333,
                                         310.60333333333335,
                                         321.8991666666667,
                                         322.72166666666664,
                                         323.5441666666667,
                                         324.3666666666667,
                                         405.9091666666667,
                                         406.94166666666666,
                                         407.97416666666663,
                                         409.00666666666666,
                                         490.7591666666667,
                                         492.0016666666667,
                                         493.2441666666667,
                                         494.4866666666666,
                                         440.63250000000005,
                                         441.735,
                                         442.83750000000003,
                                         443.94000000000005,
                                         445.88250000000005,
                                         446.985,
                                         448.0875,
                                         449.19,
                                         508.32916666666677,
                                         509.5716666666667,
                                         510.8141666666667,
                                         512.0566666666666,
                                         424.31916666666666,
                                         425.3516666666667,
                                         426.3841666666667,
                                         427.4166666666667,
                                         339.4691666666667,
                                         340.2916666666667,
                                         341.11416666666673,
                                         341.9366666666667,
                                         397.55027777777786,
                                         398.4772222222222,
                                         399.4041666666667,
                                         400.33111111111117,
                                         501.1069444444446,
                                         502.2705555555556,
                                         503.43416666666667,
                                         504.59777777777776,
                                         605.6102777777779,
                                         607.0105555555556,
                                         608.4108333333332,
                                         609.8111111111112,
                                         543.1991666666668,
                                         544.4416666666667,
                                         545.6841666666667,
                                         546.9266666666667,
                                         549.1158333333333,
                                         550.3583333333333,
                                         551.6008333333334,
                                         552.8433333333334,
                                         625.4113888888888,
                                         626.8116666666666,
                                         628.2119444444445,
                                         629.6122222222223,
                                         521.8547222222221,
                                         523.0183333333333,
                                         524.1819444444445,
                                         525.3455555555555,
                                         417.35138888888883,
                                         418.2783333333333,
                                         419.2052777777778,
                                         420.13222222222225,
                                         341.7269444444445,
                                         342.49722222222226,
                                         343.26750000000004,
                                         344.0377777777778,
                                         430.68361111111113,
                                         431.65055555555557,
                                         432.6175,
                                         433.58444444444444,
                                         520.4269444444445,
                                         521.5905555555555,
                                         522.7541666666667,
                                         523.9177777777778,
                                         466.62916666666666,
                                         467.66166666666663,
                                         468.69416666666666,
                                         469.7266666666667,
                                         471.54583333333335,
                                         472.5783333333333,
                                         473.6108333333334,
                                         474.6433333333333,
                                         536.8813888888889,
                                         538.045,
                                         539.2086111111112,
                                         540.3722222222221,
                                         447.92472222222216,
                                         448.89166666666665,
                                         449.8586111111111,
                                         450.8255555555555,
                                         358.1813888888888,
                                         358.9516666666667,
                                         359.72194444444443,
                                         360.49222222222215,
                                         280.8902777777777,
                                         281.50388888888887,
                                         282.1175,
                                         282.7311111111111,
                                         353.9669444444445,
                                         354.7372222222222,
                                         355.5075,
                                         356.2777777777778,
                                         427.6702777777778,
                                         428.59722222222223,
                                         429.52416666666664,
                                         430.4511111111111,
                                         383.33916666666664,
                                         384.16166666666663,
                                         384.9841666666666,
                                         385.8066666666667,
                                         387.25583333333327,
                                         388.0783333333333,
                                         388.90083333333337,
                                         389.7233333333333,
                                         440.7780555555555,
                                         441.70500000000004,
                                         442.6319444444444,
                                         443.5588888888889,
                                         367.70138888888886,
                                         368.4716666666667,
                                         369.2419444444444,
                                         370.01222222222225,
                                         293.99805555555554,
                                         294.6116666666667,
                                         295.22527777777776,
                                         295.83888888888885,
                                         18.94361111111111,
                                         19.557222222222222,
                                         20.170833333333334,
                                         20.784444444444443,
                                         25.140277777777776,
                                         25.910555555555558,
                                         26.680833333333332,
                                         27.45111111111111,
                                         31.963611111111113,
                                         32.89055555555556,
                                         33.8175,
                                         34.74444444444445,
                                         32.219166666666666,
                                         33.04166666666667,
                                         33.86416666666666,
                                         34.68666666666667,
                                         36.13583333333334,
                                         36.958333333333336,
                                         37.780833333333334,
                                         38.60333333333333,
                                         45.0713888888889,
                                         45.998333333333335,
                                         46.92527777777778,
                                         47.852222222222224,
                                         38.874722222222225,
                                         39.644999999999996,
                                         40.41527777777778,
                                         41.18555555555555,
                                         32.05138888888889,
                                         32.665,
                                         33.27861111111111,
                                         33.89222222222222,
                                         34.66027777777778,
                                         35.43055555555556,
                                         36.200833333333335,
                                         36.971111111111114,
                                         45.21694444444445,
                                         46.183888888888895,
                                         47.15083333333333,
                                         48.117777777777775,
                                         56.56027777777779,
                                         57.723888888888894,
                                         58.8875,
                                         60.05111111111111,
                                         55.02916666666667,
                                         56.061666666666675,
                                         57.09416666666666,
                                         58.126666666666665,
                                         59.94583333333334,
                                         60.97833333333334,
                                         62.01083333333333,
                                         63.04333333333334,
                                         73.01472222222223,
                                         74.17833333333334,
                                         75.34194444444445,
                                         76.50555555555556,
                                         62.45805555555557,
                                         63.425,
                                         64.39194444444445,
                                         65.35888888888888,
                                         51.11472222222222,
                                         51.885,
                                         52.655277777777776,
                                         53.425555555555555,
                                         55.39027777777778,
                                         56.31722222222223,
                                         57.24416666666667,
                                         58.17111111111111,
                                         71.58694444444446,
                                         72.75055555555556,
                                         73.91416666666666,
                                         75.07777777777777,
                                         88.7302777777778,
                                         90.13055555555556,
                                         91.53083333333333,
                                         92.93111111111111,
                                         84.55916666666666,
                                         85.80166666666668,
                                         87.04416666666665,
                                         88.28666666666666,
                                         90.47583333333334,
                                         91.71833333333335,
                                         92.96083333333333,
                                         94.20333333333333,
                                         108.5313888888889,
                                         109.93166666666669,
                                         111.33194444444445,
                                         112.73222222222223,
                                         92.33472222222224,
                                         93.49833333333333,
                                         94.66194444444444,
                                         95.82555555555555,
                                         75.1913888888889,
                                         76.11833333333333,
                                         77.04527777777777,
                                         77.97222222222223,
                                         80.00583333333334,
                                         80.82833333333333,
                                         81.65083333333334,
                                         82.47333333333333,
                                         102.25583333333334,
                                         103.28833333333333,
                                         104.32083333333333,
                                         105.35333333333334,
                                         125.34583333333336,
                                         126.58833333333334,
                                         127.83083333333332,
                                         129.07333333333335,
                                         116.3925,
                                         117.49500000000002,
                                         118.5975,
                                         119.7,
                                         121.6425,
                                         122.745,
                                         123.8475,
                                         124.95000000000002,
                                         142.91583333333332,
                                         144.15833333333333,
                                         145.4008333333333,
                                         146.64333333333335,
                                         120.66583333333332,
                                         121.69833333333334,
                                         122.73083333333334,
                                         123.76333333333335,
                                         97.57583333333332,
                                         98.39833333333334,
                                         99.22083333333332,
                                         100.04333333333334,
                                         111.33916666666667,
                                         112.16166666666666,
                                         112.98416666666668,
                                         113.80666666666666,
                                         141.58916666666667,
                                         142.62166666666667,
                                         143.65416666666667,
                                         144.68666666666667,
                                         172.67916666666667,
                                         173.92166666666668,
                                         175.1641666666667,
                                         176.40666666666667,
                                         158.39249999999998,
                                         159.495,
                                         160.59750000000003,
                                         161.70000000000002,
                                         163.64249999999998,
                                         164.745,
                                         165.84750000000003,
                                         166.95000000000002,
                                         190.24916666666667,
                                         191.49166666666667,
                                         192.73416666666665,
                                         193.9766666666667,
                                         159.99916666666664,
                                         161.03166666666667,
                                         162.06416666666667,
                                         163.0966666666667,
                                         128.90916666666666,
                                         129.73166666666668,
                                         130.55416666666667,
                                         131.37666666666667,
                                         160.2525,
                                         161.1794444444444,
                                         162.1063888888889,
                                         163.03333333333333,
                                         203.22250000000003,
                                         204.3861111111111,
                                         205.54972222222224,
                                         206.71333333333334,
                                         247.13916666666668,
                                         248.53944444444443,
                                         249.93972222222223,
                                         251.34000000000003,
                                         225.11916666666667,
                                         226.36166666666665,
                                         227.60416666666666,
                                         228.84666666666666,
                                         231.03583333333333,
                                         232.27833333333334,
                                         233.5208333333333,
                                         234.76333333333335,
                                         266.94027777777774,
                                         268.34055555555557,
                                         269.74083333333334,
                                         271.1411111111111,
                                         223.9702777777778,
                                         225.13388888888892,
                                         226.29749999999999,
                                         227.4611111111111,
                                         180.05361111111114,
                                         180.98055555555558,
                                         181.9075,
                                         182.83444444444444,
                                         144.53583333333333,
                                         145.30611111111108,
                                         146.07638888888889,
                                         146.84666666666666,
                                         183.14583333333334,
                                         184.11277777777775,
                                         185.07972222222222,
                                         186.04666666666668,
                                         222.5425,
                                         223.70611111111108,
                                         224.86972222222224,
                                         226.03333333333336,
                                         202.3091666666667,
                                         203.34166666666664,
                                         204.37416666666667,
                                         205.40666666666667,
                                         207.22583333333336,
                                         208.25833333333335,
                                         209.29083333333332,
                                         210.32333333333335,
                                         238.99694444444447,
                                         240.16055555555556,
                                         241.32416666666666,
                                         242.48777777777775,
                                         200.38694444444445,
                                         201.35388888888892,
                                         202.32083333333333,
                                         203.28777777777776,
                                         160.99027777777778,
                                         161.76055555555556,
                                         162.53083333333333,
                                         163.30111111111108,
                                         123.80583333333333,
                                         124.41944444444442,
                                         125.03305555555558,
                                         125.64666666666666,
                                         156.77583333333334,
                                         157.54611111111112,
                                         158.3163888888889,
                                         159.08666666666667,
                                         190.3725,
                                         191.29944444444445,
                                         192.22638888888886,
                                         193.1533333333333,
                                         172.77916666666667,
                                         173.60166666666666,
                                         174.42416666666665,
                                         175.24666666666664,
                                         176.69583333333335,
                                         177.51833333333335,
                                         178.34083333333334,
                                         179.16333333333333,
                                         203.48027777777781,
                                         204.40722222222223,
                                         205.33416666666668,
                                         206.26111111111106,
                                         170.51027777777776,
                                         171.28055555555557,
                                         172.05083333333334,
                                         172.82111111111112,
                                         136.9136111111111,
                                         137.5272222222222,
                                         138.14083333333335,
                                         138.75444444444446};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow5Stride1Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.04,
                                         0.08,
                                         0.12,
                                         0.16,
                                         0.24000000000000002,
                                         0.32,
                                         0.4,
                                         0.48,
                                         0.6,
                                         0.72,
                                         0.8400000000000001,
                                         0.96,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.12,
                                         1.28,
                                         1.44,
                                         1.6,
                                         1.08,
                                         1.2000000000000002,
                                         1.3199999999999998,
                                         1.44,
                                         0.88,
                                         0.9600000000000001,
                                         1.04,
                                         1.12,
                                         0.52,
                                         0.56,
                                         0.6,
                                         0.64,
                                         0.7200000000000001,
                                         0.7999999999999999,
                                         0.88,
                                         0.9600000000000001,
                                         1.76,
                                         1.92,
                                         2.08,
                                         2.24,
                                         3.12,
                                         3.36,
                                         3.6,
                                         3.84,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.8,
                                         5.12,
                                         5.44,
                                         5.760000000000001,
                                         4.08,
                                         4.32,
                                         4.56,
                                         4.8,
                                         3.04,
                                         3.2,
                                         3.3600000000000003,
                                         3.5200000000000005,
                                         1.68,
                                         1.76,
                                         1.8399999999999999,
                                         1.92,
                                         2.04,
                                         2.16,
                                         2.2800000000000002,
                                         2.4,
                                         4.5600000000000005,
                                         4.800000000000001,
                                         5.040000000000001,
                                         5.28,
                                         7.5600000000000005,
                                         7.92,
                                         8.280000000000001,
                                         8.639999999999999,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         11.040000000000001,
                                         11.52,
                                         12.000000000000002,
                                         12.48,
                                         9.000000000000002,
                                         9.36,
                                         9.719999999999999,
                                         10.08,
                                         6.4799999999999995,
                                         6.72,
                                         6.96,
                                         7.2,
                                         3.48,
                                         3.6,
                                         3.7199999999999998,
                                         3.84,
                                         4.,
                                         4.16,
                                         4.32,
                                         4.48,
                                         8.64,
                                         8.96,
                                         9.280000000000001,
                                         9.600000000000001,
                                         13.920000000000002,
                                         14.4,
                                         14.879999999999999,
                                         15.36,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         15.840000000000002,
                                         16.32,
                                         16.799999999999997,
                                         17.28,
                                         11.2,
                                         11.52,
                                         11.84,
                                         12.16,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         4.,
                                         4.16,
                                         4.32,
                                         4.48,
                                         8.64,
                                         8.96,
                                         9.280000000000001,
                                         9.600000000000001,
                                         13.920000000000002,
                                         14.4,
                                         14.879999999999999,
                                         15.36,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         19.840000000000003,
                                         20.48,
                                         21.12,
                                         21.759999999999998,
                                         15.840000000000002,
                                         16.32,
                                         16.799999999999997,
                                         17.28,
                                         11.2,
                                         11.52,
                                         11.84,
                                         12.16,
                                         5.92,
                                         6.08,
                                         6.24,
                                         6.4,
                                         3.96,
                                         4.08,
                                         4.2,
                                         4.32,
                                         8.4,
                                         8.64,
                                         8.88,
                                         9.120000000000001,
                                         13.320000000000004,
                                         13.68,
                                         14.04,
                                         14.4,
                                         18.720000000000006,
                                         19.2,
                                         19.68,
                                         20.159999999999997,
                                         18.720000000000006,
                                         19.2,
                                         19.68,
                                         20.159999999999997,
                                         14.76,
                                         15.120000000000001,
                                         15.48,
                                         15.840000000000002,
                                         10.32,
                                         10.56,
                                         10.799999999999999,
                                         11.040000000000001,
                                         5.4,
                                         5.52,
                                         5.640000000000001,
                                         5.76,
                                         3.2800000000000002,
                                         3.3600000000000003,
                                         3.4400000000000004,
                                         3.52,
                                         6.88,
                                         7.04,
                                         7.2,
                                         7.36,
                                         10.8,
                                         11.04,
                                         11.28,
                                         11.520000000000001,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         15.040000000000001,
                                         15.36,
                                         15.68,
                                         16.,
                                         11.76,
                                         12.,
                                         12.24,
                                         12.48,
                                         8.16,
                                         8.32,
                                         8.48,
                                         8.64,
                                         4.24,
                                         4.32,
                                         4.4,
                                         4.48,
                                         1.96,
                                         2.,
                                         2.04,
                                         2.08,
                                         4.08,
                                         4.16,
                                         4.24,
                                         4.32,
                                         6.36,
                                         6.48,
                                         6.6,
                                         6.720000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         8.8,
                                         8.96,
                                         9.12,
                                         9.280000000000001,
                                         6.84,
                                         6.960000000000001,
                                         7.08,
                                         7.200000000000001,
                                         4.720000000000001,
                                         4.8,
                                         4.88,
                                         4.96,
                                         2.44,
                                         2.48,
                                         2.52,
                                         2.56,
                                         2.6,
                                         2.64,
                                         2.68,
                                         2.72,
                                         5.36,
                                         5.44,
                                         5.52,
                                         5.6,
                                         8.280000000000001,
                                         8.4,
                                         8.52,
                                         8.64,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         11.360000000000001,
                                         11.52,
                                         11.68,
                                         11.84,
                                         8.76,
                                         8.879999999999999,
                                         9.,
                                         9.120000000000001,
                                         6.,
                                         6.08,
                                         6.16,
                                         6.24,
                                         3.08,
                                         3.12,
                                         3.16,
                                         3.2,
                                         5.84,
                                         5.92,
                                         6.,
                                         6.08,
                                         12.000000000000002,
                                         12.16,
                                         12.32,
                                         12.479999999999999,
                                         18.48,
                                         18.72,
                                         18.96,
                                         19.2,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         25.279999999999998,
                                         25.600000000000005,
                                         25.92,
                                         26.24,
                                         19.44,
                                         19.68,
                                         19.92,
                                         20.16,
                                         13.280000000000001,
                                         13.44,
                                         13.600000000000001,
                                         13.76,
                                         6.800000000000001,
                                         6.880000000000001,
                                         6.960000000000001,
                                         7.04,
                                         9.719999999999999,
                                         9.84,
                                         9.96,
                                         10.08,
                                         19.92,
                                         20.159999999999997,
                                         20.400000000000002,
                                         20.639999999999997,
                                         30.599999999999998,
                                         30.96,
                                         31.320000000000004,
                                         31.68,
                                         41.76,
                                         42.24,
                                         42.72,
                                         43.2,
                                         41.76,
                                         42.24,
                                         42.72,
                                         43.2,
                                         32.04,
                                         32.4,
                                         32.760000000000005,
                                         33.120000000000005,
                                         21.84,
                                         22.08,
                                         22.320000000000004,
                                         22.56,
                                         11.16,
                                         11.280000000000001,
                                         11.400000000000002,
                                         11.52,
                                         14.239999999999998,
                                         14.4,
                                         14.560000000000002,
                                         14.719999999999999,
                                         29.12,
                                         29.439999999999998,
                                         29.760000000000005,
                                         30.08,
                                         44.64,
                                         45.120000000000005,
                                         45.6,
                                         46.08,
                                         60.8,
                                         61.440000000000005,
                                         62.08,
                                         62.72,
                                         60.8,
                                         61.440000000000005,
                                         62.08,
                                         62.72,
                                         46.56,
                                         47.04,
                                         47.52,
                                         48.,
                                         31.68,
                                         31.999999999999996,
                                         32.32,
                                         32.64,
                                         16.16,
                                         16.32,
                                         16.480000000000004,
                                         16.64,
                                         14.239999999999998,
                                         14.4,
                                         14.560000000000002,
                                         14.719999999999999,
                                         29.12,
                                         29.439999999999998,
                                         29.760000000000005,
                                         30.08,
                                         44.64,
                                         45.120000000000005,
                                         45.6,
                                         46.08,
                                         60.8,
                                         61.440000000000005,
                                         62.08,
                                         62.72,
                                         60.8,
                                         61.440000000000005,
                                         62.08,
                                         62.72,
                                         46.56,
                                         47.04,
                                         47.52,
                                         48.,
                                         31.68,
                                         31.999999999999996,
                                         32.32,
                                         32.64,
                                         16.16,
                                         16.32,
                                         16.480000000000004,
                                         16.64,
                                         11.64,
                                         11.760000000000002,
                                         11.88,
                                         12.,
                                         23.759999999999998,
                                         24.,
                                         24.240000000000002,
                                         24.48,
                                         36.36,
                                         36.720000000000006,
                                         37.080000000000005,
                                         37.44,
                                         49.44,
                                         49.92,
                                         50.400000000000006,
                                         50.879999999999995,
                                         49.44,
                                         49.92,
                                         50.400000000000006,
                                         50.879999999999995,
                                         37.8,
                                         38.160000000000004,
                                         38.52,
                                         38.879999999999995,
                                         25.68,
                                         25.919999999999998,
                                         26.159999999999997,
                                         26.400000000000002,
                                         13.08,
                                         13.2,
                                         13.32,
                                         13.440000000000001,
                                         8.4,
                                         8.48,
                                         8.56,
                                         8.64,
                                         17.12,
                                         17.28,
                                         17.439999999999998,
                                         17.6,
                                         26.16,
                                         26.4,
                                         26.64,
                                         26.880000000000003,
                                         35.519999999999996,
                                         35.84,
                                         36.160000000000004,
                                         36.480000000000004,
                                         35.519999999999996,
                                         35.84,
                                         36.160000000000004,
                                         36.480000000000004,
                                         27.12,
                                         27.36,
                                         27.6,
                                         27.840000000000003,
                                         18.4,
                                         18.56,
                                         18.72,
                                         18.880000000000003,
                                         9.36,
                                         9.440000000000001,
                                         9.52,
                                         9.600000000000001,
                                         4.5200000000000005,
                                         4.5600000000000005,
                                         4.6000000000000005,
                                         4.64,
                                         9.2,
                                         9.280000000000001,
                                         9.36,
                                         9.44,
                                         14.04,
                                         14.16,
                                         14.28,
                                         14.399999999999999,
                                         19.04,
                                         19.2,
                                         19.36,
                                         19.52,
                                         19.04,
                                         19.2,
                                         19.36,
                                         19.52,
                                         14.52,
                                         14.64,
                                         14.76,
                                         14.879999999999999,
                                         9.84,
                                         9.92,
                                         10.,
                                         10.08,
                                         5.,
                                         5.04,
                                         5.08,
                                         5.12,
                                         5.16,
                                         5.2,
                                         5.24,
                                         5.28,
                                         10.48,
                                         10.56,
                                         10.64,
                                         10.72,
                                         15.96,
                                         16.080000000000002,
                                         16.200000000000003,
                                         16.32,
                                         21.6,
                                         21.76,
                                         21.92,
                                         22.08,
                                         21.6,
                                         21.76,
                                         21.92,
                                         22.08,
                                         16.44,
                                         16.560000000000002,
                                         16.68,
                                         16.8,
                                         11.120000000000001,
                                         11.2,
                                         11.280000000000001,
                                         11.36,
                                         5.64,
                                         5.68,
                                         5.72,
                                         5.76,
                                         10.96,
                                         11.04,
                                         11.120000000000001,
                                         11.2,
                                         22.240000000000002,
                                         22.4,
                                         22.56,
                                         22.72,
                                         33.84,
                                         34.08,
                                         34.32,
                                         34.56,
                                         45.76,
                                         46.080000000000005,
                                         46.400000000000006,
                                         46.72,
                                         45.76,
                                         46.080000000000005,
                                         46.400000000000006,
                                         46.72,
                                         34.800000000000004,
                                         35.040000000000006,
                                         35.28,
                                         35.52,
                                         23.520000000000003,
                                         23.68,
                                         23.84,
                                         24.,
                                         11.92,
                                         12.,
                                         12.08,
                                         12.16,
                                         17.400000000000002,
                                         17.52,
                                         17.64,
                                         17.759999999999998,
                                         35.28,
                                         35.519999999999996,
                                         35.76,
                                         36.,
                                         53.64,
                                         54.,
                                         54.36,
                                         54.720000000000006,
                                         72.48,
                                         72.96,
                                         73.44000000000001,
                                         73.92,
                                         72.48,
                                         72.96,
                                         73.44000000000001,
                                         73.92,
                                         55.080000000000005,
                                         55.440000000000005,
                                         55.8,
                                         56.160000000000004,
                                         37.2,
                                         37.44,
                                         37.68,
                                         37.92,
                                         18.84,
                                         18.96,
                                         19.08,
                                         19.2,
                                         24.480000000000004,
                                         24.64,
                                         24.8,
                                         24.959999999999997,
                                         49.6,
                                         49.919999999999995,
                                         50.24,
                                         50.56,
                                         75.36,
                                         75.83999999999999,
                                         76.32000000000001,
                                         76.80000000000001,
                                         101.76,
                                         102.39999999999999,
                                         103.04000000000002,
                                         103.68,
                                         101.76,
                                         102.39999999999999,
                                         103.04000000000002,
                                         103.68,
                                         77.28000000000002,
                                         77.76,
                                         78.24,
                                         78.72,
                                         52.160000000000004,
                                         52.48,
                                         52.8,
                                         53.120000000000005,
                                         26.4,
                                         26.560000000000002,
                                         26.72,
                                         26.88,
                                         24.480000000000004,
                                         24.64,
                                         24.8,
                                         24.959999999999997,
                                         49.6,
                                         49.919999999999995,
                                         50.24,
                                         50.56,
                                         75.36,
                                         75.83999999999999,
                                         76.32000000000001,
                                         76.80000000000001,
                                         101.76,
                                         102.39999999999999,
                                         103.04000000000002,
                                         103.68,
                                         101.76,
                                         102.39999999999999,
                                         103.04000000000002,
                                         103.68,
                                         77.28000000000002,
                                         77.76,
                                         78.24,
                                         78.72,
                                         52.160000000000004,
                                         52.48,
                                         52.8,
                                         53.120000000000005,
                                         26.4,
                                         26.560000000000002,
                                         26.72,
                                         26.88,
                                         19.32,
                                         19.44,
                                         19.560000000000002,
                                         19.68,
                                         39.120000000000005,
                                         39.36,
                                         39.6,
                                         39.84,
                                         59.4,
                                         59.76,
                                         60.11999999999999,
                                         60.48000000000001,
                                         80.16000000000001,
                                         80.63999999999999,
                                         81.12,
                                         81.6,
                                         80.16000000000001,
                                         80.63999999999999,
                                         81.12,
                                         81.6,
                                         60.84,
                                         61.2,
                                         61.56,
                                         61.92,
                                         41.04,
                                         41.28,
                                         41.519999999999996,
                                         41.76,
                                         20.759999999999998,
                                         20.880000000000003,
                                         21.,
                                         21.12,
                                         13.52,
                                         13.600000000000001,
                                         13.68,
                                         13.760000000000002,
                                         27.36,
                                         27.520000000000003,
                                         27.68,
                                         27.84,
                                         41.52,
                                         41.76,
                                         42.,
                                         42.24,
                                         56.,
                                         56.32,
                                         56.64,
                                         56.96,
                                         56.,
                                         56.32,
                                         56.64,
                                         56.96,
                                         42.480000000000004,
                                         42.720000000000006,
                                         42.96,
                                         43.2,
                                         28.64,
                                         28.8,
                                         28.96,
                                         29.12,
                                         14.48,
                                         14.56,
                                         14.64,
                                         14.719999999999999,
                                         7.08,
                                         7.12,
                                         7.16,
                                         7.2,
                                         14.32,
                                         14.4,
                                         14.48,
                                         14.56,
                                         21.72,
                                         21.84,
                                         21.96,
                                         22.080000000000002,
                                         29.28,
                                         29.44,
                                         29.6,
                                         29.76,
                                         29.28,
                                         29.44,
                                         29.6,
                                         29.76,
                                         22.200000000000003,
                                         22.32,
                                         22.44,
                                         22.560000000000002,
                                         14.96,
                                         15.040000000000001,
                                         15.120000000000001,
                                         15.2,
                                         7.5600000000000005,
                                         7.6000000000000005,
                                         7.640000000000001,
                                         7.68};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<5, 1>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
