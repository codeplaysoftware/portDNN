/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v2.11.0.

#include <gtest/gtest.h>

#include "portdnn/padding_mode.h"

#include "portdnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/data_format_types.h"
#include "test/types/kernel_data_types.h"
#include "test/types/nested_pairs_to_triple.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using DataFormatList = sycldnn::types::DataFormatTypes;
using BackendList = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, DataFormatList>::type;
using SNNTypeBackendPairs =
    sycldnn::types::CartesianProduct<SNNTypePairs, BackendList>::type;
using TestTriples =
    sycldnn::types::NestedPairsToTriple<SNNTypeBackendPairs>::type;
using GTestTypeTriples = sycldnn::types::ToGTestTypes<TestTriples>::type;

template <typename Triple>
using AvgWindow3Stride2Grad =
    PoolingFixture<typename Triple::FirstType, typename Triple::SecondType,
                   typename Triple::ThirdType, pooling::Average,
                   pooling::Backpropagate>;
TYPED_TEST_SUITE(AvgWindow3Stride2Grad, GTestTypeTriples);
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.25,
                                         0.5833333333333333,
                                         0.3333333333333333,
                                         1.0833333333333333,
                                         0.75,
                                         0.9166666666666666,
                                         1.8055555555555556,
                                         0.8888888888888888,
                                         2.638888888888889,
                                         1.75,
                                         0.6666666666666666,
                                         1.2222222222222223,
                                         0.5555555555555556,
                                         1.5555555555555556,
                                         1.,
                                         2.4166666666666665,
                                         4.305555555555555,
                                         1.8888888888888888,
                                         5.138888888888889,
                                         3.25,
                                         1.75,
                                         3.083333333333333,
                                         1.3333333333333333,
                                         3.583333333333333,
                                         2.25};
  const std::array<int, 4> in_shape = {{1, 5, 5, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.2222222222222222, 0.1111111111111111,
      0.1111111111111111, 0.3333333333333333, 0.2222222222222222,
      0.2222222222222222, 0.4444444444444444, 0.4444444444444444,
      1.1111111111111112, 0.6666666666666666, 0.6666666666666666,
      0.3333333333333333, 0.3333333333333333, 0.7777777777777777,
      0.4444444444444444, 0.4444444444444444, 0.3333333333333333,
      0.3333333333333333, 0.7777777777777777, 0.4444444444444444,
      0.4444444444444444};
  const std::array<int, 4> in_shape = {{1, 5, 5, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.25,
                                         0.5,
                                         0.75,
                                         1.1666666666666665,
                                         0.5,
                                         0.6666666666666666,
                                         1.75,
                                         2.1666666666666665,
                                         1.25,
                                         1.5,
                                         1.4166666666666665,
                                         1.8333333333333333,
                                         2.9166666666666665,
                                         3.611111111111111,
                                         1.5,
                                         1.7777777777777777,
                                         4.583333333333333,
                                         5.277777777777778,
                                         3.083333333333333,
                                         3.5,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.1666666666666665,
                                         2.4444444444444446,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         4.416666666666666,
                                         4.833333333333333,
                                         7.916666666666666,
                                         8.61111111111111,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         3.25,
                                         3.5,
                                         5.75,
                                         6.166666666666666,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5};
  const std::array<int, 4> in_shape = {{1, 5, 5, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.2222222222222222, 0.1111111111111111,
      0.2222222222222222, 0.4444444444444444, 0.6666666666666666,
      0.3333333333333333, 0.4444444444444444, 0.3333333333333333,
      0.4444444444444444, 0.1111111111111111, 0.2222222222222222,
      0.1111111111111111, 0.2222222222222222, 0.4444444444444444,
      0.6666666666666666, 0.3333333333333333, 0.4444444444444444,
      0.3333333333333333, 0.4444444444444444, 0.6666666666666667,
      0.8888888888888888, 0.6666666666666667, 0.8888888888888888,
      1.7777777777777777, 2.2222222222222223, 1.111111111111111,
      1.3333333333333333, 1.111111111111111,  1.3333333333333333,
      0.5555555555555556, 0.6666666666666666, 0.5555555555555556,
      0.6666666666666666, 1.3333333333333333, 1.5555555555555554,
      0.7777777777777777, 0.8888888888888888, 0.7777777777777777,
      0.8888888888888888, 0.5555555555555556, 0.6666666666666666,
      0.5555555555555556, 0.6666666666666666, 1.3333333333333333,
      1.5555555555555554, 0.7777777777777777, 0.8888888888888888,
      0.7777777777777777, 0.8888888888888888};
  const std::array<int, 4> in_shape = {{1, 5, 5, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.25,
                                         0.5,
                                         0.75,
                                         1.,
                                         1.0833333333333333,
                                         1.5,
                                         1.9166666666666665,
                                         2.333333333333333,
                                         0.8333333333333333,
                                         1.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         3.083333333333333,
                                         3.5,
                                         3.9166666666666665,
                                         4.333333333333333,
                                         2.25,
                                         2.5,
                                         2.75,
                                         3.,
                                         2.4166666666666665,
                                         2.833333333333333,
                                         3.25,
                                         3.6666666666666665,
                                         5.138888888888889,
                                         5.833333333333333,
                                         6.527777777777777,
                                         7.222222222222222,
                                         2.7222222222222223,
                                         3.,
                                         3.2777777777777777,
                                         3.5555555555555554,
                                         8.472222222222221,
                                         9.166666666666666,
                                         9.86111111111111,
                                         10.555555555555555,
                                         5.75,
                                         6.166666666666666,
                                         6.583333333333333,
                                         7.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         4.055555555555555,
                                         4.333333333333333,
                                         4.611111111111111,
                                         4.888888888888889,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         8.416666666666666,
                                         8.833333333333332,
                                         9.25,
                                         9.666666666666666,
                                         15.13888888888889,
                                         15.833333333333332,
                                         16.52777777777778,
                                         17.22222222222222,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         6.25,
                                         6.5,
                                         6.75,
                                         7.,
                                         11.083333333333332,
                                         11.5,
                                         11.916666666666666,
                                         12.333333333333332,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.};
  const std::array<int, 4> in_shape = {{1, 5, 5, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777};
  const std::array<int, 4> in_shape = {{1, 5, 5, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.16666666666666666, 0.16666666666666666, 0.5,
      0.3333333333333333,  1.0833333333333333,  0.75,
      0.611111111111111,   0.611111111111111,   1.5,
      0.8888888888888888,  2.638888888888889,   1.75,
      0.4444444444444444,  0.4444444444444444,  1.,
      0.5555555555555556,  1.5555555555555556,  1.,
      1.611111111111111,   1.611111111111111,   3.5,
      1.8888888888888888,  5.138888888888889,   3.25,
      1.1666666666666665,  1.1666666666666665,  2.5,
      1.3333333333333333,  3.583333333333333,   2.25};
  const std::array<int, 4> in_shape = {{1, 5, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.2222222222222222, 0.,
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.2222222222222222, 0.,
      0.4444444444444444, 0.4444444444444444, 1.1111111111111112,
      0.6666666666666666, 0.6666666666666666, 0.,
      0.3333333333333333, 0.3333333333333333, 0.7777777777777777,
      0.4444444444444444, 0.4444444444444444, 0.,
      0.3333333333333333, 0.3333333333333333, 0.7777777777777777,
      0.4444444444444444, 0.4444444444444444, 0.};
  const std::array<int, 4> in_shape = {{1, 5, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.6666666666666666,
                                         1.,
                                         0.5,
                                         0.6666666666666666,
                                         1.75,
                                         2.1666666666666665,
                                         1.25,
                                         1.5,
                                         0.9444444444444443,
                                         1.222222222222222,
                                         0.9444444444444443,
                                         1.222222222222222,
                                         2.444444444444444,
                                         3.,
                                         1.5,
                                         1.7777777777777777,
                                         4.583333333333333,
                                         5.277777777777778,
                                         3.083333333333333,
                                         3.5,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         2.944444444444444,
                                         3.222222222222222,
                                         2.944444444444444,
                                         3.222222222222222,
                                         6.444444444444445,
                                         7.,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         4.666666666666666,
                                         5.,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5};
  const std::array<int, 4> in_shape = {{1, 5, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 5, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.9999999999999999,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.,
                                         0.8333333333333333,
                                         1.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         3.083333333333333,
                                         3.5,
                                         3.9166666666666665,
                                         4.333333333333333,
                                         2.25,
                                         2.5,
                                         2.75,
                                         3.,
                                         1.6111111111111112,
                                         1.8888888888888886,
                                         2.1666666666666665,
                                         2.444444444444444,
                                         1.6111111111111112,
                                         1.8888888888888886,
                                         2.1666666666666665,
                                         2.444444444444444,
                                         4.333333333333333,
                                         4.888888888888888,
                                         5.444444444444445,
                                         6.,
                                         2.7222222222222223,
                                         3.,
                                         3.2777777777777777,
                                         3.5555555555555554,
                                         8.472222222222221,
                                         9.166666666666666,
                                         9.86111111111111,
                                         10.555555555555555,
                                         5.75,
                                         6.166666666666666,
                                         6.583333333333333,
                                         7.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         12.333333333333332,
                                         12.88888888888889,
                                         13.444444444444445,
                                         14.,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.};
  const std::array<int, 4> in_shape = {{1, 5, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 5, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.16666666666666666,
                                         0.5,
                                         0.3333333333333333,
                                         0.8333333333333333,
                                         0.5,
                                         1.5,
                                         1.,
                                         0.7222222222222222,
                                         0.7222222222222222,
                                         1.7222222222222223,
                                         1.,
                                         2.2777777777777777,
                                         1.2777777777777777,
                                         3.6111111111111107,
                                         2.333333333333333,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         1.4444444444444442,
                                         0.7777777777777777,
                                         2.1111111111111107,
                                         1.3333333333333333,
                                         2.0555555555555554,
                                         2.0555555555555554,
                                         4.388888888888889,
                                         2.333333333333333,
                                         4.944444444444444,
                                         2.6111111111111107,
                                         6.944444444444444,
                                         4.333333333333333,
                                         1.5,
                                         1.5,
                                         3.1666666666666665,
                                         1.6666666666666665,
                                         3.5,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.};
  const std::array<int, 4> in_shape = {{1, 5, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.3333333333333333,
                                         0.7777777777777778,
                                         1.7777777777777777,
                                         1.,
                                         1.,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 5, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.6666666666666666,
                                         1.,
                                         0.5,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         0.8333333333333333,
                                         1.,
                                         2.583333333333333,
                                         3.,
                                         1.75,
                                         2.,
                                         1.1666666666666667,
                                         1.4444444444444444,
                                         1.1666666666666667,
                                         1.4444444444444444,
                                         2.8888888888888884,
                                         3.4444444444444446,
                                         1.722222222222222,
                                         2.,
                                         4.,
                                         4.555555555555555,
                                         2.2777777777777777,
                                         2.5555555555555554,
                                         6.527777777777778,
                                         7.222222222222221,
                                         4.25,
                                         4.666666666666666,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.9444444444444446,
                                         4.222222222222221,
                                         2.5,
                                         2.6666666666666665,
                                         3.833333333333333,
                                         4.111111111111111,
                                         3.833333333333333,
                                         4.111111111111111,
                                         8.222222222222221,
                                         8.777777777777779,
                                         4.388888888888888,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.888888888888888,
                                         4.944444444444445,
                                         5.222222222222221,
                                         13.194444444444445,
                                         13.888888888888888,
                                         8.25,
                                         8.666666666666666,
                                         2.833333333333333,
                                         3.,
                                         2.833333333333333,
                                         3.,
                                         6.,
                                         6.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.};
  const std::array<int, 4> in_shape = {{1, 5, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         3.1111111111111107,
                                         3.5555555555555554,
                                         1.7777777777777777,
                                         2.,
                                         1.7777777777777777,
                                         2.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 5, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x5x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.9999999999999999,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.,
                                         0.8333333333333333,
                                         1.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.333333333333333,
                                         2.6666666666666665,
                                         3.,
                                         3.333333333333333,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         4.75,
                                         5.166666666666666,
                                         5.583333333333333,
                                         6.,
                                         3.25,
                                         3.5,
                                         3.75,
                                         4.,
                                         2.0555555555555554,
                                         2.3333333333333335,
                                         2.611111111111111,
                                         2.888888888888889,
                                         2.0555555555555554,
                                         2.3333333333333335,
                                         2.611111111111111,
                                         2.888888888888889,
                                         5.222222222222221,
                                         5.777777777777777,
                                         6.333333333333333,
                                         6.888888888888889,
                                         3.166666666666666,
                                         3.444444444444444,
                                         3.722222222222222,
                                         4.,
                                         7.444444444444444,
                                         8.,
                                         8.555555555555555,
                                         9.11111111111111,
                                         4.277777777777778,
                                         4.555555555555555,
                                         4.833333333333333,
                                         5.111111111111111,
                                         12.36111111111111,
                                         13.055555555555555,
                                         13.749999999999998,
                                         14.444444444444443,
                                         8.083333333333332,
                                         8.5,
                                         8.916666666666666,
                                         9.333333333333332,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777777,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         7.611111111111111,
                                         7.888888888888889,
                                         8.166666666666666,
                                         8.444444444444443,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         15.888888888888888,
                                         16.444444444444443,
                                         17.,
                                         17.555555555555557,
                                         8.5,
                                         8.777777777777777,
                                         9.055555555555555,
                                         9.333333333333332,
                                         18.11111111111111,
                                         18.666666666666664,
                                         19.22222222222222,
                                         19.777777777777775,
                                         9.61111111111111,
                                         9.88888888888889,
                                         10.166666666666666,
                                         10.444444444444443,
                                         25.694444444444443,
                                         26.38888888888889,
                                         27.083333333333332,
                                         27.777777777777775,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         11.666666666666666,
                                         12.,
                                         12.333333333333332,
                                         12.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.};
  const std::array<int, 4> in_shape = {{1, 5, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x5x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         5.777777777777778,
                                         6.222222222222221,
                                         6.666666666666666,
                                         7.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 5, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.8333333333333333,
                                         1.611111111111111,
                                         0.7777777777777778,
                                         2.2777777777777777,
                                         1.5,
                                         0.6666666666666666,
                                         1.2222222222222223,
                                         0.5555555555555556,
                                         1.5555555555555556,
                                         1.,
                                         2.4166666666666665,
                                         4.305555555555555,
                                         1.8888888888888888,
                                         5.138888888888889,
                                         3.25,
                                         1.75,
                                         3.083333333333333,
                                         1.3333333333333333,
                                         3.583333333333333,
                                         2.25};
  const std::array<int, 4> in_shape = {{1, 6, 5, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 5, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.6666666666666665,
                                         3.222222222222222,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.1666666666666665,
                                         2.4444444444444446,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         4.416666666666666,
                                         4.833333333333333,
                                         7.916666666666666,
                                         8.61111111111111,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         3.25,
                                         3.5,
                                         5.75,
                                         6.166666666666666,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5};
  const std::array<int, 4> in_shape = {{1, 6, 5, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 5, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         2.333333333333333,
                                         2.6666666666666665,
                                         3.,
                                         3.333333333333333,
                                         4.777777777777778,
                                         5.333333333333333,
                                         5.888888888888889,
                                         6.444444444444444,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         4.055555555555555,
                                         4.333333333333333,
                                         4.611111111111111,
                                         4.888888888888889,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         8.416666666666666,
                                         8.833333333333332,
                                         9.25,
                                         9.666666666666666,
                                         15.13888888888889,
                                         15.833333333333332,
                                         16.52777777777778,
                                         17.22222222222222,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         6.25,
                                         6.5,
                                         6.75,
                                         7.,
                                         11.083333333333332,
                                         11.5,
                                         11.916666666666666,
                                         12.333333333333332,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.};
  const std::array<int, 4> in_shape = {{1, 6, 5, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 5, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.5555555555555556, 0.5555555555555556, 1.3333333333333333,
      0.7777777777777778, 2.2777777777777777, 1.5,
      0.4444444444444444, 0.4444444444444444, 1.,
      0.5555555555555556, 1.5555555555555556, 1.,
      1.611111111111111,  1.611111111111111,  3.5,
      1.8888888888888888, 5.138888888888889,  3.25,
      1.1666666666666665, 1.1666666666666665, 2.5,
      1.3333333333333333, 3.583333333333333,  2.25};
  const std::array<int, 4> in_shape = {{1, 6, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         2.944444444444444,
                                         3.222222222222222,
                                         2.944444444444444,
                                         3.222222222222222,
                                         6.444444444444445,
                                         7.,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         4.666666666666666,
                                         5.,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5};
  const std::array<int, 4> in_shape = {{1, 6, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         12.333333333333332,
                                         12.88888888888889,
                                         13.444444444444445,
                                         14.,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.};
  const std::array<int, 4> in_shape = {{1, 6, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.6666666666666667,
                                         0.6666666666666667,
                                         1.5555555555555554,
                                         0.8888888888888888,
                                         2.,
                                         1.111111111111111,
                                         3.1111111111111107,
                                         2.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         1.4444444444444442,
                                         0.7777777777777777,
                                         2.1111111111111107,
                                         1.3333333333333333,
                                         2.0555555555555554,
                                         2.0555555555555554,
                                         4.388888888888889,
                                         2.333333333333333,
                                         4.944444444444444,
                                         2.6111111111111107,
                                         6.944444444444444,
                                         4.333333333333333,
                                         1.5,
                                         1.5,
                                         3.1666666666666665,
                                         1.6666666666666665,
                                         3.5,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.};
  const std::array<int, 4> in_shape = {{1, 6, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.3333333333333333,
                                         0.7777777777777778,
                                         1.7777777777777777,
                                         1.,
                                         1.,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         2.6666666666666665,
                                         3.1111111111111107,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         2.,
                                         2.222222222222222,
                                         5.666666666666666,
                                         6.222222222222221,
                                         3.6666666666666665,
                                         4.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.9444444444444446,
                                         4.222222222222221,
                                         2.5,
                                         2.6666666666666665,
                                         3.833333333333333,
                                         4.111111111111111,
                                         3.833333333333333,
                                         4.111111111111111,
                                         8.222222222222221,
                                         8.777777777777779,
                                         4.388888888888888,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.888888888888888,
                                         4.944444444444445,
                                         5.222222222222221,
                                         13.194444444444445,
                                         13.888888888888888,
                                         8.25,
                                         8.666666666666666,
                                         2.833333333333333,
                                         3.,
                                         2.833333333333333,
                                         3.,
                                         6.,
                                         6.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.};
  const std::array<int, 4> in_shape = {{1, 6, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         3.1111111111111107,
                                         3.5555555555555554,
                                         1.7777777777777777,
                                         2.,
                                         1.7777777777777777,
                                         2.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         4.888888888888888,
                                         5.333333333333333,
                                         5.777777777777778,
                                         6.222222222222221,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666666,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         4.,
                                         4.222222222222222,
                                         4.444444444444444,
                                         10.777777777777779,
                                         11.333333333333332,
                                         11.88888888888889,
                                         12.444444444444443,
                                         7.,
                                         7.333333333333333,
                                         7.666666666666666,
                                         8.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777777,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         7.611111111111111,
                                         7.888888888888889,
                                         8.166666666666666,
                                         8.444444444444443,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         15.888888888888888,
                                         16.444444444444443,
                                         17.,
                                         17.555555555555557,
                                         8.5,
                                         8.777777777777777,
                                         9.055555555555555,
                                         9.333333333333332,
                                         18.11111111111111,
                                         18.666666666666664,
                                         19.22222222222222,
                                         19.777777777777775,
                                         9.61111111111111,
                                         9.88888888888889,
                                         10.166666666666666,
                                         10.444444444444443,
                                         25.694444444444443,
                                         26.38888888888889,
                                         27.083333333333332,
                                         27.777777777777775,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         11.666666666666666,
                                         12.,
                                         12.333333333333332,
                                         12.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.};
  const std::array<int, 4> in_shape = {{1, 6, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         5.777777777777778,
                                         6.222222222222221,
                                         6.666666666666666,
                                         7.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 6, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.8333333333333333,
                                         1.611111111111111,
                                         0.7777777777777778,
                                         2.2777777777777777,
                                         1.5,
                                         0.6666666666666666,
                                         1.2222222222222223,
                                         0.5555555555555556,
                                         1.5555555555555556,
                                         1.,
                                         1.833333333333333,
                                         3.2777777777777777,
                                         1.4444444444444444,
                                         3.9444444444444446,
                                         2.5,
                                         1.1666666666666665,
                                         2.0555555555555554,
                                         0.8888888888888888,
                                         2.388888888888889,
                                         1.5,
                                         3.6666666666666665,
                                         6.388888888888888,
                                         2.7222222222222223,
                                         7.222222222222222,
                                         4.5,
                                         2.5,
                                         4.333333333333333,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.};
  const std::array<int, 4> in_shape = {{1, 8, 5, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         2.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 5, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.6666666666666665,
                                         3.222222222222222,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.1666666666666665,
                                         2.4444444444444446,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         3.333333333333333,
                                         3.666666666666666,
                                         6.,
                                         6.555555555555555,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         7.333333333333333,
                                         7.888888888888889,
                                         4.666666666666666,
                                         5.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         3.833333333333333,
                                         4.111111111111111,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         4.5,
                                         4.777777777777778,
                                         2.833333333333333,
                                         3.,
                                         6.916666666666666,
                                         7.333333333333333,
                                         12.083333333333332,
                                         12.777777777777777,
                                         5.166666666666666,
                                         5.444444444444445,
                                         13.75,
                                         14.444444444444445,
                                         8.583333333333332,
                                         9.,
                                         4.75,
                                         5.,
                                         8.25,
                                         8.666666666666666,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.};
  const std::array<int, 4> in_shape = {{1, 8, 5, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 5, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         2.333333333333333,
                                         2.6666666666666665,
                                         3.,
                                         3.333333333333333,
                                         4.777777777777778,
                                         5.333333333333333,
                                         5.888888888888889,
                                         6.444444444444444,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         4.055555555555555,
                                         4.333333333333333,
                                         4.611111111111111,
                                         4.888888888888889,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         6.333333333333332,
                                         6.666666666666666,
                                         7.,
                                         7.333333333333332,
                                         11.444444444444443,
                                         12.,
                                         12.555555555555555,
                                         13.11111111111111,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         14.11111111111111,
                                         14.666666666666666,
                                         15.222222222222221,
                                         15.777777777777779,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         7.3888888888888875,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         8.722222222222221,
                                         9.,
                                         9.277777777777777,
                                         9.555555555555555,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         13.416666666666666,
                                         13.833333333333332,
                                         14.25,
                                         14.666666666666666,
                                         23.472222222222218,
                                         24.166666666666664,
                                         24.861111111111107,
                                         25.555555555555554,
                                         10.055555555555555,
                                         10.333333333333332,
                                         10.61111111111111,
                                         10.88888888888889,
                                         26.805555555555554,
                                         27.5,
                                         28.194444444444443,
                                         28.88888888888889,
                                         16.75,
                                         17.166666666666664,
                                         17.583333333333332,
                                         18.,
                                         9.25,
                                         9.5,
                                         9.75,
                                         10.,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.};
  const std::array<int, 4> in_shape = {{1, 8, 5, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666667,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 5, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.5555555555555556, 0.5555555555555556, 1.3333333333333333,
      0.7777777777777778, 2.2777777777777777, 1.5,
      0.4444444444444444, 0.4444444444444444, 1.,
      0.5555555555555556, 1.5555555555555556, 1.,
      1.222222222222222,  1.222222222222222,  2.6666666666666665,
      1.4444444444444444, 3.9444444444444446, 2.5,
      0.7777777777777777, 0.7777777777777777, 1.6666666666666665,
      0.8888888888888888, 2.388888888888889,  1.5,
      2.444444444444444,  2.444444444444444,  5.166666666666666,
      2.7222222222222223, 7.222222222222222,  4.5,
      1.6666666666666665, 1.6666666666666665, 3.5,
      1.8333333333333333, 4.833333333333333,  3.};
  const std::array<int, 4> in_shape = {{1, 8, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         2.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         7.333333333333333,
                                         7.888888888888889,
                                         4.666666666666666,
                                         5.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         4.5,
                                         4.777777777777778,
                                         2.833333333333333,
                                         3.,
                                         4.611111111111111,
                                         4.888888888888888,
                                         4.611111111111111,
                                         4.888888888888888,
                                         9.777777777777777,
                                         10.333333333333332,
                                         5.166666666666666,
                                         5.444444444444445,
                                         13.75,
                                         14.444444444444445,
                                         8.583333333333332,
                                         9.,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.};
  const std::array<int, 4> in_shape = {{1, 8, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         9.333333333333332,
                                         9.777777777777779,
                                         10.222222222222221,
                                         10.666666666666666,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         14.11111111111111,
                                         14.666666666666666,
                                         15.222222222222221,
                                         15.777777777777779,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         8.722222222222221,
                                         9.,
                                         9.277777777777777,
                                         9.555555555555555,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         8.944444444444443,
                                         9.222222222222221,
                                         9.5,
                                         9.777777777777777,
                                         8.944444444444443,
                                         9.222222222222221,
                                         9.5,
                                         9.777777777777777,
                                         19.,
                                         19.555555555555554,
                                         20.11111111111111,
                                         20.666666666666664,
                                         10.055555555555555,
                                         10.333333333333332,
                                         10.61111111111111,
                                         10.88888888888889,
                                         26.805555555555554,
                                         27.5,
                                         28.194444444444443,
                                         28.88888888888889,
                                         16.75,
                                         17.166666666666664,
                                         17.583333333333332,
                                         18.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.};
  const std::array<int, 4> in_shape = {{1, 8, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666667,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.6666666666666667,
                                         0.6666666666666667,
                                         1.5555555555555554,
                                         0.8888888888888888,
                                         2.,
                                         1.111111111111111,
                                         3.1111111111111107,
                                         2.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         1.4444444444444442,
                                         0.7777777777777777,
                                         2.1111111111111107,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         1.5555555555555556,
                                         3.3333333333333335,
                                         1.7777777777777777,
                                         3.7777777777777777,
                                         1.9999999999999998,
                                         5.333333333333333,
                                         3.333333333333333,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         3.2222222222222223,
                                         2.,
                                         3.1666666666666665,
                                         3.1666666666666665,
                                         6.611111111111111,
                                         3.444444444444444,
                                         7.166666666666666,
                                         3.7222222222222223,
                                         9.722222222222221,
                                         6.,
                                         2.1666666666666665,
                                         2.1666666666666665,
                                         4.5,
                                         2.333333333333333,
                                         4.833333333333333,
                                         2.5,
                                         6.5,
                                         4.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.3333333333333333,
                                         0.7777777777777778,
                                         1.7777777777777777,
                                         1.,
                                         1.,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.6666666666666665,
                                         1.4444444444444444,
                                         3.111111111111111,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         2.6666666666666665,
                                         3.1111111111111107,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         2.,
                                         2.222222222222222,
                                         5.666666666666666,
                                         6.222222222222221,
                                         3.6666666666666665,
                                         4.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.9444444444444446,
                                         4.222222222222221,
                                         2.5,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         2.888888888888889,
                                         3.111111111111111,
                                         6.222222222222221,
                                         6.666666666666667,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.555555555555555,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         10.11111111111111,
                                         10.666666666666666,
                                         6.333333333333333,
                                         6.666666666666666,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         6.166666666666666,
                                         6.444444444444445,
                                         3.833333333333333,
                                         4.,
                                         6.055555555555555,
                                         6.333333333333333,
                                         6.055555555555555,
                                         6.333333333333333,
                                         12.666666666666666,
                                         13.222222222222221,
                                         6.611111111111111,
                                         6.888888888888888,
                                         13.777777777777779,
                                         14.333333333333332,
                                         7.166666666666666,
                                         7.444444444444445,
                                         18.75,
                                         19.444444444444443,
                                         11.583333333333332,
                                         12.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.166666666666666,
                                         4.333333333333333,
                                         8.666666666666666,
                                         9.,
                                         4.5,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.666666666666666,
                                         4.833333333333333,
                                         5.,
                                         12.583333333333332,
                                         13.,
                                         7.75,
                                         8.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         3.1111111111111107,
                                         3.5555555555555554,
                                         1.7777777777777777,
                                         2.,
                                         1.7777777777777777,
                                         2.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.222222222222222,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         4.888888888888888,
                                         5.333333333333333,
                                         5.777777777777778,
                                         6.222222222222221,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666666,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         4.,
                                         4.222222222222222,
                                         4.444444444444444,
                                         10.777777777777779,
                                         11.333333333333332,
                                         11.88888888888889,
                                         12.444444444444443,
                                         7.,
                                         7.333333333333333,
                                         7.666666666666666,
                                         8.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777777,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         7.611111111111111,
                                         7.888888888888889,
                                         8.166666666666666,
                                         8.444444444444443,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         6.,
                                         6.222222222222222,
                                         5.555555555555555,
                                         5.777777777777778,
                                         6.,
                                         6.222222222222222,
                                         11.999999999999998,
                                         12.444444444444443,
                                         12.88888888888889,
                                         13.333333333333334,
                                         6.444444444444444,
                                         6.666666666666666,
                                         6.888888888888888,
                                         7.111111111111111,
                                         13.777777777777777,
                                         14.222222222222221,
                                         14.666666666666668,
                                         15.11111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         7.777777777777778,
                                         7.999999999999999,
                                         19.666666666666664,
                                         20.22222222222222,
                                         20.777777777777775,
                                         21.333333333333332,
                                         12.333333333333332,
                                         12.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         12.055555555555555,
                                         12.333333333333332,
                                         12.61111111111111,
                                         12.88888888888889,
                                         7.5,
                                         7.666666666666666,
                                         7.833333333333333,
                                         8.,
                                         11.833333333333332,
                                         12.11111111111111,
                                         12.38888888888889,
                                         12.666666666666666,
                                         11.833333333333332,
                                         12.11111111111111,
                                         12.38888888888889,
                                         12.666666666666666,
                                         24.777777777777775,
                                         25.333333333333332,
                                         25.888888888888886,
                                         26.444444444444443,
                                         12.944444444444443,
                                         13.222222222222221,
                                         13.5,
                                         13.777777777777777,
                                         27.,
                                         27.555555555555557,
                                         28.11111111111111,
                                         28.666666666666664,
                                         14.055555555555555,
                                         14.333333333333332,
                                         14.61111111111111,
                                         14.88888888888889,
                                         36.80555555555556,
                                         37.5,
                                         38.19444444444444,
                                         38.888888888888886,
                                         22.75,
                                         23.166666666666664,
                                         23.583333333333332,
                                         24.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         17.,
                                         17.333333333333332,
                                         17.666666666666664,
                                         18.,
                                         8.833333333333332,
                                         9.,
                                         9.166666666666666,
                                         9.333333333333332,
                                         18.333333333333332,
                                         18.666666666666664,
                                         19.,
                                         19.333333333333332,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         24.75,
                                         25.166666666666664,
                                         25.583333333333332,
                                         26.,
                                         15.25,
                                         15.5,
                                         15.75,
                                         16.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID1x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         5.777777777777778,
                                         6.222222222222221,
                                         6.666666666666666,
                                         7.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         9.333333333333332,
                                         9.777777777777779,
                                         10.222222222222221,
                                         10.666666666666666,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         11.111111111111109,
                                         11.555555555555555,
                                         12.,
                                         12.444444444444445,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{1, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.25,
                                         0.5833333333333333,
                                         0.3333333333333333,
                                         1.0833333333333333,
                                         0.75,
                                         0.9166666666666666,
                                         1.8055555555555556,
                                         0.8888888888888888,
                                         2.638888888888889,
                                         1.75,
                                         0.6666666666666666,
                                         1.2222222222222223,
                                         0.5555555555555556,
                                         1.5555555555555556,
                                         1.,
                                         2.4166666666666665,
                                         4.305555555555555,
                                         1.8888888888888888,
                                         5.138888888888889,
                                         3.25,
                                         1.75,
                                         3.083333333333333,
                                         1.3333333333333333,
                                         3.583333333333333,
                                         2.25,
                                         2.5,
                                         4.333333333333333,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.,
                                         4.666666666666666,
                                         8.055555555555555,
                                         3.3888888888888884,
                                         8.88888888888889,
                                         5.5,
                                         2.1666666666666665,
                                         3.722222222222222,
                                         1.5555555555555554,
                                         4.055555555555555,
                                         2.5,
                                         6.166666666666666,
                                         10.555555555555554,
                                         4.388888888888888,
                                         11.38888888888889,
                                         7.,
                                         4.,
                                         6.833333333333333,
                                         2.833333333333333,
                                         7.333333333333333,
                                         4.5,
                                         4.75,
                                         8.083333333333332,
                                         3.333333333333333,
                                         8.583333333333332,
                                         5.25,
                                         8.416666666666666,
                                         14.305555555555554,
                                         5.888888888888888,
                                         15.138888888888888,
                                         9.25,
                                         3.6666666666666665,
                                         6.222222222222221,
                                         2.5555555555555554,
                                         6.555555555555555,
                                         4.,
                                         9.916666666666666,
                                         16.805555555555554,
                                         6.888888888888888,
                                         17.63888888888889,
                                         10.75,
                                         6.25,
                                         10.583333333333332,
                                         4.333333333333333,
                                         11.083333333333332,
                                         6.75};
  const std::array<int, 4> in_shape = {{3, 5, 5, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         2.888888888888889,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.2222222222222223,
                                         4.666666666666666,
                                         2.4444444444444446,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333};
  const std::array<int, 4> in_shape = {{3, 5, 5, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.25,
                                         0.5,
                                         0.75,
                                         1.1666666666666665,
                                         0.5,
                                         0.6666666666666666,
                                         1.75,
                                         2.1666666666666665,
                                         1.25,
                                         1.5,
                                         1.4166666666666665,
                                         1.8333333333333333,
                                         2.9166666666666665,
                                         3.611111111111111,
                                         1.5,
                                         1.7777777777777777,
                                         4.583333333333333,
                                         5.277777777777778,
                                         3.083333333333333,
                                         3.5,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.1666666666666665,
                                         2.4444444444444446,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         4.416666666666666,
                                         4.833333333333333,
                                         7.916666666666666,
                                         8.61111111111111,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         3.25,
                                         3.5,
                                         5.75,
                                         6.166666666666666,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5,
                                         4.75,
                                         5.,
                                         8.25,
                                         8.666666666666666,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.,
                                         8.916666666666666,
                                         9.333333333333332,
                                         15.416666666666666,
                                         16.11111111111111,
                                         6.5,
                                         6.777777777777777,
                                         17.083333333333332,
                                         17.77777777777778,
                                         10.583333333333332,
                                         11.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         7.166666666666666,
                                         7.444444444444444,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         11.916666666666666,
                                         12.333333333333332,
                                         20.416666666666664,
                                         21.111111111111107,
                                         8.5,
                                         8.777777777777777,
                                         22.083333333333332,
                                         22.77777777777778,
                                         13.583333333333332,
                                         14.,
                                         7.75,
                                         8.,
                                         13.25,
                                         13.666666666666666,
                                         5.5,
                                         5.666666666666666,
                                         14.25,
                                         14.666666666666666,
                                         8.75,
                                         9.,
                                         9.25,
                                         9.5,
                                         15.75,
                                         16.166666666666664,
                                         6.5,
                                         6.666666666666666,
                                         16.75,
                                         17.166666666666664,
                                         10.25,
                                         10.5,
                                         16.416666666666664,
                                         16.833333333333332,
                                         27.916666666666664,
                                         28.611111111111107,
                                         11.5,
                                         11.777777777777777,
                                         29.583333333333332,
                                         30.277777777777775,
                                         18.083333333333332,
                                         18.5,
                                         7.166666666666666,
                                         7.333333333333333,
                                         12.166666666666666,
                                         12.444444444444443,
                                         5.,
                                         5.111111111111111,
                                         12.833333333333332,
                                         13.11111111111111,
                                         7.833333333333333,
                                         8.,
                                         19.416666666666664,
                                         19.833333333333332,
                                         32.916666666666664,
                                         33.61111111111111,
                                         13.5,
                                         13.777777777777777,
                                         34.58333333333333,
                                         35.27777777777778,
                                         21.083333333333332,
                                         21.5,
                                         12.25,
                                         12.5,
                                         20.75,
                                         21.166666666666664,
                                         8.5,
                                         8.666666666666666,
                                         21.75,
                                         22.166666666666664,
                                         13.25,
                                         13.5};
  const std::array<int, 4> in_shape = {{3, 5, 5, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         5.333333333333334,
                                         5.777777777777778,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.222222222222221,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.333333333333332,
                                         4.666666666666666,
                                         4.888888888888889,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665};
  const std::array<int, 4> in_shape = {{3, 5, 5, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.25,
                                         0.5,
                                         0.75,
                                         1.,
                                         1.0833333333333333,
                                         1.5,
                                         1.9166666666666665,
                                         2.333333333333333,
                                         0.8333333333333333,
                                         1.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         3.083333333333333,
                                         3.5,
                                         3.9166666666666665,
                                         4.333333333333333,
                                         2.25,
                                         2.5,
                                         2.75,
                                         3.,
                                         2.4166666666666665,
                                         2.833333333333333,
                                         3.25,
                                         3.6666666666666665,
                                         5.138888888888889,
                                         5.833333333333333,
                                         6.527777777777777,
                                         7.222222222222222,
                                         2.7222222222222223,
                                         3.,
                                         3.2777777777777777,
                                         3.5555555555555554,
                                         8.472222222222221,
                                         9.166666666666666,
                                         9.86111111111111,
                                         10.555555555555555,
                                         5.75,
                                         6.166666666666666,
                                         6.583333333333333,
                                         7.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         4.055555555555555,
                                         4.333333333333333,
                                         4.611111111111111,
                                         4.888888888888889,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         8.416666666666666,
                                         8.833333333333332,
                                         9.25,
                                         9.666666666666666,
                                         15.13888888888889,
                                         15.833333333333332,
                                         16.52777777777778,
                                         17.22222222222222,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         6.25,
                                         6.5,
                                         6.75,
                                         7.,
                                         11.083333333333332,
                                         11.5,
                                         11.916666666666666,
                                         12.333333333333332,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.,
                                         9.25,
                                         9.5,
                                         9.75,
                                         10.,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.,
                                         17.416666666666664,
                                         17.833333333333332,
                                         18.25,
                                         18.666666666666664,
                                         30.13888888888889,
                                         30.833333333333332,
                                         31.527777777777775,
                                         32.22222222222222,
                                         12.722222222222221,
                                         13.,
                                         13.277777777777777,
                                         13.555555555555554,
                                         33.47222222222222,
                                         34.166666666666664,
                                         34.86111111111111,
                                         35.55555555555556,
                                         20.75,
                                         21.166666666666664,
                                         21.583333333333332,
                                         22.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         14.055555555555554,
                                         14.333333333333332,
                                         14.61111111111111,
                                         14.888888888888888,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         23.416666666666664,
                                         23.833333333333332,
                                         24.25,
                                         24.666666666666664,
                                         40.138888888888886,
                                         40.83333333333333,
                                         41.52777777777778,
                                         42.222222222222214,
                                         16.72222222222222,
                                         17.,
                                         17.27777777777778,
                                         17.555555555555554,
                                         43.47222222222222,
                                         44.166666666666664,
                                         44.86111111111111,
                                         45.55555555555556,
                                         26.75,
                                         27.166666666666664,
                                         27.583333333333332,
                                         28.,
                                         15.25,
                                         15.5,
                                         15.75,
                                         16.,
                                         26.083333333333332,
                                         26.5,
                                         26.916666666666664,
                                         27.333333333333332,
                                         10.833333333333332,
                                         11.,
                                         11.166666666666666,
                                         11.333333333333332,
                                         28.083333333333332,
                                         28.5,
                                         28.916666666666664,
                                         29.333333333333332,
                                         17.25,
                                         17.5,
                                         17.75,
                                         18.,
                                         18.25,
                                         18.5,
                                         18.75,
                                         19.,
                                         31.083333333333332,
                                         31.5,
                                         31.916666666666664,
                                         32.33333333333333,
                                         12.833333333333332,
                                         13.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         33.08333333333333,
                                         33.5,
                                         33.916666666666664,
                                         34.33333333333333,
                                         20.25,
                                         20.5,
                                         20.75,
                                         21.,
                                         32.416666666666664,
                                         32.83333333333333,
                                         33.25,
                                         33.666666666666664,
                                         55.138888888888886,
                                         55.83333333333333,
                                         56.52777777777777,
                                         57.222222222222214,
                                         22.72222222222222,
                                         23.,
                                         23.27777777777778,
                                         23.555555555555554,
                                         58.472222222222214,
                                         59.166666666666664,
                                         59.8611111111111,
                                         60.55555555555555,
                                         35.75,
                                         36.166666666666664,
                                         36.58333333333333,
                                         37.,
                                         14.166666666666666,
                                         14.333333333333332,
                                         14.5,
                                         14.666666666666666,
                                         24.055555555555554,
                                         24.333333333333332,
                                         24.61111111111111,
                                         24.888888888888886,
                                         9.888888888888888,
                                         10.,
                                         10.11111111111111,
                                         10.222222222222221,
                                         25.388888888888886,
                                         25.666666666666664,
                                         25.944444444444443,
                                         26.22222222222222,
                                         15.5,
                                         15.666666666666666,
                                         15.833333333333332,
                                         16.,
                                         38.416666666666664,
                                         38.83333333333333,
                                         39.25,
                                         39.666666666666664,
                                         65.13888888888889,
                                         65.83333333333333,
                                         66.52777777777777,
                                         67.22222222222221,
                                         26.72222222222222,
                                         27.,
                                         27.277777777777775,
                                         27.555555555555554,
                                         68.47222222222221,
                                         69.16666666666666,
                                         69.86111111111111,
                                         70.55555555555556,
                                         41.75,
                                         42.166666666666664,
                                         42.58333333333333,
                                         43.,
                                         24.25,
                                         24.5,
                                         24.75,
                                         25.,
                                         41.08333333333333,
                                         41.5,
                                         41.916666666666664,
                                         42.33333333333333,
                                         16.833333333333332,
                                         17.,
                                         17.166666666666664,
                                         17.333333333333332,
                                         43.08333333333333,
                                         43.5,
                                         43.916666666666664,
                                         44.33333333333333,
                                         26.25,
                                         26.5,
                                         26.75,
                                         27.};
  const std::array<int, 4> in_shape = {{3, 5, 5, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         10.222222222222221,
                                         10.666666666666668,
                                         11.11111111111111,
                                         11.555555555555555,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.333333333333332,
                                         17.77777777777778,
                                         18.22222222222222,
                                         18.666666666666664,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333};
  const std::array<int, 4> in_shape = {{3, 5, 5, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.16666666666666666, 0.16666666666666666, 0.5,
      0.3333333333333333,  1.0833333333333333,  0.75,
      0.611111111111111,   0.611111111111111,   1.5,
      0.8888888888888888,  2.638888888888889,   1.75,
      0.4444444444444444,  0.4444444444444444,  1.,
      0.5555555555555556,  1.5555555555555556,  1.,
      1.611111111111111,   1.611111111111111,   3.5,
      1.8888888888888888,  5.138888888888889,   3.25,
      1.1666666666666665,  1.1666666666666665,  2.5,
      1.3333333333333333,  3.583333333333333,   2.25,
      1.6666666666666665,  1.6666666666666665,  3.5,
      1.8333333333333333,  4.833333333333333,   3.,
      3.1111111111111107,  3.1111111111111107,  6.5,
      3.3888888888888884,  8.88888888888889,    5.5,
      1.4444444444444444,  1.4444444444444444,  3.,
      1.5555555555555554,  4.055555555555555,   2.5,
      4.111111111111111,   4.111111111111111,   8.5,
      4.388888888888888,   11.38888888888889,   7.,
      2.6666666666666665,  2.6666666666666665,  5.5,
      2.833333333333333,   7.333333333333333,   4.5,
      3.1666666666666665,  3.1666666666666665,  6.5,
      3.333333333333333,   8.583333333333332,   5.25,
      5.611111111111111,   5.611111111111111,   11.5,
      5.888888888888888,   15.138888888888888,  9.25,
      2.444444444444444,   2.444444444444444,   5.,
      2.5555555555555554,  6.555555555555555,   4.,
      6.611111111111111,   6.611111111111111,   13.5,
      6.888888888888888,   17.63888888888889,   10.75,
      4.166666666666666,   4.166666666666666,   8.5,
      4.333333333333333,   11.083333333333332,  6.75};
  const std::array<int, 4> in_shape = {{3, 5, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         2.888888888888889,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         2.2222222222222223,
                                         2.2222222222222223,
                                         4.666666666666666,
                                         2.4444444444444446,
                                         2.4444444444444446,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 5, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.6666666666666666,
                                         1.,
                                         0.5,
                                         0.6666666666666666,
                                         1.75,
                                         2.1666666666666665,
                                         1.25,
                                         1.5,
                                         0.9444444444444443,
                                         1.222222222222222,
                                         0.9444444444444443,
                                         1.222222222222222,
                                         2.444444444444444,
                                         3.,
                                         1.5,
                                         1.7777777777777777,
                                         4.583333333333333,
                                         5.277777777777778,
                                         3.083333333333333,
                                         3.5,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         2.944444444444444,
                                         3.222222222222222,
                                         2.944444444444444,
                                         3.222222222222222,
                                         6.444444444444445,
                                         7.,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         4.666666666666666,
                                         5.,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.,
                                         5.944444444444445,
                                         6.222222222222221,
                                         5.944444444444445,
                                         6.222222222222221,
                                         12.444444444444443,
                                         13.,
                                         6.5,
                                         6.777777777777777,
                                         17.083333333333332,
                                         17.77777777777778,
                                         10.583333333333332,
                                         11.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         7.944444444444444,
                                         8.222222222222221,
                                         7.944444444444444,
                                         8.222222222222221,
                                         16.444444444444443,
                                         17.,
                                         8.5,
                                         8.777777777777777,
                                         22.083333333333332,
                                         22.77777777777778,
                                         13.583333333333332,
                                         14.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         5.166666666666666,
                                         5.333333333333333,
                                         10.666666666666666,
                                         11.,
                                         5.5,
                                         5.666666666666666,
                                         14.25,
                                         14.666666666666666,
                                         8.75,
                                         9.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.166666666666666,
                                         6.333333333333333,
                                         12.666666666666666,
                                         13.,
                                         6.5,
                                         6.666666666666666,
                                         16.75,
                                         17.166666666666664,
                                         10.25,
                                         10.5,
                                         10.944444444444443,
                                         11.222222222222221,
                                         10.944444444444443,
                                         11.222222222222221,
                                         22.444444444444443,
                                         23.,
                                         11.5,
                                         11.777777777777777,
                                         29.583333333333332,
                                         30.277777777777775,
                                         18.083333333333332,
                                         18.5,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.777777777777779,
                                         10.,
                                         5.,
                                         5.111111111111111,
                                         12.833333333333332,
                                         13.11111111111111,
                                         7.833333333333333,
                                         8.,
                                         12.944444444444443,
                                         13.222222222222221,
                                         12.944444444444443,
                                         13.222222222222221,
                                         26.444444444444443,
                                         27.,
                                         13.5,
                                         13.777777777777777,
                                         34.58333333333333,
                                         35.27777777777778,
                                         21.083333333333332,
                                         21.5,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.166666666666666,
                                         8.333333333333332,
                                         16.666666666666664,
                                         17.,
                                         8.5,
                                         8.666666666666666,
                                         21.75,
                                         22.166666666666664,
                                         13.25,
                                         13.5};
  const std::array<int, 4> in_shape = {{3, 5, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         5.333333333333334,
                                         5.777777777777778,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.222222222222221,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.333333333333332,
                                         4.666666666666666,
                                         4.888888888888889,
                                         4.666666666666666,
                                         4.888888888888889,
                                         0.,
                                         0.,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 5, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.9999999999999999,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.,
                                         0.8333333333333333,
                                         1.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         3.083333333333333,
                                         3.5,
                                         3.9166666666666665,
                                         4.333333333333333,
                                         2.25,
                                         2.5,
                                         2.75,
                                         3.,
                                         1.6111111111111112,
                                         1.8888888888888886,
                                         2.1666666666666665,
                                         2.444444444444444,
                                         1.6111111111111112,
                                         1.8888888888888886,
                                         2.1666666666666665,
                                         2.444444444444444,
                                         4.333333333333333,
                                         4.888888888888888,
                                         5.444444444444445,
                                         6.,
                                         2.7222222222222223,
                                         3.,
                                         3.2777777777777777,
                                         3.5555555555555554,
                                         8.472222222222221,
                                         9.166666666666666,
                                         9.86111111111111,
                                         10.555555555555555,
                                         5.75,
                                         6.166666666666666,
                                         6.583333333333333,
                                         7.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         12.333333333333332,
                                         12.88888888888889,
                                         13.444444444444445,
                                         14.,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.,
                                         11.61111111111111,
                                         11.88888888888889,
                                         12.166666666666666,
                                         12.444444444444443,
                                         11.61111111111111,
                                         11.88888888888889,
                                         12.166666666666666,
                                         12.444444444444443,
                                         24.333333333333332,
                                         24.888888888888886,
                                         25.444444444444443,
                                         26.,
                                         12.722222222222221,
                                         13.,
                                         13.277777777777777,
                                         13.555555555555554,
                                         33.47222222222222,
                                         34.166666666666664,
                                         34.86111111111111,
                                         35.55555555555556,
                                         20.75,
                                         21.166666666666664,
                                         21.583333333333332,
                                         22.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         15.61111111111111,
                                         15.888888888888888,
                                         16.166666666666664,
                                         16.444444444444443,
                                         15.61111111111111,
                                         15.888888888888888,
                                         16.166666666666664,
                                         16.444444444444443,
                                         32.33333333333333,
                                         32.888888888888886,
                                         33.44444444444444,
                                         34.,
                                         16.72222222222222,
                                         17.,
                                         17.27777777777778,
                                         17.555555555555554,
                                         43.47222222222222,
                                         44.166666666666664,
                                         44.86111111111111,
                                         45.55555555555556,
                                         26.75,
                                         27.166666666666664,
                                         27.583333333333332,
                                         28.,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         21.,
                                         21.333333333333332,
                                         21.666666666666664,
                                         22.,
                                         10.833333333333332,
                                         11.,
                                         11.166666666666666,
                                         11.333333333333332,
                                         28.083333333333332,
                                         28.5,
                                         28.916666666666664,
                                         29.333333333333332,
                                         17.25,
                                         17.5,
                                         17.75,
                                         18.,
                                         12.166666666666666,
                                         12.333333333333332,
                                         12.5,
                                         12.666666666666666,
                                         12.166666666666666,
                                         12.333333333333332,
                                         12.5,
                                         12.666666666666666,
                                         25.,
                                         25.333333333333332,
                                         25.666666666666664,
                                         26.,
                                         12.833333333333332,
                                         13.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         33.08333333333333,
                                         33.5,
                                         33.916666666666664,
                                         34.33333333333333,
                                         20.25,
                                         20.5,
                                         20.75,
                                         21.,
                                         21.61111111111111,
                                         21.888888888888886,
                                         22.166666666666664,
                                         22.444444444444443,
                                         21.61111111111111,
                                         21.888888888888886,
                                         22.166666666666664,
                                         22.444444444444443,
                                         44.33333333333333,
                                         44.888888888888886,
                                         45.44444444444444,
                                         46.,
                                         22.72222222222222,
                                         23.,
                                         23.27777777777778,
                                         23.555555555555554,
                                         58.472222222222214,
                                         59.166666666666664,
                                         59.8611111111111,
                                         60.55555555555555,
                                         35.75,
                                         36.166666666666664,
                                         36.58333333333333,
                                         37.,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         19.333333333333332,
                                         19.555555555555557,
                                         19.77777777777778,
                                         20.,
                                         9.888888888888888,
                                         10.,
                                         10.11111111111111,
                                         10.222222222222221,
                                         25.388888888888886,
                                         25.666666666666664,
                                         25.944444444444443,
                                         26.22222222222222,
                                         15.5,
                                         15.666666666666666,
                                         15.833333333333332,
                                         16.,
                                         25.611111111111107,
                                         25.888888888888886,
                                         26.166666666666664,
                                         26.444444444444443,
                                         25.611111111111107,
                                         25.888888888888886,
                                         26.166666666666664,
                                         26.444444444444443,
                                         52.33333333333333,
                                         52.888888888888886,
                                         53.44444444444444,
                                         54.,
                                         26.72222222222222,
                                         27.,
                                         27.277777777777775,
                                         27.555555555555554,
                                         68.47222222222221,
                                         69.16666666666666,
                                         69.86111111111111,
                                         70.55555555555556,
                                         41.75,
                                         42.166666666666664,
                                         42.58333333333333,
                                         43.,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         33.,
                                         33.33333333333333,
                                         33.666666666666664,
                                         34.,
                                         16.833333333333332,
                                         17.,
                                         17.166666666666664,
                                         17.333333333333332,
                                         43.08333333333333,
                                         43.5,
                                         43.916666666666664,
                                         44.33333333333333,
                                         26.25,
                                         26.5,
                                         26.75,
                                         27.};
  const std::array<int, 4> in_shape = {{3, 5, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         10.222222222222221,
                                         10.666666666666668,
                                         11.11111111111111,
                                         11.555555555555555,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.333333333333332,
                                         17.77777777777778,
                                         18.22222222222222,
                                         18.666666666666664,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 5, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.16666666666666666,
                                         0.5,
                                         0.3333333333333333,
                                         0.8333333333333333,
                                         0.5,
                                         1.5,
                                         1.,
                                         0.7222222222222222,
                                         0.7222222222222222,
                                         1.7222222222222223,
                                         1.,
                                         2.2777777777777777,
                                         1.2777777777777777,
                                         3.6111111111111107,
                                         2.333333333333333,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         1.4444444444444442,
                                         0.7777777777777777,
                                         2.1111111111111107,
                                         1.3333333333333333,
                                         2.0555555555555554,
                                         2.0555555555555554,
                                         4.388888888888889,
                                         2.333333333333333,
                                         4.944444444444444,
                                         2.6111111111111107,
                                         6.944444444444444,
                                         4.333333333333333,
                                         1.5,
                                         1.5,
                                         3.1666666666666665,
                                         1.6666666666666665,
                                         3.5,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.,
                                         2.1666666666666665,
                                         2.1666666666666665,
                                         4.5,
                                         2.333333333333333,
                                         4.833333333333333,
                                         2.5,
                                         6.5,
                                         4.,
                                         4.055555555555555,
                                         4.055555555555555,
                                         8.38888888888889,
                                         4.333333333333333,
                                         8.944444444444445,
                                         4.611111111111111,
                                         11.944444444444443,
                                         7.333333333333333,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         4.111111111111111,
                                         2.111111111111111,
                                         5.444444444444445,
                                         3.333333333333333,
                                         5.388888888888889,
                                         5.388888888888889,
                                         11.055555555555555,
                                         5.666666666666666,
                                         11.61111111111111,
                                         5.944444444444445,
                                         15.277777777777779,
                                         9.333333333333332,
                                         3.5,
                                         3.5,
                                         7.166666666666666,
                                         3.6666666666666665,
                                         7.5,
                                         3.833333333333333,
                                         9.833333333333332,
                                         6.,
                                         4.166666666666666,
                                         4.166666666666666,
                                         8.5,
                                         4.333333333333333,
                                         8.833333333333332,
                                         4.5,
                                         11.5,
                                         7.,
                                         7.3888888888888875,
                                         7.3888888888888875,
                                         15.055555555555554,
                                         7.666666666666666,
                                         15.611111111111109,
                                         7.944444444444445,
                                         20.27777777777778,
                                         12.333333333333332,
                                         3.222222222222222,
                                         3.222222222222222,
                                         6.555555555555555,
                                         3.333333333333333,
                                         6.777777777777777,
                                         3.444444444444444,
                                         8.777777777777777,
                                         5.333333333333333,
                                         8.722222222222221,
                                         8.722222222222221,
                                         17.72222222222222,
                                         9.,
                                         18.277777777777775,
                                         9.277777777777777,
                                         23.61111111111111,
                                         14.333333333333332,
                                         5.5,
                                         5.5,
                                         11.166666666666666,
                                         5.666666666666666,
                                         11.5,
                                         5.833333333333333,
                                         14.833333333333332,
                                         9.};
  const std::array<int, 4> in_shape = {{3, 5, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.3333333333333333,
                                         0.7777777777777778,
                                         1.7777777777777777,
                                         1.,
                                         1.,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         4.,
                                         2.1111111111111107,
                                         4.444444444444444,
                                         2.333333333333333,
                                         2.333333333333333,
                                         0.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         3.2222222222222223,
                                         3.2222222222222223,
                                         6.666666666666666,
                                         3.444444444444444,
                                         7.111111111111111,
                                         3.6666666666666665,
                                         3.6666666666666665,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.6666666666666665,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.6666666666666665,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 5, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.6666666666666666,
                                         1.,
                                         0.5,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         0.8333333333333333,
                                         1.,
                                         2.583333333333333,
                                         3.,
                                         1.75,
                                         2.,
                                         1.1666666666666667,
                                         1.4444444444444444,
                                         1.1666666666666667,
                                         1.4444444444444444,
                                         2.8888888888888884,
                                         3.4444444444444446,
                                         1.722222222222222,
                                         2.,
                                         4.,
                                         4.555555555555555,
                                         2.2777777777777777,
                                         2.5555555555555554,
                                         6.527777777777778,
                                         7.222222222222221,
                                         4.25,
                                         4.666666666666666,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.9444444444444446,
                                         4.222222222222221,
                                         2.5,
                                         2.6666666666666665,
                                         3.833333333333333,
                                         4.111111111111111,
                                         3.833333333333333,
                                         4.111111111111111,
                                         8.222222222222221,
                                         8.777777777777779,
                                         4.388888888888888,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.888888888888888,
                                         4.944444444444445,
                                         5.222222222222221,
                                         13.194444444444445,
                                         13.888888888888888,
                                         8.25,
                                         8.666666666666666,
                                         2.833333333333333,
                                         3.,
                                         2.833333333333333,
                                         3.,
                                         6.,
                                         6.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.166666666666666,
                                         4.333333333333333,
                                         8.666666666666666,
                                         9.,
                                         4.5,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.666666666666666,
                                         4.833333333333333,
                                         5.,
                                         12.583333333333332,
                                         13.,
                                         7.75,
                                         8.,
                                         7.833333333333332,
                                         8.11111111111111,
                                         7.833333333333332,
                                         8.11111111111111,
                                         16.22222222222222,
                                         16.77777777777778,
                                         8.38888888888889,
                                         8.666666666666666,
                                         17.333333333333332,
                                         17.88888888888889,
                                         8.944444444444443,
                                         9.222222222222221,
                                         23.194444444444443,
                                         23.888888888888886,
                                         14.25,
                                         14.666666666666666,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         8.,
                                         8.222222222222221,
                                         4.111111111111111,
                                         4.222222222222222,
                                         10.61111111111111,
                                         10.88888888888889,
                                         6.5,
                                         6.666666666666666,
                                         10.5,
                                         10.777777777777779,
                                         10.5,
                                         10.777777777777779,
                                         21.555555555555557,
                                         22.11111111111111,
                                         11.055555555555555,
                                         11.333333333333332,
                                         22.666666666666664,
                                         23.22222222222222,
                                         11.61111111111111,
                                         11.88888888888889,
                                         29.86111111111111,
                                         30.555555555555557,
                                         18.25,
                                         18.666666666666664,
                                         6.833333333333333,
                                         7.,
                                         6.833333333333333,
                                         7.,
                                         14.,
                                         14.333333333333332,
                                         7.166666666666666,
                                         7.333333333333333,
                                         14.666666666666666,
                                         15.,
                                         7.5,
                                         7.666666666666666,
                                         19.25,
                                         19.666666666666664,
                                         11.75,
                                         12.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.166666666666666,
                                         8.333333333333332,
                                         16.666666666666664,
                                         17.,
                                         8.5,
                                         8.666666666666666,
                                         17.333333333333332,
                                         17.666666666666664,
                                         8.833333333333332,
                                         9.,
                                         22.583333333333332,
                                         23.,
                                         13.75,
                                         14.,
                                         14.5,
                                         14.777777777777775,
                                         14.5,
                                         14.777777777777775,
                                         29.55555555555555,
                                         30.111111111111107,
                                         15.055555555555555,
                                         15.333333333333332,
                                         30.666666666666664,
                                         31.222222222222218,
                                         15.61111111111111,
                                         15.88888888888889,
                                         39.861111111111114,
                                         40.55555555555556,
                                         24.25,
                                         24.666666666666664,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.333333333333333,
                                         6.444444444444444,
                                         12.88888888888889,
                                         13.11111111111111,
                                         6.555555555555555,
                                         6.666666666666666,
                                         13.333333333333332,
                                         13.555555555555554,
                                         6.777777777777778,
                                         6.888888888888888,
                                         17.27777777777778,
                                         17.555555555555554,
                                         10.5,
                                         10.666666666666666,
                                         17.166666666666664,
                                         17.444444444444443,
                                         17.166666666666664,
                                         17.444444444444443,
                                         34.888888888888886,
                                         35.44444444444444,
                                         17.72222222222222,
                                         18.,
                                         36.,
                                         36.55555555555555,
                                         18.27777777777778,
                                         18.555555555555554,
                                         46.52777777777778,
                                         47.22222222222222,
                                         28.25,
                                         28.666666666666664,
                                         10.833333333333332,
                                         11.,
                                         10.833333333333332,
                                         11.,
                                         22.,
                                         22.333333333333332,
                                         11.166666666666666,
                                         11.333333333333332,
                                         22.666666666666664,
                                         23.,
                                         11.5,
                                         11.666666666666666,
                                         29.25,
                                         29.666666666666664,
                                         17.75,
                                         18.};
  const std::array<int, 4> in_shape = {{3, 5, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         3.1111111111111107,
                                         3.5555555555555554,
                                         1.7777777777777777,
                                         2.,
                                         1.7777777777777777,
                                         2.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         7.5555555555555545,
                                         8.,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         8.444444444444443,
                                         8.888888888888888,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.444444444444445,
                                         4.666666666666666,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.222222222222221,
                                         6.444444444444445,
                                         12.888888888888888,
                                         13.333333333333332,
                                         6.666666666666666,
                                         6.888888888888888,
                                         13.777777777777777,
                                         14.222222222222221,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.111111111111111,
                                         7.333333333333333,
                                         0.,
                                         0.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 5, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x5x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.9999999999999999,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.,
                                         0.8333333333333333,
                                         1.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.333333333333333,
                                         2.6666666666666665,
                                         3.,
                                         3.333333333333333,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         4.75,
                                         5.166666666666666,
                                         5.583333333333333,
                                         6.,
                                         3.25,
                                         3.5,
                                         3.75,
                                         4.,
                                         2.0555555555555554,
                                         2.3333333333333335,
                                         2.611111111111111,
                                         2.888888888888889,
                                         2.0555555555555554,
                                         2.3333333333333335,
                                         2.611111111111111,
                                         2.888888888888889,
                                         5.222222222222221,
                                         5.777777777777777,
                                         6.333333333333333,
                                         6.888888888888889,
                                         3.166666666666666,
                                         3.444444444444444,
                                         3.722222222222222,
                                         4.,
                                         7.444444444444444,
                                         8.,
                                         8.555555555555555,
                                         9.11111111111111,
                                         4.277777777777778,
                                         4.555555555555555,
                                         4.833333333333333,
                                         5.111111111111111,
                                         12.36111111111111,
                                         13.055555555555555,
                                         13.749999999999998,
                                         14.444444444444443,
                                         8.083333333333332,
                                         8.5,
                                         8.916666666666666,
                                         9.333333333333332,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777777,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         7.611111111111111,
                                         7.888888888888889,
                                         8.166666666666666,
                                         8.444444444444443,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         15.888888888888888,
                                         16.444444444444443,
                                         17.,
                                         17.555555555555557,
                                         8.5,
                                         8.777777777777777,
                                         9.055555555555555,
                                         9.333333333333332,
                                         18.11111111111111,
                                         18.666666666666664,
                                         19.22222222222222,
                                         19.777777777777775,
                                         9.61111111111111,
                                         9.88888888888889,
                                         10.166666666666666,
                                         10.444444444444443,
                                         25.694444444444443,
                                         26.38888888888889,
                                         27.083333333333332,
                                         27.777777777777775,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         11.666666666666666,
                                         12.,
                                         12.333333333333332,
                                         12.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         17.,
                                         17.333333333333332,
                                         17.666666666666664,
                                         18.,
                                         8.833333333333332,
                                         9.,
                                         9.166666666666666,
                                         9.333333333333332,
                                         18.333333333333332,
                                         18.666666666666664,
                                         19.,
                                         19.333333333333332,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         24.75,
                                         25.166666666666664,
                                         25.583333333333332,
                                         26.,
                                         15.25,
                                         15.5,
                                         15.75,
                                         16.,
                                         15.388888888888888,
                                         15.666666666666664,
                                         15.944444444444443,
                                         16.22222222222222,
                                         15.388888888888888,
                                         15.666666666666664,
                                         15.944444444444443,
                                         16.22222222222222,
                                         31.888888888888886,
                                         32.44444444444444,
                                         32.99999999999999,
                                         33.55555555555556,
                                         16.5,
                                         16.77777777777778,
                                         17.055555555555554,
                                         17.333333333333332,
                                         34.111111111111114,
                                         34.666666666666664,
                                         35.22222222222222,
                                         35.77777777777778,
                                         17.61111111111111,
                                         17.888888888888886,
                                         18.166666666666664,
                                         18.444444444444443,
                                         45.69444444444444,
                                         46.388888888888886,
                                         47.08333333333333,
                                         47.77777777777777,
                                         28.083333333333332,
                                         28.5,
                                         28.916666666666664,
                                         29.333333333333332,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         15.777777777777777,
                                         16.,
                                         16.22222222222222,
                                         16.444444444444443,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         20.944444444444443,
                                         21.22222222222222,
                                         21.5,
                                         21.77777777777778,
                                         12.833333333333332,
                                         13.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         20.72222222222222,
                                         21.,
                                         21.277777777777775,
                                         21.555555555555557,
                                         20.72222222222222,
                                         21.,
                                         21.277777777777775,
                                         21.555555555555557,
                                         42.55555555555555,
                                         43.111111111111114,
                                         43.666666666666664,
                                         44.22222222222222,
                                         21.833333333333332,
                                         22.11111111111111,
                                         22.38888888888889,
                                         22.666666666666664,
                                         44.77777777777777,
                                         45.33333333333333,
                                         45.888888888888886,
                                         46.44444444444444,
                                         22.944444444444443,
                                         23.22222222222222,
                                         23.5,
                                         23.77777777777778,
                                         59.02777777777777,
                                         59.72222222222222,
                                         60.416666666666664,
                                         61.111111111111114,
                                         36.08333333333333,
                                         36.5,
                                         36.916666666666664,
                                         37.33333333333333,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         27.666666666666664,
                                         28.,
                                         28.333333333333332,
                                         28.666666666666664,
                                         14.166666666666666,
                                         14.333333333333332,
                                         14.5,
                                         14.666666666666666,
                                         29.,
                                         29.333333333333332,
                                         29.666666666666664,
                                         30.,
                                         14.833333333333332,
                                         15.,
                                         15.166666666666666,
                                         15.333333333333332,
                                         38.08333333333333,
                                         38.5,
                                         38.916666666666664,
                                         39.33333333333333,
                                         23.25,
                                         23.5,
                                         23.75,
                                         24.,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         33.,
                                         33.33333333333333,
                                         33.666666666666664,
                                         34.,
                                         16.833333333333332,
                                         17.,
                                         17.166666666666664,
                                         17.333333333333332,
                                         34.33333333333333,
                                         34.666666666666664,
                                         35.,
                                         35.33333333333333,
                                         17.5,
                                         17.666666666666664,
                                         17.833333333333332,
                                         18.,
                                         44.75,
                                         45.166666666666664,
                                         45.58333333333333,
                                         46.,
                                         27.25,
                                         27.5,
                                         27.75,
                                         28.,
                                         28.72222222222222,
                                         29.,
                                         29.27777777777778,
                                         29.55555555555555,
                                         28.72222222222222,
                                         29.,
                                         29.27777777777778,
                                         29.55555555555555,
                                         58.55555555555556,
                                         59.1111111111111,
                                         59.666666666666664,
                                         60.222222222222214,
                                         29.833333333333332,
                                         30.11111111111111,
                                         30.388888888888886,
                                         30.666666666666664,
                                         60.77777777777777,
                                         61.33333333333333,
                                         61.888888888888886,
                                         62.444444444444436,
                                         30.944444444444443,
                                         31.22222222222222,
                                         31.5,
                                         31.77777777777778,
                                         79.02777777777777,
                                         79.72222222222223,
                                         80.41666666666666,
                                         81.11111111111111,
                                         48.08333333333333,
                                         48.5,
                                         48.916666666666664,
                                         49.33333333333333,
                                         12.555555555555555,
                                         12.666666666666666,
                                         12.777777777777777,
                                         12.888888888888888,
                                         12.555555555555555,
                                         12.666666666666666,
                                         12.777777777777777,
                                         12.888888888888888,
                                         25.555555555555557,
                                         25.77777777777778,
                                         26.,
                                         26.22222222222222,
                                         13.,
                                         13.11111111111111,
                                         13.222222222222221,
                                         13.333333333333332,
                                         26.444444444444443,
                                         26.666666666666664,
                                         26.888888888888886,
                                         27.111111111111107,
                                         13.444444444444443,
                                         13.555555555555555,
                                         13.666666666666666,
                                         13.777777777777777,
                                         34.27777777777777,
                                         34.55555555555556,
                                         34.83333333333333,
                                         35.11111111111111,
                                         20.833333333333332,
                                         21.,
                                         21.166666666666664,
                                         21.333333333333332,
                                         34.05555555555556,
                                         34.33333333333333,
                                         34.61111111111111,
                                         34.888888888888886,
                                         34.05555555555556,
                                         34.33333333333333,
                                         34.61111111111111,
                                         34.888888888888886,
                                         69.22222222222223,
                                         69.77777777777777,
                                         70.33333333333333,
                                         70.88888888888889,
                                         35.166666666666664,
                                         35.44444444444444,
                                         35.72222222222222,
                                         36.,
                                         71.44444444444444,
                                         72.,
                                         72.55555555555554,
                                         73.1111111111111,
                                         36.27777777777777,
                                         36.55555555555556,
                                         36.83333333333333,
                                         37.11111111111111,
                                         92.3611111111111,
                                         93.05555555555556,
                                         93.75,
                                         94.44444444444444,
                                         56.08333333333333,
                                         56.5,
                                         56.916666666666664,
                                         57.33333333333333,
                                         21.5,
                                         21.666666666666664,
                                         21.833333333333332,
                                         22.,
                                         21.5,
                                         21.666666666666664,
                                         21.833333333333332,
                                         22.,
                                         43.666666666666664,
                                         44.,
                                         44.33333333333333,
                                         44.666666666666664,
                                         22.166666666666664,
                                         22.333333333333332,
                                         22.5,
                                         22.666666666666664,
                                         45.,
                                         45.33333333333333,
                                         45.666666666666664,
                                         46.,
                                         22.833333333333332,
                                         23.,
                                         23.166666666666664,
                                         23.333333333333332,
                                         58.08333333333333,
                                         58.5,
                                         58.916666666666664,
                                         59.33333333333333,
                                         35.25,
                                         35.5,
                                         35.75,
                                         36.};
  const std::array<int, 4> in_shape = {{3, 5, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x5x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         5.777777777777778,
                                         6.222222222222221,
                                         6.666666666666666,
                                         7.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         14.666666666666666,
                                         15.111111111111109,
                                         15.555555555555557,
                                         16.,
                                         7.777777777777777,
                                         7.999999999999999,
                                         8.222222222222221,
                                         8.444444444444443,
                                         16.444444444444443,
                                         16.888888888888886,
                                         17.333333333333332,
                                         17.777777777777775,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         25.333333333333332,
                                         25.777777777777775,
                                         26.22222222222222,
                                         26.666666666666664,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555554,
                                         13.777777777777777,
                                         27.111111111111107,
                                         27.555555555555554,
                                         28.,
                                         28.444444444444443,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 5, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.8333333333333333,
                                         1.611111111111111,
                                         0.7777777777777778,
                                         2.2777777777777777,
                                         1.5,
                                         0.6666666666666666,
                                         1.2222222222222223,
                                         0.5555555555555556,
                                         1.5555555555555556,
                                         1.,
                                         2.4166666666666665,
                                         4.305555555555555,
                                         1.8888888888888888,
                                         5.138888888888889,
                                         3.25,
                                         1.75,
                                         3.083333333333333,
                                         1.3333333333333333,
                                         3.583333333333333,
                                         2.25,
                                         1.6666666666666665,
                                         2.8888888888888884,
                                         1.222222222222222,
                                         3.2222222222222223,
                                         2.,
                                         1.6666666666666665,
                                         2.8888888888888884,
                                         1.222222222222222,
                                         3.2222222222222223,
                                         2.,
                                         3.833333333333333,
                                         6.611111111111111,
                                         2.7777777777777777,
                                         7.277777777777778,
                                         4.5,
                                         2.1666666666666665,
                                         3.722222222222222,
                                         1.5555555555555554,
                                         4.055555555555555,
                                         2.5,
                                         6.166666666666666,
                                         10.555555555555554,
                                         4.388888888888888,
                                         11.38888888888889,
                                         7.,
                                         4.,
                                         6.833333333333333,
                                         2.833333333333333,
                                         7.333333333333333,
                                         4.5,
                                         3.1666666666666665,
                                         5.388888888888889,
                                         2.2222222222222223,
                                         5.722222222222222,
                                         3.5,
                                         3.1666666666666665,
                                         5.388888888888889,
                                         2.2222222222222223,
                                         5.722222222222222,
                                         3.5,
                                         6.833333333333333,
                                         11.61111111111111,
                                         4.777777777777778,
                                         12.277777777777779,
                                         7.5,
                                         3.6666666666666665,
                                         6.222222222222221,
                                         2.5555555555555554,
                                         6.555555555555555,
                                         4.,
                                         9.916666666666666,
                                         16.805555555555554,
                                         6.888888888888888,
                                         17.63888888888889,
                                         10.75,
                                         6.25,
                                         10.583333333333332,
                                         4.333333333333333,
                                         11.083333333333332,
                                         6.75};
  const std::array<int, 4> in_shape = {{3, 6, 5, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         2.888888888888889,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.2222222222222223,
                                         4.666666666666666,
                                         2.4444444444444446,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 5, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.6666666666666665,
                                         3.222222222222222,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.1666666666666665,
                                         2.4444444444444446,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         4.416666666666666,
                                         4.833333333333333,
                                         7.916666666666666,
                                         8.61111111111111,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         3.25,
                                         3.5,
                                         5.75,
                                         6.166666666666666,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         5.5,
                                         5.777777777777777,
                                         2.333333333333333,
                                         2.444444444444444,
                                         6.166666666666666,
                                         6.444444444444445,
                                         3.833333333333333,
                                         4.,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         5.5,
                                         5.777777777777777,
                                         2.333333333333333,
                                         2.444444444444444,
                                         6.166666666666666,
                                         6.444444444444445,
                                         3.833333333333333,
                                         4.,
                                         7.333333333333332,
                                         7.666666666666666,
                                         12.666666666666666,
                                         13.222222222222221,
                                         5.333333333333333,
                                         5.555555555555555,
                                         14.,
                                         14.555555555555555,
                                         8.666666666666666,
                                         9.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         7.166666666666666,
                                         7.444444444444444,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         11.916666666666666,
                                         12.333333333333332,
                                         20.416666666666664,
                                         21.111111111111107,
                                         8.5,
                                         8.777777777777777,
                                         22.083333333333332,
                                         22.77777777777778,
                                         13.583333333333332,
                                         14.,
                                         7.75,
                                         8.,
                                         13.25,
                                         13.666666666666666,
                                         5.5,
                                         5.666666666666666,
                                         14.25,
                                         14.666666666666666,
                                         8.75,
                                         9.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         10.5,
                                         10.777777777777779,
                                         4.333333333333333,
                                         4.444444444444445,
                                         11.166666666666666,
                                         11.444444444444445,
                                         6.833333333333333,
                                         7.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         10.5,
                                         10.777777777777779,
                                         4.333333333333333,
                                         4.444444444444445,
                                         11.166666666666666,
                                         11.444444444444445,
                                         6.833333333333333,
                                         7.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         22.666666666666664,
                                         23.22222222222222,
                                         9.333333333333332,
                                         9.555555555555555,
                                         23.999999999999996,
                                         24.555555555555557,
                                         14.666666666666666,
                                         15.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         12.166666666666666,
                                         12.444444444444443,
                                         5.,
                                         5.111111111111111,
                                         12.833333333333332,
                                         13.11111111111111,
                                         7.833333333333333,
                                         8.,
                                         19.416666666666664,
                                         19.833333333333332,
                                         32.916666666666664,
                                         33.61111111111111,
                                         13.5,
                                         13.777777777777777,
                                         34.58333333333333,
                                         35.27777777777778,
                                         21.083333333333332,
                                         21.5,
                                         12.25,
                                         12.5,
                                         20.75,
                                         21.166666666666664,
                                         8.5,
                                         8.666666666666666,
                                         21.75,
                                         22.166666666666664,
                                         13.25,
                                         13.5};
  const std::array<int, 4> in_shape = {{3, 6, 5, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         5.333333333333334,
                                         5.777777777777778,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.222222222222221,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.333333333333332,
                                         4.666666666666666,
                                         4.888888888888889,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 5, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         2.333333333333333,
                                         2.6666666666666665,
                                         3.,
                                         3.333333333333333,
                                         4.777777777777778,
                                         5.333333333333333,
                                         5.888888888888889,
                                         6.444444444444444,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         4.055555555555555,
                                         4.333333333333333,
                                         4.611111111111111,
                                         4.888888888888889,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         8.416666666666666,
                                         8.833333333333332,
                                         9.25,
                                         9.666666666666666,
                                         15.13888888888889,
                                         15.833333333333332,
                                         16.52777777777778,
                                         17.22222222222222,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         6.25,
                                         6.5,
                                         6.75,
                                         7.,
                                         11.083333333333332,
                                         11.5,
                                         11.916666666666666,
                                         12.333333333333332,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         10.722222222222221,
                                         11.,
                                         11.277777777777779,
                                         11.555555555555554,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         12.055555555555555,
                                         12.333333333333332,
                                         12.61111111111111,
                                         12.88888888888889,
                                         7.5,
                                         7.666666666666666,
                                         7.833333333333333,
                                         8.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         10.722222222222221,
                                         11.,
                                         11.277777777777779,
                                         11.555555555555554,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         12.055555555555555,
                                         12.333333333333332,
                                         12.61111111111111,
                                         12.88888888888889,
                                         7.5,
                                         7.666666666666666,
                                         7.833333333333333,
                                         8.,
                                         14.333333333333332,
                                         14.666666666666664,
                                         15.,
                                         15.333333333333332,
                                         24.777777777777775,
                                         25.333333333333332,
                                         25.88888888888889,
                                         26.444444444444443,
                                         10.444444444444443,
                                         10.666666666666666,
                                         10.88888888888889,
                                         11.11111111111111,
                                         27.444444444444443,
                                         28.,
                                         28.555555555555554,
                                         29.11111111111111,
                                         17.,
                                         17.333333333333332,
                                         17.666666666666664,
                                         18.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         14.055555555555554,
                                         14.333333333333332,
                                         14.61111111111111,
                                         14.888888888888888,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         23.416666666666664,
                                         23.833333333333332,
                                         24.25,
                                         24.666666666666664,
                                         40.138888888888886,
                                         40.83333333333333,
                                         41.52777777777778,
                                         42.222222222222214,
                                         16.72222222222222,
                                         17.,
                                         17.27777777777778,
                                         17.555555555555554,
                                         43.47222222222222,
                                         44.166666666666664,
                                         44.86111111111111,
                                         45.55555555555556,
                                         26.75,
                                         27.166666666666664,
                                         27.583333333333332,
                                         28.,
                                         15.25,
                                         15.5,
                                         15.75,
                                         16.,
                                         26.083333333333332,
                                         26.5,
                                         26.916666666666664,
                                         27.333333333333332,
                                         10.833333333333332,
                                         11.,
                                         11.166666666666666,
                                         11.333333333333332,
                                         28.083333333333332,
                                         28.5,
                                         28.916666666666664,
                                         29.333333333333332,
                                         17.25,
                                         17.5,
                                         17.75,
                                         18.,
                                         12.166666666666666,
                                         12.333333333333332,
                                         12.5,
                                         12.666666666666666,
                                         20.72222222222222,
                                         21.,
                                         21.27777777777778,
                                         21.555555555555557,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         22.055555555555557,
                                         22.333333333333332,
                                         22.611111111111107,
                                         22.88888888888889,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         12.166666666666666,
                                         12.333333333333332,
                                         12.5,
                                         12.666666666666666,
                                         20.72222222222222,
                                         21.,
                                         21.27777777777778,
                                         21.555555555555557,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         22.055555555555557,
                                         22.333333333333332,
                                         22.611111111111107,
                                         22.88888888888889,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         26.333333333333332,
                                         26.666666666666664,
                                         27.,
                                         27.333333333333332,
                                         44.77777777777777,
                                         45.33333333333333,
                                         45.888888888888886,
                                         46.44444444444444,
                                         18.444444444444443,
                                         18.666666666666664,
                                         18.888888888888886,
                                         19.11111111111111,
                                         47.44444444444444,
                                         47.99999999999999,
                                         48.55555555555554,
                                         49.111111111111114,
                                         29.,
                                         29.333333333333332,
                                         29.666666666666664,
                                         30.,
                                         14.166666666666666,
                                         14.333333333333332,
                                         14.5,
                                         14.666666666666666,
                                         24.055555555555554,
                                         24.333333333333332,
                                         24.61111111111111,
                                         24.888888888888886,
                                         9.888888888888888,
                                         10.,
                                         10.11111111111111,
                                         10.222222222222221,
                                         25.388888888888886,
                                         25.666666666666664,
                                         25.944444444444443,
                                         26.22222222222222,
                                         15.5,
                                         15.666666666666666,
                                         15.833333333333332,
                                         16.,
                                         38.416666666666664,
                                         38.83333333333333,
                                         39.25,
                                         39.666666666666664,
                                         65.13888888888889,
                                         65.83333333333333,
                                         66.52777777777777,
                                         67.22222222222221,
                                         26.72222222222222,
                                         27.,
                                         27.277777777777775,
                                         27.555555555555554,
                                         68.47222222222221,
                                         69.16666666666666,
                                         69.86111111111111,
                                         70.55555555555556,
                                         41.75,
                                         42.166666666666664,
                                         42.58333333333333,
                                         43.,
                                         24.25,
                                         24.5,
                                         24.75,
                                         25.,
                                         41.08333333333333,
                                         41.5,
                                         41.916666666666664,
                                         42.33333333333333,
                                         16.833333333333332,
                                         17.,
                                         17.166666666666664,
                                         17.333333333333332,
                                         43.08333333333333,
                                         43.5,
                                         43.916666666666664,
                                         44.33333333333333,
                                         26.25,
                                         26.5,
                                         26.75,
                                         27.};
  const std::array<int, 4> in_shape = {{3, 6, 5, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         10.222222222222221,
                                         10.666666666666668,
                                         11.11111111111111,
                                         11.555555555555555,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.333333333333332,
                                         17.77777777777778,
                                         18.22222222222222,
                                         18.666666666666664,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 5, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.5555555555555556, 0.5555555555555556, 1.3333333333333333,
      0.7777777777777778, 2.2777777777777777, 1.5,
      0.4444444444444444, 0.4444444444444444, 1.,
      0.5555555555555556, 1.5555555555555556, 1.,
      1.611111111111111,  1.611111111111111,  3.5,
      1.8888888888888888, 5.138888888888889,  3.25,
      1.1666666666666665, 1.1666666666666665, 2.5,
      1.3333333333333333, 3.583333333333333,  2.25,
      1.1111111111111112, 1.1111111111111112, 2.333333333333333,
      1.222222222222222,  3.2222222222222223, 2.,
      1.1111111111111112, 1.1111111111111112, 2.333333333333333,
      1.222222222222222,  3.2222222222222223, 2.,
      2.5555555555555554, 2.5555555555555554, 5.333333333333333,
      2.7777777777777777, 7.277777777777778,  4.5,
      1.4444444444444444, 1.4444444444444444, 3.,
      1.5555555555555554, 4.055555555555555,  2.5,
      4.111111111111111,  4.111111111111111,  8.5,
      4.388888888888888,  11.38888888888889,  7.,
      2.6666666666666665, 2.6666666666666665, 5.5,
      2.833333333333333,  7.333333333333333,  4.5,
      2.111111111111111,  2.111111111111111,  4.333333333333334,
      2.2222222222222223, 5.722222222222222,  3.5,
      2.111111111111111,  2.111111111111111,  4.333333333333334,
      2.2222222222222223, 5.722222222222222,  3.5,
      4.555555555555555,  4.555555555555555,  9.333333333333334,
      4.777777777777778,  12.277777777777779, 7.5,
      2.444444444444444,  2.444444444444444,  5.,
      2.5555555555555554, 6.555555555555555,  4.,
      6.611111111111111,  6.611111111111111,  13.5,
      6.888888888888888,  17.63888888888889,  10.75,
      4.166666666666666,  4.166666666666666,  8.5,
      4.333333333333333,  11.083333333333332, 6.75};
  const std::array<int, 4> in_shape = {{3, 6, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         2.888888888888889,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         2.2222222222222223,
                                         2.2222222222222223,
                                         4.666666666666666,
                                         2.4444444444444446,
                                         2.4444444444444446,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         2.944444444444444,
                                         3.222222222222222,
                                         2.944444444444444,
                                         3.222222222222222,
                                         6.444444444444445,
                                         7.,
                                         3.5,
                                         3.7777777777777777,
                                         9.583333333333332,
                                         10.277777777777779,
                                         6.083333333333333,
                                         6.5,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         4.666666666666666,
                                         5.,
                                         2.5,
                                         2.6666666666666665,
                                         6.75,
                                         7.166666666666666,
                                         4.25,
                                         4.5,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         6.166666666666666,
                                         6.444444444444445,
                                         3.833333333333333,
                                         4.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         6.166666666666666,
                                         6.444444444444445,
                                         3.833333333333333,
                                         4.,
                                         4.888888888888889,
                                         5.111111111111111,
                                         4.888888888888889,
                                         5.111111111111111,
                                         10.222222222222221,
                                         10.666666666666666,
                                         5.333333333333333,
                                         5.555555555555555,
                                         14.,
                                         14.555555555555555,
                                         8.666666666666666,
                                         9.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         7.944444444444444,
                                         8.222222222222221,
                                         7.944444444444444,
                                         8.222222222222221,
                                         16.444444444444443,
                                         17.,
                                         8.5,
                                         8.777777777777777,
                                         22.083333333333332,
                                         22.77777777777778,
                                         13.583333333333332,
                                         14.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         5.166666666666666,
                                         5.333333333333333,
                                         10.666666666666666,
                                         11.,
                                         5.5,
                                         5.666666666666666,
                                         14.25,
                                         14.666666666666666,
                                         8.75,
                                         9.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.111111111111111,
                                         4.222222222222222,
                                         8.444444444444443,
                                         8.666666666666668,
                                         4.333333333333333,
                                         4.444444444444445,
                                         11.166666666666666,
                                         11.444444444444445,
                                         6.833333333333333,
                                         7.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.111111111111111,
                                         4.222222222222222,
                                         8.444444444444443,
                                         8.666666666666668,
                                         4.333333333333333,
                                         4.444444444444445,
                                         11.166666666666666,
                                         11.444444444444445,
                                         6.833333333333333,
                                         7.,
                                         8.88888888888889,
                                         9.11111111111111,
                                         8.88888888888889,
                                         9.11111111111111,
                                         18.22222222222222,
                                         18.666666666666668,
                                         9.333333333333332,
                                         9.555555555555555,
                                         23.999999999999996,
                                         24.555555555555557,
                                         14.666666666666666,
                                         15.,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.777777777777779,
                                         10.,
                                         5.,
                                         5.111111111111111,
                                         12.833333333333332,
                                         13.11111111111111,
                                         7.833333333333333,
                                         8.,
                                         12.944444444444443,
                                         13.222222222222221,
                                         12.944444444444443,
                                         13.222222222222221,
                                         26.444444444444443,
                                         27.,
                                         13.5,
                                         13.777777777777777,
                                         34.58333333333333,
                                         35.27777777777778,
                                         21.083333333333332,
                                         21.5,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.166666666666666,
                                         8.333333333333332,
                                         16.666666666666664,
                                         17.,
                                         8.5,
                                         8.666666666666666,
                                         21.75,
                                         22.166666666666664,
                                         13.25,
                                         13.5};
  const std::array<int, 4> in_shape = {{3, 6, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         5.333333333333334,
                                         5.777777777777778,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.222222222222221,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.333333333333332,
                                         4.666666666666666,
                                         4.888888888888889,
                                         4.666666666666666,
                                         4.888888888888889,
                                         0.,
                                         0.,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         5.611111111111111,
                                         5.888888888888888,
                                         6.166666666666666,
                                         6.444444444444444,
                                         12.333333333333332,
                                         12.88888888888889,
                                         13.444444444444445,
                                         14.,
                                         6.722222222222221,
                                         7.,
                                         7.277777777777777,
                                         7.555555555555555,
                                         18.47222222222222,
                                         19.166666666666664,
                                         19.86111111111111,
                                         20.555555555555557,
                                         11.75,
                                         12.166666666666666,
                                         12.583333333333332,
                                         13.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         13.083333333333332,
                                         13.5,
                                         13.916666666666666,
                                         14.333333333333332,
                                         8.25,
                                         8.5,
                                         8.75,
                                         9.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         12.055555555555555,
                                         12.333333333333332,
                                         12.61111111111111,
                                         12.88888888888889,
                                         7.5,
                                         7.666666666666666,
                                         7.833333333333333,
                                         8.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         12.055555555555555,
                                         12.333333333333332,
                                         12.61111111111111,
                                         12.88888888888889,
                                         7.5,
                                         7.666666666666666,
                                         7.833333333333333,
                                         8.,
                                         9.555555555555554,
                                         9.777777777777779,
                                         10.,
                                         10.222222222222221,
                                         9.555555555555554,
                                         9.777777777777779,
                                         10.,
                                         10.222222222222221,
                                         20.,
                                         20.444444444444443,
                                         20.888888888888886,
                                         21.333333333333332,
                                         10.444444444444443,
                                         10.666666666666666,
                                         10.88888888888889,
                                         11.11111111111111,
                                         27.444444444444443,
                                         28.,
                                         28.555555555555554,
                                         29.11111111111111,
                                         17.,
                                         17.333333333333332,
                                         17.666666666666664,
                                         18.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         15.61111111111111,
                                         15.888888888888888,
                                         16.166666666666664,
                                         16.444444444444443,
                                         15.61111111111111,
                                         15.888888888888888,
                                         16.166666666666664,
                                         16.444444444444443,
                                         32.33333333333333,
                                         32.888888888888886,
                                         33.44444444444444,
                                         34.,
                                         16.72222222222222,
                                         17.,
                                         17.27777777777778,
                                         17.555555555555554,
                                         43.47222222222222,
                                         44.166666666666664,
                                         44.86111111111111,
                                         45.55555555555556,
                                         26.75,
                                         27.166666666666664,
                                         27.583333333333332,
                                         28.,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         21.,
                                         21.333333333333332,
                                         21.666666666666664,
                                         22.,
                                         10.833333333333332,
                                         11.,
                                         11.166666666666666,
                                         11.333333333333332,
                                         28.083333333333332,
                                         28.5,
                                         28.916666666666664,
                                         29.333333333333332,
                                         17.25,
                                         17.5,
                                         17.75,
                                         18.,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         16.666666666666664,
                                         16.888888888888886,
                                         17.111111111111107,
                                         17.333333333333336,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         22.055555555555557,
                                         22.333333333333332,
                                         22.611111111111107,
                                         22.88888888888889,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         16.666666666666664,
                                         16.888888888888886,
                                         17.111111111111107,
                                         17.333333333333336,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         22.055555555555557,
                                         22.333333333333332,
                                         22.611111111111107,
                                         22.88888888888889,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         17.555555555555557,
                                         17.77777777777778,
                                         18.,
                                         18.22222222222222,
                                         17.555555555555557,
                                         17.77777777777778,
                                         18.,
                                         18.22222222222222,
                                         35.99999999999999,
                                         36.44444444444444,
                                         36.888888888888886,
                                         37.333333333333336,
                                         18.444444444444443,
                                         18.666666666666664,
                                         18.888888888888886,
                                         19.11111111111111,
                                         47.44444444444444,
                                         47.99999999999999,
                                         48.55555555555554,
                                         49.111111111111114,
                                         29.,
                                         29.333333333333332,
                                         29.666666666666664,
                                         30.,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         19.333333333333332,
                                         19.555555555555557,
                                         19.77777777777778,
                                         20.,
                                         9.888888888888888,
                                         10.,
                                         10.11111111111111,
                                         10.222222222222221,
                                         25.388888888888886,
                                         25.666666666666664,
                                         25.944444444444443,
                                         26.22222222222222,
                                         15.5,
                                         15.666666666666666,
                                         15.833333333333332,
                                         16.,
                                         25.611111111111107,
                                         25.888888888888886,
                                         26.166666666666664,
                                         26.444444444444443,
                                         25.611111111111107,
                                         25.888888888888886,
                                         26.166666666666664,
                                         26.444444444444443,
                                         52.33333333333333,
                                         52.888888888888886,
                                         53.44444444444444,
                                         54.,
                                         26.72222222222222,
                                         27.,
                                         27.277777777777775,
                                         27.555555555555554,
                                         68.47222222222221,
                                         69.16666666666666,
                                         69.86111111111111,
                                         70.55555555555556,
                                         41.75,
                                         42.166666666666664,
                                         42.58333333333333,
                                         43.,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         33.,
                                         33.33333333333333,
                                         33.666666666666664,
                                         34.,
                                         16.833333333333332,
                                         17.,
                                         17.166666666666664,
                                         17.333333333333332,
                                         43.08333333333333,
                                         43.5,
                                         43.916666666666664,
                                         44.33333333333333,
                                         26.25,
                                         26.5,
                                         26.75,
                                         27.};
  const std::array<int, 4> in_shape = {{3, 6, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         4.666666666666666,
                                         4.888888888888889,
                                         5.111111111111111,
                                         5.333333333333333,
                                         10.222222222222221,
                                         10.666666666666668,
                                         11.11111111111111,
                                         11.555555555555555,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         5.555555555555555,
                                         5.777777777777777,
                                         6.,
                                         6.222222222222221,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.333333333333332,
                                         17.77777777777778,
                                         18.22222222222222,
                                         18.666666666666664,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.6666666666666667,
                                         0.6666666666666667,
                                         1.5555555555555554,
                                         0.8888888888888888,
                                         2.,
                                         1.111111111111111,
                                         3.1111111111111107,
                                         2.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         1.4444444444444442,
                                         0.7777777777777777,
                                         2.1111111111111107,
                                         1.3333333333333333,
                                         2.0555555555555554,
                                         2.0555555555555554,
                                         4.388888888888889,
                                         2.333333333333333,
                                         4.944444444444444,
                                         2.6111111111111107,
                                         6.944444444444444,
                                         4.333333333333333,
                                         1.5,
                                         1.5,
                                         3.1666666666666665,
                                         1.6666666666666665,
                                         3.5,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         4.333333333333333,
                                         2.6666666666666665,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         4.333333333333333,
                                         2.6666666666666665,
                                         3.333333333333333,
                                         3.333333333333333,
                                         6.888888888888889,
                                         3.5555555555555554,
                                         7.333333333333332,
                                         3.7777777777777777,
                                         9.777777777777779,
                                         6.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         4.111111111111111,
                                         2.111111111111111,
                                         5.444444444444445,
                                         3.333333333333333,
                                         5.388888888888889,
                                         5.388888888888889,
                                         11.055555555555555,
                                         5.666666666666666,
                                         11.61111111111111,
                                         5.944444444444445,
                                         15.277777777777779,
                                         9.333333333333332,
                                         3.5,
                                         3.5,
                                         7.166666666666666,
                                         3.6666666666666665,
                                         7.5,
                                         3.833333333333333,
                                         9.833333333333332,
                                         6.,
                                         2.7777777777777777,
                                         2.7777777777777777,
                                         5.666666666666666,
                                         2.888888888888889,
                                         5.888888888888889,
                                         3.,
                                         7.666666666666666,
                                         4.666666666666666,
                                         2.7777777777777777,
                                         2.7777777777777777,
                                         5.666666666666666,
                                         2.888888888888889,
                                         5.888888888888889,
                                         3.,
                                         7.666666666666666,
                                         4.666666666666666,
                                         6.,
                                         6.,
                                         12.222222222222221,
                                         6.222222222222221,
                                         12.666666666666666,
                                         6.444444444444445,
                                         16.444444444444443,
                                         10.,
                                         3.222222222222222,
                                         3.222222222222222,
                                         6.555555555555555,
                                         3.333333333333333,
                                         6.777777777777777,
                                         3.444444444444444,
                                         8.777777777777777,
                                         5.333333333333333,
                                         8.722222222222221,
                                         8.722222222222221,
                                         17.72222222222222,
                                         9.,
                                         18.277777777777775,
                                         9.277777777777777,
                                         23.61111111111111,
                                         14.333333333333332,
                                         5.5,
                                         5.5,
                                         11.166666666666666,
                                         5.666666666666666,
                                         11.5,
                                         5.833333333333333,
                                         14.833333333333332,
                                         9.};
  const std::array<int, 4> in_shape = {{3, 6, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.3333333333333333,
                                         0.7777777777777778,
                                         1.7777777777777777,
                                         1.,
                                         1.,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         4.,
                                         2.1111111111111107,
                                         4.444444444444444,
                                         2.333333333333333,
                                         2.333333333333333,
                                         0.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         3.2222222222222223,
                                         3.2222222222222223,
                                         6.666666666666666,
                                         3.444444444444444,
                                         7.111111111111111,
                                         3.6666666666666665,
                                         3.6666666666666665,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.6666666666666665,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.6666666666666665,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         2.6666666666666665,
                                         3.1111111111111107,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         2.,
                                         2.222222222222222,
                                         5.666666666666666,
                                         6.222222222222221,
                                         3.6666666666666665,
                                         4.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.9444444444444446,
                                         4.222222222222221,
                                         2.5,
                                         2.6666666666666665,
                                         3.833333333333333,
                                         4.111111111111111,
                                         3.833333333333333,
                                         4.111111111111111,
                                         8.222222222222221,
                                         8.777777777777779,
                                         4.388888888888888,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.888888888888888,
                                         4.944444444444445,
                                         5.222222222222221,
                                         13.194444444444445,
                                         13.888888888888888,
                                         8.25,
                                         8.666666666666666,
                                         2.833333333333333,
                                         3.,
                                         2.833333333333333,
                                         3.,
                                         6.,
                                         6.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         8.388888888888888,
                                         8.666666666666666,
                                         5.166666666666666,
                                         5.333333333333333,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         8.388888888888888,
                                         8.666666666666666,
                                         5.166666666666666,
                                         5.333333333333333,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.444444444444445,
                                         6.666666666666666,
                                         13.333333333333334,
                                         13.777777777777779,
                                         6.888888888888889,
                                         7.111111111111111,
                                         14.222222222222221,
                                         14.666666666666664,
                                         7.333333333333332,
                                         7.555555555555555,
                                         19.,
                                         19.555555555555557,
                                         11.666666666666666,
                                         12.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         8.,
                                         8.222222222222221,
                                         4.111111111111111,
                                         4.222222222222222,
                                         10.61111111111111,
                                         10.88888888888889,
                                         6.5,
                                         6.666666666666666,
                                         10.5,
                                         10.777777777777779,
                                         10.5,
                                         10.777777777777779,
                                         21.555555555555557,
                                         22.11111111111111,
                                         11.055555555555555,
                                         11.333333333333332,
                                         22.666666666666664,
                                         23.22222222222222,
                                         11.61111111111111,
                                         11.88888888888889,
                                         29.86111111111111,
                                         30.555555555555557,
                                         18.25,
                                         18.666666666666664,
                                         6.833333333333333,
                                         7.,
                                         6.833333333333333,
                                         7.,
                                         14.,
                                         14.333333333333332,
                                         7.166666666666666,
                                         7.333333333333333,
                                         14.666666666666666,
                                         15.,
                                         7.5,
                                         7.666666666666666,
                                         19.25,
                                         19.666666666666664,
                                         11.75,
                                         12.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.555555555555554,
                                         11.777777777777779,
                                         5.888888888888888,
                                         6.,
                                         15.055555555555554,
                                         15.333333333333332,
                                         9.166666666666666,
                                         9.333333333333332,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.555555555555554,
                                         11.777777777777779,
                                         5.888888888888888,
                                         6.,
                                         15.055555555555554,
                                         15.333333333333332,
                                         9.166666666666666,
                                         9.333333333333332,
                                         11.777777777777777,
                                         12.,
                                         11.777777777777777,
                                         12.,
                                         24.,
                                         24.444444444444443,
                                         12.222222222222221,
                                         12.444444444444443,
                                         24.888888888888886,
                                         25.333333333333332,
                                         12.666666666666666,
                                         12.88888888888889,
                                         32.33333333333333,
                                         32.888888888888886,
                                         19.666666666666664,
                                         20.,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.333333333333333,
                                         6.444444444444444,
                                         12.88888888888889,
                                         13.11111111111111,
                                         6.555555555555555,
                                         6.666666666666666,
                                         13.333333333333332,
                                         13.555555555555554,
                                         6.777777777777778,
                                         6.888888888888888,
                                         17.27777777777778,
                                         17.555555555555554,
                                         10.5,
                                         10.666666666666666,
                                         17.166666666666664,
                                         17.444444444444443,
                                         17.166666666666664,
                                         17.444444444444443,
                                         34.888888888888886,
                                         35.44444444444444,
                                         17.72222222222222,
                                         18.,
                                         36.,
                                         36.55555555555555,
                                         18.27777777777778,
                                         18.555555555555554,
                                         46.52777777777778,
                                         47.22222222222222,
                                         28.25,
                                         28.666666666666664,
                                         10.833333333333332,
                                         11.,
                                         10.833333333333332,
                                         11.,
                                         22.,
                                         22.333333333333332,
                                         11.166666666666666,
                                         11.333333333333332,
                                         22.666666666666664,
                                         23.,
                                         11.5,
                                         11.666666666666666,
                                         29.25,
                                         29.666666666666664,
                                         17.75,
                                         18.};
  const std::array<int, 4> in_shape = {{3, 6, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         3.1111111111111107,
                                         3.5555555555555554,
                                         1.7777777777777777,
                                         2.,
                                         1.7777777777777777,
                                         2.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         7.5555555555555545,
                                         8.,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         8.444444444444443,
                                         8.888888888888888,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.444444444444445,
                                         4.666666666666666,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.222222222222221,
                                         6.444444444444445,
                                         12.888888888888888,
                                         13.333333333333332,
                                         6.666666666666666,
                                         6.888888888888888,
                                         13.777777777777777,
                                         14.222222222222221,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.111111111111111,
                                         7.333333333333333,
                                         0.,
                                         0.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         4.888888888888888,
                                         5.333333333333333,
                                         5.777777777777778,
                                         6.222222222222221,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666666,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         4.,
                                         4.222222222222222,
                                         4.444444444444444,
                                         10.777777777777779,
                                         11.333333333333332,
                                         11.88888888888889,
                                         12.444444444444443,
                                         7.,
                                         7.333333333333333,
                                         7.666666666666666,
                                         8.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777777,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         7.611111111111111,
                                         7.888888888888889,
                                         8.166666666666666,
                                         8.444444444444443,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         7.388888888888889,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         15.888888888888888,
                                         16.444444444444443,
                                         17.,
                                         17.555555555555557,
                                         8.5,
                                         8.777777777777777,
                                         9.055555555555555,
                                         9.333333333333332,
                                         18.11111111111111,
                                         18.666666666666664,
                                         19.22222222222222,
                                         19.777777777777775,
                                         9.61111111111111,
                                         9.88888888888889,
                                         10.166666666666666,
                                         10.444444444444443,
                                         25.694444444444443,
                                         26.38888888888889,
                                         27.083333333333332,
                                         27.777777777777775,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         11.666666666666666,
                                         12.,
                                         12.333333333333332,
                                         12.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         16.5,
                                         16.777777777777775,
                                         17.055555555555557,
                                         17.333333333333332,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         16.5,
                                         16.777777777777775,
                                         17.055555555555557,
                                         17.333333333333332,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         12.666666666666664,
                                         12.88888888888889,
                                         13.11111111111111,
                                         13.333333333333332,
                                         12.666666666666664,
                                         12.88888888888889,
                                         13.11111111111111,
                                         13.333333333333332,
                                         26.22222222222222,
                                         26.666666666666668,
                                         27.11111111111111,
                                         27.555555555555557,
                                         13.555555555555554,
                                         13.777777777777779,
                                         14.,
                                         14.222222222222221,
                                         27.999999999999996,
                                         28.444444444444443,
                                         28.888888888888886,
                                         29.33333333333333,
                                         14.444444444444443,
                                         14.666666666666664,
                                         14.888888888888888,
                                         15.11111111111111,
                                         37.44444444444444,
                                         38.,
                                         38.55555555555556,
                                         39.111111111111114,
                                         23.,
                                         23.333333333333332,
                                         23.666666666666664,
                                         24.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         15.777777777777777,
                                         16.,
                                         16.22222222222222,
                                         16.444444444444443,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         20.944444444444443,
                                         21.22222222222222,
                                         21.5,
                                         21.77777777777778,
                                         12.833333333333332,
                                         13.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         20.72222222222222,
                                         21.,
                                         21.277777777777775,
                                         21.555555555555557,
                                         20.72222222222222,
                                         21.,
                                         21.277777777777775,
                                         21.555555555555557,
                                         42.55555555555555,
                                         43.111111111111114,
                                         43.666666666666664,
                                         44.22222222222222,
                                         21.833333333333332,
                                         22.11111111111111,
                                         22.38888888888889,
                                         22.666666666666664,
                                         44.77777777777777,
                                         45.33333333333333,
                                         45.888888888888886,
                                         46.44444444444444,
                                         22.944444444444443,
                                         23.22222222222222,
                                         23.5,
                                         23.77777777777778,
                                         59.02777777777777,
                                         59.72222222222222,
                                         60.416666666666664,
                                         61.111111111111114,
                                         36.08333333333333,
                                         36.5,
                                         36.916666666666664,
                                         37.33333333333333,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         27.666666666666664,
                                         28.,
                                         28.333333333333332,
                                         28.666666666666664,
                                         14.166666666666666,
                                         14.333333333333332,
                                         14.5,
                                         14.666666666666666,
                                         29.,
                                         29.333333333333332,
                                         29.666666666666664,
                                         30.,
                                         14.833333333333332,
                                         15.,
                                         15.166666666666666,
                                         15.333333333333332,
                                         38.08333333333333,
                                         38.5,
                                         38.916666666666664,
                                         39.33333333333333,
                                         23.25,
                                         23.5,
                                         23.75,
                                         24.,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555557,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         29.83333333333333,
                                         30.111111111111107,
                                         30.388888888888886,
                                         30.666666666666664,
                                         18.166666666666664,
                                         18.333333333333332,
                                         18.5,
                                         18.666666666666664,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555557,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         29.83333333333333,
                                         30.111111111111107,
                                         30.388888888888886,
                                         30.666666666666664,
                                         18.166666666666664,
                                         18.333333333333332,
                                         18.5,
                                         18.666666666666664,
                                         23.333333333333332,
                                         23.555555555555554,
                                         23.77777777777778,
                                         24.,
                                         23.333333333333332,
                                         23.555555555555554,
                                         23.77777777777778,
                                         24.,
                                         47.55555555555556,
                                         48.,
                                         48.44444444444444,
                                         48.888888888888886,
                                         24.22222222222222,
                                         24.444444444444443,
                                         24.666666666666664,
                                         24.888888888888886,
                                         49.33333333333333,
                                         49.77777777777777,
                                         50.22222222222222,
                                         50.666666666666664,
                                         25.111111111111107,
                                         25.333333333333332,
                                         25.555555555555554,
                                         25.77777777777778,
                                         64.1111111111111,
                                         64.66666666666666,
                                         65.22222222222221,
                                         65.77777777777777,
                                         39.,
                                         39.33333333333333,
                                         39.666666666666664,
                                         40.,
                                         12.555555555555555,
                                         12.666666666666666,
                                         12.777777777777777,
                                         12.888888888888888,
                                         12.555555555555555,
                                         12.666666666666666,
                                         12.777777777777777,
                                         12.888888888888888,
                                         25.555555555555557,
                                         25.77777777777778,
                                         26.,
                                         26.22222222222222,
                                         13.,
                                         13.11111111111111,
                                         13.222222222222221,
                                         13.333333333333332,
                                         26.444444444444443,
                                         26.666666666666664,
                                         26.888888888888886,
                                         27.111111111111107,
                                         13.444444444444443,
                                         13.555555555555555,
                                         13.666666666666666,
                                         13.777777777777777,
                                         34.27777777777777,
                                         34.55555555555556,
                                         34.83333333333333,
                                         35.11111111111111,
                                         20.833333333333332,
                                         21.,
                                         21.166666666666664,
                                         21.333333333333332,
                                         34.05555555555556,
                                         34.33333333333333,
                                         34.61111111111111,
                                         34.888888888888886,
                                         34.05555555555556,
                                         34.33333333333333,
                                         34.61111111111111,
                                         34.888888888888886,
                                         69.22222222222223,
                                         69.77777777777777,
                                         70.33333333333333,
                                         70.88888888888889,
                                         35.166666666666664,
                                         35.44444444444444,
                                         35.72222222222222,
                                         36.,
                                         71.44444444444444,
                                         72.,
                                         72.55555555555554,
                                         73.1111111111111,
                                         36.27777777777777,
                                         36.55555555555556,
                                         36.83333333333333,
                                         37.11111111111111,
                                         92.3611111111111,
                                         93.05555555555556,
                                         93.75,
                                         94.44444444444444,
                                         56.08333333333333,
                                         56.5,
                                         56.916666666666664,
                                         57.33333333333333,
                                         21.5,
                                         21.666666666666664,
                                         21.833333333333332,
                                         22.,
                                         21.5,
                                         21.666666666666664,
                                         21.833333333333332,
                                         22.,
                                         43.666666666666664,
                                         44.,
                                         44.33333333333333,
                                         44.666666666666664,
                                         22.166666666666664,
                                         22.333333333333332,
                                         22.5,
                                         22.666666666666664,
                                         45.,
                                         45.33333333333333,
                                         45.666666666666664,
                                         46.,
                                         22.833333333333332,
                                         23.,
                                         23.166666666666664,
                                         23.333333333333332,
                                         58.08333333333333,
                                         58.5,
                                         58.916666666666664,
                                         59.33333333333333,
                                         35.25,
                                         35.5,
                                         35.75,
                                         36.};
  const std::array<int, 4> in_shape = {{3, 6, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x6x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         5.777777777777778,
                                         6.222222222222221,
                                         6.666666666666666,
                                         7.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         14.666666666666666,
                                         15.111111111111109,
                                         15.555555555555557,
                                         16.,
                                         7.777777777777777,
                                         7.999999999999999,
                                         8.222222222222221,
                                         8.444444444444443,
                                         16.444444444444443,
                                         16.888888888888886,
                                         17.333333333333332,
                                         17.777777777777775,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         25.333333333333332,
                                         25.777777777777775,
                                         26.22222222222222,
                                         26.666666666666664,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555554,
                                         13.777777777777777,
                                         27.111111111111107,
                                         27.555555555555554,
                                         28.,
                                         28.444444444444443,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 6, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.16666666666666666,
                                         0.38888888888888884,
                                         0.2222222222222222,
                                         0.7222222222222222,
                                         0.5,
                                         0.8333333333333333,
                                         1.611111111111111,
                                         0.7777777777777778,
                                         2.2777777777777777,
                                         1.5,
                                         0.6666666666666666,
                                         1.2222222222222223,
                                         0.5555555555555556,
                                         1.5555555555555556,
                                         1.,
                                         1.833333333333333,
                                         3.2777777777777777,
                                         1.4444444444444444,
                                         3.9444444444444446,
                                         2.5,
                                         1.1666666666666665,
                                         2.0555555555555554,
                                         0.8888888888888888,
                                         2.388888888888889,
                                         1.5,
                                         3.6666666666666665,
                                         6.388888888888888,
                                         2.7222222222222223,
                                         7.222222222222222,
                                         4.5,
                                         2.5,
                                         4.333333333333333,
                                         1.8333333333333333,
                                         4.833333333333333,
                                         3.,
                                         2.1666666666666665,
                                         3.722222222222222,
                                         1.5555555555555554,
                                         4.055555555555555,
                                         2.5,
                                         2.1666666666666665,
                                         3.722222222222222,
                                         1.5555555555555554,
                                         4.055555555555555,
                                         2.5,
                                         4.833333333333333,
                                         8.277777777777777,
                                         3.444444444444444,
                                         8.944444444444445,
                                         5.5,
                                         2.6666666666666665,
                                         4.555555555555555,
                                         1.8888888888888888,
                                         4.888888888888889,
                                         3.,
                                         5.833333333333333,
                                         9.944444444444443,
                                         4.111111111111111,
                                         10.61111111111111,
                                         6.5,
                                         3.1666666666666665,
                                         5.388888888888889,
                                         2.2222222222222223,
                                         5.722222222222222,
                                         3.5,
                                         8.666666666666666,
                                         14.722222222222221,
                                         6.055555555555555,
                                         15.555555555555555,
                                         9.5,
                                         5.5,
                                         9.333333333333332,
                                         3.833333333333333,
                                         9.833333333333332,
                                         6.,
                                         4.166666666666666,
                                         7.055555555555555,
                                         2.888888888888889,
                                         7.388888888888889,
                                         4.5,
                                         4.166666666666666,
                                         7.055555555555555,
                                         2.888888888888889,
                                         7.388888888888889,
                                         4.5,
                                         8.833333333333332,
                                         14.944444444444443,
                                         6.111111111111111,
                                         15.61111111111111,
                                         9.5,
                                         4.666666666666666,
                                         7.8888888888888875,
                                         3.222222222222222,
                                         8.222222222222221,
                                         5.,
                                         9.833333333333332,
                                         16.611111111111107,
                                         6.777777777777777,
                                         17.27777777777778,
                                         10.5,
                                         5.166666666666666,
                                         8.722222222222221,
                                         3.5555555555555554,
                                         9.055555555555555,
                                         5.5,
                                         13.666666666666666,
                                         23.055555555555554,
                                         9.38888888888889,
                                         23.88888888888889,
                                         14.5,
                                         8.5,
                                         14.333333333333332,
                                         5.833333333333333,
                                         14.833333333333332,
                                         9.};
  const std::array<int, 4> in_shape = {{3, 8, 5, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x5x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         2.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.7777777777777777,
                                         2.,
                                         2.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.2222222222222223,
                                         4.666666666666666,
                                         2.4444444444444446,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.1111111111111107,
                                         6.444444444444444,
                                         3.333333333333333,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         3.444444444444444,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.5555555555555554,
                                         7.333333333333333,
                                         3.7777777777777777,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 5, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.7777777777777777,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         1.3333333333333333,
                                         1.6666666666666665,
                                         2.6666666666666665,
                                         3.222222222222222,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         2.1666666666666665,
                                         2.4444444444444446,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         3.333333333333333,
                                         3.666666666666666,
                                         6.,
                                         6.555555555555555,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         7.333333333333333,
                                         7.888888888888889,
                                         4.666666666666666,
                                         5.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         3.833333333333333,
                                         4.111111111111111,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         4.5,
                                         4.777777777777778,
                                         2.833333333333333,
                                         3.,
                                         6.916666666666666,
                                         7.333333333333333,
                                         12.083333333333332,
                                         12.777777777777777,
                                         5.166666666666666,
                                         5.444444444444445,
                                         13.75,
                                         14.444444444444445,
                                         8.583333333333332,
                                         9.,
                                         4.75,
                                         5.,
                                         8.25,
                                         8.666666666666666,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         7.166666666666666,
                                         7.444444444444444,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         7.166666666666666,
                                         7.444444444444444,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         15.999999999999998,
                                         16.555555555555554,
                                         6.666666666666666,
                                         6.888888888888888,
                                         17.333333333333332,
                                         17.88888888888889,
                                         10.666666666666666,
                                         11.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         8.833333333333332,
                                         9.11111111111111,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         9.5,
                                         9.777777777777779,
                                         5.833333333333333,
                                         6.,
                                         11.333333333333332,
                                         11.666666666666666,
                                         19.333333333333332,
                                         19.888888888888886,
                                         8.,
                                         8.222222222222221,
                                         20.666666666666664,
                                         21.22222222222222,
                                         12.666666666666666,
                                         13.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         10.5,
                                         10.777777777777779,
                                         4.333333333333333,
                                         4.444444444444445,
                                         11.166666666666666,
                                         11.444444444444445,
                                         6.833333333333333,
                                         7.,
                                         16.916666666666664,
                                         17.333333333333332,
                                         28.75,
                                         29.444444444444443,
                                         11.833333333333332,
                                         12.11111111111111,
                                         30.416666666666664,
                                         31.11111111111111,
                                         18.583333333333332,
                                         19.,
                                         10.75,
                                         11.,
                                         18.25,
                                         18.666666666666664,
                                         7.5,
                                         7.666666666666666,
                                         19.25,
                                         19.666666666666664,
                                         11.75,
                                         12.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         13.833333333333332,
                                         14.11111111111111,
                                         5.666666666666666,
                                         5.777777777777778,
                                         14.499999999999998,
                                         14.777777777777779,
                                         8.833333333333332,
                                         9.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         13.833333333333332,
                                         14.11111111111111,
                                         5.666666666666666,
                                         5.777777777777778,
                                         14.499999999999998,
                                         14.777777777777779,
                                         8.833333333333332,
                                         9.,
                                         17.333333333333332,
                                         17.666666666666664,
                                         29.333333333333332,
                                         29.888888888888886,
                                         12.,
                                         12.222222222222221,
                                         30.666666666666664,
                                         31.22222222222222,
                                         18.666666666666664,
                                         19.,
                                         9.166666666666666,
                                         9.333333333333332,
                                         15.5,
                                         15.777777777777775,
                                         6.333333333333333,
                                         6.444444444444444,
                                         16.166666666666664,
                                         16.444444444444443,
                                         9.833333333333332,
                                         10.,
                                         19.333333333333332,
                                         19.666666666666664,
                                         32.666666666666664,
                                         33.222222222222214,
                                         13.333333333333332,
                                         13.555555555555554,
                                         34.,
                                         34.55555555555556,
                                         20.666666666666664,
                                         21.,
                                         10.166666666666666,
                                         10.333333333333332,
                                         17.166666666666664,
                                         17.444444444444443,
                                         7.,
                                         7.111111111111111,
                                         17.833333333333332,
                                         18.11111111111111,
                                         10.833333333333332,
                                         11.,
                                         26.916666666666664,
                                         27.333333333333332,
                                         45.416666666666664,
                                         46.11111111111111,
                                         18.5,
                                         18.77777777777778,
                                         47.08333333333333,
                                         47.77777777777778,
                                         28.583333333333332,
                                         29.,
                                         16.75,
                                         17.,
                                         28.25,
                                         28.666666666666664,
                                         11.5,
                                         11.666666666666666,
                                         29.25,
                                         29.666666666666664,
                                         17.75,
                                         18.};
  const std::array<int, 4> in_shape = {{3, 8, 5, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x5x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.555555555555555,
                                         3.7777777777777777,
                                         4.,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.222222222222221,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.333333333333332,
                                         4.666666666666666,
                                         4.888888888888889,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.,
                                         6.222222222222221,
                                         12.444444444444445,
                                         12.888888888888888,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         6.666666666666666,
                                         6.888888888888888,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         6.888888888888888,
                                         7.111111111111111,
                                         14.222222222222221,
                                         14.666666666666666,
                                         7.333333333333333,
                                         7.555555555555555,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 5, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.16666666666666666,
                                         0.3333333333333333,
                                         0.5,
                                         0.6666666666666666,
                                         0.7222222222222222,
                                         1.,
                                         1.2777777777777777,
                                         1.5555555555555554,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         2.333333333333333,
                                         2.6666666666666665,
                                         3.,
                                         3.333333333333333,
                                         4.777777777777778,
                                         5.333333333333333,
                                         5.888888888888889,
                                         6.444444444444444,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         4.055555555555555,
                                         4.333333333333333,
                                         4.611111111111111,
                                         4.888888888888889,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         6.333333333333332,
                                         6.666666666666666,
                                         7.,
                                         7.333333333333332,
                                         11.444444444444443,
                                         12.,
                                         12.555555555555555,
                                         13.11111111111111,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         14.11111111111111,
                                         14.666666666666666,
                                         15.222222222222221,
                                         15.777777777777779,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.5,
                                         4.666666666666666,
                                         7.3888888888888875,
                                         7.666666666666666,
                                         7.944444444444445,
                                         8.222222222222221,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         8.722222222222221,
                                         9.,
                                         9.277777777777777,
                                         9.555555555555555,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         13.416666666666666,
                                         13.833333333333332,
                                         14.25,
                                         14.666666666666666,
                                         23.472222222222218,
                                         24.166666666666664,
                                         24.861111111111107,
                                         25.555555555555554,
                                         10.055555555555555,
                                         10.333333333333332,
                                         10.61111111111111,
                                         10.88888888888889,
                                         26.805555555555554,
                                         27.5,
                                         28.194444444444443,
                                         28.88888888888889,
                                         16.75,
                                         17.166666666666664,
                                         17.583333333333332,
                                         18.,
                                         9.25,
                                         9.5,
                                         9.75,
                                         10.,
                                         16.083333333333332,
                                         16.5,
                                         16.916666666666664,
                                         17.333333333333332,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         14.055555555555554,
                                         14.333333333333332,
                                         14.61111111111111,
                                         14.888888888888888,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         14.055555555555554,
                                         14.333333333333332,
                                         14.61111111111111,
                                         14.888888888888888,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         18.333333333333332,
                                         18.666666666666664,
                                         19.,
                                         19.333333333333332,
                                         31.444444444444443,
                                         31.999999999999996,
                                         32.55555555555556,
                                         33.11111111111111,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555554,
                                         13.777777777777777,
                                         34.111111111111114,
                                         34.666666666666664,
                                         35.222222222222214,
                                         35.77777777777778,
                                         21.,
                                         21.333333333333332,
                                         21.666666666666664,
                                         22.,
                                         10.166666666666666,
                                         10.333333333333332,
                                         10.5,
                                         10.666666666666666,
                                         17.388888888888886,
                                         17.666666666666664,
                                         17.944444444444443,
                                         18.22222222222222,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         18.72222222222222,
                                         19.,
                                         19.277777777777775,
                                         19.555555555555557,
                                         11.5,
                                         11.666666666666666,
                                         11.833333333333332,
                                         12.,
                                         22.333333333333332,
                                         22.666666666666664,
                                         23.,
                                         23.333333333333332,
                                         38.11111111111111,
                                         38.666666666666664,
                                         39.22222222222222,
                                         39.77777777777777,
                                         15.777777777777777,
                                         16.,
                                         16.22222222222222,
                                         16.444444444444443,
                                         40.77777777777778,
                                         41.33333333333333,
                                         41.888888888888886,
                                         42.44444444444444,
                                         25.,
                                         25.333333333333332,
                                         25.666666666666664,
                                         26.,
                                         12.166666666666666,
                                         12.333333333333332,
                                         12.5,
                                         12.666666666666666,
                                         20.72222222222222,
                                         21.,
                                         21.27777777777778,
                                         21.555555555555557,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         22.055555555555557,
                                         22.333333333333332,
                                         22.611111111111107,
                                         22.88888888888889,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         33.416666666666664,
                                         33.83333333333333,
                                         34.25,
                                         34.666666666666664,
                                         56.80555555555556,
                                         57.5,
                                         58.19444444444444,
                                         58.888888888888886,
                                         23.388888888888886,
                                         23.666666666666664,
                                         23.944444444444443,
                                         24.22222222222222,
                                         60.138888888888886,
                                         60.83333333333333,
                                         61.52777777777777,
                                         62.22222222222222,
                                         36.75,
                                         37.166666666666664,
                                         37.58333333333333,
                                         38.,
                                         21.25,
                                         21.5,
                                         21.75,
                                         22.,
                                         36.08333333333333,
                                         36.5,
                                         36.916666666666664,
                                         37.33333333333333,
                                         14.833333333333332,
                                         15.,
                                         15.166666666666666,
                                         15.333333333333332,
                                         38.08333333333333,
                                         38.5,
                                         38.916666666666664,
                                         39.33333333333333,
                                         23.25,
                                         23.5,
                                         23.75,
                                         24.,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         27.388888888888886,
                                         27.666666666666664,
                                         27.944444444444443,
                                         28.22222222222222,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         28.72222222222222,
                                         28.999999999999996,
                                         29.27777777777778,
                                         29.555555555555557,
                                         17.5,
                                         17.666666666666664,
                                         17.833333333333332,
                                         18.,
                                         16.166666666666664,
                                         16.333333333333332,
                                         16.5,
                                         16.666666666666664,
                                         27.388888888888886,
                                         27.666666666666664,
                                         27.944444444444443,
                                         28.22222222222222,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         28.72222222222222,
                                         28.999999999999996,
                                         29.27777777777778,
                                         29.555555555555557,
                                         17.5,
                                         17.666666666666664,
                                         17.833333333333332,
                                         18.,
                                         34.33333333333333,
                                         34.666666666666664,
                                         35.,
                                         35.33333333333333,
                                         58.11111111111111,
                                         58.666666666666664,
                                         59.22222222222222,
                                         59.77777777777777,
                                         23.77777777777778,
                                         24.,
                                         24.22222222222222,
                                         24.444444444444443,
                                         60.77777777777778,
                                         61.33333333333333,
                                         61.888888888888886,
                                         62.44444444444444,
                                         37.,
                                         37.33333333333333,
                                         37.666666666666664,
                                         38.,
                                         18.166666666666664,
                                         18.333333333333332,
                                         18.5,
                                         18.666666666666664,
                                         30.72222222222222,
                                         31.,
                                         31.27777777777778,
                                         31.55555555555555,
                                         12.555555555555555,
                                         12.666666666666666,
                                         12.777777777777777,
                                         12.888888888888888,
                                         32.05555555555556,
                                         32.33333333333333,
                                         32.61111111111111,
                                         32.888888888888886,
                                         19.5,
                                         19.666666666666664,
                                         19.833333333333332,
                                         20.,
                                         38.33333333333333,
                                         38.666666666666664,
                                         39.,
                                         39.33333333333333,
                                         64.77777777777777,
                                         65.33333333333333,
                                         65.88888888888889,
                                         66.44444444444443,
                                         26.444444444444443,
                                         26.666666666666664,
                                         26.888888888888886,
                                         27.111111111111107,
                                         67.44444444444444,
                                         68.,
                                         68.55555555555554,
                                         69.11111111111111,
                                         41.,
                                         41.33333333333333,
                                         41.666666666666664,
                                         42.,
                                         20.166666666666664,
                                         20.333333333333332,
                                         20.5,
                                         20.666666666666664,
                                         34.05555555555555,
                                         34.33333333333333,
                                         34.611111111111114,
                                         34.888888888888886,
                                         13.888888888888888,
                                         14.,
                                         14.11111111111111,
                                         14.222222222222221,
                                         35.388888888888886,
                                         35.666666666666664,
                                         35.94444444444444,
                                         36.22222222222222,
                                         21.5,
                                         21.666666666666664,
                                         21.833333333333332,
                                         22.,
                                         53.416666666666664,
                                         53.83333333333333,
                                         54.25,
                                         54.666666666666664,
                                         90.13888888888887,
                                         90.83333333333333,
                                         91.52777777777777,
                                         92.22222222222221,
                                         36.72222222222222,
                                         37.,
                                         37.27777777777777,
                                         37.55555555555556,
                                         93.47222222222221,
                                         94.16666666666666,
                                         94.86111111111111,
                                         95.55555555555556,
                                         56.75,
                                         57.166666666666664,
                                         57.58333333333333,
                                         58.,
                                         33.25,
                                         33.5,
                                         33.75,
                                         34.,
                                         56.08333333333333,
                                         56.5,
                                         56.916666666666664,
                                         57.33333333333333,
                                         22.833333333333332,
                                         23.,
                                         23.166666666666664,
                                         23.333333333333332,
                                         58.08333333333333,
                                         58.5,
                                         58.916666666666664,
                                         59.33333333333333,
                                         35.25,
                                         35.5,
                                         35.75,
                                         36.};
  const std::array<int, 4> in_shape = {{3, 8, 5, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x5x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666667,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.888888888888889,
                                         7.111111111111111,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.888888888888889,
                                         7.111111111111111,
                                         13.777777777777777,
                                         14.222222222222221,
                                         14.666666666666668,
                                         15.11111111111111,
                                         7.333333333333332,
                                         7.555555555555555,
                                         7.777777777777777,
                                         8.,
                                         7.333333333333332,
                                         7.555555555555555,
                                         7.777777777777777,
                                         8.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.333333333333332,
                                         17.77777777777778,
                                         18.22222222222222,
                                         18.666666666666664,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         11.777777777777777,
                                         12.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         11.777777777777777,
                                         12.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         24.444444444444443,
                                         24.88888888888889,
                                         25.333333333333332,
                                         25.777777777777775,
                                         12.666666666666666,
                                         12.88888888888889,
                                         13.11111111111111,
                                         13.333333333333332,
                                         12.666666666666666,
                                         12.88888888888889,
                                         13.11111111111111,
                                         13.333333333333332,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555555,
                                         13.777777777777777,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         13.555555555555554,
                                         13.777777777777777,
                                         14.,
                                         14.222222222222221,
                                         13.555555555555554,
                                         13.777777777777777,
                                         14.,
                                         14.222222222222221,
                                         28.,
                                         28.444444444444443,
                                         28.88888888888889,
                                         29.333333333333332,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.88888888888889,
                                         15.11111111111111,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.88888888888889,
                                         15.11111111111111,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 5, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.1111111111111111, 0.1111111111111111, 0.3333333333333333,
      0.2222222222222222, 0.7222222222222222, 0.5,
      0.5555555555555556, 0.5555555555555556, 1.3333333333333333,
      0.7777777777777778, 2.2777777777777777, 1.5,
      0.4444444444444444, 0.4444444444444444, 1.,
      0.5555555555555556, 1.5555555555555556, 1.,
      1.222222222222222,  1.222222222222222,  2.6666666666666665,
      1.4444444444444444, 3.9444444444444446, 2.5,
      0.7777777777777777, 0.7777777777777777, 1.6666666666666665,
      0.8888888888888888, 2.388888888888889,  1.5,
      2.444444444444444,  2.444444444444444,  5.166666666666666,
      2.7222222222222223, 7.222222222222222,  4.5,
      1.6666666666666665, 1.6666666666666665, 3.5,
      1.8333333333333333, 4.833333333333333,  3.,
      1.4444444444444444, 1.4444444444444444, 3.,
      1.5555555555555554, 4.055555555555555,  2.5,
      1.4444444444444444, 1.4444444444444444, 3.,
      1.5555555555555554, 4.055555555555555,  2.5,
      3.2222222222222223, 3.2222222222222223, 6.666666666666666,
      3.444444444444444,  8.944444444444445,  5.5,
      1.7777777777777777, 1.7777777777777777, 3.6666666666666665,
      1.8888888888888888, 4.888888888888889,  3.,
      3.888888888888889,  3.888888888888889,  8.,
      4.111111111111111,  10.61111111111111,  6.5,
      2.111111111111111,  2.111111111111111,  4.333333333333334,
      2.2222222222222223, 5.722222222222222,  3.5,
      5.777777777777778,  5.777777777777778,  11.833333333333332,
      6.055555555555555,  15.555555555555555, 9.5,
      3.6666666666666665, 3.6666666666666665, 7.5,
      3.833333333333333,  9.833333333333332,  6.,
      2.7777777777777777, 2.7777777777777777, 5.666666666666666,
      2.888888888888889,  7.388888888888889,  4.5,
      2.7777777777777777, 2.7777777777777777, 5.666666666666666,
      2.888888888888889,  7.388888888888889,  4.5,
      5.888888888888888,  5.888888888888888,  11.999999999999998,
      6.111111111111111,  15.61111111111111,  9.5,
      3.1111111111111107, 3.1111111111111107, 6.333333333333332,
      3.222222222222222,  8.222222222222221,  5.,
      6.555555555555555,  6.555555555555555,  13.333333333333332,
      6.777777777777777,  17.27777777777778,  10.5,
      3.444444444444444,  3.444444444444444,  7.,
      3.5555555555555554, 9.055555555555555,  5.5,
      9.11111111111111,   9.11111111111111,   18.5,
      9.38888888888889,   23.88888888888889,  14.5,
      5.666666666666666,  5.666666666666666,  11.5,
      5.833333333333333,  14.833333333333332, 9.};
  const std::array<int, 4> in_shape = {{3, 8, 6, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x6x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.2222222222222222,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.1111111111111112,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.7777777777777777,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         0.,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         2.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         0.8888888888888888,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.7777777777777777,
                                         2.,
                                         2.,
                                         0.,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         0.,
                                         2.2222222222222223,
                                         2.2222222222222223,
                                         4.666666666666666,
                                         2.4444444444444446,
                                         2.4444444444444446,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         1.5555555555555554,
                                         0.,
                                         3.1111111111111107,
                                         3.1111111111111107,
                                         6.444444444444444,
                                         3.333333333333333,
                                         3.333333333333333,
                                         0.,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         3.444444444444444,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         0.,
                                         3.5555555555555554,
                                         3.5555555555555554,
                                         7.333333333333333,
                                         3.7777777777777777,
                                         3.7777777777777777,
                                         0.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 6, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         1.1666666666666665,
                                         1.4444444444444444,
                                         0.8333333333333333,
                                         1.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         4.,
                                         4.555555555555555,
                                         2.6666666666666665,
                                         3.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.833333333333333,
                                         3.111111111111111,
                                         1.8333333333333333,
                                         2.,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         7.333333333333333,
                                         7.888888888888889,
                                         4.666666666666666,
                                         5.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         4.5,
                                         4.777777777777778,
                                         2.833333333333333,
                                         3.,
                                         4.611111111111111,
                                         4.888888888888888,
                                         4.611111111111111,
                                         4.888888888888888,
                                         9.777777777777777,
                                         10.333333333333332,
                                         5.166666666666666,
                                         5.444444444444445,
                                         13.75,
                                         14.444444444444445,
                                         8.583333333333332,
                                         9.,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         3.1666666666666665,
                                         3.333333333333333,
                                         6.666666666666666,
                                         7.,
                                         3.5,
                                         3.6666666666666665,
                                         9.25,
                                         9.666666666666666,
                                         5.75,
                                         6.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         7.833333333333333,
                                         8.11111111111111,
                                         4.833333333333333,
                                         5.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.222222222222221,
                                         6.444444444444445,
                                         12.888888888888888,
                                         13.333333333333332,
                                         6.666666666666666,
                                         6.888888888888888,
                                         17.333333333333332,
                                         17.88888888888889,
                                         10.666666666666666,
                                         11.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         9.5,
                                         9.777777777777779,
                                         5.833333333333333,
                                         6.,
                                         7.555555555555555,
                                         7.777777777777778,
                                         7.555555555555555,
                                         7.777777777777778,
                                         15.555555555555554,
                                         16.,
                                         8.,
                                         8.222222222222221,
                                         20.666666666666664,
                                         21.22222222222222,
                                         12.666666666666666,
                                         13.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.111111111111111,
                                         4.222222222222222,
                                         8.444444444444443,
                                         8.666666666666668,
                                         4.333333333333333,
                                         4.444444444444445,
                                         11.166666666666666,
                                         11.444444444444445,
                                         6.833333333333333,
                                         7.,
                                         11.277777777777777,
                                         11.555555555555555,
                                         11.277777777777777,
                                         11.555555555555555,
                                         23.111111111111107,
                                         23.666666666666664,
                                         11.833333333333332,
                                         12.11111111111111,
                                         30.416666666666664,
                                         31.11111111111111,
                                         18.583333333333332,
                                         19.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         7.166666666666666,
                                         7.333333333333333,
                                         14.666666666666666,
                                         15.,
                                         7.5,
                                         7.666666666666666,
                                         19.25,
                                         19.666666666666664,
                                         11.75,
                                         12.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         14.499999999999998,
                                         14.777777777777779,
                                         8.833333333333332,
                                         9.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         14.499999999999998,
                                         14.777777777777779,
                                         8.833333333333332,
                                         9.,
                                         11.555555555555554,
                                         11.777777777777777,
                                         11.555555555555554,
                                         11.777777777777777,
                                         23.555555555555554,
                                         23.999999999999996,
                                         12.,
                                         12.222222222222221,
                                         30.666666666666664,
                                         31.22222222222222,
                                         18.666666666666664,
                                         19.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.444444444444443,
                                         12.666666666666664,
                                         6.333333333333333,
                                         6.444444444444444,
                                         16.166666666666664,
                                         16.444444444444443,
                                         9.833333333333332,
                                         10.,
                                         12.88888888888889,
                                         13.11111111111111,
                                         12.88888888888889,
                                         13.11111111111111,
                                         26.22222222222222,
                                         26.666666666666664,
                                         13.333333333333332,
                                         13.555555555555554,
                                         34.,
                                         34.55555555555556,
                                         20.666666666666664,
                                         21.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         6.777777777777778,
                                         6.888888888888888,
                                         13.777777777777779,
                                         14.,
                                         7.,
                                         7.111111111111111,
                                         17.833333333333332,
                                         18.11111111111111,
                                         10.833333333333332,
                                         11.,
                                         17.944444444444443,
                                         18.22222222222222,
                                         17.944444444444443,
                                         18.22222222222222,
                                         36.44444444444444,
                                         37.,
                                         18.5,
                                         18.77777777777778,
                                         47.08333333333333,
                                         47.77777777777778,
                                         28.583333333333332,
                                         29.,
                                         11.166666666666666,
                                         11.333333333333332,
                                         11.166666666666666,
                                         11.333333333333332,
                                         22.666666666666664,
                                         23.,
                                         11.5,
                                         11.666666666666666,
                                         29.25,
                                         29.666666666666664,
                                         17.75,
                                         18.};
  const std::array<int, 4> in_shape = {{3, 8, 6, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x6x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.,
                                         0.,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.2222222222222223,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.3333333333333333,
                                         1.5555555555555554,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.555555555555555,
                                         3.7777777777777777,
                                         4.,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         0.,
                                         0.,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.222222222222221,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.333333333333332,
                                         4.666666666666666,
                                         4.888888888888889,
                                         4.666666666666666,
                                         4.888888888888889,
                                         0.,
                                         0.,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         3.,
                                         3.1111111111111107,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         3.,
                                         3.1111111111111107,
                                         0.,
                                         0.,
                                         6.,
                                         6.222222222222221,
                                         6.,
                                         6.222222222222221,
                                         12.444444444444445,
                                         12.888888888888888,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.444444444444445,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         6.666666666666666,
                                         6.888888888888888,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         6.888888888888888,
                                         7.111111111111111,
                                         6.888888888888888,
                                         7.111111111111111,
                                         14.222222222222221,
                                         14.666666666666666,
                                         7.333333333333333,
                                         7.555555555555555,
                                         7.333333333333333,
                                         7.555555555555555,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 6, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         2.0555555555555554,
                                         2.333333333333333,
                                         2.6111111111111107,
                                         2.888888888888889,
                                         1.5,
                                         1.6666666666666665,
                                         1.8333333333333333,
                                         2.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         7.444444444444445,
                                         8.,
                                         8.555555555555554,
                                         9.11111111111111,
                                         5.,
                                         5.333333333333333,
                                         5.666666666666666,
                                         6.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         5.388888888888889,
                                         5.666666666666666,
                                         5.944444444444445,
                                         6.222222222222222,
                                         3.5,
                                         3.6666666666666665,
                                         3.833333333333333,
                                         4.,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         9.333333333333332,
                                         9.777777777777779,
                                         10.222222222222221,
                                         10.666666666666666,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         14.11111111111111,
                                         14.666666666666666,
                                         15.222222222222221,
                                         15.777777777777779,
                                         9.,
                                         9.333333333333332,
                                         9.666666666666666,
                                         10.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         8.722222222222221,
                                         9.,
                                         9.277777777777777,
                                         9.555555555555555,
                                         5.5,
                                         5.666666666666666,
                                         5.833333333333333,
                                         6.,
                                         8.944444444444443,
                                         9.222222222222221,
                                         9.5,
                                         9.777777777777777,
                                         8.944444444444443,
                                         9.222222222222221,
                                         9.5,
                                         9.777777777777777,
                                         19.,
                                         19.555555555555554,
                                         20.11111111111111,
                                         20.666666666666664,
                                         10.055555555555555,
                                         10.333333333333332,
                                         10.61111111111111,
                                         10.88888888888889,
                                         26.805555555555554,
                                         27.5,
                                         28.194444444444443,
                                         28.88888888888889,
                                         16.75,
                                         17.166666666666664,
                                         17.583333333333332,
                                         18.,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         6.166666666666666,
                                         6.333333333333333,
                                         6.5,
                                         6.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         13.666666666666666,
                                         14.,
                                         6.833333333333333,
                                         7.,
                                         7.166666666666666,
                                         7.333333333333333,
                                         18.083333333333332,
                                         18.5,
                                         18.916666666666664,
                                         19.333333333333332,
                                         11.25,
                                         11.5,
                                         11.75,
                                         12.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         15.38888888888889,
                                         15.666666666666666,
                                         15.944444444444443,
                                         16.22222222222222,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         25.333333333333332,
                                         25.777777777777775,
                                         26.22222222222222,
                                         26.666666666666664,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555554,
                                         13.777777777777777,
                                         34.111111111111114,
                                         34.666666666666664,
                                         35.222222222222214,
                                         35.77777777777778,
                                         21.,
                                         21.333333333333332,
                                         21.666666666666664,
                                         22.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         18.72222222222222,
                                         19.,
                                         19.277777777777775,
                                         19.555555555555557,
                                         11.5,
                                         11.666666666666666,
                                         11.833333333333332,
                                         12.,
                                         14.88888888888889,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         14.88888888888889,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         30.666666666666664,
                                         31.111111111111107,
                                         31.55555555555555,
                                         32.,
                                         15.777777777777777,
                                         16.,
                                         16.22222222222222,
                                         16.444444444444443,
                                         40.77777777777778,
                                         41.33333333333333,
                                         41.888888888888886,
                                         42.44444444444444,
                                         25.,
                                         25.333333333333332,
                                         25.666666666666664,
                                         26.,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         16.666666666666664,
                                         16.888888888888886,
                                         17.111111111111107,
                                         17.333333333333336,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         22.055555555555557,
                                         22.333333333333332,
                                         22.611111111111107,
                                         22.88888888888889,
                                         13.5,
                                         13.666666666666666,
                                         13.833333333333332,
                                         14.,
                                         22.27777777777778,
                                         22.555555555555554,
                                         22.833333333333332,
                                         23.11111111111111,
                                         22.27777777777778,
                                         22.555555555555554,
                                         22.833333333333332,
                                         23.11111111111111,
                                         45.66666666666666,
                                         46.222222222222214,
                                         46.77777777777777,
                                         47.33333333333333,
                                         23.388888888888886,
                                         23.666666666666664,
                                         23.944444444444443,
                                         24.22222222222222,
                                         60.138888888888886,
                                         60.83333333333333,
                                         61.52777777777777,
                                         62.22222222222222,
                                         36.75,
                                         37.166666666666664,
                                         37.58333333333333,
                                         38.,
                                         14.166666666666666,
                                         14.333333333333332,
                                         14.5,
                                         14.666666666666666,
                                         14.166666666666666,
                                         14.333333333333332,
                                         14.5,
                                         14.666666666666666,
                                         29.,
                                         29.333333333333332,
                                         29.666666666666664,
                                         30.,
                                         14.833333333333332,
                                         15.,
                                         15.166666666666666,
                                         15.333333333333332,
                                         38.08333333333333,
                                         38.5,
                                         38.916666666666664,
                                         39.33333333333333,
                                         23.25,
                                         23.5,
                                         23.75,
                                         24.,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         28.72222222222222,
                                         28.999999999999996,
                                         29.27777777777778,
                                         29.555555555555557,
                                         17.5,
                                         17.666666666666664,
                                         17.833333333333332,
                                         18.,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         28.72222222222222,
                                         28.999999999999996,
                                         29.27777777777778,
                                         29.555555555555557,
                                         17.5,
                                         17.666666666666664,
                                         17.833333333333332,
                                         18.,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555554,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555554,
                                         46.66666666666667,
                                         47.11111111111111,
                                         47.55555555555555,
                                         47.99999999999999,
                                         23.77777777777778,
                                         24.,
                                         24.22222222222222,
                                         24.444444444444443,
                                         60.77777777777778,
                                         61.33333333333333,
                                         61.888888888888886,
                                         62.44444444444444,
                                         37.,
                                         37.33333333333333,
                                         37.666666666666664,
                                         38.,
                                         12.11111111111111,
                                         12.222222222222221,
                                         12.333333333333332,
                                         12.444444444444443,
                                         12.11111111111111,
                                         12.222222222222221,
                                         12.333333333333332,
                                         12.444444444444443,
                                         24.666666666666664,
                                         24.888888888888886,
                                         25.111111111111107,
                                         25.33333333333333,
                                         12.555555555555555,
                                         12.666666666666666,
                                         12.777777777777777,
                                         12.888888888888888,
                                         32.05555555555556,
                                         32.33333333333333,
                                         32.61111111111111,
                                         32.888888888888886,
                                         19.5,
                                         19.666666666666664,
                                         19.833333333333332,
                                         20.,
                                         25.555555555555554,
                                         25.77777777777778,
                                         26.,
                                         26.22222222222222,
                                         25.555555555555554,
                                         25.77777777777778,
                                         26.,
                                         26.22222222222222,
                                         51.99999999999999,
                                         52.44444444444444,
                                         52.888888888888886,
                                         53.33333333333333,
                                         26.444444444444443,
                                         26.666666666666664,
                                         26.888888888888886,
                                         27.111111111111107,
                                         67.44444444444444,
                                         68.,
                                         68.55555555555554,
                                         69.11111111111111,
                                         41.,
                                         41.33333333333333,
                                         41.666666666666664,
                                         42.,
                                         13.444444444444443,
                                         13.555555555555555,
                                         13.666666666666666,
                                         13.777777777777777,
                                         13.444444444444443,
                                         13.555555555555555,
                                         13.666666666666666,
                                         13.777777777777777,
                                         27.33333333333333,
                                         27.555555555555557,
                                         27.77777777777778,
                                         28.,
                                         13.888888888888888,
                                         14.,
                                         14.11111111111111,
                                         14.222222222222221,
                                         35.388888888888886,
                                         35.666666666666664,
                                         35.94444444444444,
                                         36.22222222222222,
                                         21.5,
                                         21.666666666666664,
                                         21.833333333333332,
                                         22.,
                                         35.61111111111111,
                                         35.888888888888886,
                                         36.166666666666664,
                                         36.44444444444444,
                                         35.61111111111111,
                                         35.888888888888886,
                                         36.166666666666664,
                                         36.44444444444444,
                                         72.33333333333333,
                                         72.88888888888889,
                                         73.44444444444444,
                                         74.,
                                         36.72222222222222,
                                         37.,
                                         37.27777777777777,
                                         37.55555555555556,
                                         93.47222222222221,
                                         94.16666666666666,
                                         94.86111111111111,
                                         95.55555555555556,
                                         56.75,
                                         57.166666666666664,
                                         57.58333333333333,
                                         58.,
                                         22.166666666666664,
                                         22.333333333333332,
                                         22.5,
                                         22.666666666666664,
                                         22.166666666666664,
                                         22.333333333333332,
                                         22.5,
                                         22.666666666666664,
                                         45.,
                                         45.33333333333333,
                                         45.666666666666664,
                                         46.,
                                         22.833333333333332,
                                         23.,
                                         23.166666666666664,
                                         23.333333333333332,
                                         58.08333333333333,
                                         58.5,
                                         58.916666666666664,
                                         59.33333333333333,
                                         35.25,
                                         35.5,
                                         35.75,
                                         36.};
  const std::array<int, 4> in_shape = {{3, 8, 6, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x6x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.111111111111111,
                                         3.5555555555555554,
                                         3.9999999999999996,
                                         4.444444444444445,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         2.,
                                         2.222222222222222,
                                         2.444444444444444,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         2.888888888888889,
                                         3.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666667,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         4.222222222222221,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.888888888888889,
                                         7.111111111111111,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.888888888888889,
                                         7.111111111111111,
                                         13.777777777777777,
                                         14.222222222222221,
                                         14.666666666666668,
                                         15.11111111111111,
                                         7.333333333333332,
                                         7.555555555555555,
                                         7.777777777777777,
                                         8.,
                                         7.333333333333332,
                                         7.555555555555555,
                                         7.777777777777777,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.333333333333332,
                                         17.77777777777778,
                                         18.22222222222222,
                                         18.666666666666664,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         9.11111111111111,
                                         9.333333333333332,
                                         9.555555555555555,
                                         9.777777777777779,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         11.777777777777777,
                                         12.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         11.777777777777777,
                                         12.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         24.444444444444443,
                                         24.88888888888889,
                                         25.333333333333332,
                                         25.777777777777775,
                                         12.666666666666666,
                                         12.88888888888889,
                                         13.11111111111111,
                                         13.333333333333332,
                                         12.666666666666666,
                                         12.88888888888889,
                                         13.11111111111111,
                                         13.333333333333332,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555555,
                                         13.777777777777777,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         13.555555555555554,
                                         13.777777777777777,
                                         14.,
                                         14.222222222222221,
                                         13.555555555555554,
                                         13.777777777777777,
                                         14.,
                                         14.222222222222221,
                                         28.,
                                         28.444444444444443,
                                         28.88888888888889,
                                         29.333333333333332,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.88888888888889,
                                         15.11111111111111,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.88888888888889,
                                         15.11111111111111,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 6, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         1.,
                                         0.6666666666666666,
                                         0.6666666666666667,
                                         0.6666666666666667,
                                         1.5555555555555554,
                                         0.8888888888888888,
                                         2.,
                                         1.111111111111111,
                                         3.1111111111111107,
                                         2.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         1.4444444444444442,
                                         0.7777777777777777,
                                         2.1111111111111107,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         1.5555555555555556,
                                         3.3333333333333335,
                                         1.7777777777777777,
                                         3.7777777777777777,
                                         1.9999999999999998,
                                         5.333333333333333,
                                         3.333333333333333,
                                         1.,
                                         1.,
                                         2.111111111111111,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         3.2222222222222223,
                                         2.,
                                         3.1666666666666665,
                                         3.1666666666666665,
                                         6.611111111111111,
                                         3.444444444444444,
                                         7.166666666666666,
                                         3.7222222222222223,
                                         9.722222222222221,
                                         6.,
                                         2.1666666666666665,
                                         2.1666666666666665,
                                         4.5,
                                         2.333333333333333,
                                         4.833333333333333,
                                         2.5,
                                         6.5,
                                         4.,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         4.111111111111111,
                                         2.111111111111111,
                                         5.444444444444445,
                                         3.333333333333333,
                                         1.8888888888888888,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         4.111111111111111,
                                         2.111111111111111,
                                         5.444444444444445,
                                         3.333333333333333,
                                         4.222222222222221,
                                         4.222222222222221,
                                         8.666666666666666,
                                         4.444444444444445,
                                         9.11111111111111,
                                         4.666666666666666,
                                         12.,
                                         7.333333333333333,
                                         2.333333333333333,
                                         2.333333333333333,
                                         4.777777777777777,
                                         2.444444444444444,
                                         5.,
                                         2.5555555555555554,
                                         6.555555555555555,
                                         4.,
                                         5.111111111111111,
                                         5.111111111111111,
                                         10.444444444444443,
                                         5.333333333333333,
                                         10.88888888888889,
                                         5.555555555555555,
                                         14.222222222222221,
                                         8.666666666666666,
                                         2.7777777777777777,
                                         2.7777777777777777,
                                         5.666666666666666,
                                         2.888888888888889,
                                         5.888888888888889,
                                         3.,
                                         7.666666666666666,
                                         4.666666666666666,
                                         7.611111111111111,
                                         7.611111111111111,
                                         15.5,
                                         7.888888888888889,
                                         16.055555555555557,
                                         8.166666666666666,
                                         20.833333333333332,
                                         12.666666666666666,
                                         4.833333333333333,
                                         4.833333333333333,
                                         9.833333333333332,
                                         5.,
                                         10.166666666666666,
                                         5.166666666666666,
                                         13.166666666666666,
                                         8.,
                                         3.6666666666666665,
                                         3.6666666666666665,
                                         7.444444444444445,
                                         3.7777777777777777,
                                         7.666666666666666,
                                         3.888888888888889,
                                         9.88888888888889,
                                         6.,
                                         3.6666666666666665,
                                         3.6666666666666665,
                                         7.444444444444445,
                                         3.7777777777777777,
                                         7.666666666666666,
                                         3.888888888888889,
                                         9.88888888888889,
                                         6.,
                                         7.777777777777777,
                                         7.777777777777777,
                                         15.777777777777779,
                                         8.,
                                         16.22222222222222,
                                         8.222222222222221,
                                         20.888888888888886,
                                         12.666666666666666,
                                         4.111111111111111,
                                         4.111111111111111,
                                         8.333333333333332,
                                         4.222222222222222,
                                         8.555555555555555,
                                         4.333333333333333,
                                         11.,
                                         6.666666666666666,
                                         8.666666666666666,
                                         8.666666666666666,
                                         17.555555555555554,
                                         8.88888888888889,
                                         18.,
                                         9.11111111111111,
                                         23.11111111111111,
                                         14.,
                                         4.555555555555555,
                                         4.555555555555555,
                                         9.222222222222221,
                                         4.666666666666666,
                                         9.444444444444443,
                                         4.777777777777778,
                                         12.11111111111111,
                                         7.333333333333333,
                                         12.055555555555555,
                                         12.055555555555555,
                                         24.388888888888886,
                                         12.333333333333332,
                                         24.94444444444444,
                                         12.61111111111111,
                                         31.944444444444443,
                                         19.333333333333332,
                                         7.5,
                                         7.5,
                                         15.166666666666666,
                                         7.666666666666666,
                                         15.5,
                                         7.833333333333333,
                                         19.833333333333332,
                                         12.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x8x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.1111111111111111,
                                         0.1111111111111111,
                                         0.3333333333333333,
                                         0.2222222222222222,
                                         0.5555555555555556,
                                         0.3333333333333333,
                                         0.3333333333333333,
                                         0.,
                                         0.5555555555555556,
                                         0.5555555555555556,
                                         1.3333333333333333,
                                         0.7777777777777778,
                                         1.7777777777777777,
                                         1.,
                                         1.,
                                         0.,
                                         0.4444444444444444,
                                         0.4444444444444444,
                                         1.,
                                         0.5555555555555556,
                                         1.2222222222222223,
                                         0.6666666666666666,
                                         0.6666666666666666,
                                         0.,
                                         1.222222222222222,
                                         1.222222222222222,
                                         2.6666666666666665,
                                         1.4444444444444444,
                                         3.111111111111111,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         0.7777777777777777,
                                         0.7777777777777777,
                                         1.6666666666666665,
                                         0.8888888888888888,
                                         1.8888888888888888,
                                         1.,
                                         1.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         1.1111111111111112,
                                         1.1111111111111112,
                                         2.333333333333333,
                                         1.222222222222222,
                                         2.5555555555555554,
                                         1.3333333333333333,
                                         1.3333333333333333,
                                         0.,
                                         2.5555555555555554,
                                         2.5555555555555554,
                                         5.333333333333333,
                                         2.7777777777777777,
                                         5.777777777777777,
                                         3.,
                                         3.,
                                         0.,
                                         1.4444444444444444,
                                         1.4444444444444444,
                                         3.,
                                         1.5555555555555554,
                                         3.222222222222222,
                                         1.6666666666666665,
                                         1.6666666666666665,
                                         0.,
                                         3.2222222222222223,
                                         3.2222222222222223,
                                         6.666666666666666,
                                         3.444444444444444,
                                         7.111111111111111,
                                         3.6666666666666665,
                                         3.6666666666666665,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.6666666666666665,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         1.7777777777777777,
                                         1.7777777777777777,
                                         3.6666666666666665,
                                         1.8888888888888888,
                                         3.888888888888889,
                                         2.,
                                         2.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.111111111111111,
                                         4.333333333333334,
                                         2.2222222222222223,
                                         4.555555555555555,
                                         2.333333333333333,
                                         2.333333333333333,
                                         0.,
                                         2.111111111111111,
                                         2.111111111111111,
                                         4.333333333333334,
                                         2.2222222222222223,
                                         4.555555555555555,
                                         2.333333333333333,
                                         2.333333333333333,
                                         0.,
                                         4.555555555555555,
                                         4.555555555555555,
                                         9.333333333333334,
                                         4.777777777777778,
                                         9.777777777777777,
                                         5.,
                                         5.,
                                         0.,
                                         2.444444444444444,
                                         2.444444444444444,
                                         5.,
                                         2.5555555555555554,
                                         5.222222222222221,
                                         2.6666666666666665,
                                         2.6666666666666665,
                                         0.,
                                         5.222222222222221,
                                         5.222222222222221,
                                         10.666666666666666,
                                         5.444444444444445,
                                         11.11111111111111,
                                         5.666666666666666,
                                         5.666666666666666,
                                         0.,
                                         2.7777777777777777,
                                         2.7777777777777777,
                                         5.666666666666666,
                                         2.888888888888889,
                                         5.888888888888889,
                                         3.,
                                         3.,
                                         0.,
                                         2.7777777777777777,
                                         2.7777777777777777,
                                         5.666666666666666,
                                         2.888888888888889,
                                         5.888888888888889,
                                         3.,
                                         3.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         1.722222222222222,
                                         2.,
                                         1.1666666666666665,
                                         1.3333333333333333,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         1.1111111111111112,
                                         1.3333333333333335,
                                         2.6666666666666665,
                                         3.1111111111111107,
                                         1.5555555555555554,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         4.,
                                         2.,
                                         2.222222222222222,
                                         5.666666666666666,
                                         6.222222222222221,
                                         3.6666666666666665,
                                         4.,
                                         1.,
                                         1.1111111111111112,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         2.6666666666666665,
                                         2.8888888888888884,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.9444444444444446,
                                         4.222222222222221,
                                         2.5,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         2.888888888888889,
                                         3.111111111111111,
                                         6.222222222222221,
                                         6.666666666666667,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.555555555555555,
                                         3.7777777777777777,
                                         3.9999999999999996,
                                         10.11111111111111,
                                         10.666666666666666,
                                         6.333333333333333,
                                         6.666666666666666,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         4.,
                                         4.222222222222222,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         6.166666666666666,
                                         6.444444444444445,
                                         3.833333333333333,
                                         4.,
                                         6.055555555555555,
                                         6.333333333333333,
                                         6.055555555555555,
                                         6.333333333333333,
                                         12.666666666666666,
                                         13.222222222222221,
                                         6.611111111111111,
                                         6.888888888888888,
                                         13.777777777777779,
                                         14.333333333333332,
                                         7.166666666666666,
                                         7.444444444444445,
                                         18.75,
                                         19.444444444444443,
                                         11.583333333333332,
                                         12.,
                                         4.166666666666666,
                                         4.333333333333333,
                                         4.166666666666666,
                                         4.333333333333333,
                                         8.666666666666666,
                                         9.,
                                         4.5,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.666666666666666,
                                         4.833333333333333,
                                         5.,
                                         12.583333333333332,
                                         13.,
                                         7.75,
                                         8.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         8.,
                                         8.222222222222221,
                                         4.111111111111111,
                                         4.222222222222222,
                                         10.61111111111111,
                                         10.88888888888889,
                                         6.5,
                                         6.666666666666666,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         8.,
                                         8.222222222222221,
                                         4.111111111111111,
                                         4.222222222222222,
                                         10.61111111111111,
                                         10.88888888888889,
                                         6.5,
                                         6.666666666666666,
                                         8.222222222222221,
                                         8.444444444444443,
                                         8.222222222222221,
                                         8.444444444444443,
                                         16.88888888888889,
                                         17.333333333333332,
                                         8.666666666666666,
                                         8.88888888888889,
                                         17.77777777777778,
                                         18.22222222222222,
                                         9.11111111111111,
                                         9.333333333333332,
                                         23.444444444444443,
                                         24.,
                                         14.333333333333332,
                                         14.666666666666666,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.555555555555555,
                                         4.666666666666666,
                                         9.333333333333332,
                                         9.555555555555554,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.777777777777779,
                                         10.,
                                         5.,
                                         5.111111111111111,
                                         12.833333333333332,
                                         13.11111111111111,
                                         7.833333333333333,
                                         8.,
                                         10.,
                                         10.222222222222221,
                                         10.,
                                         10.222222222222221,
                                         20.444444444444443,
                                         20.888888888888886,
                                         10.444444444444443,
                                         10.666666666666666,
                                         21.333333333333332,
                                         21.77777777777778,
                                         10.88888888888889,
                                         11.11111111111111,
                                         27.888888888888886,
                                         28.444444444444443,
                                         17.,
                                         17.333333333333332,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.555555555555554,
                                         11.777777777777779,
                                         5.888888888888888,
                                         6.,
                                         15.055555555555554,
                                         15.333333333333332,
                                         9.166666666666666,
                                         9.333333333333332,
                                         14.944444444444443,
                                         15.222222222222221,
                                         14.944444444444443,
                                         15.222222222222221,
                                         30.444444444444443,
                                         31.,
                                         15.499999999999998,
                                         15.777777777777779,
                                         31.55555555555555,
                                         32.111111111111114,
                                         16.055555555555554,
                                         16.333333333333332,
                                         40.97222222222222,
                                         41.666666666666664,
                                         24.916666666666664,
                                         25.333333333333332,
                                         9.5,
                                         9.666666666666666,
                                         9.5,
                                         9.666666666666666,
                                         19.333333333333332,
                                         19.666666666666664,
                                         9.833333333333332,
                                         10.,
                                         20.,
                                         20.333333333333332,
                                         10.166666666666666,
                                         10.333333333333332,
                                         25.916666666666664,
                                         26.333333333333332,
                                         15.75,
                                         16.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.222222222222221,
                                         7.333333333333333,
                                         14.666666666666664,
                                         14.88888888888889,
                                         7.444444444444444,
                                         7.555555555555555,
                                         15.11111111111111,
                                         15.333333333333332,
                                         7.666666666666666,
                                         7.777777777777778,
                                         19.5,
                                         19.77777777777778,
                                         11.833333333333332,
                                         12.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.222222222222221,
                                         7.333333333333333,
                                         14.666666666666664,
                                         14.88888888888889,
                                         7.444444444444444,
                                         7.555555555555555,
                                         15.11111111111111,
                                         15.333333333333332,
                                         7.666666666666666,
                                         7.777777777777778,
                                         19.5,
                                         19.77777777777778,
                                         11.833333333333332,
                                         12.,
                                         15.333333333333332,
                                         15.555555555555554,
                                         15.333333333333332,
                                         15.555555555555554,
                                         31.111111111111107,
                                         31.555555555555557,
                                         15.777777777777775,
                                         16.,
                                         32.,
                                         32.44444444444444,
                                         16.22222222222222,
                                         16.444444444444443,
                                         41.22222222222222,
                                         41.77777777777777,
                                         25.,
                                         25.333333333333332,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.11111111111111,
                                         8.222222222222221,
                                         16.444444444444443,
                                         16.666666666666664,
                                         8.333333333333332,
                                         8.444444444444445,
                                         16.888888888888886,
                                         17.11111111111111,
                                         8.555555555555555,
                                         8.666666666666666,
                                         21.72222222222222,
                                         22.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         17.11111111111111,
                                         17.333333333333332,
                                         17.11111111111111,
                                         17.333333333333332,
                                         34.666666666666664,
                                         35.11111111111111,
                                         17.555555555555554,
                                         17.77777777777778,
                                         35.55555555555555,
                                         36.,
                                         18.,
                                         18.22222222222222,
                                         45.666666666666664,
                                         46.22222222222222,
                                         27.666666666666664,
                                         28.,
                                         9.,
                                         9.11111111111111,
                                         9.,
                                         9.11111111111111,
                                         18.22222222222222,
                                         18.444444444444443,
                                         9.222222222222221,
                                         9.333333333333332,
                                         18.666666666666664,
                                         18.888888888888886,
                                         9.444444444444445,
                                         9.555555555555555,
                                         23.944444444444443,
                                         24.22222222222222,
                                         14.5,
                                         14.666666666666666,
                                         23.833333333333332,
                                         24.11111111111111,
                                         23.833333333333332,
                                         24.11111111111111,
                                         48.22222222222222,
                                         48.77777777777777,
                                         24.388888888888886,
                                         24.666666666666664,
                                         49.33333333333333,
                                         49.88888888888888,
                                         24.944444444444443,
                                         25.22222222222222,
                                         63.19444444444444,
                                         63.888888888888886,
                                         38.25,
                                         38.666666666666664,
                                         14.833333333333332,
                                         15.,
                                         14.833333333333332,
                                         15.,
                                         30.,
                                         30.333333333333332,
                                         15.166666666666666,
                                         15.333333333333332,
                                         30.666666666666664,
                                         31.,
                                         15.5,
                                         15.666666666666666,
                                         39.25,
                                         39.666666666666664,
                                         23.75,
                                         24.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x8x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.4444444444444444,
                                         0.6666666666666666,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.,
                                         0.,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         0.8888888888888888,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.6666666666666665,
                                         1.3333333333333333,
                                         1.5555555555555556,
                                         3.1111111111111107,
                                         3.5555555555555554,
                                         1.7777777777777777,
                                         2.,
                                         1.7777777777777777,
                                         2.,
                                         0.,
                                         0.,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.7777777777777777,
                                         2.,
                                         1.,
                                         1.1111111111111112,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         2.2222222222222223,
                                         2.444444444444444,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.222222222222222,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         1.8888888888888888,
                                         2.,
                                         1.8888888888888888,
                                         2.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.444444444444445,
                                         4.666666666666666,
                                         2.333333333333333,
                                         2.444444444444444,
                                         4.888888888888888,
                                         5.111111111111111,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         4.888888888888889,
                                         5.111111111111111,
                                         4.888888888888889,
                                         5.111111111111111,
                                         10.222222222222221,
                                         10.666666666666666,
                                         5.333333333333333,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.555555555555554,
                                         5.777777777777777,
                                         6.,
                                         5.777777777777777,
                                         6.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         5.777777777777778,
                                         6.,
                                         3.,
                                         3.1111111111111107,
                                         6.222222222222221,
                                         6.444444444444444,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.222222222222222,
                                         3.333333333333333,
                                         0.,
                                         0.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.222222222222221,
                                         6.444444444444445,
                                         12.888888888888888,
                                         13.333333333333332,
                                         6.666666666666666,
                                         6.888888888888888,
                                         13.777777777777777,
                                         14.222222222222221,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.111111111111111,
                                         7.333333333333333,
                                         0.,
                                         0.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         7.111111111111111,
                                         7.333333333333333,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         7.555555555555555,
                                         7.777777777777778,
                                         3.888888888888889,
                                         4.,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.111111111111111,
                                         4.222222222222222,
                                         8.444444444444443,
                                         8.666666666666668,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.11111111111111,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.555555555555555,
                                         4.666666666666666,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.111111111111111,
                                         4.222222222222222,
                                         8.444444444444443,
                                         8.666666666666668,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.88888888888889,
                                         9.11111111111111,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.555555555555555,
                                         4.666666666666666,
                                         0.,
                                         0.,
                                         8.88888888888889,
                                         9.11111111111111,
                                         8.88888888888889,
                                         9.11111111111111,
                                         18.22222222222222,
                                         18.666666666666668,
                                         9.333333333333332,
                                         9.555555555555555,
                                         19.11111111111111,
                                         19.555555555555554,
                                         9.777777777777779,
                                         10.,
                                         9.777777777777779,
                                         10.,
                                         0.,
                                         0.,
                                         4.777777777777778,
                                         4.888888888888888,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.777777777777779,
                                         10.,
                                         5.,
                                         5.111111111111111,
                                         10.222222222222221,
                                         10.444444444444443,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         10.222222222222221,
                                         10.444444444444443,
                                         10.222222222222221,
                                         10.444444444444443,
                                         20.888888888888886,
                                         21.333333333333332,
                                         10.666666666666666,
                                         10.88888888888889,
                                         21.777777777777775,
                                         22.22222222222222,
                                         11.11111111111111,
                                         11.333333333333332,
                                         11.11111111111111,
                                         11.333333333333332,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.555555555555554,
                                         11.777777777777779,
                                         5.888888888888888,
                                         6.,
                                         5.888888888888888,
                                         6.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.444444444444444,
                                         5.555555555555555,
                                         11.11111111111111,
                                         11.333333333333332,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.555555555555554,
                                         11.777777777777779,
                                         5.888888888888888,
                                         6.,
                                         5.888888888888888,
                                         6.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, SAME3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         3.1666666666666665,
                                         3.444444444444444,
                                         3.7222222222222223,
                                         4.,
                                         2.1666666666666665,
                                         2.333333333333333,
                                         2.5,
                                         2.6666666666666665,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         2.,
                                         2.2222222222222223,
                                         2.4444444444444446,
                                         2.666666666666667,
                                         4.888888888888888,
                                         5.333333333333333,
                                         5.777777777777778,
                                         6.222222222222221,
                                         2.8888888888888884,
                                         3.1111111111111107,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         6.666666666666666,
                                         7.111111111111111,
                                         7.555555555555555,
                                         8.,
                                         3.7777777777777777,
                                         4.,
                                         4.222222222222222,
                                         4.444444444444444,
                                         10.777777777777779,
                                         11.333333333333332,
                                         11.88888888888889,
                                         12.444444444444443,
                                         7.,
                                         7.333333333333333,
                                         7.666666666666666,
                                         8.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777777,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         7.611111111111111,
                                         7.888888888888889,
                                         8.166666666666666,
                                         8.444444444444443,
                                         4.833333333333333,
                                         5.,
                                         5.166666666666666,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         6.,
                                         6.222222222222222,
                                         5.555555555555555,
                                         5.777777777777778,
                                         6.,
                                         6.222222222222222,
                                         11.999999999999998,
                                         12.444444444444443,
                                         12.88888888888889,
                                         13.333333333333334,
                                         6.444444444444444,
                                         6.666666666666666,
                                         6.888888888888888,
                                         7.111111111111111,
                                         13.777777777777777,
                                         14.222222222222221,
                                         14.666666666666668,
                                         15.11111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         7.777777777777778,
                                         7.999999999999999,
                                         19.666666666666664,
                                         20.22222222222222,
                                         20.777777777777775,
                                         21.333333333333332,
                                         12.333333333333332,
                                         12.666666666666666,
                                         13.,
                                         13.333333333333332,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         7.777777777777777,
                                         8.,
                                         8.222222222222221,
                                         8.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         12.055555555555555,
                                         12.333333333333332,
                                         12.61111111111111,
                                         12.88888888888889,
                                         7.5,
                                         7.666666666666666,
                                         7.833333333333333,
                                         8.,
                                         11.833333333333332,
                                         12.11111111111111,
                                         12.38888888888889,
                                         12.666666666666666,
                                         11.833333333333332,
                                         12.11111111111111,
                                         12.38888888888889,
                                         12.666666666666666,
                                         24.777777777777775,
                                         25.333333333333332,
                                         25.888888888888886,
                                         26.444444444444443,
                                         12.944444444444443,
                                         13.222222222222221,
                                         13.5,
                                         13.777777777777777,
                                         27.,
                                         27.555555555555557,
                                         28.11111111111111,
                                         28.666666666666664,
                                         14.055555555555555,
                                         14.333333333333332,
                                         14.61111111111111,
                                         14.88888888888889,
                                         36.80555555555556,
                                         37.5,
                                         38.19444444444444,
                                         38.888888888888886,
                                         22.75,
                                         23.166666666666664,
                                         23.583333333333332,
                                         24.,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         8.166666666666666,
                                         8.333333333333332,
                                         8.5,
                                         8.666666666666666,
                                         17.,
                                         17.333333333333332,
                                         17.666666666666664,
                                         18.,
                                         8.833333333333332,
                                         9.,
                                         9.166666666666666,
                                         9.333333333333332,
                                         18.333333333333332,
                                         18.666666666666664,
                                         19.,
                                         19.333333333333332,
                                         9.5,
                                         9.666666666666666,
                                         9.833333333333332,
                                         10.,
                                         24.75,
                                         25.166666666666664,
                                         25.583333333333332,
                                         26.,
                                         15.25,
                                         15.5,
                                         15.75,
                                         16.,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         15.777777777777777,
                                         16.,
                                         16.22222222222222,
                                         16.444444444444443,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         20.944444444444443,
                                         21.22222222222222,
                                         21.5,
                                         21.77777777777778,
                                         12.833333333333332,
                                         13.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         15.777777777777777,
                                         16.,
                                         16.22222222222222,
                                         16.444444444444443,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         20.944444444444443,
                                         21.22222222222222,
                                         21.5,
                                         21.77777777777778,
                                         12.833333333333332,
                                         13.,
                                         13.166666666666666,
                                         13.333333333333332,
                                         16.22222222222222,
                                         16.444444444444443,
                                         16.666666666666664,
                                         16.888888888888886,
                                         16.22222222222222,
                                         16.444444444444443,
                                         16.666666666666664,
                                         16.888888888888886,
                                         33.33333333333333,
                                         33.77777777777778,
                                         34.22222222222222,
                                         34.666666666666664,
                                         17.11111111111111,
                                         17.333333333333332,
                                         17.555555555555554,
                                         17.77777777777778,
                                         35.11111111111111,
                                         35.55555555555556,
                                         36.,
                                         36.44444444444444,
                                         18.,
                                         18.22222222222222,
                                         18.444444444444443,
                                         18.666666666666664,
                                         46.33333333333333,
                                         46.888888888888886,
                                         47.44444444444444,
                                         48.,
                                         28.333333333333332,
                                         28.666666666666664,
                                         29.,
                                         29.333333333333332,
                                         9.,
                                         9.11111111111111,
                                         9.222222222222221,
                                         9.333333333333332,
                                         9.,
                                         9.11111111111111,
                                         9.222222222222221,
                                         9.333333333333332,
                                         18.444444444444443,
                                         18.666666666666664,
                                         18.888888888888886,
                                         19.111111111111107,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         19.333333333333332,
                                         19.555555555555557,
                                         19.77777777777778,
                                         20.,
                                         9.888888888888888,
                                         10.,
                                         10.11111111111111,
                                         10.222222222222221,
                                         25.388888888888886,
                                         25.666666666666664,
                                         25.944444444444443,
                                         26.22222222222222,
                                         15.5,
                                         15.666666666666666,
                                         15.833333333333332,
                                         16.,
                                         19.77777777777778,
                                         20.,
                                         20.22222222222222,
                                         20.444444444444443,
                                         19.77777777777778,
                                         20.,
                                         20.22222222222222,
                                         20.444444444444443,
                                         40.44444444444444,
                                         40.888888888888886,
                                         41.33333333333333,
                                         41.77777777777777,
                                         20.666666666666664,
                                         20.888888888888886,
                                         21.11111111111111,
                                         21.333333333333332,
                                         42.22222222222222,
                                         42.666666666666664,
                                         43.11111111111111,
                                         43.55555555555556,
                                         21.555555555555554,
                                         21.77777777777778,
                                         22.,
                                         22.22222222222222,
                                         55.222222222222214,
                                         55.77777777777777,
                                         56.33333333333333,
                                         56.888888888888886,
                                         33.666666666666664,
                                         34.,
                                         34.33333333333333,
                                         34.666666666666664,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555557,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         29.83333333333333,
                                         30.111111111111107,
                                         30.388888888888886,
                                         30.666666666666664,
                                         18.166666666666664,
                                         18.333333333333332,
                                         18.5,
                                         18.666666666666664,
                                         29.611111111111107,
                                         29.888888888888886,
                                         30.166666666666664,
                                         30.444444444444443,
                                         29.611111111111107,
                                         29.888888888888886,
                                         30.166666666666664,
                                         30.444444444444443,
                                         60.33333333333333,
                                         60.888888888888886,
                                         61.44444444444444,
                                         62.,
                                         30.72222222222222,
                                         30.999999999999996,
                                         31.27777777777778,
                                         31.555555555555557,
                                         62.55555555555555,
                                         63.1111111111111,
                                         63.666666666666664,
                                         64.22222222222223,
                                         31.83333333333333,
                                         32.11111111111111,
                                         32.388888888888886,
                                         32.666666666666664,
                                         81.25,
                                         81.94444444444444,
                                         82.63888888888889,
                                         83.33333333333333,
                                         49.416666666666664,
                                         49.83333333333333,
                                         50.25,
                                         50.666666666666664,
                                         18.833333333333332,
                                         19.,
                                         19.166666666666664,
                                         19.333333333333332,
                                         18.833333333333332,
                                         19.,
                                         19.166666666666664,
                                         19.333333333333332,
                                         38.33333333333333,
                                         38.666666666666664,
                                         39.,
                                         39.33333333333333,
                                         19.5,
                                         19.666666666666664,
                                         19.833333333333332,
                                         20.,
                                         39.666666666666664,
                                         40.,
                                         40.33333333333333,
                                         40.666666666666664,
                                         20.166666666666664,
                                         20.333333333333332,
                                         20.5,
                                         20.666666666666664,
                                         51.416666666666664,
                                         51.83333333333333,
                                         52.25,
                                         52.666666666666664,
                                         31.25,
                                         31.5,
                                         31.75,
                                         32.,
                                         14.333333333333332,
                                         14.444444444444443,
                                         14.555555555555555,
                                         14.666666666666666,
                                         14.333333333333332,
                                         14.444444444444443,
                                         14.555555555555555,
                                         14.666666666666666,
                                         29.111111111111107,
                                         29.33333333333333,
                                         29.555555555555557,
                                         29.77777777777778,
                                         14.777777777777777,
                                         14.888888888888888,
                                         15.,
                                         15.11111111111111,
                                         30.,
                                         30.22222222222222,
                                         30.444444444444443,
                                         30.666666666666664,
                                         15.222222222222221,
                                         15.333333333333332,
                                         15.444444444444443,
                                         15.555555555555555,
                                         38.72222222222222,
                                         39.,
                                         39.27777777777777,
                                         39.55555555555556,
                                         23.5,
                                         23.666666666666664,
                                         23.833333333333332,
                                         24.,
                                         14.333333333333332,
                                         14.444444444444443,
                                         14.555555555555555,
                                         14.666666666666666,
                                         14.333333333333332,
                                         14.444444444444443,
                                         14.555555555555555,
                                         14.666666666666666,
                                         29.111111111111107,
                                         29.33333333333333,
                                         29.555555555555557,
                                         29.77777777777778,
                                         14.777777777777777,
                                         14.888888888888888,
                                         15.,
                                         15.11111111111111,
                                         30.,
                                         30.22222222222222,
                                         30.444444444444443,
                                         30.666666666666664,
                                         15.222222222222221,
                                         15.333333333333332,
                                         15.444444444444443,
                                         15.555555555555555,
                                         38.72222222222222,
                                         39.,
                                         39.27777777777777,
                                         39.55555555555556,
                                         23.5,
                                         23.666666666666664,
                                         23.833333333333332,
                                         24.,
                                         30.444444444444443,
                                         30.666666666666664,
                                         30.888888888888886,
                                         31.111111111111107,
                                         30.444444444444443,
                                         30.666666666666664,
                                         30.888888888888886,
                                         31.111111111111107,
                                         61.77777777777777,
                                         62.222222222222214,
                                         62.666666666666664,
                                         63.111111111111114,
                                         31.33333333333333,
                                         31.55555555555555,
                                         31.77777777777778,
                                         32.,
                                         63.55555555555556,
                                         64.,
                                         64.44444444444444,
                                         64.88888888888889,
                                         32.22222222222222,
                                         32.44444444444444,
                                         32.666666666666664,
                                         32.888888888888886,
                                         81.88888888888889,
                                         82.44444444444444,
                                         83.,
                                         83.55555555555554,
                                         49.666666666666664,
                                         50.,
                                         50.33333333333333,
                                         50.666666666666664,
                                         16.11111111111111,
                                         16.22222222222222,
                                         16.333333333333332,
                                         16.444444444444443,
                                         16.11111111111111,
                                         16.22222222222222,
                                         16.333333333333332,
                                         16.444444444444443,
                                         32.666666666666664,
                                         32.888888888888886,
                                         33.111111111111114,
                                         33.33333333333333,
                                         16.555555555555554,
                                         16.666666666666664,
                                         16.77777777777778,
                                         16.88888888888889,
                                         33.55555555555556,
                                         33.77777777777777,
                                         34.,
                                         34.22222222222222,
                                         17.,
                                         17.11111111111111,
                                         17.22222222222222,
                                         17.333333333333332,
                                         43.166666666666664,
                                         43.44444444444444,
                                         43.72222222222222,
                                         44.,
                                         26.166666666666664,
                                         26.333333333333332,
                                         26.5,
                                         26.666666666666664,
                                         34.,
                                         34.22222222222222,
                                         34.44444444444444,
                                         34.666666666666664,
                                         34.,
                                         34.22222222222222,
                                         34.44444444444444,
                                         34.666666666666664,
                                         68.88888888888889,
                                         69.33333333333333,
                                         69.77777777777779,
                                         70.22222222222221,
                                         34.888888888888886,
                                         35.11111111111111,
                                         35.33333333333333,
                                         35.55555555555556,
                                         70.66666666666666,
                                         71.1111111111111,
                                         71.55555555555556,
                                         72.,
                                         35.77777777777777,
                                         36.,
                                         36.22222222222222,
                                         36.44444444444444,
                                         90.77777777777777,
                                         91.33333333333333,
                                         91.88888888888889,
                                         92.44444444444444,
                                         55.,
                                         55.33333333333333,
                                         55.666666666666664,
                                         56.,
                                         17.88888888888889,
                                         18.,
                                         18.11111111111111,
                                         18.22222222222222,
                                         17.88888888888889,
                                         18.,
                                         18.11111111111111,
                                         18.22222222222222,
                                         36.22222222222222,
                                         36.44444444444444,
                                         36.666666666666664,
                                         36.888888888888886,
                                         18.333333333333332,
                                         18.444444444444443,
                                         18.555555555555554,
                                         18.666666666666664,
                                         37.11111111111111,
                                         37.33333333333333,
                                         37.55555555555556,
                                         37.77777777777777,
                                         18.777777777777775,
                                         18.88888888888889,
                                         19.,
                                         19.11111111111111,
                                         47.61111111111111,
                                         47.888888888888886,
                                         48.166666666666664,
                                         48.44444444444444,
                                         28.833333333333332,
                                         29.,
                                         29.166666666666664,
                                         29.333333333333332,
                                         47.388888888888886,
                                         47.666666666666664,
                                         47.94444444444444,
                                         48.22222222222222,
                                         47.388888888888886,
                                         47.666666666666664,
                                         47.94444444444444,
                                         48.22222222222222,
                                         95.88888888888889,
                                         96.44444444444444,
                                         97.,
                                         97.55555555555554,
                                         48.5,
                                         48.77777777777777,
                                         49.05555555555556,
                                         49.33333333333333,
                                         98.1111111111111,
                                         98.66666666666666,
                                         99.22222222222223,
                                         99.77777777777776,
                                         49.61111111111111,
                                         49.888888888888886,
                                         50.166666666666664,
                                         50.44444444444444,
                                         125.69444444444444,
                                         126.38888888888889,
                                         127.08333333333333,
                                         127.77777777777777,
                                         76.08333333333333,
                                         76.5,
                                         76.91666666666666,
                                         77.33333333333333,
                                         29.5,
                                         29.666666666666664,
                                         29.833333333333332,
                                         30.,
                                         29.5,
                                         29.666666666666664,
                                         29.833333333333332,
                                         30.,
                                         59.666666666666664,
                                         60.,
                                         60.33333333333333,
                                         60.666666666666664,
                                         30.166666666666664,
                                         30.333333333333332,
                                         30.5,
                                         30.666666666666664,
                                         61.,
                                         61.33333333333333,
                                         61.666666666666664,
                                         62.,
                                         30.833333333333332,
                                         31.,
                                         31.166666666666664,
                                         31.333333333333332,
                                         78.08333333333333,
                                         78.5,
                                         78.91666666666666,
                                         79.33333333333333,
                                         47.25,
                                         47.5,
                                         47.75,
                                         48.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(AvgWindow3Stride2Grad, VALID3x8x8x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.1111111111111111,
                                         0.2222222222222222,
                                         0.3333333333333333,
                                         0.4444444444444444,
                                         0.6666666666666667,
                                         0.8888888888888888,
                                         1.111111111111111,
                                         1.3333333333333333,
                                         0.5555555555555556,
                                         0.6666666666666666,
                                         0.7777777777777777,
                                         0.8888888888888888,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         1.,
                                         1.1111111111111112,
                                         1.222222222222222,
                                         1.3333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         1.5555555555555556,
                                         1.7777777777777777,
                                         1.9999999999999998,
                                         2.2222222222222223,
                                         4.,
                                         4.444444444444445,
                                         4.888888888888889,
                                         5.333333333333333,
                                         2.4444444444444446,
                                         2.6666666666666665,
                                         2.888888888888889,
                                         3.111111111111111,
                                         5.777777777777778,
                                         6.222222222222221,
                                         6.666666666666666,
                                         7.111111111111111,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         1.4444444444444444,
                                         1.5555555555555554,
                                         1.6666666666666665,
                                         1.7777777777777777,
                                         3.333333333333333,
                                         3.5555555555555554,
                                         3.7777777777777777,
                                         4.,
                                         1.8888888888888888,
                                         2.,
                                         2.111111111111111,
                                         2.2222222222222223,
                                         4.222222222222221,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888889,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         2.333333333333333,
                                         2.444444444444444,
                                         2.5555555555555554,
                                         2.6666666666666665,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         4.222222222222222,
                                         4.444444444444445,
                                         4.666666666666666,
                                         4.888888888888888,
                                         9.333333333333332,
                                         9.777777777777779,
                                         10.222222222222221,
                                         10.666666666666666,
                                         5.111111111111111,
                                         5.333333333333333,
                                         5.555555555555555,
                                         5.777777777777778,
                                         11.111111111111109,
                                         11.555555555555555,
                                         12.,
                                         12.444444444444445,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         2.7777777777777777,
                                         2.888888888888889,
                                         3.,
                                         3.1111111111111107,
                                         6.,
                                         6.222222222222221,
                                         6.444444444444445,
                                         6.666666666666666,
                                         3.222222222222222,
                                         3.333333333333333,
                                         3.444444444444444,
                                         3.5555555555555554,
                                         6.888888888888888,
                                         7.111111111111111,
                                         7.333333333333333,
                                         7.555555555555555,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         3.6666666666666665,
                                         3.7777777777777777,
                                         3.888888888888889,
                                         4.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         4.111111111111111,
                                         4.222222222222222,
                                         4.333333333333333,
                                         4.444444444444445,
                                         8.666666666666666,
                                         8.88888888888889,
                                         9.11111111111111,
                                         9.333333333333332,
                                         4.555555555555555,
                                         4.666666666666666,
                                         4.777777777777778,
                                         4.888888888888888,
                                         9.555555555555555,
                                         9.777777777777777,
                                         10.,
                                         10.222222222222221,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         5.,
                                         5.111111111111111,
                                         5.222222222222222,
                                         5.333333333333333,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         9.555555555555554,
                                         9.777777777777779,
                                         10.,
                                         10.222222222222221,
                                         9.555555555555554,
                                         9.777777777777779,
                                         10.,
                                         10.222222222222221,
                                         20.,
                                         20.444444444444443,
                                         20.888888888888886,
                                         21.333333333333332,
                                         10.444444444444443,
                                         10.666666666666666,
                                         10.88888888888889,
                                         11.11111111111111,
                                         21.777777777777775,
                                         22.22222222222222,
                                         22.666666666666664,
                                         23.111111111111107,
                                         11.333333333333332,
                                         11.555555555555554,
                                         11.777777777777779,
                                         12.,
                                         11.333333333333332,
                                         11.555555555555554,
                                         11.777777777777779,
                                         12.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         5.444444444444444,
                                         5.555555555555555,
                                         5.666666666666666,
                                         5.777777777777778,
                                         11.333333333333332,
                                         11.555555555555555,
                                         11.777777777777777,
                                         12.,
                                         5.888888888888888,
                                         6.,
                                         6.111111111111111,
                                         6.222222222222221,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.888888888888888,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         6.333333333333333,
                                         6.444444444444444,
                                         6.555555555555555,
                                         6.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         12.222222222222221,
                                         12.444444444444443,
                                         12.666666666666666,
                                         12.88888888888889,
                                         25.333333333333332,
                                         25.777777777777775,
                                         26.22222222222222,
                                         26.666666666666664,
                                         13.11111111111111,
                                         13.333333333333332,
                                         13.555555555555554,
                                         13.777777777777777,
                                         27.111111111111107,
                                         27.555555555555554,
                                         28.,
                                         28.444444444444443,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         6.777777777777778,
                                         6.888888888888888,
                                         7.,
                                         7.111111111111111,
                                         14.,
                                         14.222222222222221,
                                         14.444444444444443,
                                         14.666666666666666,
                                         7.222222222222221,
                                         7.333333333333333,
                                         7.444444444444444,
                                         7.555555555555555,
                                         14.888888888888888,
                                         15.11111111111111,
                                         15.333333333333332,
                                         15.555555555555555,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         7.666666666666666,
                                         7.777777777777778,
                                         7.888888888888888,
                                         8.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         16.666666666666664,
                                         16.888888888888886,
                                         17.111111111111107,
                                         17.333333333333336,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         17.555555555555557,
                                         17.77777777777778,
                                         18.,
                                         18.22222222222222,
                                         9.,
                                         9.11111111111111,
                                         9.222222222222221,
                                         9.333333333333332,
                                         9.,
                                         9.11111111111111,
                                         9.222222222222221,
                                         9.333333333333332,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         8.11111111111111,
                                         8.222222222222221,
                                         8.333333333333332,
                                         8.444444444444445,
                                         16.666666666666664,
                                         16.888888888888886,
                                         17.111111111111107,
                                         17.333333333333336,
                                         8.555555555555555,
                                         8.666666666666666,
                                         8.777777777777777,
                                         8.88888888888889,
                                         17.555555555555557,
                                         17.77777777777778,
                                         18.,
                                         18.22222222222222,
                                         9.,
                                         9.11111111111111,
                                         9.222222222222221,
                                         9.333333333333332,
                                         9.,
                                         9.11111111111111,
                                         9.222222222222221,
                                         9.333333333333332,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         17.555555555555557,
                                         17.77777777777778,
                                         18.,
                                         18.22222222222222,
                                         17.555555555555557,
                                         17.77777777777778,
                                         18.,
                                         18.22222222222222,
                                         35.99999999999999,
                                         36.44444444444444,
                                         36.888888888888886,
                                         37.333333333333336,
                                         18.444444444444443,
                                         18.666666666666664,
                                         18.888888888888886,
                                         19.11111111111111,
                                         37.77777777777777,
                                         38.22222222222222,
                                         38.666666666666664,
                                         39.11111111111111,
                                         19.333333333333332,
                                         19.555555555555557,
                                         19.77777777777778,
                                         20.,
                                         19.333333333333332,
                                         19.555555555555557,
                                         19.77777777777778,
                                         20.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         9.444444444444445,
                                         9.555555555555555,
                                         9.666666666666666,
                                         9.777777777777777,
                                         19.333333333333332,
                                         19.555555555555557,
                                         19.77777777777778,
                                         20.,
                                         9.888888888888888,
                                         10.,
                                         10.11111111111111,
                                         10.222222222222221,
                                         20.22222222222222,
                                         20.444444444444443,
                                         20.666666666666664,
                                         20.888888888888886,
                                         10.333333333333332,
                                         10.444444444444445,
                                         10.555555555555555,
                                         10.666666666666666,
                                         10.333333333333332,
                                         10.444444444444445,
                                         10.555555555555555,
                                         10.666666666666666,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         20.22222222222222,
                                         20.444444444444443,
                                         20.666666666666664,
                                         20.888888888888886,
                                         20.22222222222222,
                                         20.444444444444443,
                                         20.666666666666664,
                                         20.888888888888886,
                                         41.33333333333333,
                                         41.77777777777777,
                                         42.22222222222222,
                                         42.666666666666664,
                                         21.111111111111107,
                                         21.333333333333332,
                                         21.555555555555557,
                                         21.77777777777778,
                                         43.11111111111111,
                                         43.55555555555555,
                                         43.99999999999999,
                                         44.44444444444444,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555557,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         10.777777777777777,
                                         10.888888888888888,
                                         11.,
                                         11.11111111111111,
                                         22.,
                                         22.22222222222222,
                                         22.444444444444443,
                                         22.666666666666664,
                                         11.222222222222221,
                                         11.333333333333332,
                                         11.444444444444445,
                                         11.555555555555555,
                                         22.888888888888886,
                                         23.111111111111107,
                                         23.333333333333332,
                                         23.555555555555557,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         11.666666666666666,
                                         11.777777777777777,
                                         11.888888888888888,
                                         12.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.,
                                         0.};
  const std::array<int, 4> in_shape = {{3, 8, 8, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<3, 2>(in_shape, padding);
  const DataType max_input_val = 2048.0;
  this->test_pool(exp_out, params, max_input_val);
}
