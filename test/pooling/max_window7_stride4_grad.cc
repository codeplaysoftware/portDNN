/*
 * Copyright Codeplay Software Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use these files except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

// DO NOT MODIFY BY HAND
// This file was automatically generated by generate_pooling_tests.py.
// Results calculated using Tensorflow v1.13.2.

#include <gtest/gtest.h>

#include "sycldnn/padding_mode.h"

#include "sycldnn/pooling/operators.h"

#include "test/types/cartesian_product.h"
#include "test/types/kernel_data_types.h"
#include "test/types/test_backend_types.h"
#include "test/types/to_gtest_types.h"

#include "test/pooling/pooling_fixture.h"

#include <array>
#include <vector>

using namespace sycldnn;  // NOLINT(google-build-using-namespace)
using DataTypeList = sycldnn::types::KernelDataTypes;
using Backends = sycldnn::types::DefaultBackendTypes;

using SNNTypePairs =
    sycldnn::types::CartesianProduct<DataTypeList, Backends>::type;
using GTestTypePairs = sycldnn::types::ToGTestTypes<SNNTypePairs>::type;

template <typename Pair>
using MaxWindow7Stride4Grad =
    PoolingFixture<typename Pair::FirstType, typename Pair::SecondType,
                   pooling::Max, pooling::Backpropagate>;
TYPED_TEST_SUITE(MaxWindow7Stride4Grad, GTestTypePairs);
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0.,
      3., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 4., 0., 0., 0., 5., 0., 6., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 7., 0., 0., 0., 8., 0., 9.};
  const std::array<int, 4> in_shape = {{1, 11, 11, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 4.};
  const std::array<int, 4> in_shape = {{1, 11, 11, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      1.,  2.,  0., 0., 0.,  0.,  0., 0., 3., 4., 0., 0., 5.,  6.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 7., 8., 0., 0., 0.,  0.,  0., 0.,
      9.,  10., 0., 0., 11., 12., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 13., 14., 0., 0., 0., 0., 0., 0., 15., 16., 0., 0.,
      17., 18.};
  const std::array<int, 4> in_shape = {{1, 11, 11, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5., 6.,
      0., 0., 0., 0., 0., 0., 7., 8.};
  const std::array<int, 4> in_shape = {{1, 11, 11, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      1.,  2.,  3.,  4.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      5.,  6.,  7.,  8.,  0., 0., 0., 0., 9.,  10., 11., 12., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      13., 14., 15., 16., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      17., 18., 19., 20., 0., 0., 0., 0., 21., 22., 23., 24., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 25., 26., 27., 28., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 29., 30., 31., 32., 0., 0., 0., 0.,
      33., 34., 35., 36.};
  const std::array<int, 4> in_shape = {{1, 11, 11, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 1.,
      2., 3., 4., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 5., 6.,
      7., 8., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  9.,  10., 11., 12., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 13., 14., 15., 16.};
  const std::array<int, 4> in_shape = {{1, 11, 11, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 1., 0., 0., 0., 2., 0., 3., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 4.,
      0., 0., 0., 5., 0., 6., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 7., 0., 0., 0., 8., 0., 9.};
  const std::array<int, 4> in_shape = {{1, 11, 12, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 4., 0.};
  const std::array<int, 4> in_shape = {{1, 11, 12, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  1.,  2., 0., 0.,  0., 0., 0.,  0.,  3.,  4.,  0., 0., 5.,
      6., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 7., 8.,
      0., 0., 0., 0.,  0.,  0., 9., 10., 0., 0., 11., 12., 0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  13., 14., 0., 0., 0.,
      0., 0., 0., 15., 16., 0., 0., 17., 18.};
  const std::array<int, 4> in_shape = {{1, 11, 12, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 2., 0., 0., 0., 0.,
      0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 11, 12, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 1.,  2.,  3.,  4.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 5.,  6.,  7.,  8.,  0., 0., 0., 0., 9.,  10., 11., 12.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 13., 14., 15., 16., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 17., 18., 19., 20., 0., 0., 0., 0., 21., 22., 23., 24.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 25., 26., 27., 28., 0., 0., 0., 0., 62., 64., 66., 68.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{1, 11, 12, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 1., 2., 3., 4., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 5., 6., 7., 8., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12., 13., 14.,
      15., 16., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.};
  const std::array<int, 4> in_shape = {{1, 11, 12, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 1., 0., 0.,  0., 2., 0., 0., 0., 3., 4., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0., 0., 5.,  0., 0., 0., 6., 0., 0., 0., 7., 8.,
      0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      9., 0., 0., 0., 10., 0., 0., 0., 11., 12.};
  const std::array<int, 4> in_shape = {{1, 11, 14, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 3., 0., 0., 0., 4., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 11, 14, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 1.,  2.,  0.,  0.,  0., 0., 0., 0.,
      3.,  4.,  0.,  0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 9.,  10., 0.,  0.,  0., 0., 0., 0.,
      11., 12., 0.,  0., 0., 0., 0., 0., 13., 14., 15., 16., 0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0.,
      17., 18., 0.,  0., 0., 0., 0., 0., 19., 20., 0.,  0.,  0., 0., 0., 0.,
      21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 11, 14, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0.,
      0., 0.};
  const std::array<int, 4> in_shape = {{1, 11, 14, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x11x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  9.,  10., 11., 12., 13., 14., 15., 16., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  17.,
      18., 19., 20., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      58., 60., 62., 64., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  66., 68., 70., 72., 74., 76., 78., 80., 0.,  0., 0., 0., 33., 34.,
      35., 36., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0.,  0.,
      0.};
  const std::array<int, 4> in_shape = {{1, 11, 14, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x11x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 1., 2., 3., 4., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  5., 6., 7., 8., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  9.,  10.,
      11., 12., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0.};
  const std::array<int, 4> in_shape = {{1, 11, 14, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 3., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 4., 0., 0., 0., 5., 0., 6., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 7., 0., 0., 0., 8., 0., 9.};
  const std::array<int, 4> in_shape = {{1, 12, 11, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 3., 0., 0.,
      0., 4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 11, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 1.,  2.,  0., 0., 0.,  0.,  0., 0., 3., 4.,
      0., 0., 5.,  6.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 7., 8.,
      0., 0., 0.,  0.,  0., 0., 9.,  10., 0., 0., 11., 12., 0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 13., 14., 0., 0., 0., 0.,
      0., 0., 15., 16., 0., 0., 17., 18.};
  const std::array<int, 4> in_shape = {{1, 12, 11, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5., 6.,
      0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 11, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 1.,  2.,  3.,  4.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 5.,  6.,  7.,  8.,
      0., 0., 0., 0., 9.,  10., 11., 12., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 13., 14., 15., 16.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 17., 18., 19., 20.,
      0., 0., 0., 0., 21., 22., 23., 24., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 25., 26., 27., 28., 0., 0., 0., 0., 62., 64., 66., 68.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{1, 12, 11, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 1.,
      2., 3., 4., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 5., 6.,
      7., 8., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  9.,  10., 11., 12., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 13., 14., 15., 16., 0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0.};
  const std::array<int, 4> in_shape = {{1, 12, 11, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 3.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 4., 0., 0., 0., 5., 0., 6., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 7., 0., 0., 0., 8., 0., 9.};
  const std::array<int, 4> in_shape = {{1, 12, 12, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      3., 0., 0., 0., 4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 12, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  1.,  2., 0., 0.,  0., 0.,
      0.,  0.,  3.,  4.,  0., 0., 5., 6., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 7., 8., 0., 0., 0., 0.,  0.,  0., 9., 10., 0., 0.,
      11., 12., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,  0., 0.,
      0.,  0.,  13., 14., 0., 0., 0., 0., 0., 0., 15., 16., 0., 0., 17., 18.};
  const std::array<int, 4> in_shape = {{1, 12, 12, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 2., 0., 0., 0., 0.,
      0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 12, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 1.,  2.,  3.,  4.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 5.,  6.,  7.,  8.,  0., 0., 0., 0., 9.,  10., 11., 12.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 13., 14., 15., 16., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 17., 18., 19., 20., 0., 0., 0., 0., 21., 22., 23., 24.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 25., 26., 27., 28., 0., 0., 0., 0., 62., 64., 66., 68.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{1, 12, 12, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 1., 2., 3., 4., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 5., 6., 7., 8., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12., 13., 14.,
      15., 16., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{1, 12, 12, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,  2., 0., 0., 0.,  3., 4., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 5., 0., 0.,  0., 6., 0.,
      0., 0., 7., 8., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 9., 0., 0., 0., 10., 0., 0., 0., 11., 12.};
  const std::array<int, 4> in_shape = {{1, 12, 14, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 4., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 14, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 1.,  2.,  0.,  0.,  0., 0., 0., 0., 3.,  4.,  0.,  0.,
      0., 0., 0., 0., 5.,  6.,  7.,  8.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 9.,  10., 0.,  0.,  0., 0., 0., 0., 11., 12., 0.,  0.,
      0., 0., 0., 0., 13., 14., 15., 16., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 17., 18., 0.,  0.,
      0., 0., 0., 0., 19., 20., 0.,  0.,  0., 0., 0., 0., 21., 22., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 12, 14, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 14, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x12x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 1., 2., 3.,  4.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 5., 6.,  7.,
      8.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 9.,  10.,
      11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      58., 60., 62., 64., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  66., 68., 70., 72., 74., 76., 78., 80., 0., 0., 0., 0., 50., 52.,
      54., 56., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 14, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x12x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 1., 2., 3., 4., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  5., 6., 7., 8., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  9.,  10.,
      11., 12., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 12, 14, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 1., 0., 0., 0., 2., 0.,
      3., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 4., 0.,  0., 0., 5., 0.,  6., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 7., 0., 0., 0., 8., 0., 9., 0.,
      0., 0., 0., 10., 0., 0., 0., 11., 0., 12.};
  const std::array<int, 4> in_shape = {{1, 14, 11, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 4., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 11, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 1.,  2., 0., 0.,  0.,  0.,  0., 0.,  3.,
      4.,  0.,  0.,  5.,  6., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  7., 8., 0.,  0., 0., 0.,  0.,  0.,  9., 10., 0.,
      0.,  11., 12., 0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,
      0.,  0.,  13., 14., 0., 0., 0.,  0., 0., 0.,  15., 16., 0., 0.,  17.,
      18., 0.,  0.,  0.,  0., 0., 0.,  0., 0., 19., 20., 0.,  0., 0.,  0.,
      0.,  0.,  21., 22., 0., 0., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 14, 11, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 5., 6.,
      0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 11, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  1.,  2.,  3.,  4.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  5.,  6.,
      7.,  8.,  0.,  0.,  0.,   0.,   9.,   10.,  11., 12., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  13.,  14.,  15.,  16.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   17.,  18.,  19., 20., 0.,  0.,  0.,  0.,
      21., 22., 23., 24., 0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  62., 64., 66., 68.,
      0.,  0.,  0.,  0.,  148., 152., 156., 160., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{1, 14, 11, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 1.,
      2., 3., 4., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 5., 6.,
      7., 8., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  9.,  10., 11., 12., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 13., 14., 15., 16., 0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 11, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 1., 0., 0., 0., 2., 0., 3.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 4.,
      0., 0., 0., 5., 0., 6., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  7., 0., 0., 0.,
      8., 0., 9., 0., 0., 0., 0., 0., 10., 0., 0., 0., 11., 0., 12.};
  const std::array<int, 4> in_shape = {{1, 14, 12, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 2., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 4., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 12, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 1.,  2.,  0., 0., 0.,  0.,
      0., 0., 3.,  4.,  0., 0., 5.,  6.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 7.,  8.,  0., 0., 0.,  0.,
      0., 0., 9.,  10., 0., 0., 11., 12., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 13., 14., 0., 0., 0.,  0.,
      0., 0., 15., 16., 0., 0., 17., 18., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 19., 20., 0., 0., 0.,  0.,  0., 0., 21., 22., 0., 0., 23., 24.};
  const std::array<int, 4> in_shape = {{1, 14, 12, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 2., 0., 0., 0., 0.,
      0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 12, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  1.,  2.,  3.,   4.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  5.,   6.,   7.,   8.,   0.,  0.,  0.,  0.,  9.,  10.,
      11., 12., 0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  13., 14.,
      15., 16., 0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      17., 18., 19., 20., 0.,   0.,   0.,   0.,   21., 22., 23., 24., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  62., 64., 66., 68.,
      0.,  0.,  0.,  0.,  148., 152., 156., 160., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{1, 14, 12, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 1., 2., 3., 4., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 5., 6., 7., 8., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 9., 10., 11., 12., 13., 14.,
      15., 16., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 12, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 1., 0.,  0.,  0., 2., 0., 0., 0.,
      3., 4., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 5., 0., 0.,
      0., 6., 0., 0.,  0., 7., 8.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0.,
      0., 0., 9., 0.,  0., 0., 10., 0.,  0., 0., 11., 12., 0., 0., 0., 0., 13.,
      0., 0., 0., 14., 0., 0., 0.,  15., 16.};
  const std::array<int, 4> in_shape = {{1, 14, 14, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 3., 0., 0., 0., 4., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 14, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 1.,  2.,  0.,  0.,  0.,  0.,  0., 0.,
      3.,  4.,  0., 0., 0.,  0.,  0.,  0., 5.,  6.,  7.,  8.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 9.,  10., 0.,  0.,  0.,  0.,  0., 0.,
      11., 12., 0., 0., 0.,  0.,  0.,  0., 13., 14., 15., 16., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 0.,  0.,  0.,  0., 17., 18., 0.,  0.,  0.,  0.,  0., 0.,
      19., 20., 0., 0., 0.,  0.,  0.,  0., 21., 22., 23., 24., 0.,  0.,  0., 0.,
      0.,  0.,  0., 0., 25., 26., 0.,  0., 0.,  0.,  0.,  0.,  27., 28., 0., 0.,
      0.,  0.,  0., 0., 29., 30., 31., 32.};
  const std::array<int, 4> in_shape = {{1, 14, 14, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 2., 0., 0., 0., 0., 0., 0., 3., 4., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 5., 6., 0., 0., 0., 0., 0., 0., 7., 8., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{1, 14, 14, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME1x14x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  9.,  10., 11., 12., 13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  17.,
      18., 19., 20., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      58., 60., 62., 64., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  66., 68., 70., 72., 74., 76., 78., 80., 0.,  0.,  0.,  0.,  33., 34.,
      35., 36., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  49., 50., 51., 52., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  53., 54., 55., 56., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  57., 58., 59., 60.,
      61., 62., 63., 64.};
  const std::array<int, 4> in_shape = {{1, 14, 14, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID1x14x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 1., 2., 3., 4., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  5., 6., 7., 8., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 13., 14., 15., 16., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  9.,  10.,
      11., 12., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,
      0.,  0.};
  const std::array<int, 4> in_shape = {{1, 14, 14, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      1., 0.,  0.,  0., 2.,  0.,  3.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  4., 0.,  0.,  0.,
      5., 0.,  6.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  7.,  0., 0.,  0.,  8.,  0., 9.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  10., 0., 0.,  0., 11., 0.,  12.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  13., 0.,  0., 0.,  14., 0., 15., 0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 16., 0., 0.,  0.,  17.,
      0., 18., 0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  19., 0., 0.,  0.,  20., 0., 21., 0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  22., 0.,
      0., 0.,  23., 0., 24., 0.,  0.,  0., 0.,  0.,  0., 0.,  0., 0.,  0.,  0.,
      0., 0.,  0.,  0., 25., 0.,  0.,  0., 26., 0.,  27.};
  const std::array<int, 4> in_shape = {{3, 11, 11, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      1., 0., 0., 0., 2., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 4.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  5., 0., 0., 0.,  6.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 7., 0., 0., 0., 8., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9., 0., 0., 0., 10., 0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 11., 0.,
      0., 0., 12.};
  const std::array<int, 4> in_shape = {{3, 11, 11, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  0.,  0.,  0.,  0.,  0.,  0.,  3.,
      4.,  0.,  0.,  5.,  6.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  7.,  8.,  0.,  0.,  0.,  0.,  0.,  0.,  9.,  10., 0.,
      0.,  11., 12., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  13., 14., 0.,  0.,  0.,  0.,  0.,  0.,  15., 16., 0.,  0.,
      17., 18., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  19., 20., 0.,  0.,  0.,  0.,  0.,
      0.,  21., 22., 0.,  0.,  23., 24., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  25., 26., 0.,  0.,  0.,  0.,  0.,  0.,  27.,
      28., 0.,  0.,  29., 30., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  31., 32., 0.,  0.,  0.,  0.,  0.,  0.,  33., 34.,
      0.,  0.,  35., 36., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  41., 42., 0.,  0.,  0.,  0.,
      76., 78., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  43., 44., 0.,  0.,  0.,  0.,  0.,
      0.,  45., 46., 0.,  0.,  47., 48., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  49., 50., 0.,  0.,  0.,  0.,  0.,  0.,
      51., 52., 0.,  0.,  53., 54.};
  const std::array<int, 4> in_shape = {{3, 11, 11, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      1., 2., 0.,  0.,  0.,  0., 0., 0., 3.,  4.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 5.,  6.,  0.,  0.,  0.,  0.,  0.,  0.,
      7., 8., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 9.,  10., 0.,  0., 0., 0., 0.,  0.,  11., 12., 0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  13., 14., 0.,  0.,  0.,  0.,
      0., 0., 15., 16., 0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 19., 20., 0.,  0.,  0.,  0.,  17., 18.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0.,  0., 0., 0., 0.,  0.,  0.,  0.,  21., 22., 0.,  0.,
      0., 0., 0.,  0.,  23., 24.};
  const std::array<int, 4> in_shape = {{3, 11, 11, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,
      4.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      5.,   6.,  7.,  8.,  0.,  0.,   0.,   0.,   9.,   10.,  11.,  12.,  0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  13., 14.,  15.,  16.,  0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   17.,  18.,  19.,  20.,  0.,   0.,
      0.,   0.,  21., 22., 23., 24.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   25., 26., 27., 28., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  29., 30.,  31.,  32.,  0.,   0.,   0.,   0.,   33.,
      34.,  35., 36., 0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   37.,  38.,  39.,  40.,  0.,   0.,   0.,
      0.,   86., 88., 90., 92., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   49.,  50.,  51.,  52.,  0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   53.,  54.,  55.,
      56.,  0.,  0.,  0.,  0.,  57.,  58.,  59.,  60.,  0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  61., 62.,  63.,  64.,  0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   65.,  66.,  67.,  68.,  0.,   0.,
      0.,   0.,  69., 70., 71., 72.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   81.,  82.,  83.,  84.,  0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   150., 152., 154., 156., 0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   85.,  86.,  87.,
      88.,  0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      89.,  90., 91., 92., 0.,  0.,   0.,   0.,   93.,  94.,  95.,  96.,  0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   97.,  98.,  99.,  100., 0.,   0.,
      0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   101., 102., 103.,
      104., 0.,  0.,  0.,  0.,  105., 106., 107., 108.};
  const std::array<int, 4> in_shape = {{3, 11, 11, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  5.,  6.,  7.,  8.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  9.,
      10., 11., 12., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 38., 40.,
      42., 44., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  25., 26., 27., 28., 0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  29., 30., 31., 32., 0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  37., 38., 39., 40., 0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      33., 34., 35., 36., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  41., 42., 43., 44., 0., 0., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  45., 46., 47., 48.};
  const std::array<int, 4> in_shape = {{3, 11, 11, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 1.,  0., 0.,  0., 2.,  0., 3., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 4.,  0., 0.,  0., 5.,  0., 6., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 7.,  0., 0.,
      0., 8.,  0., 9.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 10., 0., 0., 0., 11., 0., 12.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 13., 0., 0., 0., 14., 0., 15.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 16., 0., 0.,  0., 17., 0., 18., 0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 19., 0., 0.,
      0., 20., 0., 21., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 22., 0., 0.,
      0., 23., 0., 24., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 25., 0., 0.,  0., 26., 0., 27.};
  const std::array<int, 4> in_shape = {{3, 11, 12, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 1., 0., 0., 0., 2., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  3., 0., 0., 0., 4., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 5.,  0., 0., 0., 6., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 7.,  0., 0., 0.,  8., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 9., 0.,  0., 0., 10., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 11.,
      0., 0., 0., 12., 0.};
  const std::array<int, 4> in_shape = {{3, 11, 12, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 1.,  2.,  0., 0., 0.,  0.,
      0., 0., 3.,  4.,  0., 0., 5.,  6.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 7.,  8.,  0., 0., 0.,  0.,
      0., 0., 9.,  10., 0., 0., 11., 12., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 13., 14., 0., 0., 0.,  0.,
      0., 0., 15., 16., 0., 0., 17., 18., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 19., 20., 0., 0., 0.,  0.,  0., 0., 21., 22., 0., 0., 23., 24.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 25., 26., 0., 0., 0.,  0.,  0., 0., 27., 28., 0., 0., 29., 30.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 35., 36., 0., 0., 0.,  0.,  0., 0., 64., 66.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 37., 38., 0., 0., 0.,  0.,
      0., 0., 39., 40., 0., 0., 41., 42., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 43., 44., 0., 0., 0.,  0.,
      0., 0., 45., 46., 0., 0., 47., 48., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 49., 50., 0., 0., 0.,  0.,
      0., 0., 51., 52., 0., 0., 53., 54.};
  const std::array<int, 4> in_shape = {{3, 11, 12, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 1.,  2.,  0.,  0.,
      0., 0., 0., 0., 3.,  4.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 5.,  6.,  0.,  0.,
      0., 0., 0., 0., 7.,  8.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 9.,  10., 0., 0., 0., 0., 0., 0., 11., 12., 0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 15., 16., 0., 0., 0., 0., 0., 0., 0.,  0.,  13., 14.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 17., 18., 0.,  0.,
      0., 0., 0., 0., 19., 20., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 21., 22., 0.,  0.,
      0., 0., 0., 0., 23., 24., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 11, 12, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  1.,   2.,   3.,   4.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      5.,   6.,   7.,   8.,   0.,  0.,  0.,  0.,  9.,   10.,  11.,  12.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  13.,  14.,  15.,  16.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      17.,  18.,  19.,  20.,  0.,  0.,  0.,  0.,  21.,  22.,  23.,  24.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  25.,  26.,  27.,  28.,
      0.,   0.,   0.,   0.,   62., 64., 66., 68., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  37.,  38.,  39.,  40.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      41.,  42.,  43.,  44.,  0.,  0.,  0.,  0.,  45.,  46.,  47.,  48.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  49.,  50.,  51.,  52.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      53.,  54.,  55.,  56.,  0.,  0.,  0.,  0.,  57.,  58.,  59.,  60.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  69.,  70.,  71.,  72.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      126., 128., 130., 132., 0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  73.,  74.,  75.,  76.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      77.,  78.,  79.,  80.,  0.,  0.,  0.,  0.,  81.,  82.,  83.,  84.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  85.,  86.,  87.,  88.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      89.,  90.,  91.,  92.,  0.,  0.,  0.,  0.,  93.,  94.,  95.,  96.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  97.,  98.,  99.,  100.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      101., 102., 103., 104., 0.,  0.,  0.,  0.,  105., 106., 107., 108.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.};
  const std::array<int, 4> in_shape = {{3, 11, 12, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 21., 22., 23., 24., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 29., 30., 31., 32., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  25., 26., 27., 28.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 33., 34., 35., 36., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 37., 38., 39., 40., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 41., 42., 43., 44., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 45., 46., 47., 48., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 11, 12, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      1.,  0.,  0.,  0.,  2.,  0., 0.,  0.,  3.,  4.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  5., 0.,  0.,  0.,
      6.,  0.,  0.,  0.,  7.,  8., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  9.,  0.,  0., 0.,  10., 0.,
      0.,  0.,  11., 12., 0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  13., 0., 0.,  0.,  14., 0.,  0.,  0., 15., 16., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      17., 0.,  0.,  0.,  18., 0., 0.,  0.,  19., 20., 0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  21., 0.,
      0.,  0.,  22., 0.,  0.,  0., 23., 24., 0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  25., 0.,  0.,  0., 26., 0.,  0.,
      0.,  27., 28., 0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  0.,  0.,  29., 0., 0.,  0.,  30., 0.,  0.,  0., 31., 32., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,
      0.,  0.,  33., 0.,  0.,  0., 34., 0.,  0.,  0.,  35., 36.};
  const std::array<int, 4> in_shape = {{3, 11, 14, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1., 0., 0., 0., 2.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 3., 0., 0.,  0., 4.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 5., 0., 0., 0., 6., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 7., 0., 0., 0., 8., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 9., 0., 0.,  0., 10., 0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 11., 0., 0.,  0., 12., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 11, 14, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   1.,  2.,  0.,  0.,  0.,  0.,
      0., 0., 3.,  4.,  0., 0., 0.,   0.,   0.,  0.,  5.,  6.,  7.,  8.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   9.,  10., 0.,  0.,  0.,  0.,
      0., 0., 11., 12., 0., 0., 0.,   0.,   0.,  0.,  13., 14., 15., 16.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   17., 18., 0.,  0.,  0.,  0.,
      0., 0., 19., 20., 0., 0., 0.,   0.,   0.,  0.,  21., 22., 23., 24.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   25., 26., 0.,  0.,  0.,  0.,
      0., 0., 27., 28., 0., 0., 0.,   0.,   0.,  0.,  29., 30., 31., 32.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  82., 84., 86., 88.,
      0., 0., 0.,  0.,  0., 0., 152., 156., 0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   49., 50., 0.,  0.,  0.,  0.,
      0., 0., 51., 52., 0., 0., 0.,   0.,   0.,  0.,  53., 54., 55., 56.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   57., 58., 0.,  0.,  0.,  0.,
      0., 0., 59., 60., 0., 0., 0.,   0.,   0.,  0.,  61., 62., 63., 64.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,   0.,   65., 66., 0.,  0.,  0.,  0.,
      0., 0., 67., 68., 0., 0., 0.,   0.,   0.,  0.,  69., 70., 71., 72.};
  const std::array<int, 4> in_shape = {{3, 11, 14, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 1.,  2.,  0., 0., 0., 0.,  0., 0., 3.,  4.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 5.,  6.,  0., 0., 0., 0.,  0., 0., 7.,  8.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 9., 10., 0., 0., 0.,  0.,  0.,  0.,
      26., 28., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  13., 14.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 17., 18., 0.,  0.,
      0.,  0.,  0., 0., 19., 20., 0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 21., 22., 0.,  0.,
      0.,  0.,  0., 0., 23., 24., 0., 0., 0., 0.,  0., 0.};
  const std::array<int, 4> in_shape = {{3, 11, 14, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x11x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,   4.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   5.,   6.,   7.,   8.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   9.,   10.,  11.,  12.,
      13.,  14.,  15.,  16.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   17.,  18.,  19.,  20.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      58.,  60.,  62.,  64.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   66.,  68.,  70.,  72.,  74.,  76.,  78.,  80.,
      0.,   0.,   0.,   0.,   33.,  34.,  35.,  36.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   49.,  50.,  51.,  52.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   53.,  54.,  55.,  56.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      57.,  58.,  59.,  60.,  61.,  62.,  63.,  64.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   162., 164., 166., 168., 170., 172., 174., 176.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      300., 304., 308., 312., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   97.,  98.,  99.,  100.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      101., 102., 103., 104., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   226., 228., 230., 232., 234., 236., 238., 240.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   113., 114., 115., 116., 117., 118., 119., 120.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   129., 130., 131., 132.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      133., 134., 135., 136., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   137., 138., 139., 140., 141., 142., 143., 144.};
  const std::array<int, 4> in_shape = {{3, 11, 14, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x11x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      1.,  2.,  3.,   4.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  5.,  6.,   7.,   8.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 13., 14., 15., 16., 0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 9., 10.,
      11., 12., 0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  17., 18.,  19.,  20.,  0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  50.,  52.,  54.,  56.,  0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      25., 26., 27.,  28.,  0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  156., 160., 164., 168., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0., 0., 0.,  0.,  0.,  0.,  0., 0., 0.,
      0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 11, 14, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 1.,  0., 0., 0., 2.,
      0., 3.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 4.,  0., 0.,  0., 5.,  0., 6., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 7., 0., 0.,
      0., 8.,  0., 9.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 10.,
      0., 0.,  0., 11., 0., 12., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 13., 0., 0., 0., 14.,
      0., 15., 0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 16., 0., 0.,  0., 17., 0., 18., 0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 19., 0., 0.,  0., 20., 0., 21., 0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 22.,
      0., 0.,  0., 23., 0., 24., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,
      0., 0.,  0., 0.,  0., 25., 0., 0.,  0., 26., 0., 27.};
  const std::array<int, 4> in_shape = {{3, 12, 11, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 1., 0., 0.,  0., 2., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 3., 0., 0.,
      0.,  4., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      5.,  0., 0., 0., 6., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 7.,  0., 0., 0., 8., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 9., 0., 0., 0.,
      10., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 11., 0., 0., 0., 12., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 12, 11, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 1.,  2.,  0.,  0.,  0.,  0.,  0., 0., 3.,  4.,
      0., 0., 5.,  6.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 7.,  8.,
      0., 0., 0.,  0.,  0., 0., 9.,  10., 0.,  0.,  11., 12., 0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  13., 14., 0., 0., 0.,  0.,
      0., 0., 15., 16., 0., 0., 17., 18., 0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 19., 20.,
      0., 0., 0.,  0.,  0., 0., 21., 22., 0.,  0.,  23., 24., 0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 25., 26., 0.,  0.,  0.,  0.,  0., 0., 27., 28.,
      0., 0., 29., 30., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  35., 36., 0.,  0.,  0., 0., 64., 66.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 37., 38., 0.,  0.,  0.,  0.,  0., 0., 39., 40.,
      0., 0., 41., 42., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 43., 44.,
      0., 0., 0.,  0.,  0., 0., 45., 46., 0.,  0.,  47., 48., 0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  49., 50., 0., 0., 0.,  0.,
      0., 0., 51., 52., 0., 0., 53., 54.};
  const std::array<int, 4> in_shape = {{3, 12, 11, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      1.,  2.,  0., 0., 0., 0., 0., 0., 3.,  4.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 5.,  6.,  0., 0., 0., 0., 0., 0.,
      7.,  8.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 9.,  10., 0., 0., 0., 0., 0., 0.,
      11., 12., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      13., 14., 0., 0., 0., 0., 0., 0., 15., 16., 0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      17., 18., 0., 0., 0., 0., 0., 0., 19., 20., 0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0., 21., 22., 0., 0., 0., 0., 0., 0.,
      23., 24., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 12, 11, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   1.,  2.,  3.,  4.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  5.,  6.,   7.,   8.,   0.,   0.,   0.,   0.,
      9.,   10.,  11., 12., 0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   13.,  14.,  15.,  16.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   17.,
      18.,  19.,  20., 0.,  0.,  0.,  0.,   21.,  22.,  23.,  24.,  0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  25.,  26.,  27.,  28.,  0.,   0.,   0.,
      0.,   62.,  64., 66., 68., 0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   37.,  38.,  39.,
      40.,  0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      41.,  42.,  43., 44., 0.,  0.,  0.,   0.,   45.,  46.,  47.,  48.,  0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  49., 50., 51.,  52.,  0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   53.,  54.,  55.,  56.,  0.,   0.,
      0.,   0.,   57., 58., 59., 60., 0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   69.,  70.,  71.,  72.,  0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  126., 128., 130., 132., 0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  73., 74.,  75.,  76.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   77.,  78.,  79.,  80.,  0.,
      0.,   0.,   0.,  81., 82., 83., 84.,  0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   85.,
      86.,  87.,  88., 0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   89., 90., 91., 92., 0.,   0.,   0.,   0.,   93.,  94.,  95.,
      96.,  0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  97., 98., 99.,  100., 0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   101., 102., 103., 104., 105., 106.,
      107., 108., 0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,   0.};
  const std::array<int, 4> in_shape = {{3, 12, 11, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      1.,  2.,  3.,  4.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      5.,  6.,  7.,  8.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      9.,  10., 11., 12., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      13., 14., 15., 16., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      17., 18., 19., 20., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      21., 22., 23., 24., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      25., 26., 27., 28., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      29., 30., 31., 32., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      33., 34., 35., 36., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      37., 38., 39., 40., 0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      41., 42., 43., 44., 0., 0., 0., 0., 0., 0., 0., 0., 45., 46., 47., 48.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 12, 11, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 1.,  0., 0., 0., 2.,  0., 3.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 4.,  0., 0., 0., 5.,  0., 6.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 7.,  0., 0., 0., 8.,  0., 9.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 10., 0., 0., 0., 11., 0., 12., 0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 13., 0., 0., 0., 14., 0., 15., 0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 16., 0., 0., 0., 17., 0., 18.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 19., 0., 0., 0., 20., 0., 21., 0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 22., 0., 0., 0., 23., 0., 24., 0., 0.,  0., 0., 0., 0.,  0., 0.,
      0., 0.,  0., 0., 0., 0.,  0., 0.,  0., 25., 0., 0., 0., 26., 0., 27.};
  const std::array<int, 4> in_shape = {{3, 12, 12, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 1.,  0., 0., 0.,  2., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  3., 0., 0., 0.,  4., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 5., 0., 0., 0., 6., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 7., 0.,
      0., 0., 8., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 9., 0.,  0., 0., 10., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 11., 0., 0., 0., 12., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 12, 12, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 1.,  2.,  0., 0., 0.,  0.,  0., 0., 3.,  4.,  0., 0., 5.,   6.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 7.,  8.,  0., 0., 0.,  0.,  0., 0., 9.,  10., 0., 0., 11.,  12.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 13., 14., 0., 0., 0.,  0.,  0., 0., 15., 16., 0., 0., 17.,  18.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 19., 20., 0., 0., 0.,  0.,  0., 0., 21., 22., 0., 0., 23.,  24.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 64., 66., 0., 0., 0.,  0.,  0., 0., 116., 120.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 37., 38., 0., 0., 0.,  0.,  0., 0., 39., 40., 0., 0., 41.,  42.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 43., 44., 0., 0., 0.,  0.,  0., 0., 45., 46., 0., 0., 47.,  48.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 49., 50., 0., 0., 0.,  0.,  0., 0., 51., 52., 0., 0., 53.,  54.};
  const std::array<int, 4> in_shape = {{3, 12, 12, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 1.,  2.,  0.,  0.,
      0., 0., 0., 0., 3.,  4.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 5.,  6.,  0.,  0.,
      0., 0., 0., 0., 7.,  8.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 9.,  10., 0.,  0.,
      0., 0., 0., 0., 11., 12., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 15., 16., 0., 0., 0., 0., 0., 0., 0.,  0.,  13., 14.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 17., 18., 0.,  0.,
      0., 0., 0., 0., 19., 20., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 21., 22., 0.,  0.,
      0., 0., 0., 0., 23., 24., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 12, 12, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  1.,   2.,   3.,   4.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      5.,   6.,   7.,   8.,   0.,  0.,  0.,  0.,  9.,   10.,  11.,  12.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  13.,  14.,  15.,  16.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      17.,  18.,  19.,  20.,  0.,  0.,  0.,  0.,  21.,  22.,  23.,  24.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  25.,  26.,  27.,  28.,
      0.,   0.,   0.,   0.,   62., 64., 66., 68., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  37.,  38.,  39.,  40.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      41.,  42.,  43.,  44.,  0.,  0.,  0.,  0.,  45.,  46.,  47.,  48.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  126., 128., 130., 132.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      228., 232., 236., 240., 0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  73.,  74.,  75.,  76.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      77.,  78.,  79.,  80.,  0.,  0.,  0.,  0.,  81.,  82.,  83.,  84.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  182., 184., 186., 188.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      190., 192., 194., 196., 0.,  0.,  0.,  0.,  198., 200., 202., 204.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,  0.,  0.,  0.,  0.,   0.,   0.,   0.};
  const std::array<int, 4> in_shape = {{3, 12, 12, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 21., 22., 23., 24., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 29., 30., 31., 32., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  25., 26., 27., 28.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 33., 34., 35., 36., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 37., 38., 39., 40., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 41., 42., 43., 44., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 45., 46., 47., 48., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 12, 12, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 1.,  0.,  0., 0., 2.,  0.,
      0., 0., 3.,  4.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 5.,  0.,  0., 0., 6.,  0.,  0., 0., 7.,  8.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 9.,  0.,
      0., 0., 10., 0.,  0., 0., 11., 12., 0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 13., 0.,  0., 0., 14., 0.,  0., 0., 15., 16., 0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 17., 0.,  0., 0., 18., 0.,
      0., 0., 19., 20., 0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 21., 0.,  0., 0., 22., 0.,  0., 0., 23., 24.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 25., 0.,  0., 0., 26., 0.,
      0., 0., 27., 28., 0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,
      0., 0., 29., 0.,  0., 0., 30., 0.,  0., 0., 31., 32., 0., 0., 0.,  0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 33., 0.,
      0., 0., 34., 0.,  0., 0., 35., 36.};
  const std::array<int, 4> in_shape = {{3, 12, 14, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 1.,  0.,  0., 0., 2., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 3.,  0., 0., 0., 4., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 5., 0., 0.,  0.,  6., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 7., 0., 0.,  0., 8., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 9., 0., 0., 0., 10., 0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  11., 0., 0., 0., 12., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 12, 14, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 1.,  2.,  0.,  0.,  0., 0., 0., 0., 3.,  4.,  0.,  0.,
      0., 0., 0., 0., 5.,  6.,  7.,  8.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 9.,  10., 0.,  0.,  0., 0., 0., 0., 11., 12., 0.,  0.,
      0., 0., 0., 0., 13., 14., 15., 16., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 17., 18., 0.,  0.,
      0., 0., 0., 0., 19., 20., 0.,  0.,  0., 0., 0., 0., 21., 22., 23., 24.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 25., 26., 0.,  0.,  0., 0., 0., 0., 27., 28., 0.,  0.,
      0., 0., 0., 0., 66., 68., 70., 72., 0., 0., 0., 0., 0.,  0.,  68., 70.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 41., 42., 0.,  0.,
      0., 0., 0., 0., 43., 44., 0.,  0.,  0., 0., 0., 0., 45., 46., 47., 48.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 49., 50., 0.,  0.,  0., 0., 0., 0., 51., 52., 0.,  0.,
      0., 0., 0., 0., 53., 54., 55., 56., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 57., 58., 0.,  0.,  0., 0., 0., 0., 59., 60., 0.,  0.,
      0., 0., 0., 0., 61., 62., 63., 64., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0.,  0.,  0., 0., 0., 0., 65., 66., 0.,  0.,
      0., 0., 0., 0., 67., 68., 0.,  0.,  0., 0., 0., 0., 69., 70., 71., 72.};
  const std::array<int, 4> in_shape = {{3, 12, 14, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 1.,  2.,  0., 0., 0., 0., 0., 0., 3.,  4.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 5.,  6.,  0., 0., 0., 0., 0., 0., 7.,  8.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      26., 28., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  22., 24.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 17., 18., 0., 0., 0., 0., 0., 0., 19., 20., 0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 21., 22., 0., 0., 0., 0., 0., 0., 23., 24., 0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 12, 14, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x12x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      5.,   6.,   7.,   8.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   9.,   10.,  11.,  12.,  13.,  14.,  15.,  16.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      58.,  60.,  62.,  64.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   66.,  68.,  70.,  72.,  74.,  76.,  78.,  80.,
      0.,   0.,   0.,   0.,   50.,  52.,  54.,  56.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   49.,  50.,  51.,  52.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      53.,  54.,  55.,  56.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   130., 132., 134., 136., 138., 140., 142., 144.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      134., 136., 138., 140., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   81.,  82.,  83.,  84.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      85.,  86.,  87.,  88.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   89.,  90.,  91.,  92.,  93.,  94.,  95.,  96.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   105., 106., 107., 108., 109., 110., 111., 112.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   210., 212., 214., 216., 218., 220., 222., 224.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      121., 122., 123., 124., 125., 126., 127., 128., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   129., 130., 131., 132.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      133., 134., 135., 136., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   137., 138., 139., 140., 141., 142., 143., 144.};
  const std::array<int, 4> in_shape = {{3, 12, 14, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x12x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      1.,  2.,  3.,  4.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  5.,  6.,  7.,  8.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 13., 14., 15., 16., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  9., 10.,
      11., 12., 0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  50., 52., 54., 56., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      42., 44., 46., 48., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  70., 72., 74., 76., 0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 41., 42., 43., 44., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  45., 46., 47., 48., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 12, 14, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  1.,  0., 0.,  0.,  2.,  0., 3.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  4.,  0.,  0., 0.,  5.,  0.,  6., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  7.,  0.,  0.,  0., 8.,  0.,  9.,  0., 0.,  0.,  0.,  10., 0.,  0.,
      0.,  11., 0.,  12., 0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  13., 0., 0.,  0.,  14., 0.,  15., 0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  16., 0.,  0., 0.,  17., 0.,  18., 0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 19., 0.,  0.,  0., 20., 0.,  21., 0.,  0.,  0.,
      0.,  22., 0.,  0.,  0., 23., 0.,  24., 0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  25., 0.,  0.,  0.,
      26., 0.,  27., 0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  28., 0.,  0.,  0.,  29.,
      0.,  30., 0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0., 0.,  0.,  0.,  0., 31., 0.,  0.,  0.,  32., 0.,
      33., 0.,  0.,  0.,  0., 34., 0.,  0.,  0., 35., 0.,  36.};
  const std::array<int, 4> in_shape = {{3, 14, 11, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x11x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      1., 0., 0., 0., 2., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 3., 0., 0.,  0., 4., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 5.,  0., 0., 0., 6.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      7., 0., 0., 0., 8., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 9., 0., 0., 0., 10., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 11., 0., 0., 0., 12., 0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,
      0., 0., 0., 0., 0., 0., 0.,  0., 0., 0., 0.,  0.};
  const std::array<int, 4> in_shape = {{3, 14, 11, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  1.,  2.,  0.,  0.,  0.,  0.,  0.,  0.,  3.,
      4.,  0.,  0.,  5.,  6.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  7.,  8.,  0.,  0.,  0.,  0.,  0.,  0.,  9.,  10., 0.,
      0.,  11., 12., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  13., 14., 0.,  0.,  0.,  0.,  0.,  0.,  15., 16., 0.,  0.,  17.,
      18., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  19., 20., 0.,  0.,  0.,  0.,
      0.,  0.,  21., 22., 0.,  0.,  23., 24., 0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  25.,
      26., 0.,  0.,  0.,  0.,  0.,  0.,  27., 28., 0.,  0.,  29., 30., 0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  31., 32., 0.,
      0.,  0.,  0.,  0.,  0.,  33., 34., 0.,  0.,  76., 78., 0.,  0.,  0.,  0.,
      76., 78., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  43., 44., 0.,  0.,  0.,  0.,  0.,  0.,  45., 46., 0.,  0.,  47.,
      48., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  49., 50., 0.,  0.,  0.,  0.,  0.,  0.,
      51., 52., 0.,  0.,  53., 54., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  55., 56., 0.,  0.,  0.,  0.,  0.,  0.,  57., 58.,
      0.,  0.,  59., 60., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,  0.,  61., 62., 0.,  0.,  0.,  0.,  0.,  0.,  63., 64., 0.,  0.,
      65., 66., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  67., 68., 0.,  0.,  0.,
      0.,  0.,  0.,  69., 70., 0.,  0.,  71., 72.};
  const std::array<int, 4> in_shape = {{3, 14, 11, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x11x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      1.,  2.,  0., 0., 0., 0.,  0., 0., 3.,  4.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 5.,  6.,  0., 0., 0.,  0.,  0.,  0.,
      7.,  8.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 9., 10., 0., 0., 0.,  0.,  0., 0., 11., 12., 0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 15., 16., 0., 0., 0.,  0.,  13., 14.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 17., 18., 0., 0., 0.,  0.,  0.,  0.,
      19., 20., 0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      21., 22., 0., 0., 0., 0.,  0., 0., 23., 24., 0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0.,  0.,
      0.,  0.,  0., 0., 0., 0.,  0., 0., 0.,  0.,  0., 0.};
  const std::array<int, 4> in_shape = {{3, 14, 11, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,   4.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   5.,   6.,   7.,   8.,   0.,   0.,   0.,   0.,
      9.,   10.,  11.,  12.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   13.,  14.,  15.,  16.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      17.,  18.,  19.,  20.,  0.,   0.,   0.,   0.,   21.,  22.,  23.,  24.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   62.,  64.,  66.,  68.,
      0.,   0.,   0.,   0.,   148., 152., 156., 160., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   49.,  50.,  51.,  52.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   53.,  54.,  55.,  56.,
      0.,   0.,   0.,   0.,   57.,  58.,  59.,  60.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      61.,  62.,  63.,  64.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   65.,  66.,  67.,  68.,  0.,   0.,   0.,   0.,
      150., 152., 154., 156., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      150., 152., 154., 156., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   85.,  86.,  87.,  88.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   89.,  90.,  91.,  92.,
      0.,   0.,   0.,   0.,   93.,  94.,  95.,  96.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   97.,  98.,  99.,  100.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      101., 102., 103., 104., 0.,   0.,   0.,   0.,   105., 106., 107., 108.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      230., 232., 234., 236., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   238., 240., 242., 244., 246., 248., 250., 252.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   133., 134., 135., 136.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      137., 138., 139., 140., 0.,   0.,   0.,   0.,   141., 142., 143., 144.};
  const std::array<int, 4> in_shape = {{3, 14, 11, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x11x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  1.,  2.,  3.,  4.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  5.,  6.,  7.,  8.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 9.,
      10., 11., 12., 0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      13., 14., 15., 16., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  17., 18., 19., 20., 0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  21., 22., 23., 24., 0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  29., 30., 31., 32., 0.,  0.,  0., 0., 0., 0., 0., 0.,
      25., 26., 27., 28., 0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  74., 76., 78., 80., 0., 0., 0., 0., 0., 0.,
      0.,  0.,  82., 84., 86., 88., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0.,
      0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 14, 11, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 1.,  0., 0.,  0., 2.,  0., 3.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 4.,  0., 0.,  0., 5.,  0., 6.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 7.,  0., 0.,  0., 8.,  0., 9.,  0., 0.,  0., 0.,
      0., 10., 0., 0.,  0., 11., 0., 12., 0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 13., 0., 0.,
      0., 14., 0., 15., 0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 16., 0., 0.,
      0., 17., 0., 18., 0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 19., 0., 0.,
      0., 20., 0., 21., 0., 0.,  0., 0.,  0., 22., 0., 0.,  0., 23., 0., 24.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 25., 0., 0.,  0., 26., 0., 27., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 28., 0., 0.,  0., 29., 0., 30., 0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,  0., 0.,
      0., 0.,  0., 0.,  0., 31., 0., 0.,  0., 32., 0., 33., 0., 0.,  0., 0.,
      0., 34., 0., 0.,  0., 35., 0., 36.};
  const std::array<int, 4> in_shape = {{3, 14, 12, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x12x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 1.,  0., 0., 0., 2., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 3.,  0., 0., 0.,  4., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  5., 0., 0.,  0., 6., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 7., 0., 0.,  0., 8., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 9., 0.,  0., 0., 10., 0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 11., 0., 0., 0., 12., 0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.,  0., 0., 0., 0., 0., 0.,
      0., 0., 0., 0.,  0., 0., 0., 0.,  0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 14, 12, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 1.,  2.,  0., 0., 0.,   0.,
      0., 0., 3.,  4.,  0., 0., 5.,  6.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 7.,  8.,  0., 0., 0.,   0.,
      0., 0., 9.,  10., 0., 0., 11., 12., 0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 13., 14., 0., 0., 0.,   0.,
      0., 0., 15., 16., 0., 0., 17., 18., 0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 19., 20., 0., 0., 0.,  0.,  0., 0., 21., 22., 0., 0., 23.,  24.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 25., 26., 0., 0., 0.,   0.,
      0., 0., 27., 28., 0., 0., 29., 30., 0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 76., 78., 0., 0., 0.,  0.,  0., 0., 140., 144.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 43., 44., 0., 0., 0.,  0.,  0., 0., 45., 46., 0., 0., 47.,  48.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 49., 50., 0., 0., 0.,   0.,
      0., 0., 51., 52., 0., 0., 53., 54., 0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 55., 56., 0., 0., 0.,   0.,
      0., 0., 57., 58., 0., 0., 59., 60., 0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 0.,  0.,  0., 0., 0.,  0.,  0., 0., 61., 62., 0., 0., 0.,   0.,
      0., 0., 63., 64., 0., 0., 65., 66., 0., 0., 0.,  0.,  0., 0., 0.,   0.,
      0., 0., 67., 68., 0., 0., 0.,  0.,  0., 0., 69., 70., 0., 0., 71.,  72.};
  const std::array<int, 4> in_shape = {{3, 14, 12, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x12x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 1.,  2.,  0.,  0.,
      0., 0., 0., 0., 3.,  4.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 5.,  6.,  0.,  0.,
      0., 0., 0., 0., 7.,  8.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 9.,  10., 0.,  0.,
      0., 0., 0., 0., 26., 28., 0., 0., 0., 0., 0., 0., 0.,  0.,  13., 14.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 17., 18., 0.,  0.,
      0., 0., 0., 0., 19., 20., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 21., 22., 0.,  0.,
      0., 0., 0., 0., 23., 24., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 14, 12, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   2.,   3.,   4.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      5.,   6.,   7.,   8.,   0.,   0.,   0.,   0.,   9.,   10.,  11.,  12.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   13.,  14.,  15.,  16.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      17.,  18.,  19.,  20.,  0.,   0.,   0.,   0.,   21.,  22.,  23.,  24.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   62.,  64.,  66.,  68.,
      0.,   0.,   0.,   0.,   148., 152., 156., 160., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   49.,  50.,  51.,  52.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      53.,  54.,  55.,  56.,  0.,   0.,   0.,   0.,   57.,  58.,  59.,  60.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   150., 152., 154., 156.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      276., 280., 284., 288., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   85.,  86.,  87.,  88.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      89.,  90.,  91.,  92.,  0.,   0.,   0.,   0.,   93.,  94.,  95.,  96.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   206., 208., 210., 212.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      214., 216., 218., 220., 0.,   0.,   0.,   0.,   222., 224., 226., 228.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   121., 122., 123., 124.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      125., 126., 127., 128., 0.,   0.,   0.,   0.,   129., 130., 131., 132.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   133., 134., 135., 136.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      137., 138., 139., 140., 0.,   0.,   0.,   0.,   141., 142., 143., 144.};
  const std::array<int, 4> in_shape = {{3, 14, 12, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x12x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 9.,  10., 11., 12., 13., 14., 15., 16.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 17., 18., 19., 20., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 50., 52., 54., 56., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  25., 26., 27., 28.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 33., 34., 35., 36., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 37., 38., 39., 40., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 41., 42., 43., 44., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 45., 46., 47., 48., 0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 14, 12, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      1.,  0.,   0.,  0., 2., 0.,  0.,  0.,  3.,  4.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  5.,  0.,  0.,  0.,
      6.,  0.,   0.,  0., 7., 8.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  9.,  0.,  0.,  0.,  10., 0.,  0.,  0.,
      11., 12.,  0.,  0., 0., 0.,  13., 0.,  0.,  0.,  14., 0.,  0.,  0.,  15.,
      16., 0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  17.,  0.,  0., 0., 18., 0.,  0.,  0.,  19., 20., 0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  21., 0.,  0.,
      0.,  22.,  0.,  0., 0., 23., 24., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  25., 0.,  0.,  0.,  26., 0.,  0.,
      0.,  27.,  28., 0., 0., 0.,  0.,  29., 0.,  0.,  0.,  30., 0.,  0.,  0.,
      31., 32.,  0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   33., 0., 0., 0.,  34., 0.,  0.,  0.,  35., 36., 0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  84., 0.,  0.,  0.,  0.,  78., 0.,
      0.,  162., 0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,
      0.,  0.,   0.,  0., 0., 0.,  0.,  0.,  45., 0.,  0.,  0.,  46., 0.,  0.,
      0.,  47.,  48.};
  const std::array<int, 4> in_shape = {{3, 14, 14, 1}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x14x1) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      1.,  0., 0., 0., 2., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 3., 0., 0., 0., 4.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 5., 0.,
      0.,  0., 6., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      7.,  0., 0., 0., 8., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 9., 0., 0., 0.,
      10., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 11., 12., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
      0.,  0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0., 0.};
  const std::array<int, 4> in_shape = {{3, 14, 14, 1}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   1.,   2.,   0.,   0.,   0.,  0.,   0.,   0.,  3.,  4.,
      0.,  0.,  0.,   0.,   0.,   0.,   5.,   6.,  7.,   8.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  9.,  10.,
      0.,  0.,  0.,   0.,   0.,   0.,   11.,  12., 0.,   0.,   0.,  0.,  0.,
      0.,  13., 14.,  15.,  16.,  0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   17.,  18., 0.,   0.,   0.,  0.,  0.,
      0.,  19., 20.,  0.,   0.,   0.,   0.,   0.,  0.,   21.,  22., 23., 24.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  25.,  26.,  0.,  0.,  0.,
      0.,  0.,  0.,   27.,  28.,  0.,   0.,   0.,  0.,   0.,   0.,  29., 30.,
      31., 32., 0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   82.,  84., 86.,  88.,  0.,  0.,  0.,
      0.,  0.,  0.,   152., 156., 0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  49.,  50.,  0.,  0.,  0.,
      0.,  0.,  0.,   51.,  52.,  0.,   0.,   0.,  0.,   0.,   0.,  53., 54.,
      55., 56., 0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   57., 58., 0.,
      0.,  0.,  0.,   0.,   0.,   59.,  60.,  0.,  0.,   0.,   0.,  0.,  0.,
      61., 62., 63.,  64.,  0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   65., 66.,  0.,   0.,  0.,  0.,
      0.,  0.,  67.,  68.,  0.,   0.,   0.,   0.,  0.,   0.,   69., 70., 71.,
      72., 0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   166., 168., 0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  154., 156., 0.,   0.,   0.,   0.,  320., 324., 0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  0.,
      0.,  0.,  0.,   0.,   0.,   0.,   0.,   0.,  0.,   0.,   0.,  0.,  89.,
      90., 0.,  0.,   0.,   0.,   0.,   0.,   91., 92.,  0.,   0.,  0.,  0.,
      0.,  0.,  93.,  94.,  95.,  96.};
  const std::array<int, 4> in_shape = {{3, 14, 14, 2}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x14x2) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 1., 2., 0.,  0.,  0., 0., 0.,
      0.,  3.,  4.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  5.,  6.,  0., 0., 0., 0., 0., 0., 7., 8.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  11., 12., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      22., 24., 0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 15., 16., 0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 17., 18., 0., 0., 0.,
      0.,  0.,  0.,  19., 20., 0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      21., 22., 23., 24., 0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0., 0., 0., 0., 0., 0., 0., 0.,  0.,  0., 0., 0.,
      0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 14, 14, 2}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, SAME3x14x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      1.,   2.,   3.,   4.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   5.,   6.,   7.,   8.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   9.,   10.,  11.,  12.,
      13.,  14.,  15.,  16.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   17.,  18.,  19.,  20.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      58.,  60.,  62.,  64.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   66.,  68.,  70.,  72.,  74.,  76.,  78.,  80.,
      0.,   0.,   0.,   0.,   33.,  34.,  35.,  36.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      49.,  50.,  51.,  52.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   53.,  54.,  55.,  56.,  0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   57.,  58.,  59.,  60.,
      61.,  62.,  63.,  64.,  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   162., 164., 166., 168., 170., 172., 174., 176.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      300., 304., 308., 312., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   97.,  98.,  99.,  100.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      101., 102., 103., 104., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   226., 228., 230., 232., 234., 236., 238., 240.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   113., 114., 115., 116., 117., 118., 119., 120.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   129., 130., 131., 132.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      133., 134., 135., 136., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   137., 138., 139., 140., 141., 142., 143., 144.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   330., 332., 334., 336.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   306., 308., 310., 312., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   636., 640., 644., 648., 0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   177., 178., 179., 180.,
      0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      181., 182., 183., 184., 0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
      0.,   0.,   0.,   0.,   185., 186., 187., 188., 189., 190., 191., 192.};
  const std::array<int, 4> in_shape = {{3, 14, 14, 4}};
  const auto padding = PaddingMode::SAME;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
TYPED_TEST(MaxWindow7Stride4Grad, VALID3x14x14x4) {
  using DataType = typename TestFixture::DataType;
  const std::vector<DataType> exp_out = {
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      1.,  2.,  3.,  4.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  5.,  6.,  7.,  8.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  13., 14., 15., 16., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  9., 10.,
      11., 12., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  21., 22., 23., 24., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      42., 44., 46., 48., 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  29., 30., 31., 32., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  33., 34., 35., 36., 0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  37., 38., 39., 40., 0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      41., 42., 43., 44., 45., 46., 47., 48., 0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0., 0.,
      0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.};
  const std::array<int, 4> in_shape = {{3, 14, 14, 4}};
  const auto padding = PaddingMode::VALID;
  const auto params = getPoolingParams<7, 4>(in_shape, padding);
  const DataType max_input_val = 512.0;
  this->test_pool(exp_out, params, max_input_val);
}
